var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="viewer3D.min.cp.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0,FORCE_USE_LOCAL_WORKER_SCRIPT=!1;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return e}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,e=new Uint8Array(this,a,c),d=new Uint8Array(c),f=0;f<c;f++)d[f]=e[f];return d.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ESCAPE_EVENT="escape";Autodesk.Viewing.PROGRESS_UPDATE_EVENT="progress";Autodesk.Viewing.FULLSCREEN_MODE_EVENT="fullScreenMode";Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT="navmode";
Autodesk.Viewing.Viewer=function(a,b){this.clientContainer=a;this.container=document.createElement("div");this.container.className="adsk-viewing-viewer";this.container.style.height="100%";this.container.style.width="100%";this.container.style.overflow="hidden";this.clientContainer.appendChild(this.container);this.listeners={};this.dockingPanels=[];this.config=b;this.screenModeDelegateClass=this.screenModeDelegate=null;this.setScreenModeDelegate(b?b.screenModeDelegate:void 0)};
Autodesk.Viewing.Viewer.prototype={load:function(a,b){throw"bool load(urn, function(void)) must be implemented.  For more details, read the Viewer class documentation.";}};Autodesk.Viewing.Viewer.prototype.initialize=function(){var a=this;this.onResizeCallback=function(b){a.resize()};window.addEventListener("resize",this.onResizeCallback,!1)};
Autodesk.Viewing.Viewer.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.container=null;this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.config=this.clientContainer=null;this.listeners={};this.dockingPanels=[];window.removeEventListener("resize",this.onResizeCallback,!1)};Autodesk.Viewing.Viewer.prototype.addEventListener=function(a,b){"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push(b)};
Autodesk.Viewing.Viewer.prototype.removeEventListener=function(a,b){if(this.listeners[a]instanceof Array)for(var c=this.listeners[a],e=0,d=c.length;e<d;e++)if(c[e]===b){c.splice(e,1);break}};Autodesk.Viewing.Viewer.prototype.fireEvent=function(a){"string"==typeof a&&(a={type:a});a.target||(a.target=this);if(!a.type)throw Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=this.listeners[a.type].slice(),c=0;c<b.length;c++)b[c].call(this,a)};
Autodesk.Viewing.Viewer.prototype.getDimensions=function(){if(this.container){var a={};this.getScreenMode()===this.ScreenMode.kFullScreen?(a.width=screen.width,a.height=screen.height):a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}}return null};Autodesk.Viewing.Viewer.prototype.setViewFromArray=function(a){};Autodesk.Viewing.Viewer.prototype.setViewFromFile=function(){};Autodesk.Viewing.Viewer.prototype.resize=function(){this.resizePanels()};
Autodesk.Viewing.Viewer.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)?(this.dockingPanels.push(a),!0):!1};Autodesk.Viewing.Viewer.prototype.removePanel=function(a){a=this.dockingPanels.indexOf(a);return-1<a?(this.dockingPanels.splice(a,1),!0):!1};
Autodesk.Viewing.Viewer.prototype.resizePanels=function(a){var b=a?a.viewer:null;b||(b=this);a=a?a.dockingPanels:null;a||(a=b.dockingPanels);for(var c=b.container.getBoundingClientRect(),b=c.top,e=c.bottom,d=c.left,f=c.right,g=c.width,c=c.height,h=0;h<a.length;++h){var k=a[h].container,l=k.getBoundingClientRect(),m=l.top,m=l.bottom,n=l.left,n=l.right,p=l.width,l=l.height;if(p&&l){g<p&&(p=Math.round(g),k.style.width=p+"px");c<l&&(l=Math.round(c),k.style.height=l+"px");if(f<n||k.dockRight)n=Math.round(f-
p-d),k.style.left=n+"px";if(e<m||k.dockBottom)m=Math.round(e-l-b),k.style.top=m+"px";k.style.maxWidth=Math.round(g)+"px";k.style.maxHeight=Math.round(c)+"px"}}};Autodesk.Viewing.Viewer.prototype.search=function(a,b,c){};Autodesk.Viewing.Viewer.prototype.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};
Autodesk.Viewing.Viewer.prototype.setScreenModeDelegate=function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.screenModeDelegateClass=a?a:null===a?Autodesk.Viewing.NullScreenModeDelegate:Autodesk.Viewing.ViewerScreenModeDelegate};Autodesk.Viewing.Viewer.prototype.getScreenModeDelegate=function(){this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this));return this.screenModeDelegate};
Autodesk.Viewing.Viewer.prototype.isScreenModeSupported=function(a){return this.getScreenModeDelegate().isModeSupported(a)};Autodesk.Viewing.Viewer.prototype.canChangeScreenMode=function(){return this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.kNormal)};Autodesk.Viewing.Viewer.prototype.setScreenMode=function(a){return this.getScreenModeDelegate().setMode(a)};Autodesk.Viewing.Viewer.prototype.getScreenMode=function(){return this.getScreenModeDelegate().getMode()};
Autodesk.Viewing.Viewer.prototype.nextScreenMode=function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a?this.setScreenMode(a):!1};Autodesk.Viewing.Viewer.prototype.escapeScreenMode=function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a?this.setScreenMode(a):!1};
Autodesk.Viewing.ScreenModeDelegate=function(a){this.viewer=a;this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this);this.getMode()===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",
this.bindFullscreenEventListener,!1))};Autodesk.Viewing.ScreenModeDelegate.prototype.uninitialize=function(){document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1);this.viewer=null};
Autodesk.Viewing.ScreenModeDelegate.prototype.isModeSupported=function(a){return!0};Autodesk.Viewing.ScreenModeDelegate.prototype.setMode=function(a){var b=this.getMode();if(a!==b&&this.isModeSupported(a)){this.doScreenModeChange(b,a);if(b!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)this.onScreenModeChanged(b,a);return!0}return!1};Autodesk.Viewing.ScreenModeDelegate.prototype.getMode=function(){throw"Implement getMode() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.getNextMode=function(){var a=this.getMode(),b;a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser&&
this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:
a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)&&(b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser);return b};Autodesk.Viewing.ScreenModeDelegate.prototype.getEscapeMode=function(){return this.getMode()!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal?Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:void 0};
Autodesk.Viewing.ScreenModeDelegate.prototype.fullscreenEventListener=function(){if(inFullscreen())this.viewer.resize();else{var a=Autodesk.Viewing.Viewer.prototype.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal);this.onScreenModeChanged(a.kFullScreen,a.kNormal)}};Autodesk.Viewing.ScreenModeDelegate.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.onScreenModeChanged=function(a,b){a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen?(document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1)):b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&
(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1));this.viewer.resize();this.viewer.fireEvent({type:Autodesk.Viewing.FULLSCREEN_MODE_EVENT,mode:b})};
Autodesk.Viewing.ViewerScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ViewerScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ViewerScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ViewerScreenModeDelegate;
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===this.viewer.container?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:this.viewer.container.classList.contains("viewer-fill-browser")?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal};
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var c=this.viewer.container;switch(b){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:c.classList.remove("viewer-fill-browser");exitFullscreen();break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:c.classList.add("viewer-fill-browser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:c.classList.add("viewer-fill-browser"),launchFullscreen(c)}};
Autodesk.Viewing.ApplicationScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ApplicationScreenModeDelegate;Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.isModeSupported=function(a){return a!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser};
Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===document.documentElement?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.doScreenModeChange=function(a,b){b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal?exitFullscreen():b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&launchFullscreen(document.documentElement)};
Autodesk.Viewing.NullScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.NullScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.NullScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ScreenModeDelegate;Autodesk.Viewing.NullScreenModeDelegate.prototype.isModeSupported=function(a){return!1};Autodesk.Viewing.NullScreenModeDelegate.prototype.getMode=function(){return Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal};var THREE={REVISION:"66"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var d=Date.now(),c=Math.max(0,16-(d-a)),g=self.setTimeout(function(){b(d+c)},c);a=d+c;return g});void 0===self.cancelAnimationFrame&&void 0!==
self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;
THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;
THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;
THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1099;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;
THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var e=function(a,b,g){0>g&&(g+=1);1<g&&(g-=1);return g<1/6?a+6*(b-a)*
g:0.5>g?b:g<2/3?a+6*(b-a)*(2/3-g):a};b=0.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=e(c,b,a+1/3);this.g=e(c,b,a);this.b=e(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<
8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,e=this.b,d=Math.max(b,c,e),f=Math.min(b,c,e),g,h=(f+d)/2;if(f===d)f=g=0;else{var k=d-f,f=0.5>=h?k/(d+f):k/(2-d-f);switch(d){case b:g=(c-e)/k+(c<e?6:0);break;case c:g=(e-b)/k+2;break;case e:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
b,c){var e=this.getHSL();e.h+=a;e.s+=b;e.l+=c;this.setHSL(e.h,e.s,e.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==e?e:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(a){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(a){this._x=a;this._updateEuler()},get y(){return this._y},set y(a){this._y=a;this._updateEuler()},get z(){return this._z},set z(a){this._z=a;this._updateEuler()},get w(){return this._w},set w(a){this._w=a;this._updateEuler()},set:function(a,b,c,e){this._x=a;this._y=b;this._z=c;this._w=
e;this._updateEuler();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._w=a._w;this._updateEuler();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var c=Math.cos(a._x/2),e=Math.cos(a._y/2),d=Math.cos(a._z/2),f=Math.sin(a._x/2),g=Math.sin(a._y/2),h=Math.sin(a._z/2);"XYZ"===a.order?(this._x=f*e*d+c*g*h,this._y=c*
g*d-f*e*h,this._z=c*e*h+f*g*d,this._w=c*e*d-f*g*h):"YXZ"===a.order?(this._x=f*e*d+c*g*h,this._y=c*g*d-f*e*h,this._z=c*e*h-f*g*d,this._w=c*e*d+f*g*h):"ZXY"===a.order?(this._x=f*e*d-c*g*h,this._y=c*g*d+f*e*h,this._z=c*e*h+f*g*d,this._w=c*e*d-f*g*h):"ZYX"===a.order?(this._x=f*e*d-c*g*h,this._y=c*g*d+f*e*h,this._z=c*e*h-f*g*d,this._w=c*e*d+f*g*h):"YZX"===a.order?(this._x=f*e*d+c*g*h,this._y=c*g*d+f*e*h,this._z=c*e*h-f*g*d,this._w=c*e*d-f*g*h):"XZY"===a.order&&(this._x=f*e*d-c*g*h,this._y=c*g*d-f*e*h,
this._z=c*e*h+f*g*d,this._w=c*e*d+f*g*h);!1!==b&&this._updateEuler();return this},setFromAxisAngle:function(a,b){var c=b/2,e=Math.sin(c);this._x=a.x*e;this._y=a.y*e;this._z=a.z*e;this._w=Math.cos(c);this._updateEuler();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var e=b[8],d=b[1],f=b[5],g=b[9],h=b[2],k=b[6],b=b[10],l=c+f+b;0<l?(c=0.5/Math.sqrt(l+1),this._w=0.25/c,this._x=(k-g)*c,this._y=(e-h)*c,this._z=(d-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=
0.25*c,this._y=(a+d)/c,this._z=(e+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(e-h)/c,this._x=(a+d)/c,this._y=0.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(d-a)/c,this._x=(e+h)/c,this._y=(g+k)/c,this._z=0.25*c);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*
this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,e=a._y,d=a._z,f=
a._w,g=b._x,h=b._y,k=b._z,l=b._w;this._x=c*l+f*g+e*k-d*h;this._y=e*l+f*h+d*g-c*k;this._z=d*l+f*k+c*h-e*g;this._w=f*l-c*g-e*h-d*k;this._updateEuler();return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this._x,e=this._y,d=this._z,f=this._w,g=f*a._w+c*a._x+e*a._y+d*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=
-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=e,this._z=d,this;var h=Math.acos(g),k=Math.sqrt(1-g*g);if(0.001>Math.abs(k))return this._w=0.5*(f+this._w),this._x=0.5*(c+this._x),this._y=0.5*(e+this._y),this._z=0.5*(d+this._z),this;g=Math.sin((1-b)*h)/k;h=Math.sin(b*h)/k;this._w=f*g+this._w*h;this._x=c*g+this._x*h;this._y=e*g+this._y*h;this._z=d*g+this._z*h;this._updateEuler();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},
fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];this._w=a[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,e){return c.copy(a).slerp(b,e)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=
a.y;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);
return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?
Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=
this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),
applyMatrix3:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*e;this.y=a[1]*b+a[4]*c+a[7]*e;this.z=a[2]*b+a[5]*c+a[8]*e;return this},applyMatrix4:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12];this.y=a[1]*b+a[5]*c+a[9]*e+a[13];this.z=a[2]*b+a[6]*c+a[10]*e+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;var d=1/(a[3]*b+a[7]*c+a[11]*e+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*e+a[12])*d;this.y=
(a[1]*b+a[5]*c+a[9]*e+a[13])*d;this.z=(a[2]*b+a[6]*c+a[10]*e+a[14])*d;return this},applyQuaternion:function(a){var b=this.x,c=this.y,e=this.z,d=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*e-g*c,k=a*c+g*b-d*e,l=a*e+d*c-f*b,b=-d*b-f*c-g*e;this.x=h*a+b*-d+k*-g-l*-f;this.y=k*a+b*-f+l*-d-h*-g;this.z=l*a+b*-g+h*-f-k*-d;return this},transformDirection:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e;this.y=a[1]*b+a[5]*c+a[9]*e;this.z=a[2]*b+a[6]*c+a[10]*e;this.normalize();return this},
divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<
a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector3,b=new THREE.Vector3);a.set(c,c,c);b.set(e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);
return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,e=this.y,d=this.z;this.x=
e*a.z-d*a.y;this.y=d*a.x-c*a.z;this.z=c*a.y-e*a.x;return this},crossVectors:function(a,b){var c=a.x,e=a.y,d=a.z,f=b.x,g=b.y,h=b.z;this.x=e*h-d*g;this.y=d*f-c*h;this.z=c*g-e*f;return this},projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;
return function(b){void 0===a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},
setEulerFromQuaternion:function(a,b){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code.");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code.");
return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code.");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();
a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){var c=4*a,e=b.elements;this.x=e[c];this.y=e[c+1];this.z=e[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.Vector4=function(a,b,c,e){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==e?e:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,e){this.x=a;this.y=b;this.z=c;this.w=e;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},
applyMatrix4:function(a){var b=this.x,c=this.y,e=this.z,d=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12]*d;this.y=a[1]*b+a[5]*c+a[9]*e+a[13]*d;this.z=a[2]*b+a[6]*c+a[10]*e+a[14]*d;this.w=a[3]*b+a[7]*c+a[11]*e+a[15]*d;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,
this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,e;a=a.elements;var d=a[0];e=a[4];var f=a[8],g=a[1],h=a[5],k=a[9];c=a[2];b=a[6];var l=a[10];if(0.01>Math.abs(e-g)&&0.01>Math.abs(f-c)&&0.01>Math.abs(k-b)){if(0.1>Math.abs(e+g)&&0.1>Math.abs(f+c)&&0.1>Math.abs(k+b)&&0.1>Math.abs(d+h+l-3))return this.set(1,0,0,0),this;a=Math.PI;d=(d+1)/2;h=(h+1)/2;l=(l+1)/2;e=(e+g)/4;f=(f+c)/4;k=(k+b)/4;d>h&&d>l?0.01>d?(b=0,e=c=0.707106781):(b=Math.sqrt(d),c=e/b,e=f/b):h>l?0.01>
h?(b=0.707106781,c=0,e=0.707106781):(c=Math.sqrt(h),b=e/c,e=k/c):0.01>l?(c=b=0.707106781,e=0):(e=Math.sqrt(l),b=f/e,c=k/e);this.set(b,c,e,a);return this}a=Math.sqrt((b-k)*(b-k)+(f-c)*(f-c)+(g-e)*(g-e));0.001>Math.abs(a)&&(a=1);this.x=(b-k)/a;this.y=(f-c)/a;this.z=(g-e)/a;this.w=Math.acos((d+h+l-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=
a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(e,e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=
Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):
Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,
this.w)}};THREE.Euler=function(a,b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._order=e||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(a){this._x=a;this._updateQuaternion()},get y(){return this._y},set y(a){this._y=a;this._updateQuaternion()},get z(){return this._z},set z(a){this._z=a;this._updateQuaternion()},get order(){return this._order},set order(a){this._order=a;this._updateQuaternion()},
set:function(a,b,c,e){this._x=a;this._y=b;this._z=c;this._order=e||this._order;this._updateQuaternion();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._updateQuaternion();return this},setFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var e=a.elements,d=e[0],f=e[4],g=e[8],h=e[1],k=e[5],l=e[9],m=e[2],n=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(c(g)),0.99999>Math.abs(g)?(this._x=Math.atan2(-l,e),this._z=
Math.atan2(-f,d)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-c(l)),0.99999>Math.abs(l)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-m,d),this._z=0)):"ZXY"===b?(this._x=Math.asin(c(n)),0.99999>Math.abs(n)?(this._y=Math.atan2(-m,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,d))):"ZYX"===b?(this._y=Math.asin(-c(m)),0.99999>Math.abs(m)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,d)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=
Math.asin(c(h)),0.99999>Math.abs(h)?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,d)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-c(f)),0.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,d)):(this._x=Math.atan2(-l,e),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+b);this._order=b;this._updateQuaternion();return this},setFromQuaternion:function(a,b,c){function e(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,f=
a.y*a.y,g=a.z*a.z,h=a.w*a.w;b=b||this._order;"XYZ"===b?(this._x=Math.atan2(2*(a.x*a.w-a.y*a.z),h-d-f+g),this._y=Math.asin(e(2*(a.x*a.z+a.y*a.w))),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+d-f-g)):"YXZ"===b?(this._x=Math.asin(e(2*(a.x*a.w-a.y*a.z))),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-d-f+g),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-d+f-g)):"ZXY"===b?(this._x=Math.asin(e(2*(a.x*a.w+a.y*a.z))),this._y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-d-f+g),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-d+f-g)):"ZYX"===
b?(this._x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-d-f+g),this._y=Math.asin(e(2*(a.y*a.w-a.x*a.z))),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+d-f-g)):"YZX"===b?(this._x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-d+f-g),this._y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+d-f-g),this._z=Math.asin(e(2*(a.x*a.y+a.z*a.w)))):"XZY"===b?(this._x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-d+f-g),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+d-f-g),this._z=Math.asin(e(2*(a.z*a.w-a.x*a.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+
b);this._order=b;!1!==c&&this._updateQuaternion();return this},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},clone:function(){return new THREE.Euler(this._x,
this._y,this._z,this._order)}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var d=b.dot(b),d=b.dot(a)/d;e&&(d=THREE.Math.clamp(d,0,1));return d}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,e=a.length;c<e;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var e=a.copy(c).multiplyScalar(0.5);
this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);
this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},addPoint:function(a){a.x<this.min.x?this.min.x=a.x:a.x>this.max.x&&(this.max.x=a.x);a.y<this.min.y?this.min.y=a.y:a.y>this.max.y&&(this.max.y=a.y);a.z<this.min.z?this.min.z=a.z:a.z>this.max.z&&(this.max.z=a.z)},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var b=1,c=a.length;b<c;b++)this.addPoint(a[b])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=
new THREE.Vector3;return function(b,c){var e=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){if(void 0!==b.geometry&&void 0!==b.geometry.vertices)for(var d=b.geometry.vertices,f=0,g=d.length;f<g;f++)a.copy(d[f]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);
this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),getTransformedBox:function(a,
b){function c(a,b,d){var c=f[0]*a+f[4]*b+f[8]*d+f[12],e=f[1]*a+f[5]*b+f[9]*d+f[13];a=f[2]*a+f[6]*b+f[10]*d+f[14];c<g&&(g=c);e<h&&(h=e);a<k&&(k=a);c>l&&(l=c);e>m&&(m=e);a>n&&(n=a)}var e=this.min,d=this.max,f=a.elements,g=Infinity,h=Infinity,k=Infinity,l=-Infinity,m=-Infinity,n=-Infinity;c(e.x,e.y,e.z);c(e.x,e.y,d.z);c(e.x,d.y,e.z);c(e.x,d.y,d.z);c(d.x,e.y,e.z);c(d.x,e.y,d.z);c(d.x,d.y,e.z);c(d.x,d.y,d.z);b.min.set(g,h,k);b.max.set(l,m,n)},translate:function(a){this.min.add(a);this.max.add(a);return this},
equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(a,b,c,e,d,f,g,h,k){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,e||0,void 0!==d?d:1,f||0,g||0,h||0,void 0!==k?k:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,e,d,f,g,h,k){var l=this.elements;l[0]=a;l[3]=b;l[6]=c;l[1]=e;l[4]=d;l[7]=f;l[2]=g;l[5]=h;l[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,e=b.length;c<e;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],e=a[2],d=a[3],f=a[4],g=a[5],h=a[6],k=a[7],a=a[8];return b*f*a-b*g*k-c*d*a+c*g*h+e*d*k-e*f*h},getInverse:function(a,
b){var c=a.elements,e=this.elements;e[0]=c[10]*c[5]-c[6]*c[9];e[1]=-c[10]*c[1]+c[2]*c[9];e[2]=c[6]*c[1]-c[2]*c[5];e[3]=-c[10]*c[4]+c[6]*c[8];e[4]=c[10]*c[0]-c[2]*c[8];e[5]=-c[6]*c[0]+c[2]*c[4];e[6]=c[9]*c[4]-c[5]*c[8];e[7]=-c[9]*c[0]+c[1]*c[8];e[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*e[0]+c[1]*e[3]+c[2]*e[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],
a[6],a[7],a[8]]},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};THREE.Matrix4=function(a,b,c,e,d,f,g,h,k,l,m,n,p,q,s,t){var u=this.elements=new Float32Array(16);u[0]=void 0!==a?a:1;u[4]=b||0;u[8]=c||0;u[12]=e||0;u[1]=d||0;u[5]=void 0!==f?f:1;u[9]=g||0;u[13]=h||0;u[2]=k||0;u[6]=l||0;u[10]=void 0!==m?m:1;u[14]=n||0;u[3]=p||0;u[7]=q||0;u[11]=s||0;u[15]=void 0!==t?t:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,e,d,f,g,h,k,l,m,n,p,q,s,t){var u=this.elements;u[0]=a;u[4]=b;u[8]=c;u[12]=e;u[1]=d;u[5]=f;u[9]=g;u[13]=h;u[2]=k;u[6]=l;u[10]=m;u[14]=n;u[3]=p;u[7]=q;u[11]=s;u[15]=t;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var e=1/a.set(b[0],b[1],b[2]).length(),d=1/a.set(b[4],b[5],b[6]).length(),f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*e;c[1]=b[1]*e;c[2]=b[2]*e;c[4]=b[4]*d;c[5]=b[5]*d;c[6]=b[6]*d;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),makeRotationFromEuler:function(a){!1===
a instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var b=this.elements,c=a.x,e=a.y,d=a.z,f=Math.cos(c),c=Math.sin(c),g=Math.cos(e),e=Math.sin(e),h=Math.cos(d),d=Math.sin(d);if("XYZ"===a.order){a=f*h;var k=f*d,l=c*h,m=c*d;b[0]=g*h;b[4]=-g*d;b[8]=e;b[1]=k+l*e;b[5]=a-m*e;b[9]=-c*g;b[2]=m-a*e;b[6]=l+k*e;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*d,l=e*h,m=e*d,b[0]=a+m*c,b[4]=l*c-k,b[8]=
f*e,b[1]=f*d,b[5]=f*h,b[9]=-c,b[2]=k*c-l,b[6]=m+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*d,l=e*h,m=e*d,b[0]=a-m*c,b[4]=-f*d,b[8]=l+k*c,b[1]=k+l*c,b[5]=f*h,b[9]=m-a*c,b[2]=-f*e,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*d,l=c*h,m=c*d,b[0]=g*h,b[4]=l*e-k,b[8]=a*e+m,b[1]=g*d,b[5]=m*e+a,b[9]=k*e-l,b[2]=-e,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*e,l=c*g,m=c*e,b[0]=g*h,b[4]=m-a*d,b[8]=l*d+k,b[1]=d,b[5]=f*h,b[9]=-c*h,b[2]=-e*h,b[6]=k*d+l,b[10]=a-m*d):"XZY"===a.order&&(a=f*g,k=f*e,l=c*g,m=c*e,b[0]=
g*h,b[4]=-d,b[8]=e*h,b[1]=a*d+m,b[5]=f*h,b[9]=k*d-l,b[2]=l*d-k,b[6]=c*h,b[10]=m*d+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,e=a.y,d=a.z,f=a.w,g=c+c,h=e+e,k=d+d;a=c*g;var l=c*
h,c=c*k,m=e*h,e=e*k,d=d*k,g=f*g,h=f*h,f=f*k;b[0]=1-(m+d);b[4]=l-f;b[8]=c+h;b[1]=l+f;b[5]=1-(a+d);b[9]=e-g;b[2]=c-h;b[6]=e+g;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(e,d,f){var g=this.elements;c.subVectors(e,d).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());b.crossVectors(c,a);g[0]=
a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,e=b.elements,d=this.elements,f=c[0],g=c[4],h=c[8],k=c[12],l=c[1],m=c[5],n=c[9],p=c[13],q=c[2],s=c[6],t=c[10],u=c[14],v=c[3],w=c[7],B=c[11],
c=c[15],A=e[0],D=e[4],W=e[8],C=e[12],P=e[1],G=e[5],F=e[9],N=e[13],z=e[2],M=e[6],H=e[10],Q=e[14],V=e[3],T=e[7],I=e[11],e=e[15];d[0]=f*A+g*P+h*z+k*V;d[4]=f*D+g*G+h*M+k*T;d[8]=f*W+g*F+h*H+k*I;d[12]=f*C+g*N+h*Q+k*e;d[1]=l*A+m*P+n*z+p*V;d[5]=l*D+m*G+n*M+p*T;d[9]=l*W+m*F+n*H+p*I;d[13]=l*C+m*N+n*Q+p*e;d[2]=q*A+s*P+t*z+u*V;d[6]=q*D+s*G+t*M+u*T;d[10]=q*W+s*F+t*H+u*I;d[14]=q*C+s*N+t*Q+u*e;d[3]=v*A+w*P+B*z+c*V;d[7]=v*D+w*G+B*M+c*T;d[11]=v*W+w*F+B*H+c*I;d[15]=v*C+w*N+B*Q+c*e;return this},multiplyToArray:function(a,
b,c){var e=this.elements;this.multiplyMatrices(a,b);c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];c[4]=e[4];c[5]=e[5];c[6]=e[6];c[7]=e[7];c[8]=e[8];c[9]=e[9];c[10]=e[10];c[11]=e[11];c[12]=e[12];c[13]=e[13];c[14]=e[14];c[15]=e[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,e=b.length;c<e;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],e=a[8],d=a[12],f=a[1],g=a[5],h=a[9],k=a[13],l=a[2],m=a[6],n=a[10],p=a[14];return a[3]*(+d*h*m-e*k*m-d*g*n+c*k*n+e*g*p-c*h*p)+a[7]*(+b*h*p-b*k*n+d*f*n-e*f*p+e*k*l-d*h*l)+a[11]*(+b*k*m-b*g*p-d*f*m+c*f*p+d*g*l-c*k*l)+a[15]*(-e*g*l-b*h*m+b*g*n+e*f*m-c*f*
n+c*h*l)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;
a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;
b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,e=a.elements,d=e[0],f=e[4],g=e[8],h=e[12],k=e[1],l=e[5],m=e[9],n=e[13],p=e[2],q=e[6],s=e[10],t=e[14],u=e[3],v=e[7],w=e[11],e=e[15];c[0]=m*t*v-n*s*v+n*q*w-l*t*w-m*q*e+l*s*e;c[4]=h*s*v-g*t*v-h*q*w+f*t*w+g*q*e-f*s*e;c[8]=g*n*v-h*m*v+h*l*w-f*n*w-g*l*e+f*m*e;c[12]=h*m*q-g*n*q-h*l*s+f*n*s+g*l*t-f*m*t;c[1]=n*s*u-m*t*u-n*p*w+k*t*w+m*p*e-k*s*e;c[5]=g*t*u-h*s*u+h*p*w-d*t*w-g*p*e+d*s*e;c[9]=h*m*u-g*n*u-h*k*w+d*n*w+g*k*e-
d*m*e;c[13]=g*n*p-h*m*p+h*k*s-d*n*s-g*k*t+d*m*t;c[2]=l*t*u-n*q*u+n*p*v-k*t*v-l*p*e+k*q*e;c[6]=h*q*u-f*t*u-h*p*v+d*t*v+f*p*e-d*q*e;c[10]=f*n*u-h*l*u+h*k*v-d*n*v-f*k*e+d*l*e;c[14]=h*l*p-f*n*p-h*k*q+d*n*q+f*k*t-d*l*t;c[3]=m*q*u-l*s*u-m*p*v+k*s*v+l*p*w-k*q*w;c[7]=f*s*u-g*q*u+g*p*v-d*s*v-f*p*w+d*q*w;c[11]=g*l*u-f*m*u-g*k*v+d*m*v+f*k*w-d*l*w;c[15]=f*m*p-g*l*p+g*k*q-d*m*q-f*k*s+d*l*s;c=d*c[0]+k*c[4]+p*c[8]+u*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");
this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(a){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(a){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(a){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},
scale:function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,
0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),e=Math.sin(b),d=1-c,f=a.x,g=a.y,h=a.z,k=d*f,l=d*g;this.set(k*f+c,k*g-e*h,k*h+e*g,0,k*g+e*h,l*g+c,l*h-e*f,0,k*h-e*g,l*h+e*f,d*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,
0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,e,d){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.elements.set(this.elements);c=1/g;var f=1/h,l=1/k;b.elements[0]*=c;b.elements[1]*=
c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=l;b.elements[9]*=l;b.elements[10]*=l;e.setFromRotationMatrix(b);d.x=g;d.y=h;d.z=k;return this}}(),makeFrustum:function(a,b,c,e,d,f){var g=this.elements;g[0]=2*d/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*d/(e-c);g[9]=(e+c)/(e-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+d)/(f-d);g[14]=-2*f*d/(f-d);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,e){a=c*Math.tan(THREE.Math.degToRad(0.5*a));
var d=-a;return this.makeFrustum(d*b,a*b,d,a,c,e)},makeOrthographic:function(a,b,c,e,d,f){var g=this.elements,h=b-a,k=c-e,l=f-d;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/k;g[9]=0;g[13]=-((c+e)/k);g[2]=0;g[6]=0;g[10]=-2/l;g[14]=-((f+d)/l);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){var a=
this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var e=c.dot(this.direction);return 0>e?c.copy(this.origin):c.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(a,b,c,e){var d=a.clone().add(b).multiplyScalar(0.5),f=b.clone().sub(a).normalize(),g=0.5*a.distanceTo(b),
h=this.origin.clone().sub(d);a=-this.direction.dot(f);b=h.dot(this.direction);var k=-h.dot(f),l=h.lengthSq(),m=Math.abs(1-a*a),n,p;0<=m?(h=a*k-b,n=a*b-k,p=g*m,0<=h?n>=-p?n<=p?(g=1/m,h*=g,n*=g,a=h*(h+a*n+2*b)+n*(a*h+n+2*k)+l):(n=g,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l):(n=-g,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l):n<=-p?(h=Math.max(0,-(-a*g+b)),n=0<h?-g:Math.min(Math.max(-g,-k),g),a=-h*h+n*(n+2*k)+l):n<=p?(h=0,n=Math.min(Math.max(-g,-k),g),a=n*(n+2*k)+l):(h=Math.max(0,-(a*g+b)),n=0<h?g:Math.min(Math.max(-g,
-k),g),a=-h*h+n*(n+2*k)+l)):(n=0<a?-g:g,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l);c&&c.copy(this.direction.clone().multiplyScalar(h).add(this.origin));e&&e.copy(f.clone().multiplyScalar(n).add(d));return a},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?
0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,e,d,f,g;e=1/this.direction.x;f=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=e?(c=(a.min.x-h.x)*e,e*=a.max.x-h.x):(c=(a.max.x-h.x)*e,e*=a.min.x-h.x);0<=f?(d=(a.min.y-h.y)*f,f*=
a.max.y-h.y):(d=(a.max.y-h.y)*f,f*=a.min.y-h.y);if(c>f||d>e)return null;if(d>c||c!==c)c=d;if(f<e||e!==e)e=f;0<=g?(d=(a.min.z-h.z)*g,g*=a.max.z-h.z):(d=(a.max.z-h.z)*g,g*=a.min.z-h.z);if(c>g||d>e)return null;if(d>c||c!==c)c=d;if(g<e||e!==e)e=g;return 0>e?null:this.at(0<=c?c:e,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,e=new THREE.Vector3;return function(d,f,g,h,k){b.subVectors(f,d);c.subVectors(g,d);e.crossVectors(b,c);f=this.direction.dot(e);if(0<
f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,d);d=h*this.direction.dot(c.crossVectors(a,c));if(0>d)return null;g=h*this.direction.dot(b.cross(a));if(0>g||d+g>f)return null;d=-h*a.dot(e);return 0>d?null:this.at(d/f,k)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},
clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var e=this.center;void 0!==c?e.copy(c):a.setFromPoints(b).center(e);for(var d=0,f=0,g=b.length;f<g;f++)d=Math.max(d,e.distanceToSquared(b[f]));this.radius=Math.sqrt(d);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),e=b||new THREE.Vector3;e.copy(a);c>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};
THREE.Frustum=function(a,b,c,e,d,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,e,d,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(e);g[4].copy(d);g[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var e=c[1],d=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],m=c[8],n=c[9],p=c[10],q=c[11],s=c[12],t=c[13],u=c[14],c=c[15];b[0].setComponents(f-a,l-g,q-m,c-s).normalize();b[1].setComponents(f+
a,l+g,q+m,c+s).normalize();b[2].setComponents(f+e,l+h,q+n,c+t).normalize();b[3].setComponents(f-e,l-h,q-n,c-t).normalize();b[4].setComponents(f-d,l-k,q-p,c-u).normalize();b[5].setComponents(f+d,l+k,q+p,c+u).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,
c=a.center;a=-a.radius;for(var e=0;6>e;e++)if(b[e].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var e=this.planes,d=0;6>d;d++){var f=e[d];a.x=0<f.normal.x?c.min.x:c.max.x;b.x=0<f.normal.x?c.max.x:c.min.x;a.y=0<f.normal.y?c.min.y:c.max.y;b.y=0<f.normal.y?c.max.y:c.min.y;a.z=0<f.normal.z?c.min.z:c.max.z;b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),
containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,e){this.normal.set(a,b,c);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e,d){e=a.subVectors(d,e).cross(b.subVectors(c,e)).normalize();this.setFromNormalAndCoplanarPoint(e,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var e=c||new THREE.Vector3,d=b.delta(a),f=this.normal.dot(d);if(0==f){if(0==this.distanceToPoint(b.start))return e.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:e.copy(d).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(e,d){var f=d||c.getNormalMatrix(e),f=a.copy(this.normal).applyMatrix3(f),g=this.coplanarPoint(b);g.applyMatrix4(e);this.setFromNormalAndCoplanarPoint(f,g);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={PI2:2*Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var d=0;36>d;d++)8==d||13==d||18==d||23==d?b[d]="-":14==d?b[d]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[d]=a[19==d?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,e,d){return e+(a-b)*(d-e)/(c-b)},smoothstep:function(a,
b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/
180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a}};
THREE.Spline=function(a){function b(a,b,g,d,c,h,e){a=0.5*(g-a);d=0.5*(d-b);return(2*(b-g)+a+d)*e+(-3*(b-g)-2*a-d)*h+a*c+b}this.points=a;var c=[],e={x:0,y:0,z:0},d,f,g,h,k,l,m,n,p;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){d=(this.points.length-1)*a;f=Math.floor(d);g=d-f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>this.points.length-2?this.points.length-1:f+1;c[3]=f>this.points.length-3?this.points.length-1:
f+2;l=this.points[c[0]];m=this.points[c[1]];n=this.points[c[2]];p=this.points[c[3]];h=g*g;k=g*h;e.x=b(l.x,m.x,n.x,p.x,g,h,k);e.y=b(l.y,m.y,n.y,p.y,g,h,k);e.z=b(l.z,m.z,n.z,p.z,g,h,k);return e};this.getControlPointsArray=function(){var a,b,g=this.points.length,d=[];for(a=0;a<g;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,g,d,c=0,h=new THREE.Vector3,e=new THREE.Vector3,k=[],f=0;k[0]=0;a||(a=100);g=this.points.length*a;h.copy(this.points[0]);for(a=1;a<g;a++)b=a/
g,d=this.getPoint(b),e.copy(d),f+=e.distanceTo(h),h.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=c&&(k[b]=f,c=b);k[k.length]=f;return{chunks:k,total:f}};this.reparametrizeByArcLength=function(a){var b,g,d,c,h,e,k=[],f=new THREE.Vector3,l=this.getLength();k.push(f.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){g=l.chunks[b]-l.chunks[b-1];e=Math.ceil(a*g/l.total);c=(b-1)/(this.points.length-1);h=b/(this.points.length-1);for(g=1;g<e-1;g++)d=c+1/e*g*(h-c),d=this.getPoint(d),k.push(f.copy(d).clone());
k.push(f.copy(this.points[b]).clone())}this.points=k}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,e,d){d=d||new THREE.Vector3;d.subVectors(e,c);a.subVectors(b,c);d.cross(a);b=d.lengthSq();return 0<b?d.multiplyScalar(1/Math.sqrt(b)):d.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(e,d,f,g,h){a.subVectors(g,d);b.subVectors(f,d);c.subVectors(e,d);e=a.dot(a);d=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var l=e*k-d*d;h=h||new THREE.Vector3;if(0==l)return h.set(-2,-1,-1);l=1/l;k=(k*f-d*g)*l;e=(e*g-d*f)*l;return h.set(1-k-e,e,k)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,e,d){b=THREE.Triangle.barycoordFromPoint(b,c,e,d,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,e){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[e]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),
a=0.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var e=c.indexOf(b);-1!==e&&c.splice(e,1)}}},dispatchEvent:function(){var a=[];return function(b){if(void 0!==this._listeners){var c=this._listeners[b.type];if(void 0!==c){b.target=this;for(var e=c.length,d=0;d<e;d++)a[d]=c[d];for(d=0;d<e;d++)a[d].call(this,
b)}}}}()};
(function(a){a.Raycaster=function(b,g,d,c){this.ray=new a.Ray(b,g);this.near=d||0;this.far=c||Infinity};var b=new a.Sphere,c=new a.Ray;new a.Plane;new a.Vector3;var e=new a.Vector3,d=new a.Matrix4,f=function(a,b){return a.distance-b.distance},g=new a.Vector3,h=new a.Vector3,k=new a.Vector3,l=function(f,m,q){if(f instanceof a.Sprite){e.setFromMatrixPosition(f.matrixWorld);var s=m.ray.distanceToPoint(e);if(s>f.scale.x)return q;q.push({distance:s,point:f.position,face:null,object:f})}else if(f instanceof a.LOD)e.setFromMatrixPosition(f.matrixWorld),
s=m.ray.origin.distanceTo(e),l(f.getObjectForDistance(s),m,q);else if(f instanceof a.Mesh){var t=f.geometry;null===t.boundingSphere&&t.computeBoundingSphere();b.copy(t.boundingSphere);b.applyMatrix4(f.matrixWorld);if(!1===m.ray.isIntersectionSphere(b))return q;d.getInverse(f.matrixWorld);c.copy(m.ray).applyMatrix4(d);if(null!==t.boundingBox&&!1===c.isIntersectionBox(t.boundingBox))return q;if(t instanceof a.BufferGeometry){var u=f.material;if(void 0===u)return q;var v=t.attributes,w,B,A=m.precision;
if(void 0!==v.index)for(var D=v.index.array,W=t.offsets||[{start:0,index:0,count:D.length}],C=t.vb?t.vb:v.position.array,P=t.vb?t.vbstride:3,G=0,F=W.length;G<F;++G)for(var v=W[G].start,N=W[G].index,t=v,z=v+W[G].count;t<z;t+=3){v=N+D[t];w=N+D[t+1];B=N+D[t+2];g.set(C[v*P],C[v*P+1],C[v*P+2]);h.set(C[w*P],C[w*P+1],C[w*P+2]);k.set(C[B*P],C[B*P+1],C[B*P+2]);var M=u.side===a.BackSide?c.intersectTriangle(k,h,g,!0):c.intersectTriangle(g,h,k,u.side!==a.DoubleSide);null!==M&&(M.applyMatrix4(f.matrixWorld),s=
m.ray.origin.distanceTo(M),s<A||s<m.near||s>m.far||q.push({distance:s,point:M,indices:[v,w,B],face:null,faceIndex:null,object:f}))}else for(C=t.vb?t.vb:v.position.array,P=t.vb?t.vbstride:3,t=0,z=v.position.array.length;t<z;t+=3)v=t,w=t+1,B=t+2,g.set(C[v*P],C[v*P+1],C[v*P+2]),h.set(C[w*P],C[w*P+1],C[w*P+2]),k.set(C[B*P],C[B*P+1],C[B*P+2]),M=u.side===a.BackSide?c.intersectTriangle(k,h,g,!0):c.intersectTriangle(g,h,k,u.side!==a.DoubleSide),null!==M&&(M.applyMatrix4(f.matrixWorld),s=m.ray.origin.distanceTo(M),
s<A||s<m.near||s>m.far||q.push({distance:s,point:M,indices:[v,w,B],face:null,faceIndex:null,object:f}))}else if(t instanceof a.Geometry)for(W=f.material instanceof a.MeshFaceMaterial,C=!0===W?f.material.materials:null,A=m.precision,D=t.vertices,P=0,G=t.faces.length;P<G;P++)if(F=t.faces[P],u=!0===W?C[F.materialIndex]:f.material,void 0!==u){v=D[F.a];w=D[F.b];B=D[F.c];if(!0===u.morphTargets){s=t.morphTargets;M=f.morphTargetInfluences;g.set(0,0,0);h.set(0,0,0);k.set(0,0,0);N=0;for(z=s.length;N<z;N++){var H=
M[N];if(0!==H){var Q=s[N].vertices;g.x+=(Q[F.a].x-v.x)*H;g.y+=(Q[F.a].y-v.y)*H;g.z+=(Q[F.a].z-v.z)*H;h.x+=(Q[F.b].x-w.x)*H;h.y+=(Q[F.b].y-w.y)*H;h.z+=(Q[F.b].z-w.z)*H;k.x+=(Q[F.c].x-B.x)*H;k.y+=(Q[F.c].y-B.y)*H;k.z+=(Q[F.c].z-B.z)*H}}g.add(v);h.add(w);k.add(B);v=g;w=h;B=k}M=u.side===a.BackSide?c.intersectTriangle(B,w,v,!0):c.intersectTriangle(v,w,B,u.side!==a.DoubleSide);null!==M&&(M.applyMatrix4(f.matrixWorld),s=m.ray.origin.distanceTo(M),s<A||s<m.near||s>m.far||q.push({distance:s,point:M,face:F,
faceIndex:P,object:f}))}}else if(f instanceof a.Line){A=m.linePrecision;u=A*A;t=f.geometry;null===t.boundingSphere&&t.computeBoundingSphere();b.copy(t.boundingSphere);b.applyMatrix4(f.matrixWorld);if(!1===m.ray.isIntersectionSphere(b))return q;d.getInverse(f.matrixWorld);c.copy(m.ray).applyMatrix4(d);if(t instanceof a.Geometry)for(D=t.vertices,A=D.length,v=new a.Vector3,w=new a.Vector3,B=f.type===a.LineStrip?1:2,t=0;t<A-1;t+=B)c.distanceSqToSegment(D[t],D[t+1],w,v)>u||(s=c.origin.distanceTo(w),s<
m.near||s>m.far||q.push({distance:s,point:v.clone().applyMatrix4(f.matrixWorld),face:null,faceIndex:null,object:f}))}},m=function(a,b,g){a=a.getDescendants();for(var d=0,c=a.length;d<c;d++)l(a[d],b,g)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.linePrecision=1;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b)};a.Raycaster.prototype.intersectObject=function(a,b){var g=[];!0===b&&m(a,this,g);l(a,this,g);g.sort(f);return g};a.Raycaster.prototype.intersectObjects=function(a,b){for(var g=
[],d=0,c=a.length;d<c;d++)l(a[d],this,g),!0===b&&m(a[d],this,g);g.sort(f);return g}})(THREE);
THREE.Object3D=function(a){this.id=THREE.Object3DIdCount++;this.parent=void 0;a?(this.matrixAutoUpdate=!1,this.skipModTerms=!0):(this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this._rotation=new THREE.Euler,this._quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this._rotation._quaternion=this.quaternion,this._quaternion._euler=this.rotation,this.matrixAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.skipModTerms=!1,this.rotationAutoUpdate=!0);this.renderDepth=
null;this.matrixWorld=new THREE.Matrix4;this.visible=this.matrixWorldNeedsUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0};
THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(a){this._rotation=a;this._rotation._quaternion=this._quaternion;this._quaternion._euler=this._rotation;this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(a){this._quaternion=a;this._quaternion._euler=this._rotation;this._rotation._quaternion=this._quaternion;this._quaternion._updateEuler()},get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");
return this.rotation.order},set eulerOrder(a){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);
this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=
new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b);a.applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;a.dispatchEvent({type:"added"});this.children||(this.children=[]);this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&
b.__addObject(a)}},remove:function(a){if(this.children){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;a.dispatchEvent({type:"removed"});this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}}},traverse:function(a){a(this);var b=this.children;if(b)for(var c=0,e=b.length;c<e;c++)b[c].traverse(a)},getObjectById:function(a,b){for(var c=0,e=this.children.length;c<e;c++){var d=this.children[c];if(d.id===a||!0===b&&(d=d.getObjectById(a,
b),void 0!==d))return d}},getObjectByName:function(a,b){for(var c=0,e=this.children.length;c<e;c++){var d=this.children[c];if(d.name===a||!0===b&&(d=d.getObjectByName(a,b),void 0!==d))return d}},getChildByName:function(a,b){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getDescendants:function(a){if(!this.children)return null;void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<
c;b++)this.children[b].getDescendants(a);return a},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent&&this.matrix?this.matrixWorld.copy(this.matrix):this.matrix&&this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;if(this.children)for(var b=
0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},clone:function(a,b){void 0===a&&(a=new THREE.Object3D(this.skipModTerms));void 0===b&&(b=!0);this.name&&(a.name=this.name);this.skipModTerms||(a.up.copy(this.up),a.position.copy(this.position),a.quaternion.copy(this.quaternion),a.scale.copy(this.scale));a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;this.matrix?a.matrix.copy(this.matrix):a.matrix=null;a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=
this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;this.userData&&(a.userData=JSON.parse(JSON.stringify(this.userData)));if(!0===b&&this.children)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;
THREE.Projector=function(){function a(){if(m===p){var a=new THREE.RenderableVertex;n.push(a);p++;m++;return a}return n[m++]}function b(){if(s===u){var a=new THREE.RenderableFace;t.push(a);u++;s++;return a}return t[s++]}function c(){if(w===A){var a=new THREE.RenderableLine;B.push(a);A++;w++;return a}return B[w++]}function e(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function d(a,b){var g=0,d=1,c=a.z+a.w,h=b.z+b.w,e=-a.z+a.w,k=-b.z+b.w;if(0<=c&&0<=h&&0<=e&&0<=k)return!0;if(0>c&&0>h||0>e&&
0>k)return!1;0>c?g=Math.max(g,c/(c-h)):0>h&&(d=Math.min(d,c/(c-h)));0>e?g=Math.max(g,e/(e-k)):0>k&&(d=Math.min(d,e/(e-k)));if(d<g)return!1;a.lerp(b,g);b.lerp(a,1-d);return!0}var f,g,h=[],k=0,l,m,n=[],p=0,q,s,t=[],u=0,v,w,B=[],A=0,D,W,C=[],P=0,G={objects:[],lights:[],elements:[]},F=new THREE.Vector3,N=new THREE.Vector3,z=new THREE.Vector3,M=new THREE.Vector3,H=new THREE.Vector4,Q=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),V=new THREE.Box3,T=Array(3),I=new THREE.Matrix4,E=
new THREE.Matrix4,J,ca=new THREE.Matrix4,Y=new THREE.Matrix3,ga=new THREE.Frustum,R=new THREE.Vector4,la=new THREE.Vector4;this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);E.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);return a.applyProjection(E)};this.unprojectVector=function(){var a=new THREE.Matrix4;return function(b,g){a.getInverse(g.projectionMatrix);E.multiplyMatrices(g.matrixWorld,a);return b.applyProjection(E)}}();this.pickingRay=function(a,b){a.z=
-1;var g=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(g,b);g.sub(a).normalize();return new THREE.Raycaster(a,g)};var Z=function(a){if(!1!==a.visible){if(a instanceof THREE.Light)G.lights.push(a);else if(a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Sprite)if(!1===a.frustumCulled||!0===ga.intersectsObject(a)){if(g===k){var b=new THREE.RenderableObject;h.push(b);k++;g++;f=b}else f=h[g++];f.id=a.id;f.object=a;null!==a.renderDepth?f.z=a.renderDepth:
(M.setFromMatrixPosition(a.matrixWorld),M.applyProjection(E),f.z=M.z);G.objects.push(f)}for(var b=0,d=a.children.length;b<d;b++)Z(a.children[b])}},ia=new function(){var g=[],d=null,h=new THREE.Matrix3,e=function(a){var b=a.positionWorld,g=a.positionScreen;b.copy(a.position).applyMatrix4(J);g.copy(b).applyMatrix4(E);b=1/g.w;g.x*=b;g.y*=b;g.z*=b;a.visible=-1<=g.x&&1>=g.x&&-1<=g.y&&1>=g.y&&-1<=g.z&&1>=g.z},k=function(a,b,g){T[0]=a.positionScreen;T[1]=b.positionScreen;T[2]=g.positionScreen;return!0===
a.visible||!0===b.visible||!0===g.visible||Q.isIntersectionBox(V.setFromPoints(T))?0>(g.positionScreen.x-a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(g.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x):!1};return{setObject:function(a){d=a;h.getNormalMatrix(d.matrixWorld);g.length=0},projectVertex:e,checkTriangleVisibility:k,pushVertex:function(b,g,d){l=a();l.position.set(b,g,d);e(l)},pushNormal:function(a,b,d){g.push(a,b,d)},pushLine:function(a,b){var g=
n[a],h=n[b];v=c();v.id=d.id;v.v1.copy(g);v.v2.copy(h);v.z=(g.positionScreen.z+h.positionScreen.z)/2;v.material=d.material;G.elements.push(v)},pushTriangle:function(a,c,e){var f=n[a],l=n[c],m=n[e];if(!0===k(f,l,m)){q=b();q.id=d.id;q.v1.copy(f);q.v2.copy(l);q.v3.copy(m);q.z=(f.positionScreen.z+l.positionScreen.z+m.positionScreen.z)/3;for(f=0;3>f;f++)l=3*arguments[f],m=q.vertexNormalsModel[f],m.set(g[l+0],g[l+1],g[l+2]),m.applyMatrix3(h).normalize();q.vertexNormalsLength=3;q.material=d.material;G.elements.push(q)}}}};
this.projectScene=function(h,k,f,l){var T,p,t,V,u,A,B,M,Q;W=w=s=0;G.elements.length=0;!0===h.autoUpdate&&h.updateMatrixWorld();void 0===k.parent&&k.updateMatrixWorld();I.copy(k.matrixWorldInverse.getInverse(k.matrixWorld));E.multiplyMatrices(k.projectionMatrix,I);ga.setFromMatrix(E);g=0;G.objects.length=0;G.lights.length=0;Z(h);!0===f&&G.objects.sort(e);h=0;for(f=G.objects.length;h<f;h++)if(T=G.objects[h].object,p=T.geometry,ia.setObject(T),J=T.matrixWorld,m=0,T instanceof THREE.Mesh)if(p instanceof
THREE.BufferGeometry){if(A=p.attributes,T=p.offsets,void 0!==A.position){M=A.position.array;p=0;for(V=M.length;p<V;p+=3)ia.pushVertex(M[p],M[p+1],M[p+2]);Q=A.normal.array;p=0;for(V=Q.length;p<V;p+=3)ia.pushNormal(Q[p],Q[p+1],Q[p+2]);if(void 0!==A.index)if(A=A.index.array,0<T.length)for(h=0;h<T.length;h++)for(V=T[h],M=V.index,p=V.start,V=V.start+V.count;p<V;p+=3)ia.pushTriangle(A[p]+M,A[p+1]+M,A[p+2]+M);else for(p=0,V=A.length;p<V;p+=3)ia.pushTriangle(A[p],A[p+1],A[p+2]);else for(p=0,V=M.length/3;p<
V;p+=3)ia.pushTriangle(p,p+1,p+2)}}else{if(p instanceof THREE.Geometry){t=p.vertices;V=p.faces;A=p.faceVertexUvs;Y.getNormalMatrix(J);M=T.material instanceof THREE.MeshFaceMaterial;Q=!0===M?T.material:null;for(var da=0,sa=t.length;da<sa;da++){var va=t[da];ia.pushVertex(va.x,va.y,va.z)}da=0;for(sa=V.length;da<sa;da++){t=V[da];var Ea=!0===M?Q.materials[t.materialIndex]:T.material;if(void 0!==Ea){B=Ea.side;var va=n[t.a],ya=n[t.b],aa=n[t.c];if(!0===Ea.morphTargets){u=p.morphTargets;var X=T.morphTargetInfluences,
ha=va.position,qa=ya.position,La=aa.position;F.set(0,0,0);N.set(0,0,0);z.set(0,0,0);for(var Na=0,$a=u.length;Na<$a;Na++){var ka=X[Na];if(0!==ka){var ja=u[Na].vertices;F.x+=(ja[t.a].x-ha.x)*ka;F.y+=(ja[t.a].y-ha.y)*ka;F.z+=(ja[t.a].z-ha.z)*ka;N.x+=(ja[t.b].x-qa.x)*ka;N.y+=(ja[t.b].y-qa.y)*ka;N.z+=(ja[t.b].z-qa.z)*ka;z.x+=(ja[t.c].x-La.x)*ka;z.y+=(ja[t.c].y-La.y)*ka;z.z+=(ja[t.c].z-La.z)*ka}}va.position.add(F);ya.position.add(N);aa.position.add(z);ia.projectVertex(va);ia.projectVertex(ya);ia.projectVertex(aa)}X=
ia.checkTriangleVisibility(va,ya,aa);if(!(!1===X&&B===THREE.FrontSide||!0===X&&B===THREE.BackSide)){q=b();q.id=T.id;q.v1.copy(va);q.v2.copy(ya);q.v3.copy(aa);q.normalModel.copy(t.normal);!1!==X||B!==THREE.BackSide&&B!==THREE.DoubleSide||q.normalModel.negate();q.normalModel.applyMatrix3(Y).normalize();q.centroidModel.copy(t.centroid).applyMatrix4(J);u=t.vertexNormals;ha=0;for(qa=Math.min(u.length,3);ha<qa;ha++)La=q.vertexNormalsModel[ha],La.copy(u[ha]),!1!==X||B!==THREE.BackSide&&B!==THREE.DoubleSide||
La.negate(),La.applyMatrix3(Y).normalize();q.vertexNormalsLength=u.length;u=0;for(X=Math.min(A.length,3);u<X;u++)if(B=A[u][da],void 0!==B)for(ha=0,qa=B.length;ha<qa;ha++)q.uvs[u][ha]=B[ha];q.color=t.color;q.material=Ea;q.z=(va.positionScreen.z+ya.positionScreen.z+aa.positionScreen.z)/3;G.elements.push(q)}}}}}else if(T instanceof THREE.Line)if(p instanceof THREE.BufferGeometry){if(A=p.attributes,void 0!==A.position){M=A.position.array;p=0;for(V=M.length;p<V;p+=3)ia.pushVertex(M[p],M[p+1],M[p+2]);if(void 0!==
A.index)for(A=A.index.array,p=0,V=A.length;p<V;p+=2)ia.pushLine(A[p],A[p+1]);else for(p=0,V=M.length/3-1;p<V;p++)ia.pushLine(p,p+1)}}else{if(p instanceof THREE.Geometry&&(ca.multiplyMatrices(E,J),t=T.geometry.vertices,0!==t.length))for(va=a(),va.positionScreen.copy(t[0]).applyMatrix4(ca),p=T.type===THREE.LinePieces?2:1,da=1,sa=t.length;da<sa;da++)va=a(),va.positionScreen.copy(t[da]).applyMatrix4(ca),0<(da+1)%p||(ya=n[m-2],R.copy(va.positionScreen),la.copy(ya.positionScreen),!0===d(R,la)&&(R.multiplyScalar(1/
R.w),la.multiplyScalar(1/la.w),v=c(),v.id=T.id,v.v1.positionScreen.copy(R),v.v2.positionScreen.copy(la),v.z=Math.max(R.z,la.z),v.material=T.material,T.material.vertexColors===THREE.VertexColors&&(v.vertexColors[0].copy(T.geometry.colors[da]),v.vertexColors[1].copy(T.geometry.colors[da-1])),G.elements.push(v)))}else T instanceof THREE.Sprite&&(H.set(J.elements[12],J.elements[13],J.elements[14],1),H.applyMatrix4(E),p=1/H.w,H.z*=p,-1<=H.z&&1>=H.z&&(W===P?(V=new THREE.RenderableSprite,C.push(V),P++,W++,
D=V):D=C[W++],D.id=T.id,D.x=H.x*p,D.y=H.y*p,D.z=H.z,D.object=T,D.rotation=T.rotation,D.scale.x=T.scale.x*Math.abs(D.x-(H.x+k.projectionMatrix.elements[0])/(H.w+k.projectionMatrix.elements[12])),D.scale.y=T.scale.y*Math.abs(D.y-(H.y+k.projectionMatrix.elements[5])/(H.w+k.projectionMatrix.elements[13])),D.material=T.material,G.elements.push(D)));!0===l&&G.elements.sort(e);return G}};
THREE.Face3=function(a,b,c,e,d,f){this.a=a;this.b=b;this.c=c;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=d instanceof THREE.Color?d:new THREE.Color;this.vertexColors=d instanceof Array?d:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,e,d,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,d,f,g)};THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.attributes={};this.boundingSphere=this.boundingBox=null};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b,c,e){this.attributes[a]={array:new b(c*e),itemSize:e};return this.attributes[a]},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.multiplyVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).multiplyVector3Array(b.array),b.needsUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);
var a=this.attributes.position.array;if(a){var b=this.boundingBox;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var c=3,e=a.length;c<e;c+=3){var d=a[c],f=a[c+1],g=a[c+2];d<b.min.x?b.min.x=d:d>b.max.x&&(b.max.x=d);f<b.min.y?b.min.y=f:f>b.max.y&&(b.max.y=f);g<b.min.z?b.min.z=g:g>b.max.z&&(b.max.z=g)}}if(void 0===a||0===a.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;
return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var e=this.boundingSphere.center,d=0,f=c.length;d<f;d+=3)b.set(c[d],c[d+1],c[d+2]),a.addPoint(b);a.center(e);for(var g=0,d=0,f=c.length;d<f;d+=3)b.set(c[d],c[d+1],c[d+2]),g=Math.max(g,e.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(g)}}}(),computeVertexNormals:function(){if(this.attributes.position){var a,b,c,e;a=this.attributes.position.array.length;
if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(a)};else for(a=0,b=this.attributes.normal.array.length;a<b;a++)this.attributes.normal.array[a]=0;var d=this.attributes.position.array,f=this.attributes.normal.array,g,h,k,l,m,n,p=new THREE.Vector3,q=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3;if(this.attributes.index){var v=this.attributes.index.array,w=this.offsets;c=0;for(e=w.length;c<e;++c){b=w[c].start;g=w[c].count;var B=
w[c].index;a=b;for(b+=g;a<b;a+=3)g=B+v[a],h=B+v[a+1],k=B+v[a+2],l=d[3*g],m=d[3*g+1],n=d[3*g+2],p.set(l,m,n),l=d[3*h],m=d[3*h+1],n=d[3*h+2],q.set(l,m,n),l=d[3*k],m=d[3*k+1],n=d[3*k+2],s.set(l,m,n),t.subVectors(s,q),u.subVectors(p,q),t.cross(u),f[3*g]+=t.x,f[3*g+1]+=t.y,f[3*g+2]+=t.z,f[3*h]+=t.x,f[3*h+1]+=t.y,f[3*h+2]+=t.z,f[3*k]+=t.x,f[3*k+1]+=t.y,f[3*k+2]+=t.z}}else for(a=0,b=d.length;a<b;a+=9)l=d[a],m=d[a+1],n=d[a+2],p.set(l,m,n),l=d[a+3],m=d[a+4],n=d[a+5],q.set(l,m,n),l=d[a+6],m=d[a+7],n=d[a+8],
s.set(l,m,n),t.subVectors(s,q),u.subVectors(p,q),t.cross(u),f[a]=t.x,f[a+1]=t.y,f[a+2]=t.z,f[a+3]=t.x,f[a+4]=t.y,f[a+5]=t.z,f[a+6]=t.x,f[a+7]=t.y,f[a+8]=t.z;this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,e,d=0,f=a.length;d<f;d+=3)b=a[d],c=a[d+1],e=a[d+2],b=1/Math.sqrt(b*b+c*c+e*e),a[d]*=b,a[d+1]*=b,a[d+2]*=b},computeTangents:function(){function a(a,b,g){n=e[3*a];p=e[3*a+1];q=e[3*a+2];s=e[3*b];t=e[3*b+1];u=e[3*b+2];v=e[3*g];
w=e[3*g+1];B=e[3*g+2];A=f[2*a];D=f[2*a+1];W=f[2*b];C=f[2*b+1];P=f[2*g];G=f[2*g+1];F=s-n;N=v-n;z=t-p;M=w-p;H=u-q;Q=B-q;V=W-A;T=P-A;I=C-D;E=G-D;J=1/(V*E-T*I);ca.set((E*F-I*N)*J,(E*z-I*M)*J,(E*H-I*Q)*J);Y.set((V*N-T*F)*J,(V*M-T*z)*J,(V*Q-T*H)*J);k[a].add(ca);k[b].add(ca);k[g].add(ca);l[a].add(Y);l[b].add(Y);l[g].add(Y)}function b(a){Ba.x=d[3*a];Ba.y=d[3*a+1];Ba.z=d[3*a+2];ra.copy(Ba);ua=k[a];ma.copy(ua);ma.sub(Ba.multiplyScalar(Ba.dot(ua))).normalize();xa.crossVectors(ra,ua);ba=xa.dot(l[a]);pa=0>ba?
-1:1;h[4*a]=ma.x;h[4*a+1]=ma.y;h[4*a+2]=ma.z;h[4*a+3]=pa}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,e=this.attributes.position.array,d=this.attributes.normal.array,f=this.attributes.uv.array,g=e.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent=
{itemSize:4,array:new Float32Array(4*g)});for(var h=this.attributes.tangent.array,k=[],l=[],m=0;m<g;m++)k[m]=new THREE.Vector3,l[m]=new THREE.Vector3;var n,p,q,s,t,u,v,w,B,A,D,W,C,P,G,F,N,z,M,H,Q,V,T,I,E,J,ca=new THREE.Vector3,Y=new THREE.Vector3,ga,R,la,Z,ia,wa=this.offsets,m=0;for(R=wa.length;m<R;++m){ga=wa[m].start;la=wa[m].count;var oa=wa[m].index,g=ga;for(ga+=la;g<ga;g+=3)la=oa+c[g],Z=oa+c[g+1],ia=oa+c[g+2],a(la,Z,ia)}var ma=new THREE.Vector3,xa=new THREE.Vector3,Ba=new THREE.Vector3,ra=new THREE.Vector3,
pa,ua,ba,m=0;for(R=wa.length;m<R;++m)for(ga=wa[m].start,la=wa[m].count,oa=wa[m].index,g=ga,ga+=la;g<ga;g+=3)la=oa+c[g],Z=oa+c[g+1],ia=oa+c[g+2],b(la),b(Z),b(ia)}},computeOffsets:function(a){var b=a;void 0===a&&(b=65535);Date.now();a=this.attributes.index.array;for(var c=this.attributes.position.array,e=a.length/3,d=new Uint16Array(a.length),f=0,g=0,h=[{start:0,count:0,index:0}],k=h[0],l=0,m=0,n=new Int32Array(6),p=new Int32Array(c.length),q=new Int32Array(c.length),s=0;s<c.length;s++)p[s]=-1,q[s]=
-1;for(c=0;c<e;c++){for(var t=m=0;3>t;t++)s=a[3*c+t],-1==p[s]?(n[2*t]=s,n[2*t+1]=-1,m++):p[s]<k.index?(n[2*t]=s,n[2*t+1]=-1,l++):(n[2*t]=s,n[2*t+1]=p[s]);if(g+m>k.index+b)for(k={start:f,count:0,index:g},h.push(k),m=0;6>m;m+=2)t=n[m+1],-1<t&&t<k.index&&(n[m+1]=-1);for(m=0;6>m;m+=2)s=n[m],t=n[m+1],-1===t&&(t=g++),p[s]=t,q[t]=s,d[f++]=t-k.index,k.count++}this.reorderBuffers(d,q,g);return this.offsets=h},reorderBuffers:function(a,b,c){var e={},d=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,
Int32Array,Uint32Array,Float32Array,Float64Array],f;for(f in this.attributes)if("index"!=f)for(var g=this.attributes[f].array,h=0,k=d.length;h<k;h++){var l=d[h];if(g instanceof l){e[f]=new l(this.attributes[f].itemSize*c);break}}for(d=0;d<c;d++)for(f in g=b[d],this.attributes)if("index"!=f)for(var h=this.attributes[f].array,k=this.attributes[f].itemSize,l=e[f],m=0;m<k;m++)l[d*k+m]=h[g*k+m];this.attributes.index.array=a;for(f in this.attributes)"index"!=f&&(this.attributes[f].array=e[f],this.attributes[f].numItems=
this.attributes[f].itemSize*c)},clone:function(){var a=new THREE.BufferGeometry,b=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c;for(c in this.attributes){for(var e=this.attributes[c],d=e.array,f={itemSize:e.itemSize,array:null},e=0,g=b.length;e<g;e++){var h=b[e];if(d instanceof h){f.array=new h(d);break}}a.attributes[c]=f}e=0;for(g=this.offsets.length;e<g;e++)b=this.offsets[e],a.offsets.push({start:b.start,index:b.index,count:b.count});
return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,e=this.vertices.length;c<e;c++)this.vertices[c].applyMatrix4(a);c=0;for(e=this.faces.length;c<e;c++){var d=this.faces[c];d.normal.applyMatrix3(b).normalize();for(var f=0,g=d.vertexNormals.length;f<g;f++)d.vertexNormals[f].applyMatrix3(b).normalize();d.centroid.applyMatrix4(a)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof
THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,0,0),c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,e=this.faces.length;c<e;c++){var d=this.faces[c],f=this.vertices[d.a],g=this.vertices[d.b];a.subVectors(this.vertices[d.c],g);b.subVectors(f,
g);a.cross(b);a.normalize();d.normal.copy(a)}},computeVertexNormals:function(a){var b,c,e;e=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)e[b]=new THREE.Vector3;if(a){var d,f,g,h=new THREE.Vector3,k=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],d=this.vertices[c.a],f=this.vertices[c.b],g=this.vertices[c.c],h.subVectors(g,f),k.subVectors(d,f),h.cross(k),e[c.a].add(h),e[c.b].add(h),e[c.c].add(h)}else for(a=
0,b=this.faces.length;a<b;a++)c=this.faces[a],e[c.a].add(c.normal),e[c.b].add(c.normal),e[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)e[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.vertexNormals[0]=e[c.a].clone(),c.vertexNormals[1]=e[c.b].clone(),c.vertexNormals[2]=e[c.c].clone()},computeMorphNormals:function(){var a,b,c,e,d;c=0;for(e=this.faces.length;c<e;c++)for(d=this.faces[c],d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):d.__originalFaceNormal=
d.normal.clone(),d.__originalVertexNormals||(d.__originalVertexNormals=[]),a=0,b=d.vertexNormals.length;a<b;a++)d.__originalVertexNormals[a]?d.__originalVertexNormals[a].copy(d.vertexNormals[a]):d.__originalVertexNormals[a]=d.vertexNormals[a].clone();var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];d=this.morphNormals[a].faceNormals;var g=
this.morphNormals[a].vertexNormals,h,k;c=0;for(e=this.faces.length;c<e;c++)h=new THREE.Vector3,k={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},d.push(h),g.push(k)}g=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(e=this.faces.length;c<e;c++)d=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=0;for(e=this.faces.length;c<
e;c++)d=this.faces[c],d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeTangents:function(){var a,b,c,e,d,f,g,h,k,l,m,n,p,q,s,t,u,v=[],w=[];c=new THREE.Vector3;var B=new THREE.Vector3,A=new THREE.Vector3,D=new THREE.Vector3,W=new THREE.Vector3;a=0;for(b=this.vertices.length;a<b;a++)v[a]=new THREE.Vector3,w[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],f=this.faceVertexUvs[0][a],e=d.a,u=d.b,d=d.c,g=this.vertices[e],h=this.vertices[u],k=this.vertices[d],
l=f[0],m=f[1],n=f[2],f=h.x-g.x,p=k.x-g.x,q=h.y-g.y,s=k.y-g.y,h=h.z-g.z,g=k.z-g.z,k=m.x-l.x,t=n.x-l.x,m=m.y-l.y,l=n.y-l.y,n=1/(k*l-t*m),c.set((l*f-m*p)*n,(l*q-m*s)*n,(l*h-m*g)*n),B.set((k*p-t*f)*n,(k*s-t*q)*n,(k*g-t*h)*n),v[e].add(c),v[u].add(c),v[d].add(c),w[e].add(B),w[u].add(B),w[d].add(B);B=["a","b","c","d"];a=0;for(b=this.faces.length;a<b;a++)for(d=this.faces[a],c=0;c<Math.min(d.vertexNormals.length,3);c++)W.copy(d.vertexNormals[c]),e=d[B[c]],u=v[e],A.copy(u),A.sub(W.multiplyScalar(W.dot(u))).normalize(),
D.crossVectors(d.vertexNormals[c],u),e=D.dot(w[e]),e=0>e?-1:1,d.vertexTangents[c]=new THREE.Vector4(A.x,A.y,A.z,e);this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,e=b.length;c<e;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);
this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var a={},b=[],c=[],e,d=Math.pow(10,4),f,g;f=0;for(g=this.vertices.length;f<g;f++)e=this.vertices[f],e=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d),void 0===a[e]?(a[e]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[e]];a=[];f=0;for(g=this.faces.length;f<g;f++)for(d=this.faces[f],d.a=c[d.a],d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],e=0;3>e;e++)if(d[e]==d[(e+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(d=
a[f],this.faces.splice(d,1),c=0,g=this.faceVertexUvs.length;c<g;c++)this.faceVertexUvs[c].splice(d,1);f=this.vertices.length-b.length;this.vertices=b;return f},makeGroups:function(){var a=0;return function(b){var c,e,d,f,g={},h=this.morphTargets.length,k=this.morphNormals.length;this.geometryGroups={};c=0;for(e=this.faces.length;c<e;c++)d=this.faces[c],d=b?d.materialIndex:0,d in g||(g[d]={hash:d,counter:0}),f=g[d].hash+"_"+g[d].counter,f in this.geometryGroups||(this.geometryGroups[f]={faces3:[],
materialIndex:d,vertices:0,numMorphTargets:h,numMorphNormals:k}),65535<this.geometryGroups[f].vertices+3&&(g[d].counter+=1,f=g[d].hash+"_"+g[d].counter,f in this.geometryGroups||(this.geometryGroups[f]={faces3:[],materialIndex:d,vertices:0,numMorphTargets:h,numMorphNormals:k})),this.geometryGroups[f].faces3.push(c),this.geometryGroups[f].vertices+=3;this.geometryGroupsList=[];for(var l in this.geometryGroups)this.geometryGroups[l].id=a++,this.geometryGroupsList.push(this.geometryGroups[l])}}(),clone:function(){for(var a=
new THREE.Geometry,b=this.vertices,c=0,e=b.length;c<e;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(e=b.length;c<e;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(e=b.length;c<e;c++){for(var d=b[c],f=[],g=0,h=d.length;g<h;g++)f.push(new THREE.Vector2(d[g].x,d[g].y));a.faceVertexUvs[0].push(f)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;
THREE.Geometry2=function(a){THREE.BufferGeometry.call(this);this.vertices=this.addAttribute("position",Float32Array,a,3).array;this.normals=this.addAttribute("normal",Float32Array,a,3).array;this.uvs=this.addAttribute("uv",Float32Array,a,2).array;this.boundingSphere=this.boundingBox=null};THREE.Geometry2.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};
THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.OrthographicCamera=function(a,b,c,e,d,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=e;this.near=void 0!==d?d:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;return a};THREE.PerspectiveCamera=function(a,b,c,e){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==e?e:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);
THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,e,d,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=e;this.width=d;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,e=a*c,a=Math.abs(a*b-e),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(e+this.x*a/this.fullWidth,e+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;return a};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};
THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};
THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,
0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.position.set(0,100,0);this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.HemisphereLight;THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};
THREE.SpotLight=function(a,b,c,e,d){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==e?e:Math.PI/3;this.exponent=void 0!==d?d:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=
this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};
THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/a.total).toFixed(0)+
"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"},initMaterials:function(a,b){for(var c=[],e=0;e<a.length;++e)c[e]=THREE.Loader.prototype.createMaterial(a[e],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function e(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function d(a,b){var g=new Image;g.onload=function(){if(c(this.width)&&c(this.height))a.image=this;else{var b=e(this.width),g=e(this.height);a.image.width=b;a.image.height=g;a.image.getContext("2d").drawImage(this,0,0,b,g)}a.needsUpdate=!0};void 0!==h.crossOrigin&&(g.crossOrigin=h.crossOrigin);g.src=b}function f(a,g,c,h,e,k,f){var l=/\.dds$/i.test(c),m=b+c;if(l){var A=THREE.ImageUtils.loadCompressedTexture(m);a[g]=A}else A=document.createElement("canvas"),
a[g]=new THREE.Texture(A);a[g].sourceFile=c;h&&(a[g].repeat.set(h[0],h[1]),1!==h[0]&&(a[g].wrapS=THREE.RepeatWrapping),1!==h[1]&&(a[g].wrapT=THREE.RepeatWrapping));e&&a[g].offset.set(e[0],e[1]);k&&(c={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==c[k[0]]&&(a[g].wrapS=c[k[0]]),void 0!==c[k[1]]&&(a[g].wrapT=c[k[1]]));f&&(a[g].anisotropy=f);l||d(a[g],m)}function g(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var h=this,k="MeshLambertMaterial",l={color:15658734,opacity:1,
map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var m=a.shading.toLowerCase();"phong"===m?k="MeshPhongMaterial":"basic"===m&&(k="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(l.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)l.transparent=a.transparent;void 0!==a.depthTest&&(l.depthTest=a.depthTest);void 0!==a.depthWrite&&(l.depthWrite=a.depthWrite);void 0!==a.visible&&(l.visible=a.visible);void 0!==a.flipSided&&(l.side=THREE.BackSide);
void 0!==a.doubleSided&&(l.side=THREE.DoubleSide);void 0!==a.wireframe&&(l.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?l.vertexColors=THREE.FaceColors:a.vertexColors&&(l.vertexColors=THREE.VertexColors));a.colorDiffuse?l.color=g(a.colorDiffuse):a.DbgColor&&(l.color=a.DbgColor);a.colorSpecular&&(l.specular=g(a.colorSpecular));a.colorAmbient&&(l.ambient=g(a.colorAmbient));a.transparency&&(l.opacity=a.transparency);a.specularCoef&&(l.shininess=a.specularCoef);a.mapDiffuse&&
b&&f(l,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&f(l,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&f(l,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&f(l,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&f(l,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(l.bumpScale=a.mapBumpScale);a.mapNormal?(k=THREE.ShaderLib.normalmap,m=THREE.UniformsUtils.clone(k.uniforms),m.tNormal.value=l.normalMap,a.mapNormalFactor&&m.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),l.map&&(m.tDiffuse.value=l.map,m.enableDiffuse.value=!0),l.specularMap&&(m.tSpecular.value=l.specularMap,m.enableSpecular.value=!0),l.lightMap&&(m.tAO.value=l.lightMap,m.enableAO.value=!0),m.diffuse.value.setHex(l.color),
m.specular.value.setHex(l.specular),m.ambient.value.setHex(l.ambient),m.shininess.value=l.shininess,void 0!==l.opacity&&(m.opacity.value=l.opacity),k=new THREE.ShaderMaterial({fragmentShader:k.fragmentShader,vertexShader:k.vertexShader,uniforms:m,lights:!0,fog:!0}),l.transparent&&(k.transparent=!0)):k=new THREE[k](l);void 0!==a.DbgName&&(k.name=a.DbgName);return k}};THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,e){var d=this,f=new XMLHttpRequest;void 0!==b&&f.addEventListener("load",function(g){b(g.target.responseText);d.manager.itemEnd(a)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==e&&f.addEventListener("error",function(a){e(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.open("GET",a,!0);f.send(null);d.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,e){var d=this,f=document.createElement("img");void 0!==b&&f.addEventListener("load",function(g){d.manager.itemEnd(a);b(this)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==e&&f.addEventListener("error",function(a){e(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.src=a;d.manager.itemStart(a);return f},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.LoadingManager=function(a,b,c){var e=this,d=0,f=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){f++};this.itemEnd=function(a){d++;if(void 0!==e.onProgress)e.onProgress(a,d,f);if(d===f&&void 0!==e.onLoad)e.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,e){c=new THREE.ImageLoader(this.manager);c.setCrossOrigin(this.crossOrigin);c.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)})},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var e=this[b];e instanceof THREE.Color?e.set(c):e instanceof THREE.Vector3&&c instanceof THREE.Vector3?e.copy(c):this[b]="overdraw"==b?Number(c):c}}},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;
a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);
THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.wrapAround=this.metal=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=
1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){for(var a=new THREE.MeshFaceMaterial,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName="position";this.setValues(a)};
THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.Texture=function(a,b,c,e,d,f,g,h,k){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==d?d:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==k?k:1;this.format=void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;
this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=
this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(a,b,c,e,d,f,g,h,k,l,m){THREE.Texture.call(this,null,f,g,h,k,l,e,d,m);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=!1};
THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.DataTexture=function(a,b,c,e,d,f,g,h,k,l,m){THREE.Texture.call(this,null,f,g,h,k,l,e,d,m);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);
THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b,c){THREE.Object3D.call(this,c);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};
THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,e=this.children.length;for(c=0;c<e;c++)this.children[c].update(this.skinMatrix,b)};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);
THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var e=1,d=this.objects.length;e<d;e++)if(c>=this.objects[e].distance)this.objects[e-1].object.visible=!1,this.objects[e].object.visible=!0;else break;for(;e<d;e++)this.objects[e].object.visible=!1}}}();
THREE.LOD.prototype.clone=function(a){void 0===a&&(a=new THREE.LOD);THREE.Object3D.prototype.clone.call(this,a);for(var b=0,c=this.objects.length;b<c;b++){var e=this.objects[b].object.clone();e.visible=0===b;a.addLevel(e,this.objects[b].distance)}return a};THREE.Sprite=function(){var a=new THREE.Geometry2(3);a.vertices.set([-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0]);return function(b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.SpriteMaterial}}();
THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Particle=THREE.Sprite;
THREE.Scene=function(a){THREE.Object3D.call(this,a);this.children=[];this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)){this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}this.dispatchEvent({type:"objectAdded",object:a});a.dispatchEvent({type:"addedToScene",scene:this});if(a.children)for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1);if(a.shadowCascadeArray)for(b=0;b<a.shadowCascadeArray.length;b++)this.__removeObject(a.shadowCascadeArray[b])}else a instanceof THREE.Camera||(this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1));this.dispatchEvent({type:"objectRemoved",object:a});a.dispatchEvent({type:"removedFromScene",scene:this});if(a.children)for(b=
0;b<a.children.length;b++)this.__removeObject(a.children[b])};THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#endif\n#endif",
normal_fragment:"vec3 normal = normalize( vNormal );\nvec3 geomNormal = normal;\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",envmap_fragment:"#if defined(USE_ENVMAP)\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( -vViewPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nvec3 cameraToVertex = normalize( -vViewPosition );\nreflectVec = reflect( cameraToVertex, vNormal );\n#endif\nreflectVec = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVec;\nfloat logShiny = log(max(1.0+1e-10, shininess));\n#ifdef ENV_LOGLUV\nfloat MipmapIndex = max(0.0, -1.66096404744368 * logShiny + 5.5);\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ), MipmapIndex );\nvec3 cubeColor = LogLuvDecode(envTexColor);\n#else\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\nvec3 cubeColor = envTexColor.xyz;\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\n#endif\nfloat facing = dot( viewPosition, normal );\nif (facing < 0.0) {\nfacing = 1.0;\n}\nvec4 speca = vec4(specular, gl_FragColor.a);\n#ifdef METAL\nvec4 schlickRefl = speca; /* + ( 1.0 - speca ) * pow( max(1.0 - facing, 0.0), 5.0 );*/\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = speca.a;\n#else\n#ifdef CLEARCOAT\nvec3 cubeColorClearcoat;\nvec3 reflectVecClearcoat = reflect( -vViewPosition, vNormal );\nreflectVecClearcoat = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVecClearcoat;\n#ifdef ENV_LOGLUV\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ));\ncubeColorClearcoat = LogLuvDecode(envTexColorClearcoat);\n#else\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ) );\ncubeColorClearcoat = envTexColorClearcoat.xyz;\n#ifdef GAMMA_INPUT\ncubeColorClearcoat.xyz *= cubeColorClearcoat.xyz;\n#endif\n#endif\ncubeColor = mix(cubeColor, cubeColorClearcoat, reflectivity);\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * speca.xyz;\nfloat schlickRefl = reflectivity + ( 1.0 - reflectivity ) * pow( max(1.0 - facing, 0.0), 5.0 );\ngl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickRefl, 0.5);\n#else\nvec4 schlickRefl = speca + ( 1.0 - speca ) * pow( max(1.0 - facing, 0.0), 5.0 );\nschlickRefl.rgb *= max(0.0, 1.0 - 1.0 / logShiny);\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * schlickRefl.xyz );\ngl_FragColor.a = schlickRefl.a;\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = schlickRefl.a;\n} else {\ngl_FragColor = mix( gl_FragColor, vec4(gl_FragColor.xyz * cubeColor.xyz, gl_FragColor.a), specularStrength * schlickRefl );\n}\n#endif\n#endif\n#endif",
envmap_pars_vertex:"#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) \nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n#endif",
map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform vec4 offsetRepeatBump;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvUvBump = uv * offsetRepeatBump.zw + offsetRepeatBump.xy;\n#endif",
map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",
logluv_pars_fragment:"const mat3 InverseM = mat3(\n6.0014, -2.7008, -1.7996,\n-1.3320,  3.1029, -5.7721,\n0.3008, -1.0882,  5.6268);\nvec3 LogLuvDecode(in vec4 vLogLuv) {\nfloat Le = vLogLuv.b * 255.0 + vLogLuv.a;\nvec3 Xp_Y_XYZp;\nXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\nXp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.g;\nXp_Y_XYZp.x = vLogLuv.r * Xp_Y_XYZp.z;\nvec3 vRGB = InverseM * Xp_Y_XYZp;\nreturn max(vRGB, vec3(0.0));\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBump );\nvec2 dSTdy = dFdy( vUvBump );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBump ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBump + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBump + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUvBump.st );\nvec2 st1 = dFdy( vUvBump.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvBump ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_phong_pars_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef USE_IRRADIANCEMAP\nuniform samplerCube irradianceMap;\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, pointHalfVector ), 0.0), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, spotHalfVector ), 0.0), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( dirVector, dirHalfVector ), 0.0), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef USE_IRRADIANCEMAP\nvec3 worldNormal = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * normal;\nvec4 cubeColor4 = textureCube(irradianceMap, worldNormal);\n#ifdef IRR_LOGLUV\nvec3 indirectDiffuse = LogLuvDecode(cubeColor4);\n#else\nvec3 indirectDiffuse = cubeColor.xyz;\n#ifdef GAMMA_INPUT\nindirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\ntotalDiffuse += diffuse * indirectDiffuse;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",default_vertex:"vec4 mvPosition;\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",defaultnormal_vertex:"vec3 objectNormal;\nobjectNormal = normal;\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif",mrt_normals_pars_vertex:"#ifdef MRT_NORMALS\nvarying float depth;\n#endif",
mrt_normals_vertex:"#ifdef MRT_NORMALS\ndepth = mvPosition.z;\n#endif",mrt_normals_pars_fragment:["#ifdef MRT_NORMALS","undefined"!==typeof _isIE11&&_isIE11?"":"#extension GL_EXT_draw_buffers : require","varying float depth;\n#define gl_FragColor gl_FragData[0]\n#endif"].join("\n"),mrt_normals_fragment:"#ifdef MRT_NORMALS\ngeomNormal = geomNormal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\ngl_FragData[1] = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif"};
THREE.UniformsUtils={merge:function(a){var b,c,e,d={};for(b=0;b<a.length;b++)for(c in e=this.clone(a[b]),e)d[c]=e[c];return d},clone:function(a){var b,c,e,d={};for(b in a)for(c in d[b]={},a[b])e=a[b][c],d[b][c]=e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix4||e instanceof THREE.Texture?e.clone():e instanceof Array?e.slice():e;return d}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},offsetRepeatBump:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0}},
bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",
value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},irradianceMap:{type:"t",value:null}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",
value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.defaultnormal_vertex,
"#endif",THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",
THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,
THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,
THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.mrt_normals_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,THREE.ShaderChunk.mrt_normals_vertex,
"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.logluv_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,
THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.mrt_normals_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,THREE.ShaderChunk.mrt_normals_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",
value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;a.shareDepthFrom=this.shareDepthFrom;
return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);
THREE.GeometryUtils={merge:function(a,b,c){var e,d,f=a.vertices.length,g=b instanceof THREE.Mesh?b.geometry:b,h=a.vertices,k=g.vertices,l=a.faces,m=g.faces;a=a.faceVertexUvs[0];g=g.faceVertexUvs[0];void 0===c&&(c=0);b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),e=b.matrix,d=(new THREE.Matrix3).getNormalMatrix(e));b=0;for(var n=k.length;b<n;b++){var p=k[b].clone();e&&p.applyMatrix4(e);h.push(p)}b=0;for(n=m.length;b<n;b++){var p=m[b],q,s,t=p.vertexNormals,u=p.vertexColors;q=new THREE.Face3(p.a+
f,p.b+f,p.c+f);q.normal.copy(p.normal);d&&q.normal.applyMatrix3(d).normalize();h=0;for(k=t.length;h<k;h++)s=t[h].clone(),d&&s.applyMatrix3(d).normalize(),q.vertexNormals.push(s);q.color.copy(p.color);h=0;for(k=u.length;h<k;h++)s=u[h],q.vertexColors.push(s.clone());q.materialIndex=p.materialIndex+c;q.centroid.copy(p.centroid);e&&q.centroid.applyMatrix4(e);l.push(q)}b=0;for(n=g.length;b<n;b++){c=g[b];e=[];h=0;for(k=c.length;h<k;h++)e.push(new THREE.Vector2(c[h].x,c[h].y));a.push(e)}},randomPointInTriangle:function(){var a=
new THREE.Vector3;return function(b,c,e){var d=new THREE.Vector3,f=THREE.Math.random16(),g=THREE.Math.random16();1<f+g&&(f=1-f,g=1-g);var h=1-f-g;d.copy(b);d.multiplyScalar(f);a.copy(c);a.multiplyScalar(g);d.add(a);a.copy(e);a.multiplyScalar(h);d.add(a);return d}}(),randomPointInFace:function(a,b,c){return THREE.GeometryUtils.randomPointInTriangle(b.vertices[a.a],b.vertices[a.b],b.vertices[a.c])},randomPointsInGeometry:function(a,b){function c(a){function b(g,d){if(d<g)return g;var c=g+Math.floor((d-
g)/2);return l[c]>a?b(g,c-1):l[c]<a?b(c+1,d):c}return b(0,l.length-1)}var e,d,f=a.faces,g=a.vertices,h=f.length,k=0,l=[],m,n,p;for(d=0;d<h;d++)e=f[d],m=g[e.a],n=g[e.b],p=g[e.c],e._area=THREE.GeometryUtils.triangleArea(m,n,p),k+=e._area,l[d]=k;e=[];for(d=0;d<b;d++)g=THREE.Math.random16()*k,g=c(g),e[d]=THREE.GeometryUtils.randomPointInFace(f[g],a,!0);return e},triangleArea:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e,d){a.subVectors(e,c);b.subVectors(d,c);a.cross(b);return 0.5*
a.length()}}(),center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.addVectors(b.min,b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},triangulateQuads:function(a){var b,c,e,d,f=[],g=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)g[b]=[];b=0;for(c=a.faces.length;b<c;b++)for(f.push(a.faces[b]),e=0,d=a.faceVertexUvs.length;e<d;e++)g[e].push(a.faceVertexUvs[e][b]);a.faces=f;a.faceVertexUvs=g;a.computeCentroids();
a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()}};
THREE.ImageUtils={crossOrigin:"",loadTexture:function(a,b,c,e){e=new THREE.ImageLoader;e.crossOrigin=this.crossOrigin;var d=new THREE.Texture(void 0,b);b=e.load(a,function(){d.needsUpdate=!0;c&&c(d)});d.image=b;d.sourceFile=a;return d},loadCompressedTexture:function(a,b,c,e){var d=new THREE.CompressedTexture;d.mapping=b;var f=new XMLHttpRequest;f.onload=function(){var a=THREE.ImageUtils.parseDDS(f.response,!0);d.format=a.format;d.type=a.type;d.mipmaps=a.mipmaps;d.image.width=a.width;d.image.height=
a.height;d.generateMipmaps=!1;d.needsUpdate=!0;c&&c(d)};f.onerror=e;f.open("GET",a,!0);f.responseType="arraybuffer";f.send(null);return d},loadTextureCube:function(a,b,c,e){var d=[];d.loadCount=0;var f=new THREE.Texture;f.image=d;void 0!==b&&(f.mapping=b);f.flipY=!1;b=0;for(var g=a.length;b<g;++b){var h=new Image;d[b]=h;h.onload=function(){d.loadCount+=1;6===d.loadCount&&(f.needsUpdate=!0,c&&c(f))};h.onerror=e;h.crossOrigin=this.crossOrigin;h.src=a[b]}return f},loadCompressedTextureCube:function(a,
b,c,e){var d=[];d.loadCount=0;var f=new THREE.CompressedTexture;f.image=d;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;b=function(a,b){return function(){var g=THREE.ImageUtils.parseDDS(a.response,!0);b.format=g.format;b.type=g.type;b.mipmaps=g.mipmaps;b.width=g.width;b.height=g.height;d.loadCount+=1;6===d.loadCount&&(f.format=g.format,f.type=g.type,1==g.mipmapCount&&(f.minFilter=THREE.LinearFilter),f.needsUpdate=!0,c&&c(f))}};if(a instanceof Array)for(var g=0,h=a.length;g<h;++g){var k=
{};d[g]=k;var l=new XMLHttpRequest;l.onload=b(l,k);l.onerror=e;k=a[g];l.open("GET",k,!0);l.responseType="arraybuffer";l.send(null)}else l=new XMLHttpRequest,l.onload=function(){var a=THREE.ImageUtils.parseDDS(l.response,!0);if(a.isCubemap){for(var b=a.mipmaps.length/a.mipmapCount,g=0;g<b;g++){d[g]={mipmaps:[]};for(var h=0;h<a.mipmapCount;h++)d[g].mipmaps.push(a.mipmaps[g*a.mipmapCount+h]),d[g].format=a.format,d[g].type=a.type,d[g].width=a.width,d[g].height=a.height}f.format=a.format;f.type=a.type;
1==a.mipmapCount&&(f.minFilter=THREE.LinearFilter);f.needsUpdate=!0;c&&c(f)}},l.onerror=e,l.open("GET",a,!0),l.responseType="arraybuffer",l.send(null);return f},loadDDSTexture:function(a,b,c,e){var d=[];d.loadCount=0;var f=new THREE.CompressedTexture;f.image=d;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;var g=new XMLHttpRequest;g.onload=function(){var a=THREE.ImageUtils.parseDDS(g.response,!0);if(a.isCubemap)for(var b=a.mipmaps.length/a.mipmapCount,e=0;e<b;e++){d[e]={mipmaps:[]};for(var m=
0;m<a.mipmapCount;m++)d[e].mipmaps.push(a.mipmaps[e*a.mipmapCount+m]),d[e].format=a.format,d[e].type=a.type,d[e].width=a.width,d[e].height=a.height}else f.image.width=a.width,f.image.height=a.height,f.mipmaps=a.mipmaps;f.format=a.format;f.type=a.type;1==a.mipmapCount&&(f.minFilter=THREE.LinearFilter);f.needsUpdate=!0;c&&c(f)};g.onerror=e;g.open("GET",a,!0);g.responseType="arraybuffer";g.send(null);return f},parseDDS:function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<
16)+(a.charCodeAt(3)<<24)}function e(a,b,g,d){var c=g*d*4;a=new Uint8Array(a,b,c);for(var c=new Uint8Array(c),h=b=0,e=0;e<d;e++)for(var k=0;k<g;k++){var f=a[h];h++;var l=a[h];h++;var m=a[h];h++;var n=a[h];h++;c[b]=m;b++;c[b]=l;b++;c[b]=f;b++;c[b]=n;b++}return c}var d={mipmaps:[],width:0,height:0,format:null,type:THREE.UnsignedByteType,mipmapCount:1},f=c("DXT1"),g=c("DXT3"),h=c("DXT5"),k=new Int32Array(a,0,31);if(542327876!==k[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),
d;if(!k[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),d;var l=k[21],m=!1;switch(l){case f:f=8;d.format=THREE.RGB_S3TC_DXT1_Format;break;case g:f=16;d.format=THREE.RGBA_S3TC_DXT3_Format;break;case h:f=16;d.format=THREE.RGBA_S3TC_DXT5_Format;break;case 116:f=16;d.format=THREE.RGBAFormat;d.type=THREE.FloatType;m=!0;break;default:if(32==k[22]&&k[23]&16711680&&k[24]&65280&&k[25]&255&&k[26]&4278190080)m=!0,f=64,d.format=THREE.RGBAFormat,d.type=THREE.UnsignedByteType;
else return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(l&255,l>>8&255,l>>16&255,l>>24&255)),d}d.mipmapCount=1;k[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,k[7]));d.isCubemap=k[28]&512?!0:!1;d.width=k[4];d.height=k[3];for(var k=k[1]+4,g=d.width,h=d.height,l=d.isCubemap?6:1,n=0;n<l;n++){for(var p=0;p<d.mipmapCount;p++){if(m)if(d.type==THREE.FloatType)var q=g*h*16,s=new Float32Array(a.slice(k,k+q));else s=e(a,k,g,h),q=s.length;else q=Math.max(4,g)/4*Math.max(4,
h)/4*f,s=new Uint8Array(a,k,q);d.mipmaps.push({data:s,width:g,height:h});k+=q;g=Math.max(0.5*g,1);h=Math.max(0.5*h,1)}g=d.width;h=d.height}return d},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var e=a.width,d=a.height,f=document.createElement("canvas");f.width=e;f.height=d;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,e,d).data,k=g.createImageData(e,d),l=k.data,m=0;m<e;m++)for(var n=0;n<d;n++){var p=
0>n-1?0:n-1,q=n+1>d-1?d-1:n+1,s=0>m-1?0:m-1,t=m+1>e-1?e-1:m+1,u=[],v=[0,0,h[4*(n*e+m)]/255*b];u.push([-1,0,h[4*(n*e+s)]/255*b]);u.push([-1,-1,h[4*(p*e+s)]/255*b]);u.push([0,-1,h[4*(p*e+m)]/255*b]);u.push([1,-1,h[4*(p*e+t)]/255*b]);u.push([1,0,h[4*(n*e+t)]/255*b]);u.push([1,1,h[4*(q*e+t)]/255*b]);u.push([0,1,h[4*(q*e+m)]/255*b]);u.push([-1,1,h[4*(q*e+s)]/255*b]);p=[];s=u.length;for(q=0;q<s;q++){var t=u[q],w=u[(q+1)%s],t=[t[0]-v[0],t[1]-v[1],t[2]-v[2]],w=[w[0]-v[0],w[1]-v[1],w[2]-v[2]];p.push(c([t[1]*
w[2]-t[2]*w[1],t[2]*w[0]-t[0]*w[2],t[0]*w[1]-t[1]*w[0]]))}u=[0,0,0];for(q=0;q<p.length;q++)u[0]+=p[q][0],u[1]+=p[q][1],u[2]+=p[q][2];u[0]/=p.length;u[1]/=p.length;u[2]/=p.length;v=4*(n*e+m);l[v]=(u[0]+1)/2*255|0;l[v+1]=(u[1]+1)/2*255|0;l[v+2]=255*u[2]|0;l[v+3]=255}g.putImageData(k,0,0);return f},generateDataTexture:function(a,b,c){var e=a*b,d=new Uint8Array(3*e),f=Math.floor(255*c.r),g=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var h=0;h<e;h++)d[3*h]=f,d[3*h+1]=g,d[3*h+2]=c;a=new THREE.DataTexture(d,
a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,e=0,d=b.length;e<d;e++)c.add(new THREE.Mesh(a,b[e]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var e=new THREE.Matrix4;e.getInverse(c.matrixWorld);a.applyMatrix(e);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,e=0,d=
String(a).split(""),f=d.length,g=[];for(a=0;a<f;a++){var h=new THREE.Path,h=this.extractGlyphPoints(d[a],b,c,e,h),e=e+h.offset;g.push(h.path)}return{paths:g,offset:e/2}},extractGlyphPoints:function(a,b,c,e,d){var f=[],g,h,k,l,m,n,p,q,s,t,u,v=b.glyphs[a]||b.glyphs["?"];if(v){if(v.o)for(b=v._cachedOutline||(v._cachedOutline=v.o.split(" ")),l=b.length,a=0;a<l;)switch(k=b[a++],k){case "m":k=b[a++]*c+e;m=b[a++]*c;d.moveTo(k,m);break;case "l":k=b[a++]*c+e;m=b[a++]*c;d.lineTo(k,m);break;case "q":k=b[a++]*
c+e;m=b[a++]*c;q=b[a++]*c+e;s=b[a++]*c;d.quadraticCurveTo(q,s,k,m);if(g=f[f.length-1])for(n=g.x,p=g.y,g=1,h=this.divisions;g<=h;g++){var w=g/h;THREE.Shape.Utils.b2(w,n,q,k);THREE.Shape.Utils.b2(w,p,s,m)}break;case "b":if(k=b[a++]*c+e,m=b[a++]*c,q=b[a++]*c+e,s=b[a++]*-c,t=b[a++]*c+e,u=b[a++]*-c,d.bezierCurveTo(k,m,q,s,t,u),g=f[f.length-1])for(n=g.x,p=g.y,g=1,h=this.divisions;g<=h;g++)w=g/h,THREE.Shape.Utils.b3(w,n,q,t,k),THREE.Shape.Utils.b3(w,p,s,u,m)}return{offset:v.ha*c,path:d}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,e=void 0!==b.font?b.font:"helvetiker",d=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=e;THREE.FontUtils.weight=d;THREE.FontUtils.style=f;c=THREE.FontUtils.drawText(a).paths;e=[];d=0;for(f=c.length;d<f;d++)Array.prototype.push.apply(e,c[d].toShapes());return e};
(function(a){var b=function(a){for(var b=a.length,d=0,f=b-1,g=0;g<b;f=g++)d+=a[f].x*a[g].y-a[g].x*a[f].y;return 0.5*d};a.Triangulate=function(a,e){var d=a.length;if(3>d)return null;var f=[],g=[],h=[],k,l,m;if(0<b(a))for(l=0;l<d;l++)g[l]=l;else for(l=0;l<d;l++)g[l]=d-1-l;var n=2*d;for(l=d-1;2<d;){if(0>=n--){console.log("Warning, unable to triangulate polygon!");break}k=l;d<=k&&(k=0);l=k+1;d<=l&&(l=0);m=l+1;d<=m&&(m=0);var p;a:{var q=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,B=void 0,A=void 0,
q=a[g[k]].x,s=a[g[k]].y,t=a[g[l]].x,u=a[g[l]].y,v=a[g[m]].x,w=a[g[m]].y;if(1E-10>(t-q)*(w-s)-(u-s)*(v-q))p=!1;else{var D=void 0,W=void 0,C=void 0,P=void 0,G=void 0,F=void 0,N=void 0,z=void 0,M=void 0,H=void 0,M=z=N=A=B=void 0,D=v-t,W=w-u,C=q-v,P=s-w,G=t-q,F=u-s;for(p=0;p<d;p++)if(B=a[g[p]].x,A=a[g[p]].y,!(B===q&&A===s||B===t&&A===u||B===v&&A===w)&&(N=B-q,z=A-s,M=B-t,H=A-u,B-=v,A-=w,M=D*H-W*M,N=G*z-F*N,z=C*A-P*B,-1E-10<=M&&-1E-10<=z&&-1E-10<=N)){p=!1;break a}p=!0}}if(p){f.push([a[g[k]],a[g[l]],a[g[m]]]);
h.push([g[k],g[l],g[m]]);k=l;for(m=l+1;m<d;k++,m++)g[k]=g[m];d--;n=2*d}}return e?h:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.AnimationHandler=function(){var a=[],b={},c={update:function(b){for(var c=0;c<a.length;c++)a[c].update(b)},addToUpdate:function(b){-1===a.indexOf(b)&&a.push(b)},removeFromUpdate:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},add:function(a){void 0!==b[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");b[a.name]=a;if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var g=0;g<a.hierarchy[c].keys.length;g++)if(0>a.hierarchy[c].keys[g].time&&
(a.hierarchy[c].keys[g].time=0),void 0!==a.hierarchy[c].keys[g].rot&&!(a.hierarchy[c].keys[g].rot instanceof THREE.Quaternion)){var h=a.hierarchy[c].keys[g].rot;a.hierarchy[c].keys[g].rot=new THREE.Quaternion(h[0],h[1],h[2],h[3])}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){h={};for(g=0;g<a.hierarchy[c].keys.length;g++)for(var e=0;e<a.hierarchy[c].keys[g].morphTargets.length;e++){var l=a.hierarchy[c].keys[g].morphTargets[e];h[l]=-1}a.hierarchy[c].usedMorphTargets=h;
for(g=0;g<a.hierarchy[c].keys.length;g++){var m={};for(l in h){for(e=0;e<a.hierarchy[c].keys[g].morphTargets.length;e++)if(a.hierarchy[c].keys[g].morphTargets[e]===l){m[l]=a.hierarchy[c].keys[g].morphTargetsInfluences[e];break}e===a.hierarchy[c].keys[g].morphTargets.length&&(m[l]=0)}a.hierarchy[c].keys[g].morphTargetsInfluences=m}}for(g=1;g<a.hierarchy[c].keys.length;g++)a.hierarchy[c].keys[g].time===a.hierarchy[c].keys[g-1].time&&(a.hierarchy[c].keys.splice(g,1),g--);for(g=0;g<a.hierarchy[c].keys.length;g++)a.hierarchy[c].keys[g].index=
g}a.initialized=!0}},get:function(a){if("string"===typeof a){if(b[a])return b[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(a){var b=[];if(a instanceof THREE.SkinnedMesh)for(var g=0;g<a.bones.length;g++)b.push(a.bones[g]);else e(a,b);return b}},e=function(a,b){b.push(a);for(var g=0;g<a.children.length;g++)e(a.children[g],b)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();
THREE.Animation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=THREE.AnimationHandler.LINEAR};THREE.Animation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;!1===this.isPlaying&&(this.isPlaying=!0,this.reset(),this.update(0));this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};
THREE.Animation.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];c.matrixAutoUpdate=!0;void 0===c.animationCache&&(c.animationCache={},c.animationCache.prevKey={pos:0,rot:0,scl:0},c.animationCache.nextKey={pos:0,rot:0,scl:0},c.animationCache.originalMatrix=c instanceof THREE.Bone?c.skinMatrix:c.matrix);var e=c.animationCache.prevKey,c=c.animationCache.nextKey;e.pos=this.data.hierarchy[a].keys[0];e.rot=this.data.hierarchy[a].keys[0];e.scl=this.data.hierarchy[a].keys[0];
c.pos=this.getNextKeyWith("pos",a,1);c.rot=this.getNextKeyWith("rot",a,1);c.scl=this.getNextKeyWith("scl",a,1)}};
THREE.Animation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=function(a,b){var g=[],c=[],k,l,m,n,p,q;k=(a.length-1)*b;l=Math.floor(k);k-=l;g[0]=0===l?l:l-1;g[1]=l;g[2]=l>a.length-2?l:l+1;g[3]=l>a.length-3?l:l+2;l=a[g[0]];n=a[g[1]];p=a[g[2]];q=a[g[3]];g=k*k;m=k*g;c[0]=e(l[0],n[0],p[0],q[0],k,g,m);c[1]=e(l[1],n[1],p[1],q[1],k,g,m);c[2]=e(l[2],n[2],p[2],q[2],k,g,m);return c},e=function(a,b,g,c,e,l,m){a=0.5*(g-a);c=0.5*(c-b);return(2*(b-g)+a+c)*m+(-3*(b-g)-2*a-c)*l+a*e+b};return function(d){if(!1!==
this.isPlaying){this.currentTime+=d*this.timeScale;var e;d=["pos","rot","scl"];var g=this.data.length;if(!0===this.loop&&this.currentTime>g)this.currentTime%=g,this.reset();else if(!1===this.loop&&this.currentTime>g){this.stop();return}this.currentTime=Math.min(this.currentTime,g);for(var g=0,h=this.hierarchy.length;g<h;g++)for(var k=this.hierarchy[g],l=k.animationCache,m=0;3>m;m++){e=d[m];var n=l.prevKey[e],p=l.nextKey[e];if(p.time<=this.currentTime){n=this.data.hierarchy[g].keys[0];for(p=this.getNextKeyWith(e,
g,1);p.time<this.currentTime&&p.index>n.index;)n=p,p=this.getNextKeyWith(e,g,p.index+1);l.prevKey[e]=n;l.nextKey[e]=p}k.matrixAutoUpdate=!0;k.matrixWorldNeedsUpdate=!0;var q=(this.currentTime-n.time)/(p.time-n.time),s=n[e],t=p[e];0>q&&(q=0);1<q&&(q=1);if("pos"===e)if(e=k.position,this.interpolationType===THREE.AnimationHandler.LINEAR)e.x=s[0]+(t[0]-s[0])*q,e.y=s[1]+(t[1]-s[1])*q,e.z=s[2]+(t[2]-s[2])*q;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=
this.getPrevKeyWith("pos",g,n.index-1).pos,a[1]=s,a[2]=t,a[3]=this.getNextKeyWith("pos",g,p.index+1).pos,q=0.33*q+0.33,n=c(a,q),e.x=n[0],e.y=n[1],e.z=n[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(q=c(a,1.01*q),b.set(q[0],q[1],q[2]),b.sub(e),b.y=0,b.normalize(),e=Math.atan2(b.x,b.z),k.rotation.set(0,e,0))}else"rot"===e?THREE.Quaternion.slerp(s,t,k.quaternion,q):"scl"===e&&(e=k.scale,e.x=s[0]+(t[0]-s[0])*q,e.y=s[1]+(t[1]-s[1])*q,e.z=s[2]+(t[2]-s[2])*q)}}}}();
THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var e=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<e.length-1?c:e.length-1:c%e.length;c<e.length;c++)if(void 0!==e[c][a])return e[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var e=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+e.length;0<=c;c--)if(void 0!==e[c][a])return e[c];return this.data.hierarchy[b].keys[e.length-1]};
THREE.KeyFrameAnimation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;for(var c=0,e=this.hierarchy.length;c<e;c++){var d=this.data.hierarchy[c].sids,f=this.hierarchy[c];if(this.data.hierarchy[c].keys.length&&d){for(var g=0;g<d.length;g++){var h=d[g],k=this.getNextKeyWith(h,c,0);k&&k.apply(h)}f.matrixAutoUpdate=!1;this.data.hierarchy[c].node.updateMatrix();
f.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var b=this.hierarchy.length,c,e;for(a=0;a<b;a++)c=this.hierarchy[a],e=this.data.hierarchy[a],void 0===e.animationCache&&(e.animationCache={},e.animationCache.prevKey=null,e.animationCache.nextKey=null,e.animationCache.originalMatrix=c instanceof THREE.Bone?c.skinMatrix:c.matrix),c=this.data.hierarchy[a].keys,c.length&&(e.animationCache.prevKey=c[0],e.animationCache.nextKey=
c[1],this.startTime=Math.min(c[0].time,this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var e=c.animationCache.originalMatrix;b instanceof THREE.Bone?(e.copy(b.skinMatrix),b.skinMatrix=e):(e.copy(b.matrix),b.matrix=e);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(!1!==this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a],e=this.data.hierarchy[a],d=e.keys,e=e.animationCache;if(d.length){var f=e.prevKey,g=e.nextKey;if(g.time<=this.currentTime){for(;g.time<this.currentTime&&g.index>f.index;)f=g,g=d[f.index+1];e.prevKey=
f;e.nextKey=g}g.time>=this.currentTime?f.interpolate(g,this.currentTime):f.interpolate(g,g.time);this.data.hierarchy[a].node.updateMatrix();c.matrixWorldNeedsUpdate=!0}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};
THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(1,0,0));this.add(e);var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(-1,0,0));this.add(d);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1);f.lookAt(new THREE.Vector3(0,1,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new THREE.Vector3(0,-1,0));this.add(g);var h=new THREE.PerspectiveCamera(90,
1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var k=new THREE.PerspectiveCamera(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,-1));this.add(k);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,p=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,e,c);c.activeCubeFace=1;a.render(b,d,c);c.activeCubeFace=
2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.generateMipmaps=p;c.activeCubeFace=5;a.render(b,k,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(a,b,c,e,d,f,g){THREE.Camera.call(this);this.fov=c;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.cameraO=new THREE.OrthographicCamera(a/-2,a/2,b/2,b/-2,f,g);this.cameraP=new THREE.PerspectiveCamera(c,a/b,e,d);this.zoom=1;this.toPerspective()};
THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var a=this.cameraP.aspect,b=(this.cameraP.near+this.cameraP.far)/2,b=Math.tan(this.fov/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.cameraO.left=-a;this.cameraO.right=a;this.cameraO.top=b;this.cameraO.bottom=-b;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(a,b){this.cameraP.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.BoxGeometry=function(a,b,c,e,d,f){function g(a,b,g,c,d,e,f,t){var u,v=h.widthSegments,w=h.heightSegments,B=d/2,A=e/2,D=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)u="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)u="y",w=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)u="x",v=h.depthSegments;var W=v+1,C=w+1,P=d/v,G=e/w,F=new THREE.Vector3;F[u]=0<f?1:-1;for(d=0;d<C;d++)for(e=0;e<W;e++){var N=new THREE.Vector3;N[a]=(e*P-B)*g;N[b]=(d*G-A)*c;N[u]=f;h.vertices.push(N)}for(d=
0;d<w;d++)for(e=0;e<v;e++)A=e+W*d,a=e+W*(d+1),b=e+1+W*(d+1),g=e+1+W*d,c=new THREE.Vector2(e/v,1-d/w),f=new THREE.Vector2(e/v,1-(d+1)/w),u=new THREE.Vector2((e+1)/v,1-(d+1)/w),B=new THREE.Vector2((e+1)/v,1-d/w),A=new THREE.Face3(A+D,a+D,g+D),A.normal.copy(F),A.vertexNormals.push(F.clone(),F.clone(),F.clone()),A.materialIndex=t,h.faces.push(A),h.faceVertexUvs[0].push([c,f,B]),A=new THREE.Face3(a+D,b+D,g+D),A.normal.copy(F),A.vertexNormals.push(F.clone(),F.clone(),F.clone()),A.materialIndex=t,h.faces.push(A),
h.faceVertexUvs[0].push([f.clone(),u,B.clone()])}THREE.Geometry.call(this);var h=this;this.width=a;this.height=b;this.depth=c;this.widthSegments=e||1;this.heightSegments=d||1;this.depthSegments=f||1;a=this.width/2;b=this.height/2;c=this.depth/2;g("z","y",-1,-1,this.depth,this.height,a,0);g("z","y",1,-1,this.depth,this.height,-a,1);g("x","z",1,1,this.width,this.depth,b,2);g("x","z",1,-1,this.width,this.depth,-b,3);g("x","y",1,-1,this.width,this.height,c,4);g("x","y",-1,-1,this.width,this.height,-c,
5);this.computeCentroids();this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,b,c,e){THREE.Geometry.call(this);this.radius=a=a||50;this.segments=b=void 0!==b?Math.max(3,b):8;this.thetaStart=c=void 0!==c?c:0;this.thetaLength=e=void 0!==e?e:2*Math.PI;var d,f=[];d=new THREE.Vector3;var g=new THREE.Vector2(0.5,0.5);this.vertices.push(d);f.push(g);for(d=0;d<=b;d++){var h=new THREE.Vector3,k=c+d/b*e;h.x=a*Math.cos(k);h.y=a*Math.sin(k);this.vertices.push(h);f.push(new THREE.Vector2((h.x/a+1)/2,(h.y/a+1)/2))}c=new THREE.Vector3(0,0,1);for(d=1;d<=b;d++)this.faces.push(new THREE.Face3(d,
d+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([f[d].clone(),f[d+1].clone(),g.clone()]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CylinderGeometry=function(a,b,c,e,d,f){THREE.Geometry.call(this);this.radiusTop=a=void 0!==a?a:20;this.radiusBottom=b=void 0!==b?b:20;this.height=c=void 0!==c?c:100;this.radialSegments=e=e||8;this.heightSegments=d=d||1;this.openEnded=f=void 0!==f?f:!1;var g=c/2,h,k,l=[],m=[];for(k=0;k<=d;k++){var n=[],p=[],q=k/d,s=q*(b-a)+a;for(h=0;h<=e;h++){var t=h/e,u=new THREE.Vector3;u.x=s*Math.sin(t*Math.PI*2);u.y=-q*c+g;u.z=s*Math.cos(t*Math.PI*2);this.vertices.push(u);n.push(this.vertices.length-1);p.push(new THREE.Vector2(t,
1-q))}l.push(n);m.push(p)}c=(b-a)/c;for(h=0;h<e;h++)for(0!==a?(n=this.vertices[l[0][h]].clone(),p=this.vertices[l[0][h+1]].clone()):(n=this.vertices[l[1][h]].clone(),p=this.vertices[l[1][h+1]].clone()),n.setY(Math.sqrt(n.x*n.x+n.z*n.z)*c).normalize(),p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*c).normalize(),k=0;k<d;k++){var q=l[k][h],s=l[k+1][h],t=l[k+1][h+1],u=l[k][h+1],v=n.clone(),w=n.clone(),B=p.clone(),A=p.clone(),D=m[k][h].clone(),W=m[k+1][h].clone(),C=m[k+1][h+1].clone(),P=m[k][h+1].clone();this.faces.push(new THREE.Face3(q,
s,u,[v,w,A]));this.faceVertexUvs[0].push([D,W,P]);this.faces.push(new THREE.Face3(s,t,u,[w.clone(),B,A.clone()]));this.faceVertexUvs[0].push([W.clone(),C,P.clone()])}if(!1===f&&0<a)for(this.vertices.push(new THREE.Vector3(0,g,0)),h=0;h<e;h++)q=l[0][h],s=l[0][h+1],t=this.vertices.length-1,v=new THREE.Vector3(0,1,0),w=new THREE.Vector3(0,1,0),B=new THREE.Vector3(0,1,0),D=m[0][h].clone(),W=m[0][h+1].clone(),C=new THREE.Vector2(W.x,0),this.faces.push(new THREE.Face3(q,s,t,[v,w,B])),this.faceVertexUvs[0].push([D,
W,C]);if(!1===f&&0<b)for(this.vertices.push(new THREE.Vector3(0,-g,0)),h=0;h<e;h++)q=l[k][h+1],s=l[k][h],t=this.vertices.length-1,v=new THREE.Vector3(0,-1,0),w=new THREE.Vector3(0,-1,0),B=new THREE.Vector3(0,-1,0),D=m[k][h+1].clone(),W=m[k][h].clone(),C=new THREE.Vector2(W.x,1),this.faces.push(new THREE.Face3(q,s,t,[v,w,B])),this.faceVertexUvs[0].push([D,W,C]);this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),a=a instanceof Array?a:[a],this.shapebb=a[a.length-1].getBoundingBox(),this.addShapeList(a,b),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,e=0;e<c;e++)this.addShape(a[e],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,g){b||console.log("die");return b.clone().multiplyScalar(g).add(a)}function e(a,b,g){var c=THREE.Math.sign,d=1,d=a.x-b.x,h=a.y-b.y,e=g.x-a.x,k=g.y-a.y,f=d*d+h*h;if(1E-10<Math.abs(d*k-h*e)){var l=Math.sqrt(f),c=Math.sqrt(e*e+k*k),f=b.x-h/l;b=b.y+d/l;e=((g.x-k/c-f)*k-(g.y+e/c-b)*e)/(d*k-h*e);g=f+d*e-a.x;a=b+h*e-a.y;d=g*g+a*a;if(2>=d)return new THREE.Vector2(g,a);d=Math.sqrt(d/2)}else a=!1,1E-10<d?1E-10<e&&(a=!0):-1E-10>d?-1E-10>e&&
(a=!0):c(h)==c(k)&&(a=!0),a?(g=-h,a=d,d=Math.sqrt(f)):(g=d,a=h,d=Math.sqrt(f/2));return new THREE.Vector2(g/d,a/d)}function d(g,c){var d,h;for(R=g.length;0<=--R;){d=R;h=R-1;0>h&&(h=g.length-1);for(var e=0,k=q+2*m,e=0;e<k;e++){var f=ca*e,l=ca*(e+1),n=c+d+f,f=c+h+f,T=c+h+l,l=c+d+l,p=g,I=e,s=k,t=d,E=h,n=n+z,f=f+z,T=T+z,l=l+z;N.faces.push(new THREE.Face3(n,f,l,null,null,w));N.faces.push(new THREE.Face3(f,T,l,null,null,w));n=B.generateSideWallUV(N,a,p,b,n,f,T,l,I,s,t,E);N.faceVertexUvs[0].push([n[0],n[1],
n[3]]);N.faceVertexUvs[0].push([n[1],n[2],n[3]])}}}function f(a,b,g){N.vertices.push(new THREE.Vector3(a,b,g))}function g(g,c,d,h){g+=z;c+=z;d+=z;N.faces.push(new THREE.Face3(g,c,d,null,null,v));g=h?B.generateBottomUV(N,a,b,g,c,d):B.generateTopUV(N,a,b,g,c,d);N.faceVertexUvs[0].push(g)}var h=void 0!==b.amount?b.amount:100,k=void 0!==b.bevelThickness?b.bevelThickness:6,l=void 0!==b.bevelSize?b.bevelSize:k-2,m=void 0!==b.bevelSegments?b.bevelSegments:3,n=void 0!==b.bevelEnabled?b.bevelEnabled:!0,p=
void 0!==b.curveSegments?b.curveSegments:12,q=void 0!==b.steps?b.steps:1,s=b.extrudePath,t,u=!1,v=b.material,w=b.extrudeMaterial,B=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,A,D,W,C;s&&(t=s.getSpacedPoints(q),u=!0,n=!1,A=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(s,q,!1),D=new THREE.Vector3,W=new THREE.Vector3,C=new THREE.Vector3);n||(l=k=m=0);var P,G,F,N=this,z=this.vertices.length,s=a.extractPoints(p),p=s.shape,M=s.holes;if(s=!THREE.Shape.Utils.isClockWise(p)){p=
p.reverse();G=0;for(F=M.length;G<F;G++)P=M[G],THREE.Shape.Utils.isClockWise(P)&&(M[G]=P.reverse());s=!1}var H=THREE.Shape.Utils.triangulateShape(p,M),Q=p;G=0;for(F=M.length;G<F;G++)P=M[G],p=p.concat(P);var V,T,I,E,J,ca=p.length,Y,ga=H.length,s=[],R=0;I=Q.length;V=I-1;for(T=R+1;R<I;R++,V++,T++)V===I&&(V=0),T===I&&(T=0),s[R]=e(Q[R],Q[V],Q[T]);var la=[],Z,ia=s.concat();G=0;for(F=M.length;G<F;G++){P=M[G];Z=[];R=0;I=P.length;V=I-1;for(T=R+1;R<I;R++,V++,T++)V===I&&(V=0),T===I&&(T=0),Z[R]=e(P[R],P[V],P[T]);
la.push(Z);ia=ia.concat(Z)}for(V=0;V<m;V++){I=V/m;E=k*(1-I);T=l*Math.sin(I*Math.PI/2);R=0;for(I=Q.length;R<I;R++)J=c(Q[R],s[R],T),f(J.x,J.y,-E);G=0;for(F=M.length;G<F;G++)for(P=M[G],Z=la[G],R=0,I=P.length;R<I;R++)J=c(P[R],Z[R],T),f(J.x,J.y,-E)}T=l;for(R=0;R<ca;R++)J=n?c(p[R],ia[R],T):p[R],u?(W.copy(A.normals[0]).multiplyScalar(J.x),D.copy(A.binormals[0]).multiplyScalar(J.y),C.copy(t[0]).add(W).add(D),f(C.x,C.y,C.z)):f(J.x,J.y,0);for(I=1;I<=q;I++)for(R=0;R<ca;R++)J=n?c(p[R],ia[R],T):p[R],u?(W.copy(A.normals[I]).multiplyScalar(J.x),
D.copy(A.binormals[I]).multiplyScalar(J.y),C.copy(t[I]).add(W).add(D),f(C.x,C.y,C.z)):f(J.x,J.y,h/q*I);for(V=m-1;0<=V;V--){I=V/m;E=k*(1-I);T=l*Math.sin(I*Math.PI/2);R=0;for(I=Q.length;R<I;R++)J=c(Q[R],s[R],T),f(J.x,J.y,h+E);G=0;for(F=M.length;G<F;G++)for(P=M[G],Z=la[G],R=0,I=P.length;R<I;R++)J=c(P[R],Z[R],T),u?f(J.x,J.y+t[q-1].y,t[q-1].x+E):f(J.x,J.y,h+E)}(function(){if(n){var a;a=0*ca;for(R=0;R<ga;R++)Y=H[R],g(Y[2]+a,Y[1]+a,Y[0]+a,!0);a=q+2*m;a*=ca;for(R=0;R<ga;R++)Y=H[R],g(Y[0]+a,Y[1]+a,Y[2]+a,
!1)}else{for(R=0;R<ga;R++)Y=H[R],g(Y[2],Y[1],Y[0],!0);for(R=0;R<ga;R++)Y=H[R],g(Y[0]+ca*q,Y[1]+ca*q,Y[2]+ca*q,!1)}})();(function(){var a=0;d(Q,a);a+=Q.length;G=0;for(F=M.length;G<F;G++)P=M[G],d(P,a),a+=P.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,e,d,f){b=a.vertices[d].x;d=a.vertices[d].y;c=a.vertices[f].x;f=a.vertices[f].y;return[new THREE.Vector2(a.vertices[e].x,a.vertices[e].y),new THREE.Vector2(b,d),new THREE.Vector2(c,f)]},generateBottomUV:function(a,b,c,e,d,f){return this.generateTopUV(a,b,c,e,d,f)},generateSideWallUV:function(a,b,c,e,d,f,g,h,k,l,m,n){b=a.vertices[d].x;c=a.vertices[d].y;d=a.vertices[d].z;e=a.vertices[f].x;k=a.vertices[f].y;f=a.vertices[f].z;l=a.vertices[g].x;
m=a.vertices[g].y;g=a.vertices[g].z;n=a.vertices[h].x;var p=a.vertices[h].y;a=a.vertices[h].z;return 0.01>Math.abs(c-k)?[new THREE.Vector2(b,1-d),new THREE.Vector2(e,1-f),new THREE.Vector2(l,1-g),new THREE.Vector2(n,1-a)]:[new THREE.Vector2(c,1-d),new THREE.Vector2(k,1-f),new THREE.Vector2(m,1-g),new THREE.Vector2(p,1-a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);!1===a instanceof Array&&(a=[a]);this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,e=a.length;c<e;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,e=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,d,f,g,h=this.vertices.length;d=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var k=d.shape,l=d.holes;if(!THREE.Shape.Utils.isClockWise(k))for(k=k.reverse(),d=0,f=l.length;d<f;d++)g=l[d],THREE.Shape.Utils.isClockWise(g)&&(l[d]=g.reverse());var m=THREE.Shape.Utils.triangulateShape(k,l);d=0;for(f=l.length;d<f;d++)g=l[d],
k=k.concat(g);l=k.length;f=m.length;for(d=0;d<l;d++)g=k[d],this.vertices.push(new THREE.Vector3(g.x,g.y,0));for(d=0;d<f;d++)l=m[d],k=l[0]+h,g=l[1]+h,l=l[2]+h,this.faces.push(new THREE.Face3(k,g,l,null,null,c)),this.faceVertexUvs[0].push(e.generateBottomUV(this,a,b,k,g,l))};
THREE.LatheGeometry=function(a,b,c,e){THREE.Geometry.call(this);b=b||12;c=c||0;e=e||2*Math.PI;for(var d=1/(a.length-1),f=1/b,g=0,h=b;g<=h;g++)for(var k=c+g*f*e,l=Math.cos(k),m=Math.sin(k),k=0,n=a.length;k<n;k++){var p=a[k],q=new THREE.Vector3;q.x=l*p.x-m*p.y;q.y=m*p.x+l*p.y;q.z=p.z;this.vertices.push(q)}c=a.length;g=0;for(h=b;g<h;g++)for(k=0,n=a.length-1;k<n;k++){b=m=k+c*g;e=m+c;var l=m+1+c,m=m+1,p=g*f,q=k*d,s=p+f,t=q+d;this.faces.push(new THREE.Face3(b,e,m));this.faceVertexUvs[0].push([new THREE.Vector2(p,
q),new THREE.Vector2(s,q),new THREE.Vector2(p,t)]);this.faces.push(new THREE.Face3(e,l,m));this.faceVertexUvs[0].push([new THREE.Vector2(s,q),new THREE.Vector2(s,t),new THREE.Vector2(p,t)])}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,e){THREE.Geometry.call(this);this.width=a;this.height=b;this.widthSegments=c||1;this.heightSegments=e||1;var d=a/2,f=b/2;c=this.widthSegments;e=this.heightSegments;var g=c+1,h=e+1,k=this.width/c,l=this.height/e,m=new THREE.Vector3(0,0,1);for(a=0;a<h;a++)for(b=0;b<g;b++)this.vertices.push(new THREE.Vector3(b*k-d,-(a*l-f),0));for(a=0;a<e;a++)for(b=0;b<c;b++){var n=b+g*a,d=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,k=new THREE.Vector2(b/c,1-a/e),l=new THREE.Vector2(b/c,1-(a+
1)/e),p=new THREE.Vector2((b+1)/c,1-(a+1)/e),q=new THREE.Vector2((b+1)/c,1-a/e),n=new THREE.Face3(n,d,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([k,l,q]);n=new THREE.Face3(d,f,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([l.clone(),p,q.clone()])}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry=function(a,b,c,e,d,f){THREE.Geometry.call(this);a=a||0;b=b||50;d=void 0!==d?d:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;e=void 0!==e?Math.max(3,e):8;var g,h=[],k=a,l=(b-a)/e;for(a=0;a<=e;a++){for(g=0;g<=c;g++){var m=new THREE.Vector3,n=d+g/c*f;m.x=k*Math.cos(n);m.y=k*Math.sin(n);this.vertices.push(m);h.push(new THREE.Vector2((m.x/b+1)/2,(m.y/b+1)/2))}k+=l}b=new THREE.Vector3(0,0,1);for(a=0;a<e;a++)for(d=a*c,g=0;g<=c;g++)n=g+d,f=n+a,l=n+c+a,m=n+c+1+a,this.faces.push(new THREE.Face3(f,
l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[f].clone(),h[l].clone(),h[m].clone()]),f=n+a,l=n+c+1+a,m=n+1+a,this.faces.push(new THREE.Face3(f,l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[f].clone(),h[l].clone(),h[m].clone()]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,k)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,e,d,f,g){THREE.Geometry.call(this);this.radius=a=a||50;this.widthSegments=b=Math.max(3,Math.floor(b)||8);this.heightSegments=c=Math.max(2,Math.floor(c)||6);this.phiStart=e=void 0!==e?e:0;this.phiLength=d=void 0!==d?d:2*Math.PI;this.thetaStart=f=void 0!==f?f:0;this.thetaLength=g=void 0!==g?g:Math.PI;var h,k,l=[],m=[];for(k=0;k<=c;k++){var n=[],p=[];for(h=0;h<=b;h++){var q=h/b,s=k/c,t=new THREE.Vector3;t.x=-a*Math.cos(e+q*d)*Math.sin(f+s*g);t.y=a*Math.cos(f+s*g);
t.z=a*Math.sin(e+q*d)*Math.sin(f+s*g);this.vertices.push(t);n.push(this.vertices.length-1);p.push(new THREE.Vector2(q,1-s))}l.push(n);m.push(p)}for(k=0;k<this.heightSegments;k++)for(h=0;h<this.widthSegments;h++){b=l[k][h+1];c=l[k][h];e=l[k+1][h];d=l[k+1][h+1];f=this.vertices[b].clone().normalize();g=this.vertices[c].clone().normalize();var n=this.vertices[e].clone().normalize(),p=this.vertices[d].clone().normalize(),q=m[k][h+1].clone(),s=m[k][h].clone(),t=m[k+1][h].clone(),u=m[k+1][h+1].clone();Math.abs(this.vertices[b].y)===
this.radius?(q.x=(q.x+s.x)/2,this.faces.push(new THREE.Face3(b,e,d,[f,n,p])),this.faceVertexUvs[0].push([q,t,u])):Math.abs(this.vertices[e].y)===this.radius?(t.x=(t.x+u.x)/2,this.faces.push(new THREE.Face3(b,c,e,[f,g,n])),this.faceVertexUvs[0].push([q,s,t])):(this.faces.push(new THREE.Face3(b,c,d,[f,g,p])),this.faceVertexUvs[0].push([q,s,u]),this.faces.push(new THREE.Face3(c,e,d,[g.clone(),n,p.clone()])),this.faceVertexUvs[0].push([s.clone(),t,u.clone()]))}this.computeCentroids();this.computeFaceNormals();
this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,b,c,e,d){THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||8;this.tubularSegments=e||6;this.arc=d||2*Math.PI;d=new THREE.Vector3;a=[];b=[];for(c=0;c<=this.radialSegments;c++)for(e=0;e<=this.tubularSegments;e++){var f=e/this.tubularSegments*this.arc,g=c/this.radialSegments*Math.PI*2;d.x=this.radius*Math.cos(f);d.y=this.radius*Math.sin(f);var h=new THREE.Vector3;h.x=(this.radius+this.tube*Math.cos(g))*Math.cos(f);h.y=(this.radius+this.tube*
Math.cos(g))*Math.sin(f);h.z=this.tube*Math.sin(g);this.vertices.push(h);a.push(new THREE.Vector2(e/this.tubularSegments,c/this.radialSegments));b.push(h.clone().sub(d).normalize())}for(c=1;c<=this.radialSegments;c++)for(e=1;e<=this.tubularSegments;e++){d=(this.tubularSegments+1)*c+e-1;var f=(this.tubularSegments+1)*(c-1)+e-1,g=(this.tubularSegments+1)*(c-1)+e,h=(this.tubularSegments+1)*c+e,k=new THREE.Face3(d,f,h,[b[d].clone(),b[f].clone(),b[h].clone()]);this.faces.push(k);this.faceVertexUvs[0].push([a[d].clone(),
a[f].clone(),a[h].clone()]);k=new THREE.Face3(f,g,h,[b[f].clone(),b[g].clone(),b[h].clone()]);this.faces.push(k);this.faceVertexUvs[0].push([a[f].clone(),a[g].clone(),a[h].clone()])}this.computeCentroids();this.computeFaceNormals()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,b,c,e,d){THREE.Geometry.call(this);this.path=a;this.segments=b||64;this.radius=c||1;this.radialSegments=e||8;this.closed=d||!1;this.grid=[];var f,g;e=this.segments+1;var h,k,l;d=new THREE.Vector3;var m,n;b=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);m=b.normals;n=b.binormals;this.tangents=b.tangents;this.normals=m;this.binormals=n;for(b=0;b<e;b++)for(this.grid[b]=[],c=b/(e-1),l=a.getPointAt(c),f=m[b],g=n[b],c=0;c<this.radialSegments;c++)h=
c/this.radialSegments*2*Math.PI,k=-this.radius*Math.cos(h),h=this.radius*Math.sin(h),d.copy(l),d.x+=k*f.x+h*g.x,d.y+=k*f.y+h*g.y,d.z+=k*f.z+h*g.z,this.grid[b][c]=this.vertices.push(new THREE.Vector3(d.x,d.y,d.z))-1;for(b=0;b<this.segments;b++)for(c=0;c<this.radialSegments;c++)d=this.closed?(b+1)%this.segments:b+1,m=(c+1)%this.radialSegments,a=this.grid[b][c],e=this.grid[d][c],d=this.grid[d][m],m=this.grid[b][m],n=new THREE.Vector2(b/this.segments,c/this.radialSegments),f=new THREE.Vector2((b+1)/this.segments,
c/this.radialSegments),g=new THREE.Vector2((b+1)/this.segments,(c+1)/this.radialSegments),k=new THREE.Vector2(b/this.segments,(c+1)/this.radialSegments),this.faces.push(new THREE.Face3(a,e,m)),this.faceVertexUvs[0].push([n,f,k]),this.faces.push(new THREE.Face3(e,d,m)),this.faceVertexUvs[0].push([f.clone(),g,k.clone()]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var e=new THREE.Vector3;new THREE.Vector3;var d=[],f=[],g=[],h=new THREE.Vector3,k=new THREE.Matrix4;b+=1;var l,m,n;this.tangents=d;this.normals=f;this.binormals=g;for(l=0;l<b;l++)m=l/(b-1),d[l]=a.getTangentAt(m),d[l].normalize();f[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;l=Math.abs(d[0].x);m=Math.abs(d[0].y);n=Math.abs(d[0].z);l<=a&&(a=l,e.set(1,0,0));m<=a&&(a=m,e.set(0,1,0));n<=a&&e.set(0,0,1);h.crossVectors(d[0],
e).normalize();f[0].crossVectors(d[0],h);g[0].crossVectors(d[0],f[0]);for(l=1;l<b;l++)f[l]=f[l-1].clone(),g[l]=g[l-1].clone(),h.crossVectors(d[l-1],d[l]),1E-4<h.length()&&(h.normalize(),e=Math.acos(THREE.Math.clamp(d[l-1].dot(d[l]),-1,1)),f[l].applyMatrix4(k.makeRotationAxis(h,e))),g[l].crossVectors(d[l],f[l]);if(c)for(e=Math.acos(THREE.Math.clamp(f[0].dot(f[b-1]),-1,1)),e/=b-1,0<d[0].dot(h.crossVectors(f[0],f[b-1]))&&(e=-e),l=1;l<b;l++)f[l].applyMatrix4(k.makeRotationAxis(d[l],e*l)),g[l].crossVectors(d[l],
f[l])};
THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this);var e=this.vertices,d=this.faces,f=this.faceVertexUvs[0],g,h,k,l,m=b+1;for(g=0;g<=c;g++)for(l=g/c,h=0;h<=b;h++)k=h/b,k=a(k,l),e.push(k);var n,p,q,s;for(g=0;g<c;g++)for(h=0;h<b;h++)a=g*m+h,e=g*m+h+1,l=(g+1)*m+h+1,k=(g+1)*m+h,n=new THREE.Vector2(h/b,g/c),p=new THREE.Vector2((h+1)/b,g/c),q=new THREE.Vector2((h+1)/b,(g+1)/c),s=new THREE.Vector2(h/b,(g+1)/c),d.push(new THREE.Face3(a,e,k)),f.push([n,p,s]),d.push(new THREE.Face3(e,l,k)),
f.push([p.clone(),q,s.clone()]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3(a,0,0),new THREE.Vector3,new THREE.Vector3(0,a,0),new THREE.Vector3,new THREE.Vector3(0,0,a));b.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));a=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,b,a,THREE.LinePieces)};
THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(a,b,c,e,d,f){THREE.Object3D.call(this);void 0===e&&(e=16776960);void 0===c&&(c=1);void 0===d&&(d=0.2*c);void 0===f&&(f=0.2*d);this.position=b;b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(b,new THREE.LineBasicMaterial({color:e}));this.line.matrixAutoUpdate=!1;this.add(this.line);b=new THREE.CylinderGeometry(0,0.5,1,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));this.cone=
new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:e}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,d,f)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){0.99999<c.y?this.quaternion.set(0,0,0,1):-0.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();
THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=0.2*a);void 0===c&&(c=0.2*b);this.line.scale.set(1,a,1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};
THREE.BoxHelper=function(a){var b=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=b;var c=new THREE.Geometry;c.vertices.push(b[0],b[1],b[1],b[2],b[2],b[3],b[3],b[0],b[4],b[5],b[5],b[6],b[6],b[7],b[7],b[4],b[0],b[4],b[1],b[5],b[2],b[6],b[3],b[7]);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);
void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,e=this.vertices;e[0].set(b.x,b.y,b.z);e[1].set(c.x,b.y,b.z);e[2].set(c.x,c.y,b.z);e[3].set(b.x,c.y,b.z);e[4].set(b.x,b.y,c.z);e[5].set(c.x,b.y,c.z);e[6].set(c.x,c.y,c.z);e[7].set(b.x,c.y,c.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};
THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){e.vertices.push(new THREE.Vector3);e.colors.push(new THREE.Color(b));void 0===f[a]&&(f[a]=[]);f[a].push(e.vertices.length-1)}var e=new THREE.Geometry,d=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),f={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,e,d,THREE.LinePieces);this.camera=a;this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=f;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Camera,c=new THREE.Projector;return function(){function e(e,g,h,k){a.set(g,h,k);c.unprojectVector(a,b);e=d.pointMap[e];if(void 0!==e)for(g=0,h=e.length;g<h;g++)d.geometry.vertices[e[g]].copy(a)}var d=this;b.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",0.7,
1.1,-1);e("u2",-0.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.PlaneGeometry(b,b),e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(c,e);this.add(this.lightPlane);c=new THREE.Geometry;c.vertices.push(new THREE.Vector3);c.vertices.push(new THREE.Vector3);e=new THREE.LineBasicMaterial({fog:!1});
e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,e);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b){var c=void 0!==b?b:16777215,e=[0,0],d={},f=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry,k=a.geometry.clone();k.mergeVertices();k.computeFaceNormals();for(var l=k.vertices,k=k.faces,m=0,n=0,p=k.length;n<p;n++)for(var q=k[n],s=0;3>s;s++){e[0]=q[g[s]];e[1]=q[g[(s+1)%3]];e.sort(f);var t=e.toString();void 0===d[t]?(d[t]={vert1:e[0],vert2:e[1],face1:n,face2:void 0},m++):d[t].face2=n}h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;
f=0;for(t in d)if(g=d[t],void 0===g.face2||0.9999>k[g.face1].normal.dot(k[g.face2].normal))m=l[g.vert1],e[f++]=m.x,e[f++]=m.y,e[f++]=m.z,m=l[g.vert2],e[f++]=m.x,e[f++]=m.y,e[f++]=m.z;THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;e=void 0!==e?e:1;b=new THREE.Geometry;c=0;for(var d=this.object.geometry.faces.length;c<d;c++)b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:a,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);a=this.geometry.vertices;for(var e=this.object.geometry.faces,d=this.object.matrixWorld,f=0,g=e.length;f<g;f++){var h=e[f];b.copy(h.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var k=2*f;a[k].copy(h.centroid).applyMatrix4(d);a[k+1].addVectors(a[k],b)}this.geometry.verticesNeedUpdate=
!0;return this}}();THREE.GridHelper=function(a,b){var c=new THREE.Geometry,e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var d=-a;d<=a;d+=b){c.vertices.push(new THREE.Vector3(-a,0,d),new THREE.Vector3(a,0,d),new THREE.Vector3(d,0,-a),new THREE.Vector3(d,0,a));var f=0===d?this.color1:this.color2;c.colors.push(f,f,f,f)}THREE.Line.call(this,c,e,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b,c,e){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];a=new THREE.SphereGeometry(b,4,2);a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(b=0;8>b;b++)a.faces[b].color=this.colors[4>b?0:1];b=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(a,b);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,e);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,e=c*Math.tan(this.light.angle);this.cone.scale.set(e,e,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;e=void 0!==e?e:1;c=new THREE.Geometry;a=a.geometry.faces;for(var d=0,f=a.length;d<f;d++)for(var g=0,h=a[d].vertexNormals.length;g<h;g++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};
THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var e=this.geometry.vertices,d=this.object.geometry.vertices,f=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=f.length;k<l;k++)for(var m=f[k],n=0,p=m.vertexNormals.length;n<p;n++){var q=m.vertexNormals[n];e[h].copy(d[m[a[n]]]).applyMatrix4(g);b.copy(q).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
b.add(e[h]);h+=1;e[h].copy(b);h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;e=void 0!==e?e:1;c=new THREE.Geometry;a=a.geometry.faces;for(var d=0,f=a.length;d<f;d++)for(var g=0,h=a[d].vertexTangents.length;g<h;g++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var e=this.geometry.vertices,d=this.object.geometry.vertices,f=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=f.length;k<l;k++)for(var m=f[k],n=0,p=m.vertexTangents.length;n<p;n++){var q=m.vertexTangents[n];e[h].copy(d[m[a[n]]]).applyMatrix4(g);b.copy(q).transformDirection(g).multiplyScalar(this.size);b.add(e[h]);h+=1;e[h].copy(b);
h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215,e=[0,0],d={},f=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var k=a.geometry.vertices,l=a.geometry.faces,m=0,n=new Uint32Array(6*l.length),p=0,q=l.length;p<q;p++)for(var s=l[p],t=0;3>t;t++){e[0]=s[g[t]];e[1]=s[g[(t+1)%3]];e.sort(f);var u=e.toString();void 0===d[u]&&(n[2*m]=e[0],n[2*m+1]=e[1],d[u]=!0,m++)}h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;
p=0;for(q=m;p<q;p++)for(t=0;2>t;t++)m=k[n[2*p+t]],g=6*p+3*t,e[g+0]=m.x,e[g+1]=m.y,e[g+2]=m.z}else if(a.geometry instanceof THREE.BufferGeometry&&void 0!==a.geometry.attributes.index){for(var k=a.geometry.attributes.position.array,q=a.geometry.attributes.index.array,l=a.geometry.offsets,m=0,n=new Uint32Array(2*q.length),s=0,v=l.length;s<v;++s)for(var t=l[s].start,u=l[s].count,g=l[s].index,p=t,w=t+u;p<w;p+=3)for(t=0;3>t;t++)e[0]=g+q[p+t],e[1]=g+q[p+(t+1)%3],e.sort(f),u=e.toString(),void 0===d[u]&&(n[2*
m]=e[0],n[2*m+1]=e[1],d[u]=!0,m++);h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;p=0;for(q=m;p<q;p++)for(t=0;2>t;t++)g=6*p+3*t,m=3*n[2*p+t],e[g+0]=k[m],e[g+1]=k[m+1],e[g+2]=k[m+2]}else if(a.geometry instanceof THREE.BufferGeometry)for(k=a.geometry.attributes.position.array,m=k.length/3,n=m/3,h.addAttribute("position",Float32Array,2*m,3),e=h.attributes.position.array,p=0,q=n;p<q;p++)for(t=0;3>t;t++)g=18*p+6*t,n=9*p+3*t,e[g+0]=k[n],e[g+1]=k[n+1],e[g+2]=k[n+2],m=9*p+(t+
1)%3*3,e[g+3]=k[m],e[g+4]=k[m+1],e[g+5]=k[m+2];THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ShadowMapPlugin=function(){var a,b,c,e,d,f,g=new THREE.Frustum,h=new THREE.Matrix4,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3;this.init=function(g){a=g.context;b=g;g=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(g.uniforms);c=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h});e=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0});d=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,
vertexShader:g.vertexShader,uniforms:h,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;d._shadowPass=!0;f._shadowPass=!0};this.render=function(a,g){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,g)};this.update=function(n,p){var q,s,t,u,v,w,B,A,D,W=[];u=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);b.shadowMapCullFace===THREE.CullFaceFront?
a.cullFace(a.FRONT):a.cullFace(a.BACK);b.setDepthTest(!0);q=0;for(s=n.__lights.length;q<s;q++)if(t=n.__lights[q],t.castShadow)if(t instanceof THREE.DirectionalLight&&t.shadowCascade)for(v=0;v<t.shadowCascadeCount;v++){var C;if(t.shadowCascadeArray[v])C=t.shadowCascadeArray[v];else{D=t;B=v;C=new THREE.DirectionalLight;C.isVirtual=!0;C.onlyShadow=!0;C.castShadow=!0;C.shadowCameraNear=D.shadowCameraNear;C.shadowCameraFar=D.shadowCameraFar;C.shadowCameraLeft=D.shadowCameraLeft;C.shadowCameraRight=D.shadowCameraRight;
C.shadowCameraBottom=D.shadowCameraBottom;C.shadowCameraTop=D.shadowCameraTop;C.shadowCameraVisible=D.shadowCameraVisible;C.shadowDarkness=D.shadowDarkness;C.shadowBias=D.shadowCascadeBias[B];C.shadowMapWidth=D.shadowCascadeWidth[B];C.shadowMapHeight=D.shadowCascadeHeight[B];C.pointsWorld=[];C.pointsFrustum=[];A=C.pointsWorld;w=C.pointsFrustum;for(var P=0;8>P;P++)A[P]=new THREE.Vector3,w[P]=new THREE.Vector3;A=D.shadowCascadeNearZ[B];D=D.shadowCascadeFarZ[B];w[0].set(-1,-1,A);w[1].set(1,-1,A);w[2].set(-1,
1,A);w[3].set(1,1,A);w[4].set(-1,-1,D);w[5].set(1,-1,D);w[6].set(-1,1,D);w[7].set(1,1,D);C.originalCamera=p;w=new THREE.Gyroscope;w.position=t.shadowCascadeOffset;w.add(C);w.add(C.target);p.add(w);t.shadowCascadeArray[v]=C;console.log("Created virtualLight",C)}B=t;A=v;D=B.shadowCascadeArray[A];D.position.copy(B.position);D.target.position.copy(B.target.position);D.lookAt(D.target);D.shadowCameraVisible=B.shadowCameraVisible;D.shadowDarkness=B.shadowDarkness;D.shadowBias=B.shadowCascadeBias[A];w=B.shadowCascadeNearZ[A];
B=B.shadowCascadeFarZ[A];D=D.pointsFrustum;D[0].z=w;D[1].z=w;D[2].z=w;D[3].z=w;D[4].z=B;D[5].z=B;D[6].z=B;D[7].z=B;W[u]=C;u++}else W[u]=t,u++;q=0;for(s=W.length;q<s;q++){t=W[q];t.shadowMap||(v=THREE.LinearFilter,b.shadowMapType===THREE.PCFSoftShadowMap&&(v=THREE.NearestFilter),t.shadowMap=new THREE.WebGLRenderTarget(t.shadowMapWidth,t.shadowMapHeight,{minFilter:v,magFilter:v,format:THREE.RGBAFormat}),t.shadowMapSize=new THREE.Vector2(t.shadowMapWidth,t.shadowMapHeight),t.shadowMatrix=new THREE.Matrix4);
if(!t.shadowCamera){if(t instanceof THREE.SpotLight)t.shadowCamera=new THREE.PerspectiveCamera(t.shadowCameraFov,t.shadowMapWidth/t.shadowMapHeight,t.shadowCameraNear,t.shadowCameraFar);else if(t instanceof THREE.DirectionalLight)t.shadowCamera=new THREE.OrthographicCamera(t.shadowCameraLeft,t.shadowCameraRight,t.shadowCameraTop,t.shadowCameraBottom,t.shadowCameraNear,t.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}n.add(t.shadowCamera);!0===n.autoUpdate&&n.updateMatrixWorld()}t.shadowCameraVisible&&
!t.cameraHelper&&(t.cameraHelper=new THREE.CameraHelper(t.shadowCamera),t.shadowCamera.add(t.cameraHelper));if(t.isVirtual&&C.originalCamera==p){v=p;u=t.shadowCamera;w=t.pointsFrustum;D=t.pointsWorld;k.set(Infinity,Infinity,Infinity);l.set(-Infinity,-Infinity,-Infinity);for(B=0;8>B;B++)A=D[B],A.copy(w[B]),THREE.ShadowMapPlugin.__projector.unprojectVector(A,v),A.applyMatrix4(u.matrixWorldInverse),A.x<k.x&&(k.x=A.x),A.x>l.x&&(l.x=A.x),A.y<k.y&&(k.y=A.y),A.y>l.y&&(l.y=A.y),A.z<k.z&&(k.z=A.z),A.z>l.z&&
(l.z=A.z);u.left=k.x;u.right=l.x;u.top=l.y;u.bottom=k.y;u.updateProjectionMatrix()}u=t.shadowMap;w=t.shadowMatrix;v=t.shadowCamera;v.position.setFromMatrixPosition(t.matrixWorld);m.setFromMatrixPosition(t.target.matrixWorld);v.lookAt(m);v.updateMatrixWorld();v.matrixWorldInverse.getInverse(v.matrixWorld);t.cameraHelper&&(t.cameraHelper.visible=t.shadowCameraVisible);t.shadowCameraVisible&&t.cameraHelper.update();w.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);w.multiply(v.projectionMatrix);w.multiply(v.matrixWorldInverse);
h.multiplyMatrices(v.projectionMatrix,v.matrixWorldInverse);g.setFromMatrix(h);b.setRenderTarget(u);b.clear();D=n.__webglObjects;t=0;for(u=D.length;t<u;t++)B=D[t],w=B.object,B.render=!1,!w.visible||!w.castShadow||(w instanceof THREE.Mesh||w instanceof THREE.ParticleSystem)&&w.frustumCulled&&!g.intersectsObject(w)||(w._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,w.matrixWorld),B.render=!0);t=0;for(u=D.length;t<u;t++)B=D[t],B.render&&(w=B.object,B=B.buffer,P=w.material instanceof THREE.MeshFaceMaterial?
w.material.materials[0]:w.material,A=void 0!==w.geometry.morphTargets&&0<w.geometry.morphTargets.length&&P.morphTargets,P=w instanceof THREE.SkinnedMesh&&P.skinning,A=w.customDepthMaterial?w.customDepthMaterial:P?A?f:d:A?e:c,B instanceof THREE.BufferGeometry?b.renderBufferDirect(v,n.__lights,null,A,B,w):b.renderBuffer(v,n.__lights,null,A,B,w));D=n.__webglObjectsImmediate;t=0;for(u=D.length;t<u;t++)B=D[t],w=B.object,w.visible&&w.castShadow&&(w._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,
w.matrixWorld),b.renderImmediateObject(v,n.__lights,null,c,w))}q=b.getClearColor();s=b.getClearAlpha();a.clearColor(q.r,q.g,q.b,s);a.enable(a.BLEND);b.shadowMapCullFace===THREE.CullFaceFront&&a.cullFace(a.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var a,b,c,e,d,f,g=new THREE.Frustum,h=new THREE.Matrix4;this.init=function(g){a=g.context;b=g;g=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(g.uniforms);c=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h});e=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0});d=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,
vertexShader:g.vertexShader,uniforms:h,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;d._shadowPass=!0;f._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(k,l){var m,n,p,q,s,t;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.setDepthTest(!0);!0===k.autoUpdate&&k.updateMatrixWorld();l.matrixWorldInverse.getInverse(l.matrixWorld);h.multiplyMatrices(l.projectionMatrix,
l.matrixWorldInverse);g.setFromMatrix(h);b.setRenderTarget(this.renderTarget);b.clear();t=k.__webglObjects;m=0;for(n=t.length;m<n;m++)p=t[m],s=p.object,p.render=!1,!s.visible||(s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)&&s.frustumCulled&&!g.intersectsObject(s)||(s._modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,s.matrixWorld),p.render=!0);var u;m=0;for(n=t.length;m<n;m++)p=t[m],p.render&&(s=p.object,p=p.buffer,s instanceof THREE.ParticleSystem&&!s.customDepthMaterial||((u=
s.material instanceof THREE.MeshFaceMaterial?s.material.materials[0]:s.material)&&b.setMaterialFaces(s.material),q=0<s.geometry.morphTargets.length&&u.morphTargets,u=s instanceof THREE.SkinnedMesh&&u.skinning,q=s.customDepthMaterial?s.customDepthMaterial:u?q?f:d:q?e:c,p instanceof THREE.BufferGeometry?b.renderBufferDirect(l,k.__lights,null,q,p,s):b.renderBuffer(l,k.__lights,null,q,p,s)));t=k.__webglObjectsImmediate;m=0;for(n=t.length;m<n;m++)p=t[m],s=p.object,s.visible&&(s._modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,
s.matrixWorld),b.renderImmediateObject(l,k.__lights,null,c,s));m=b.getClearColor();n=b.getClearAlpha();a.clearColor(m.r,m.g,m.b,n);a.enable(a.BLEND)}};/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
(function(){function a(a){throw a;}function b(a,b){var g=a.split("."),c=t;g[0]in c||!c.execScript||c.execScript("var "+g[0]);for(var d;g.length&&(d=g.shift());)g.length||b===q?c=c[d]?c[d]:c[d]={}:c[d]=b}function c(a){var b=a.length,g=0,c=Number.POSITIVE_INFINITY,d,h,e,k,f,l,m,n,p;for(n=0;n<b;++n)a[n]>g&&(g=a[n]),a[n]<c&&(c=a[n]);d=1<<g;h=new (u?Uint32Array:Array)(d);e=1;k=0;for(f=2;e<=g;){for(n=0;n<b;++n)if(a[n]===e){l=0;m=k;for(p=0;p<e;++p)l=l<<1|m&1,m>>=1;for(p=l;p<d;p+=f)h[p]=e<<16|n;++k}++e;k<<=
1;f<<=1}return[h,g,c]}function e(b,g){this.l=[];this.m=32768;this.d=this.f=this.c=this.t=0;this.input=u?new Uint8Array(b):b;this.u=!1;this.n=D;this.K=!1;if(g||!(g={}))g.index&&(this.c=g.index),g.bufferSize&&(this.m=g.bufferSize),g.bufferType&&(this.n=g.bufferType),g.resize&&(this.K=g.resize);switch(this.n){case A:this.a=32768;this.b=new (u?Uint8Array:Array)(32768+this.m+258);break;case D:this.a=0;this.b=new (u?Uint8Array:Array)(this.m);this.e=this.W;this.B=this.R;this.q=this.V;break;default:a(Error("invalid inflate mode"))}}
function d(b,g){for(var c=b.f,d=b.d,h=b.input,e=b.c,k;d<g;)k=h[e++],k===q&&a(Error("input buffer is broken")),c|=k<<d,d+=8;b.f=c>>>g;b.d=d-g;b.c=e;return c&(1<<g)-1}function f(a,b){for(var g=a.f,c=a.d,d=a.input,h=a.c,e=b[0],k=b[1],f;c<k;){f=d[h++];if(f===q)break;g|=f<<c;c+=8}d=e[g&(1<<k)-1];e=d>>>16;a.f=g>>e;a.d=c-e;a.c=h;return d&65535}function g(a){function b(a,g,c){var h,e,k,l;for(l=0;l<a;)switch(h=f(this,g),h){case 16:for(k=3+d(this,2);k--;)c[l++]=e;break;case 17:for(k=3+d(this,3);k--;)c[l++]=
0;e=0;break;case 18:for(k=11+d(this,7);k--;)c[l++]=0;e=0;break;default:e=c[l++]=h}return c}var g=d(a,5)+257,h=d(a,5)+1,e=d(a,4)+4,k=new (u?Uint8Array:Array)(W.length),l;for(l=0;l<e;++l)k[W[l]]=d(a,3);e=c(k);k=new (u?Uint8Array:Array)(g);l=new (u?Uint8Array:Array)(h);a.q(c(b.call(a,g,e,k)),c(b.call(a,h,e,l)))}function h(a){a=a||{};this.files=[];this.v=a.comment}function k(a,b){b=b||{};this.input=u&&a instanceof Array?new Uint8Array(a):a;this.c=0;this.ba=b.verify||!1;this.j=b.password}function l(a,
b){this.input=a;this.offset=b}function m(a,b){this.input=a;this.offset=b}function n(b){var g=[],c={},d,h,e,k;if(!b.i){if(b.o===q){d=b.input;if(!b.D)a:{h=b.input;for(e=h.length-12;0<e;--e)if(h[e]===Q[0]&&h[e+1]===Q[1]&&h[e+2]===Q[2]&&h[e+3]===Q[3]){b.D=e;break a}a(Error("End of Central Directory Record not found"))}h=b.D;d[h++]===Q[0]&&d[h++]===Q[1]&&d[h++]===Q[2]&&d[h++]===Q[3]||a(Error("invalid signature"));b.ha=d[h++]|d[h++]<<8;b.ja=d[h++]|d[h++]<<8;b.ka=d[h++]|d[h++]<<8;b.aa=d[h++]|d[h++]<<8;b.Q=
(d[h++]|d[h++]<<8|d[h++]<<16|d[h++]<<24)>>>0;b.o=(d[h++]|d[h++]<<8|d[h++]<<16|d[h++]<<24)>>>0;b.w=d[h++]|d[h++]<<8;b.v=u?d.subarray(h,h+b.w):d.slice(h,h+b.w)}d=b.o;e=0;for(k=b.aa;e<k;++e)h=new l(b.input,d),h.parse(),d+=h.length,g[e]=h,c[h.filename]=e;b.Q<d-b.o&&a(Error("invalid file header size"));b.i=g;b.G=c}}function p(a,b,g){g^=a.s(b);a.k(b,g);return g}var q=void 0,s,t=this,u="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (u?Uint8Array:Array)(256);
for(s=0;256>s;++s)for(var v=s,w=7,v=v>>>1;v;v>>>=1)--w;s=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,
3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,
314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,
3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,
1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,
1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var B=u?new Uint32Array(s):s;s=[];for(v=0;288>v;v++)switch(!0){case 143>=v:s.push([v+48,8]);break;case 255>=v:s.push([v-144+400,9]);break;case 279>=v:s.push([v-256+0,7]);break;case 287>=v:s.push([v-280+192,8]);break;default:a("invalid literal: "+
v)}s=function(){function b(g){switch(!0){case 3===g:return[257,g-3,0];case 4===g:return[258,g-4,0];case 5===g:return[259,g-5,0];case 6===g:return[260,g-6,0];case 7===g:return[261,g-7,0];case 8===g:return[262,g-8,0];case 9===g:return[263,g-9,0];case 10===g:return[264,g-10,0];case 12>=g:return[265,g-11,1];case 14>=g:return[266,g-13,1];case 16>=g:return[267,g-15,1];case 18>=g:return[268,g-17,1];case 22>=g:return[269,g-19,2];case 26>=g:return[270,g-23,2];case 30>=g:return[271,g-27,2];case 34>=g:return[272,
g-31,2];case 42>=g:return[273,g-35,3];case 50>=g:return[274,g-43,3];case 58>=g:return[275,g-51,3];case 66>=g:return[276,g-59,3];case 82>=g:return[277,g-67,4];case 98>=g:return[278,g-83,4];case 114>=g:return[279,g-99,4];case 130>=g:return[280,g-115,4];case 162>=g:return[281,g-131,5];case 194>=g:return[282,g-163,5];case 226>=g:return[283,g-195,5];case 257>=g:return[284,g-227,5];case 258===g:return[285,g-258,0];default:a("invalid length: "+g)}}var g=[],c,d;for(c=3;258>=c;c++)d=b(c),g[c]=d[2]<<24|d[1]<<
16|d[0];return g}();u&&new Uint32Array(s);var A=0,D=1;e.prototype.r=function(){for(;!this.u;){var b=d(this,3);b&1&&(this.u=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,h=this.b,e=this.a,k=q,f=q,l=q,m=h.length,k=q;this.d=this.f=0;k=b[c++];k===q&&a(Error("invalid uncompressed block header: LEN (first byte)"));f=k;k=b[c++];k===q&&a(Error("invalid uncompressed block header: LEN (second byte)"));f|=k<<8;k=b[c++];k===q&&a(Error("invalid uncompressed block header: NLEN (first byte)"));l=k;k=b[c++];
k===q&&a(Error("invalid uncompressed block header: NLEN (second byte)"));l|=k<<8;f===~l&&a(Error("invalid uncompressed block header: length verify"));c+f>b.length&&a(Error("input buffer is broken"));switch(this.n){case A:for(;e+f>h.length;){k=m-e;f-=k;if(u)h.set(b.subarray(c,c+k),e),e+=k,c+=k;else for(;k--;)h[e++]=b[c++];this.a=e;h=this.e();e=this.a}break;case D:for(;e+f>h.length;)h=this.e({H:2});break;default:a(Error("invalid inflate mode"))}if(u)h.set(b.subarray(c,c+f),e),e+=f,c+=f;else for(;f--;)h[e++]=
b[c++];this.c=c;this.a=e;this.b=h;break;case 1:this.q(N,z);break;case 2:g(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.B()};s=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var W=u?new Uint16Array(s):s;s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var C=u?new Uint16Array(s):s;s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var P=u?new Uint8Array(s):s;s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,
769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var G=u?new Uint16Array(s):s;s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var F=u?new Uint8Array(s):s;s=new (u?Uint8Array:Array)(288);v=0;for(w=s.length;v<w;++v)s[v]=143>=v?8:255>=v?9:279>=v?7:8;var N=c(s);s=new (u?Uint8Array:Array)(30);v=0;for(w=s.length;v<w;++v)s[v]=5;var z=c(s);s=e.prototype;s.q=function(a,b){var g=this.b,c=this.a;this.C=a;for(var h=g.length-258,e,k,l;256!==(e=f(this,a));)if(256>e)c>=h&&(this.a=
c,g=this.e(),c=this.a),g[c++]=e;else for(e-=257,l=C[e],0<P[e]&&(l+=d(this,P[e])),e=f(this,b),k=G[e],0<F[e]&&(k+=d(this,F[e])),c>=h&&(this.a=c,g=this.e(),c=this.a);l--;)g[c]=g[c++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=c};s.V=function(a,b){var g=this.b,c=this.a;this.C=a;for(var h=g.length,e,k,l;256!==(e=f(this,a));)if(256>e)c>=h&&(g=this.e(),h=g.length),g[c++]=e;else for(e-=257,l=C[e],0<P[e]&&(l+=d(this,P[e])),e=f(this,b),k=G[e],0<F[e]&&(k+=d(this,F[e])),c+l>h&&(g=this.e(),h=g.length);l--;)g[c]=
g[c++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=c};s.e=function(){var a=new (u?Uint8Array:Array)(this.a-32768),b=this.a-32768,g,c,d=this.b;if(u)a.set(d.subarray(32768,a.length));else for(g=0,c=a.length;g<c;++g)a[g]=d[g+32768];this.l.push(a);this.t+=a.length;if(u)d.set(d.subarray(b,b+32768));else for(g=0;32768>g;++g)d[g]=d[b+g];this.a=32768;return d};s.W=function(a){var b,g=this.input.length/this.c+1|0,c,d,h,e=this.input,k=this.b;a&&("number"===typeof a.H&&(g=a.H),"number"===typeof a.P&&(g+=a.P));
2>g?(c=(e.length-this.c)/this.C[2],h=c/2*258|0,d=h<k.length?k.length+h:k.length<<1):d=k.length*g;u?(b=new Uint8Array(d),b.set(k)):b=k;return this.b=b};s.B=function(){var a=0,b=this.b,g=this.l,c,d=new (u?Uint8Array:Array)(this.t+(this.a-32768)),h,e,k,f;if(0===g.length)return u?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);h=0;for(e=g.length;h<e;++h)for(c=g[h],k=0,f=c.length;k<f;++k)d[a++]=c[k];h=32768;for(e=this.a;h<e;++h)d[a++]=b[h];this.l=[];return this.buffer=d};s.R=function(){var a,
b=this.a;u?this.K?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};h.prototype.L=function(a){this.j=a};h.prototype.s=function(a){a=a[2]&65535|2;return a*(a^1)>>8&255};h.prototype.k=function(a,b){a[0]=(B[(a[0]^b)&255]^a[0]>>>8)>>>0;a[1]=(6681*(20173*(a[1]+(a[0]&255))>>>0)>>>0)+1>>>0;a[2]=(B[(a[2]^a[1]>>>24)&255]^a[2]>>>8)>>>0};h.prototype.T=function(a){var b=[305419896,591751049,878082192],g,c;u&&(b=new Uint32Array(b));
g=0;for(c=a.length;g<c;++g)this.k(b,a[g]&255);return b};var M=[80,75,1,2],H=[80,75,3,4],Q=[80,75,5,6];l.prototype.parse=function(){var b=this.input,g=this.offset;b[g++]===M[0]&&b[g++]===M[1]&&b[g++]===M[2]&&b[g++]===M[3]||a(Error("invalid file header signature"));this.version=b[g++];this.ia=b[g++];this.Z=b[g++]|b[g++]<<8;this.I=b[g++]|b[g++]<<8;this.A=b[g++]|b[g++]<<8;this.time=b[g++]|b[g++]<<8;this.U=b[g++]|b[g++]<<8;this.p=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.z=(b[g++]|b[g++]<<8|b[g++]<<
16|b[g++]<<24)>>>0;this.J=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.h=b[g++]|b[g++]<<8;this.g=b[g++]|b[g++]<<8;this.F=b[g++]|b[g++]<<8;this.ea=b[g++]|b[g++]<<8;this.ga=b[g++]|b[g++]<<8;this.fa=b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24;this.$=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.filename=String.fromCharCode.apply(null,u?b.subarray(g,g+=this.h):b.slice(g,g+=this.h));this.X=u?b.subarray(g,g+=this.g):b.slice(g,g+=this.g);this.v=u?b.subarray(g,g+this.F):b.slice(g,g+this.F);this.length=
g-this.offset};m.prototype.parse=function(){var b=this.input,g=this.offset;b[g++]===H[0]&&b[g++]===H[1]&&b[g++]===H[2]&&b[g++]===H[3]||a(Error("invalid local file header signature"));this.Z=b[g++]|b[g++]<<8;this.I=b[g++]|b[g++]<<8;this.A=b[g++]|b[g++]<<8;this.time=b[g++]|b[g++]<<8;this.U=b[g++]|b[g++]<<8;this.p=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.z=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.J=(b[g++]|b[g++]<<8|b[g++]<<16|b[g++]<<24)>>>0;this.h=b[g++]|b[g++]<<8;this.g=b[g++]|b[g++]<<
8;this.filename=String.fromCharCode.apply(null,u?b.subarray(g,g+=this.h):b.slice(g,g+=this.h));this.X=u?b.subarray(g,g+=this.g):b.slice(g,g+=this.g);this.length=g-this.offset};s=k.prototype;s.Y=function(){var a=[],b,g,c;this.i||n(this);c=this.i;b=0;for(g=c.length;b<g;++b)a[b]=c[b].filename;return a};s.r=function(b,g){var c;this.G||n(this);c=this.G[b];c===q&&a(Error(b+" not found"));var d;d=g||{};var h=this.input,k=this.i,f,l,s,t;k||n(this);k[c]===q&&a(Error("wrong index"));k=k[c].$;c=new m(this.input,
k);c.parse();k+=c.length;f=c.z;if(0!==(c.I&1)){d.password||this.j||a(Error("please set password"));d=this.S(d.password||this.j);s=k;for(t=k+12;s<t;++s)p(this,d,h[s]);k+=12;f-=12;s=k;for(t=k+f;s<t;++s)h[s]=p(this,d,h[s])}switch(c.A){case 0:l=u?this.input.subarray(k,k+f):this.input.slice(k,k+f);break;case 8:l=(new e(this.input,{index:k,bufferSize:c.J})).r();break;default:a(Error("unknown compression type"))}if(this.ba){h=q;f="number"===typeof h?h:h=0;d=l.length;k=-1;for(f=d&7;f--;++h)k=k>>>8^B[(k^l[h])&
255];for(f=d>>3;f--;h+=8)k=k>>>8^B[(k^l[h])&255],k=k>>>8^B[(k^l[h+1])&255],k=k>>>8^B[(k^l[h+2])&255],k=k>>>8^B[(k^l[h+3])&255],k=k>>>8^B[(k^l[h+4])&255],k=k>>>8^B[(k^l[h+5])&255],k=k>>>8^B[(k^l[h+6])&255],k=k>>>8^B[(k^l[h+7])&255];h=(k^4294967295)>>>0;c.p!==h&&a(Error("wrong crc: file=0x"+c.p.toString(16)+", data=0x"+h.toString(16)))}return l};s.L=function(a){this.j=a};s.k=h.prototype.k;s.S=h.prototype.T;s.s=h.prototype.s;b("Zlib.Unzip",k);b("Zlib.Unzip.prototype.decompress",k.prototype.r);b("Zlib.Unzip.prototype.getFilenames",
k.prototype.Y);b("Zlib.Unzip.prototype.setPassword",k.prototype.L)}).call(this);/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
(function(){function a(a){throw a;}function b(a,b){var g=a.split("."),c=n;g[0]in c||!c.execScript||c.execScript("var "+g[0]);for(var d;g.length&&(d=g.shift());)g.length||b===m?c=c[d]?c[d]:c[d]={}:c[d]=b}function c(a,b,g){var c="number"===typeof b?b:b=0,d="number"===typeof g?g:a.length;g=-1;for(c=d&7;c--;++b)g=g>>>8^u[(g^a[b])&255];for(c=d>>3;c--;b+=8)g=g>>>8^u[(g^a[b])&255],g=g>>>8^u[(g^a[b+1])&255],g=g>>>8^u[(g^a[b+2])&255],g=g>>>8^u[(g^a[b+3])&255],g=g>>>8^u[(g^a[b+4])&255],g=g>>>8^u[(g^a[b+5])&
255],g=g>>>8^u[(g^a[b+6])&255],g=g>>>8^u[(g^a[b+7])&255];return(g^4294967295)>>>0}function e(){}function d(a){var b=a.length,g=0,c=Number.POSITIVE_INFINITY,d,h,e,k,f,l,m,n,q;for(n=0;n<b;++n)a[n]>g&&(g=a[n]),a[n]<c&&(c=a[n]);d=1<<g;h=new (p?Uint32Array:Array)(d);e=1;k=0;for(f=2;e<=g;){for(n=0;n<b;++n)if(a[n]===e){l=0;m=k;for(q=0;q<e;++q)l=l<<1|m&1,m>>=1;for(q=l;q<d;q+=f)h[q]=e<<16|n;++k}++e;k<<=1;f<<=1}return[h,g,c]}function f(b,g){this.i=[];this.j=32768;this.d=this.f=this.c=this.n=0;this.input=p?
new Uint8Array(b):b;this.o=!1;this.k=w;this.w=!1;if(g||!(g={}))g.index&&(this.c=g.index),g.bufferSize&&(this.j=g.bufferSize),g.bufferType&&(this.k=g.bufferType),g.resize&&(this.w=g.resize);switch(this.k){case v:this.a=32768;this.b=new (p?Uint8Array:Array)(32768+this.j+258);break;case w:this.a=0;this.b=new (p?Uint8Array:Array)(this.j);this.e=this.D;this.q=this.A;this.l=this.C;break;default:a(Error("invalid inflate mode"))}}function g(b,g){for(var c=b.f,d=b.d,h=b.input,e=b.c,k;d<g;)k=h[e++],k===m&&
a(Error("input buffer is broken")),c|=k<<d,d+=8;b.f=c>>>g;b.d=d-g;b.c=e;return c&(1<<g)-1}function h(a,b){for(var g=a.f,c=a.d,d=a.input,h=a.c,e=b[0],k=b[1],f;c<k;){f=d[h++];if(f===m)break;g|=f<<c;c+=8}d=e[g&(1<<k)-1];e=d>>>16;a.f=g>>e;a.d=c-e;a.c=h;return d&65535}function k(a){function b(a,c,d){var e,k,f,l;for(l=0;l<a;)switch(e=h(this,c),e){case 16:for(f=3+g(this,2);f--;)d[l++]=k;break;case 17:for(f=3+g(this,3);f--;)d[l++]=0;k=0;break;case 18:for(f=11+g(this,7);f--;)d[l++]=0;k=0;break;default:k=d[l++]=
e}return d}var c=g(a,5)+257,e=g(a,5)+1,k=g(a,4)+4,f=new (p?Uint8Array:Array)(B.length),l;for(l=0;l<k;++l)f[B[l]]=g(a,3);k=d(f);f=new (p?Uint8Array:Array)(c);l=new (p?Uint8Array:Array)(e);a.l(d(b.call(a,c,k,f)),d(b.call(a,e,k,l)))}function l(a){this.input=a;this.c=0;this.m=[];this.s=!1}var m=void 0,n=this,p="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (p?Uint8Array:Array)(256);var q;for(q=0;256>q;++q)for(var s=q,t=7,s=s>>>1;s;s>>>=1)--t;q=
[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,
651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,
4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,
167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,
3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,
2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var u=p?new Uint32Array(q):q;e.prototype.getName=function(){return this.name};e.prototype.getData=function(){return this.data};e.prototype.G=function(){return this.H};b("Zlib.GunzipMember",e);b("Zlib.GunzipMember.prototype.getName",e.prototype.getName);b("Zlib.GunzipMember.prototype.getData",
e.prototype.getData);b("Zlib.GunzipMember.prototype.getMtime",e.prototype.G);q=[];for(s=0;288>s;s++)switch(!0){case 143>=s:q.push([s+48,8]);break;case 255>=s:q.push([s-144+400,9]);break;case 279>=s:q.push([s-256+0,7]);break;case 287>=s:q.push([s-280+192,8]);break;default:a("invalid literal: "+s)}q=function(){function b(g){switch(!0){case 3===g:return[257,g-3,0];case 4===g:return[258,g-4,0];case 5===g:return[259,g-5,0];case 6===g:return[260,g-6,0];case 7===g:return[261,g-7,0];case 8===g:return[262,
g-8,0];case 9===g:return[263,g-9,0];case 10===g:return[264,g-10,0];case 12>=g:return[265,g-11,1];case 14>=g:return[266,g-13,1];case 16>=g:return[267,g-15,1];case 18>=g:return[268,g-17,1];case 22>=g:return[269,g-19,2];case 26>=g:return[270,g-23,2];case 30>=g:return[271,g-27,2];case 34>=g:return[272,g-31,2];case 42>=g:return[273,g-35,3];case 50>=g:return[274,g-43,3];case 58>=g:return[275,g-51,3];case 66>=g:return[276,g-59,3];case 82>=g:return[277,g-67,4];case 98>=g:return[278,g-83,4];case 114>=g:return[279,
g-99,4];case 130>=g:return[280,g-115,4];case 162>=g:return[281,g-131,5];case 194>=g:return[282,g-163,5];case 226>=g:return[283,g-195,5];case 257>=g:return[284,g-227,5];case 258===g:return[285,g-258,0];default:a("invalid length: "+g)}}var g=[],c,d;for(c=3;258>=c;c++)d=b(c),g[c]=d[2]<<24|d[1]<<16|d[0];return g}();p&&new Uint32Array(q);var v=0,w=1;f.prototype.g=function(){for(;!this.o;){var b=g(this,3);b&1&&(this.o=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,h=this.a,e=m,f=m,l=m,n=
d.length,e=m;this.d=this.f=0;e=b[c++];e===m&&a(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=b[c++];e===m&&a(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=b[c++];e===m&&a(Error("invalid uncompressed block header: NLEN (first byte)"));l=e;e=b[c++];e===m&&a(Error("invalid uncompressed block header: NLEN (second byte)"));l|=e<<8;f===~l&&a(Error("invalid uncompressed block header: length verify"));c+f>b.length&&a(Error("input buffer is broken"));switch(this.k){case v:for(;h+
f>d.length;){e=n-h;f-=e;if(p)d.set(b.subarray(c,c+e),h),h+=e,c+=e;else for(;e--;)d[h++]=b[c++];this.a=h;d=this.e();h=this.a}break;case w:for(;h+f>d.length;)d=this.e({t:2});break;default:a(Error("invalid inflate mode"))}if(p)d.set(b.subarray(c,c+f),h),h+=f,c+=f;else for(;f--;)d[h++]=b[c++];this.c=c;this.a=h;this.b=d;break;case 1:this.l(P,G);break;case 2:k(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.q()};q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var B=p?new Uint16Array(q):
q;q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var A=p?new Uint16Array(q):q;q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var D=p?new Uint8Array(q):q;q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var W=p?new Uint16Array(q):q;q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var C=p?new Uint8Array(q):q;q=new (p?Uint8Array:Array)(288);s=
0;for(t=q.length;s<t;++s)q[s]=143>=s?8:255>=s?9:279>=s?7:8;var P=d(q);q=new (p?Uint8Array:Array)(30);s=0;for(t=q.length;s<t;++s)q[s]=5;var G=d(q);f.prototype.l=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length-258,k,f,l;256!==(k=h(this,a));)if(256>k)d>=e&&(this.a=d,c=this.e(),d=this.a),c[d++]=k;else for(k-=257,l=A[k],0<D[k]&&(l+=g(this,D[k])),k=h(this,b),f=W[k],0<C[k]&&(f+=g(this,C[k])),d>=e&&(this.a=d,c=this.e(),d=this.a);l--;)c[d]=c[d++-f];for(;8<=this.d;)this.d-=8,this.c--;this.a=
d};f.prototype.C=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length,k,f,l;256!==(k=h(this,a));)if(256>k)d>=e&&(c=this.e(),e=c.length),c[d++]=k;else for(k-=257,l=A[k],0<D[k]&&(l+=g(this,D[k])),k=h(this,b),f=W[k],0<C[k]&&(f+=g(this,C[k])),d+l>e&&(c=this.e(),e=c.length);l--;)c[d]=c[d++-f];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};f.prototype.e=function(){var a=new (p?Uint8Array:Array)(this.a-32768),b=this.a-32768,g,c,d=this.b;if(p)a.set(d.subarray(32768,a.length));else for(g=0,c=a.length;g<
c;++g)a[g]=d[g+32768];this.i.push(a);this.n+=a.length;if(p)d.set(d.subarray(b,b+32768));else for(g=0;32768>g;++g)d[g]=d[b+g];this.a=32768;return d};f.prototype.D=function(a){var b,g=this.input.length/this.c+1|0,c,d,h,e=this.input,k=this.b;a&&("number"===typeof a.t&&(g=a.t),"number"===typeof a.z&&(g+=a.z));2>g?(c=(e.length-this.c)/this.r[2],h=c/2*258|0,d=h<k.length?k.length+h:k.length<<1):d=k.length*g;p?(b=new Uint8Array(d),b.set(k)):b=k;return this.b=b};f.prototype.q=function(){var a=0,b=this.b,g=
this.i,c,d=new (p?Uint8Array:Array)(this.n+(this.a-32768)),h,e,k,f;if(0===g.length)return p?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);h=0;for(e=g.length;h<e;++h)for(c=g[h],k=0,f=c.length;k<f;++k)d[a++]=c[k];h=32768;for(e=this.a;h<e;++h)d[a++]=b[h];this.i=[];return this.buffer=d};f.prototype.A=function(){var a,b=this.a;p?this.w?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};l.prototype.F=function(){this.s||
this.g();return this.m.slice()};l.prototype.g=function(){for(var b=this.input.length;this.c<b;){var g=new e,d=m,h=m,k=m,l=d=k=m,n=m,d=d=m,q=this.input,h=this.c;g.u=q[h++];g.v=q[h++];31===g.u&&139===g.v||a(Error("invalid file signature:"+g.u+","+g.v));g.p=q[h++];switch(g.p){case 8:break;default:a(Error("unknown compression method: "+g.p))}g.h=q[h++];d=q[h++]|q[h++]<<8|q[h++]<<16|q[h++]<<24;g.H=new Date(1E3*d);g.N=q[h++];g.M=q[h++];0<(g.h&4)&&(g.I=q[h++]|q[h++]<<8,h+=g.I);if(0<(g.h&8)){n=[];for(l=0;0<
(d=q[h++]);)n[l++]=String.fromCharCode(d);g.name=n.join("")}if(0<(g.h&16)){n=[];for(l=0;0<(d=q[h++]);)n[l++]=String.fromCharCode(d);g.J=n.join("")}0<(g.h&2)&&(g.B=c(q,0,h)&65535,g.B!==(q[h++]|q[h++]<<8)&&a(Error("invalid header crc16")));d=q[q.length-4]|q[q.length-3]<<8|q[q.length-2]<<16|q[q.length-1]<<24;q.length-h-4-4<512*d&&(k=d);h=new f(q,{index:h,bufferSize:k});g.data=k=h.g();h=h.c;g.K=d=(q[h++]|q[h++]<<8|q[h++]<<16|q[h++]<<24)>>>0;c(k,m,m)!==d&&a(Error("invalid CRC-32 checksum: 0x"+c(k,m,m).toString(16)+
" / 0x"+d.toString(16)));g.L=d=(q[h++]|q[h++]<<8|q[h++]<<16|q[h++]<<24)>>>0;(k.length&4294967295)!==d&&a(Error("invalid input size: "+(k.length&4294967295)+" / "+d));this.m.push(g);this.c=h}this.s=!0;b=this.m;g=k=h=0;for(q=b.length;g<q;++g)k+=b[g].data.length;if(p)for(k=new Uint8Array(k),g=0;g<q;++g)k.set(b[g].data,h),h+=b[g].data.length;else{k=[];for(g=0;g<q;++g)k[g]=b[g].data;k=Array.prototype.concat.apply([],k)}return k};b("Zlib.Gunzip",l);b("Zlib.Gunzip.prototype.decompress",l.prototype.g);b("Zlib.Gunzip.prototype.getMembers",
l.prototype.F)}).call(this);"undefined"!==typeof window&&!function(a,b,c){var e=a.L,d={version:"0.7.2",noConflict:function(){return a.L=e,this}};a.L=d;d.Util={extend:function(a){var b,c,d,e,f=Array.prototype.slice.call(arguments,1);c=0;for(d=f.length;d>c;c++)for(b in e=f[c]||{},e)e.hasOwnProperty(b)&&(a[b]=e[b]);return a},bind:function(a,b){var c=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,c||arguments)}},stamp:function(){var a=0;return function(b){return b._leaflet_id=
b._leaflet_id||++a,b._leaflet_id}}(),invokeEach:function(a,b,c){var d,e;if("object"==typeof a){e=Array.prototype.slice.call(arguments,3);for(d in a)b.apply(c,[d,a[d]].concat(e));return!0}return!1},limitExecByInterval:function(a,b,c){var d,e;return function p(){var f=arguments;return d?void(e=!0):(d=!0,setTimeout(function(){d=!1;e&&(p.apply(c,f),e=!1)},b),void a.apply(c,f))}},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?
a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return d.Util.trim(a).split(/\s+/)},setOptions:function(a,b){return a.options=d.extend({},a.options,b),a.options},getParamString:function(a,b,c){var d=[],e;for(e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,g){var d=b[g];if(d===c)throw Error("No value provided for variable "+a);return"function"==
typeof d&&(d=d(b)),d})},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};(function(){function b(g){var c,d,h=["webkit","moz","o","ms"];for(c=0;c<h.length&&!d;c++)d=a[h[c]+g];return d}function c(b){var g=+new Date,d=Math.max(0,16-(g-e));return e=g+d,a.setTimeout(b,d)}var e=0,f=a.requestAnimationFrame||b("RequestAnimationFrame")||c,m=a.cancelAnimationFrame||b("CancelAnimationFrame")||
b("CancelRequestAnimationFrame")||function(b){a.clearTimeout(b)};d.Util.requestAnimFrame=function(b,g,e,k){return b=d.bind(b,g),e&&f===c?void b():f.call(a,b,k)};d.Util.cancelAnimFrame=function(b){b&&m.call(a,b)}})();d.extend=d.Util.extend;d.bind=d.Util.bind;d.stamp=d.Util.stamp;d.setOptions=d.Util.setOptions;d.Class=function(){};d.Class.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments);this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;
var e=new c;e.constructor=b;b.prototype=e;for(var f in this)this.hasOwnProperty(f)&&"prototype"!==f&&(b[f]=this[f]);a.statics&&(d.extend(b,a.statics),delete a.statics);a.includes&&(d.Util.extend.apply(null,[e].concat(a.includes)),delete a.includes);a.options&&e.options&&(a.options=d.extend({},e.options,a.options));d.extend(e,a);e._initHooks=[];var n=this;return b.__super__=n.prototype,e.callInitHooks=function(){if(!this._initHooksCalled){n.prototype.callInitHooks&&n.prototype.callInitHooks.call(this);
this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;b>a;a++)e._initHooks[a].call(this)}},b};d.Class.include=function(a){d.extend(this.prototype,a)};d.Class.mergeOptions=function(a){d.extend(this.prototype.options,a)};d.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"==typeof a?a:function(){this[a].apply(this,b)})};d.Mixin={};d.Mixin.Events={addEventListener:function(a,
b,c){if(d.Util.invokeEach(a,this.addEventListener,this,b,c))return this;var e,f,n,p,q,s,t,u=this._leaflet_events=this._leaflet_events||{},v=c&&c!==this&&d.stamp(c);a=d.Util.splitWords(a);e=0;for(f=a.length;f>e;e++)n={action:b,context:c||this},p=a[e],v?(q=p+"_idx",s=q+"_len",t=u[q]=u[q]||{},t[v]||(t[v]=[],u[s]=(u[s]||0)+1),t[v].push(n)):(u[p]=u[p]||[],u[p].push(n));return this},hasEventListeners:function(a){var b=this._leaflet_events;return!!b&&(a in b&&0<b[a].length||a+"_idx"in b&&0<b[a+"_idx_len"])},
removeEventListener:function(a,b,c){if(!this._leaflet_events)return this;if(!a)return this.clearAllEventListeners();if(d.Util.invokeEach(a,this.removeEventListener,this,b,c))return this;var e,f,n,p,q,s,t,u,v,w=this._leaflet_events,B=c&&c!==this&&d.stamp(c);a=d.Util.splitWords(a);e=0;for(f=a.length;f>e;e++)if(n=a[e],s=n+"_idx",t=s+"_len",u=w[s],b){if(p=B&&u?u[B]:w[n]){for(q=p.length-1;0<=q;q--)p[q].action!==b||c&&p[q].context!==c||(v=p.splice(q,1),v[0].action=d.Util.falseFn);c&&u&&0===p.length&&(delete u[B],
w[t]--)}}else delete w[n],delete w[s],delete w[t];return this},clearAllEventListeners:function(){return delete this._leaflet_events,this},fireEvent:function(a,b){if(!this.hasEventListeners(a))return this;var c,e,f,n,p,q=d.Util.extend({},b,{type:a,target:this});n=this._leaflet_events;if(n[a])for(c=n[a].slice(),e=0,f=c.length;f>e;e++)c[e].action.call(c[e].context,q);n=n[a+"_idx"];for(p in n)if(c=n[p].slice())for(e=0,f=c.length;f>e;e++)c[e].action.call(c[e].context,q);return this},addOneTimeEventListener:function(a,
b,c){if(d.Util.invokeEach(a,this.addOneTimeEventListener,this,b,c))return this;var e=d.bind(function(){this.removeEventListener(a,b,c).removeEventListener(a,e,c)},this);return this.addEventListener(a,b,c).addEventListener(a,e,c)}};d.Mixin.Events.on=d.Mixin.Events.addEventListener;d.Mixin.Events.off=d.Mixin.Events.removeEventListener;d.Mixin.Events.once=d.Mixin.Events.addOneTimeEventListener;d.Mixin.Events.fire=d.Mixin.Events.fireEvent;(function(){var g="ActiveXObject"in a,h=g&&!b.addEventListener,
e=navigator.userAgent.toLowerCase(),f=-1!==e.indexOf("webkit"),m=-1!==e.indexOf("chrome"),n=-1!==e.indexOf("phantom"),p=-1!==e.indexOf("android"),q=-1!==e.search("android [23]"),e=-1!==e.indexOf("gecko"),s=typeof orientation!=c+"",t=a.navigator&&a.navigator.msPointerEnabled&&a.navigator.msMaxTouchPoints&&!a.PointerEvent,u=a.PointerEvent&&a.navigator.pointerEnabled&&a.navigator.maxTouchPoints||t,v="devicePixelRatio"in a&&1<a.devicePixelRatio||"matchMedia"in a&&a.matchMedia("(min-resolution:144dpi)")&&
a.matchMedia("(min-resolution:144dpi)").matches,w=b.documentElement,B=g&&"transition"in w.style,A="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!q,D="MozPerspective"in w.style,W="OTransition"in w.style,C=!a.L_DISABLE_3D&&(B||A||D||W)&&!n,P;if(P=!a.L_NO_TOUCH){if(n=!n)u||"ontouchstart"in w?n=!0:(n=b.createElement("div"),w=!1,n=n.setAttribute?(n.setAttribute("ontouchstart","return;"),"function"==typeof n.ontouchstart&&(w=!0),n.removeAttribute("ontouchstart"),w):!1);P=n}d.Browser={ie:g,ielt9:h,
webkit:f,gecko:e&&!f&&!a.opera&&!g,android:p,android23:q,chrome:m,ie3d:B,webkit3d:A,gecko3d:D,opera3d:W,any3d:C,mobile:s,mobileWebkit:s&&f,mobileWebkit3d:s&&A,mobileOpera:s&&a.opera,touch:P,msPointer:t,pointer:u,retina:v}})();d.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};d.Point.prototype={clone:function(){return new d.Point(this.x,this.y)},add:function(a){return this.clone()._add(d.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(d.point(a))},
_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),
this.y=Math.floor(this.y),this},distanceTo:function(a){a=d.point(a);var b=a.x-this.x;a=a.y-this.y;return Math.sqrt(b*b+a*a)},equals:function(a){return a=d.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=d.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+d.Util.formatNum(this.x)+", "+d.Util.formatNum(this.y)+")"}};d.point=function(a,b,e){return a instanceof d.Point?a:d.Util.isArray(a)?new d.Point(a[0],a[1]):a===c||null===
a?a:new d.Point(a,b,e)};d.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])};d.Bounds.prototype={extend:function(a){return a=d.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new d.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new d.Point(this.min.x,
this.max.y)},getTopRight:function(){return new d.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof d.Point?d.point(a):d.bounds(a),a instanceof d.Bounds?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min;a=a.max;var f=a.y>=b.y&&e.y<=c.y;return a.x>=b.x&&e.x<=c.x&&f},isValid:function(){return!(!this.min||
!this.max)}};d.bounds=function(a,b){return!a||a instanceof d.Bounds?a:new d.Bounds(a,b)};d.Transformation=function(a,b,c,d){this._a=a;this._b=b;this._c=c;this._d=d};d.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new d.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}};d.DomUtil={get:function(a){return"string"==typeof a?
b.getElementById(a):a},getStyle:function(a,c){var d=a.style[c];(!d&&a.currentStyle&&(d=a.currentStyle[c]),d&&"auto"!==d||!b.defaultView)||(d=(d=b.defaultView.getComputedStyle(a,null))?d[c]:null);return"auto"===d?null:d},getViewportOffset:function(a){var c,e=0,f=0,m=a,n=b.body,p=b.documentElement;do{if(e+=m.offsetTop||0,f+=m.offsetLeft||0,e+=parseInt(d.DomUtil.getStyle(m,"borderTopWidth"),10)||0,f+=parseInt(d.DomUtil.getStyle(m,"borderLeftWidth"),10)||0,c=d.DomUtil.getStyle(m,"position"),m.offsetParent===
n&&"absolute"===c)break;if("fixed"===c){e+=n.scrollTop||p.scrollTop||0;f+=n.scrollLeft||p.scrollLeft||0;break}if("relative"===c&&!m.offsetLeft){c=d.DomUtil.getStyle(m,"width");var q=d.DomUtil.getStyle(m,"max-width"),s=m.getBoundingClientRect();"none"===c&&"none"===q||(f+=s.left+m.clientLeft);e+=s.top+(n.scrollTop||p.scrollTop||0);break}m=m.offsetParent}while(m);m=a;do{if(m===n)break;e-=m.scrollTop||0;f-=m.scrollLeft||0;m=m.parentNode}while(m);return new d.Point(f,e)},documentIsLtr:function(){return d.DomUtil._docIsLtrCached||
(d.DomUtil._docIsLtrCached=!0,d.DomUtil._docIsLtr="ltr"===d.DomUtil.getStyle(b.body,"direction")),d.DomUtil._docIsLtr},create:function(a,c,d){a=b.createElement(a);return a.className=c,d&&d.appendChild(a),a},hasClass:function(a,b){if(a.classList!==c)return a.classList.contains(b);var e=d.DomUtil._getClass(a);return 0<e.length&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(e)},addClass:function(a,b){if(a.classList!==c)for(var e=d.Util.splitWords(b),f=0,m=e.length;m>f;f++)a.classList.add(e[f]);else d.DomUtil.hasClass(a,
b)||(e=d.DomUtil._getClass(a),d.DomUtil._setClass(a,(e?e+" ":"")+b))},removeClass:function(a,b){a.classList!==c?a.classList.remove(b):d.DomUtil._setClass(a,d.Util.trim((" "+d.DomUtil._getClass(a)+" ").replace(" "+b+" "," ")))},_setClass:function(a,b){a.className.baseVal===c?a.className=b:a.className.baseVal=b},_getClass:function(a){return a.className.baseVal===c?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var c=!1;
try{c=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(d){if(1===b)return}b=Math.round(100*b);c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}},testProp:function(a){for(var c=b.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1},getTranslateString:function(a){var b=d.Browser.webkit3d;return"translate"+(b?"3d":"")+"("+a.x+"px,"+a.y+"px"+((b?",0":"")+")")},getScaleString:function(a,b){return d.DomUtil.getTranslateString(b.add(b.multiplyBy(-1*
a)))+(" scale("+a+") ")},setPosition:function(a,b,c){a._leaflet_pos=b;!c&&d.Browser.any3d?a.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos}};d.DomUtil.TRANSFORM=d.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);d.DomUtil.TRANSITION=d.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);d.DomUtil.TRANSITION_END=
"webkitTransition"===d.DomUtil.TRANSITION||"OTransition"===d.DomUtil.TRANSITION?d.DomUtil.TRANSITION+"End":"transitionend";(function(){if("onselectstart"in b)d.extend(d.DomUtil,{disableTextSelection:function(){d.DomEvent.on(a,"selectstart",d.DomEvent.preventDefault)},enableTextSelection:function(){d.DomEvent.off(a,"selectstart",d.DomEvent.preventDefault)}});else{var g=d.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);d.extend(d.DomUtil,{disableTextSelection:function(){if(g){var a=
b.documentElement.style;this._userSelect=a[g];a[g]="none"}},enableTextSelection:function(){g&&(b.documentElement.style[g]=this._userSelect,delete this._userSelect)}})}d.extend(d.DomUtil,{disableImageDrag:function(){d.DomEvent.on(a,"dragstart",d.DomEvent.preventDefault)},enableImageDrag:function(){d.DomEvent.off(a,"dragstart",d.DomEvent.preventDefault)}})})();d.LatLng=function(a,b,d){if(a=parseFloat(a),b=parseFloat(b),isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=
a;this.lng=b;d!==c&&(this.alt=parseFloat(d))};d.extend(d.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1E-9});d.LatLng.prototype={equals:function(a){if(!a)return!1;a=d.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=d.LatLng.MAX_MARGIN},toString:function(a){return"LatLng("+d.Util.formatNum(this.lat,a)+", "+d.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){a=d.latLng(a);var b=d.LatLng.DEG_TO_RAD,c=(a.lng-this.lng)*b,e=this.lat*b,f=a.lat*b;a=Math.sin((a.lat-
this.lat)*b/2);c=Math.sin(c/2);e=a*a+c*c*Math.cos(e)*Math.cos(f);return 12756274*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))},wrap:function(a,b){var c=this.lng;return a=a||-180,b=b||180,c=(c+b)%(b-a)+(a>c||c===b?b:a),new d.LatLng(this.lat,c)}};d.latLng=function(a,b){return a instanceof d.LatLng?a:d.Util.isArray(a)?"number"==typeof a[0]||"string"==typeof a[0]?new d.LatLng(a[0],a[1],a[2]):null:a===c||null===a?a:"object"==typeof a&&"lat"in a?new d.LatLng(a.lat,"lng"in a?a.lng:a.lon):b===c?null:new d.LatLng(a,
b)};d.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])};d.LatLngBounds.prototype={extend:function(a){if(!a)return this;var b=d.latLng(a);return a=null!==b?b:d.latLngBounds(a),a instanceof d.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):(this._southWest=
new d.LatLng(a.lat,a.lng),this._northEast=new d.LatLng(a.lat,a.lng)):a instanceof d.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast)),this},pad:function(a){var b=this._southWest,c=this._northEast,e=Math.abs(b.lat-c.lat)*a;a*=Math.abs(b.lng-c.lng);return new d.LatLngBounds(new d.LatLng(b.lat-e,b.lng-a),new d.LatLng(c.lat+e,c.lng+a))},getCenter:function(){return new d.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},
getNorthEast:function(){return this._northEast},getNorthWest:function(){return new d.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new d.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof d.LatLng?d.latLng(a):d.latLngBounds(a);var b,c,e=this._southWest,
f=this._northEast;return a instanceof d.LatLngBounds?(b=a.getSouthWest(),c=a.getNorthEast()):b=c=a,b.lat>=e.lat&&c.lat<=f.lat&&b.lng>=e.lng&&c.lng<=f.lng},intersects:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest();a=a.getNorthEast();var f=a.lng>=b.lng&&e.lng<=c.lng;return a.lat>=b.lat&&e.lat<=c.lat&&f},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){return a?(a=d.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&
this._northEast.equals(a.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}};d.latLngBounds=function(a,b){return!a||a instanceof d.LatLngBounds?a:new d.LatLngBounds(a,b)};d.Projection={};d.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var b=d.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,c=Math.max(Math.min(c,a.lat),-c);a=a.lng*b;b*=c;return b=Math.log(Math.tan(Math.PI/4+b/2)),new d.Point(a,b)},unproject:function(a){var b=d.LatLng.RAD_TO_DEG,
c=a.x*b;a=(2*Math.atan(Math.exp(a.y))-Math.PI/2)*b;return new d.LatLng(a,c)}};d.Projection.LonLat={project:function(a){return new d.Point(a.lng,a.lat)},unproject:function(a){return new d.LatLng(a.y,a.x)}};d.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),c=this.transformation.untransform(a,c);return this.projection.unproject(c)},project:function(a){return this.projection.project(a)},
scale:function(a){return 256*Math.pow(2,a)},getSize:function(a){a=this.scale(a);return d.point(a,a)}};d.CRS.Simple=d.extend({},d.CRS,{projection:d.Projection.LonLat,transformation:new d.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)}});d.CRS.EPSG3857=d.extend({},d.CRS,{code:"EPSG:3857",projection:d.Projection.SphericalMercator,transformation:new d.Transformation(0.5/Math.PI,0.5,-0.5/Math.PI,0.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}});d.CRS.EPSG900913=
d.extend({},d.CRS.EPSG3857,{code:"EPSG:900913"});d.CRS.EPSG4326=d.extend({},d.CRS,{code:"EPSG:4326",projection:d.Projection.LonLat,transformation:new d.Transformation(1/360,0.5,-1/360,0.5)});d.Map=d.Class.extend({includes:d.Mixin.Events,options:{crs:d.CRS.EPSG3857,fadeAnimation:d.DomUtil.TRANSITION&&!d.Browser.android23,trackResize:!0,markerZoomAnimation:d.DomUtil.TRANSITION&&d.Browser.any3d},initialize:function(a,b){b=d.setOptions(this,b);this._initContainer(a);this._initLayout();this._onResize=
d.bind(this._onResize,this);this._initEvents();b.maxBounds&&this.setMaxBounds(b.maxBounds);b.center&&b.zoom!==c&&this.setView(d.latLng(b.center),b.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(b.layers)},setView:function(a,b){return b=b===c?this.getZoom():b,this._resetView(d.latLng(a),this._limitZoom(b)),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=this._limitZoom(a),
this)},zoomIn:function(a,b){return this.setZoom(this._zoom+(a||1),b)},zoomOut:function(a,b){return this.setZoom(this._zoom-(a||1),b)},setZoomAround:function(a,b,c){var e=this.getZoomScale(b),f=this.getSize().divideBy(2);a=(a instanceof d.Point?a:this.latLngToContainerPoint(a)).subtract(f).multiplyBy(1-1/e);f=this.containerPointToLatLng(f.add(a));return this.setView(f,b,{zoom:c})},fitBounds:function(a,b){b=b||{};a=a.getBounds?a.getBounds():d.latLngBounds(a);var c=d.point(b.paddingTopLeft||b.padding||
[0,0]),e=d.point(b.paddingBottomRight||b.padding||[0,0]),f=this.getBoundsZoom(a,!1,c.add(e)),c=e.subtract(c).divideBy(2),e=this.project(a.getSouthWest(),f),n=this.project(a.getNorthEast(),f),c=this.unproject(e.add(n).divideBy(2).add(c),f);return f=b&&b.maxZoom?Math.min(b.maxZoom,f):f,this.setView(c,f,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){return this.fire("movestart"),this._rawPanBy(d.point(a)),
this.fire("move"),this.fire("moveend")},setMaxBounds:function(a){return a=d.latLngBounds(a),this.options.maxBounds=a,a?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(a,b){var c=this.getCenter(),d=this._limitCenter(c,this._zoom,a);return c.equals(d)?this:this.panTo(d,b)},addLayer:function(a){var b=d.stamp(a);return this._layers[b]?this:(this._layers[b]=a,!a.options||isNaN(a.options.maxZoom)&&
isNaN(a.options.minZoom)||(this._zoomBoundLayers[b]=a,this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&a instanceof d.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,a.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(a),this)},removeLayer:function(a){var b=d.stamp(a);return this._layers[b]?(this._loaded&&a.onRemove(this),delete this._layers[b],this._loaded&&this.fire("layerremove",{layer:a}),this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],
this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&a instanceof d.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,a.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(a){return a?d.stamp(a)in this._layers:!1},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},invalidateSize:function(a){if(!this._loaded)return this;a=d.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0;this._initialCenter=
null;var c=this.getSize(),e=b.divideBy(2).round(),f=c.divideBy(2).round(),e=e.subtract(f);return e.x||e.y?(a.animate&&a.pan?this.panBy(e):(a.pan&&this._rawPanBy(e),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},
remove:function(){this._loaded&&this.fire("unload");this._initEvents("off");try{delete this._container._leaflet}catch(a){this._container._leaflet=c}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),
a=this.unproject(a.getTopRight());return new d.LatLngBounds(b,a)},getMinZoom:function(){return this.options.minZoom===c?this._layersMinZoom===c?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===c?this._layersMaxZoom===c?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=d.latLngBounds(a);var e,f=this.getMinZoom()-(b?1:0),n=this.getMaxZoom(),p=this.getSize(),q=a.getNorthWest();a=a.getSouthEast();e=!0;c=d.point(c||[0,0]);do f++,
e=this.project(a,f).subtract(this.project(q,f)).add(c),e=b?e.x<p.x||e.y<p.y:p.contains(e);while(e&&n>=f);return e&&b?null:b?f:f-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new d.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var a=this._getTopLeftPoint();return new d.Bounds(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},
getContainer:function(){return this._container},getZoomScale:function(a){var b=this.options.crs;return b.scale(a)/b.scale(this._zoom)},getScaleZoom:function(a){return this._zoom+Math.log(a)/Math.LN2},project:function(a,b){return b=b===c?this._zoom:b,this.options.crs.latLngToPoint(d.latLng(a),b)},unproject:function(a,b){return b=b===c?this._zoom:b,this.options.crs.pointToLatLng(d.point(a),b)},layerPointToLatLng:function(a){a=d.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(d.latLng(a))._round()._subtract(this.getPixelOrigin())},
containerPointToLayerPoint:function(a){return d.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return d.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(d.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(d.latLng(a)))},mouseEventToContainerPoint:function(a){return d.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},
mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=d.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet)throw Error("Map container is already initialized.");a._leaflet=!0},_initLayout:function(){var a=this._container;d.DomUtil.addClass(a,"leaflet-container"+(d.Browser.touch?" leaflet-touch":"")+(d.Browser.retina?" leaflet-retina":"")+(d.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?
" leaflet-fade-anim":""));var b=d.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container);this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane);a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane);a.shadowPane=this._createPane("leaflet-shadow-pane");
a.overlayPane=this._createPane("leaflet-overlay-pane");a.markerPane=this._createPane("leaflet-marker-pane");a.popupPane=this._createPane("leaflet-popup-pane");this.options.markerZoomAnimation||(d.DomUtil.addClass(a.markerPane," leaflet-zoom-hide"),d.DomUtil.addClass(a.shadowPane," leaflet-zoom-hide"),d.DomUtil.addClass(a.popupPane," leaflet-zoom-hide"))},_createPane:function(a,b){return d.DomUtil.create("div",a,b||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},
_addLayers:function(a){a=a?d.Util.isArray(a)?a:[a]:[];for(var b=0,c=a.length;c>b;b++)this.addLayer(a[b])},_resetView:function(a,b,c,e){var f=this._zoom!==b;e||(this.fire("movestart"),f&&this.fire("zoomstart"));this._zoom=b;this._initialCenter=a;this._initialTopLeftPoint=this._getNewTopLeftPoint(a);c?this._initialTopLeftPoint._add(this._getMapPanePos()):d.DomUtil.setPosition(this._mapPane,new d.Point(0,0));this._tileLayersToLoad=this._tileLayersNum;a=!this._loaded;this._loaded=!0;a&&(this.fire("load"),
this.eachLayer(this._layerAdd,this));this.fire("viewreset",{hard:!c});this.fire("move");(f||e)&&this.fire("zoomend");this.fire("moveend",{hard:!c})},_rawPanBy:function(a){d.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var a,b=1/0,d=-1/0,e=this._getZoomSpan();for(a in this._zoomBoundLayers){var f=this._zoomBoundLayers[a];isNaN(f.options.minZoom)||(b=Math.min(b,f.options.minZoom));
isNaN(f.options.maxZoom)||(d=Math.max(d,f.options.maxZoom))}a===c?this._layersMaxZoom=this._layersMinZoom=c:(this._layersMaxZoom=d,this._layersMinZoom=b);e!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(b){if(d.DomEvent){b=b||"on";d.DomEvent[b](this._container,"click",this._onMouseClick,this);var c,e,f="dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu".split(" ");
c=0;for(e=f.length;e>c;c++)d.DomEvent[b](this._container,f[c],this._fireMouseEvent,this);this.options.trackResize&&d.DomEvent[b](a,"resize",this._onResize,this)}},_onResize:function(){d.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=d.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(a){!this._loaded||!a._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||d.DomEvent._skipped(a)||
(this.fire("preclick"),this._fireMouseEvent(a))},_fireMouseEvent:function(a){if(this._loaded&&!d.DomEvent._skipped(a)){var b=a.type;if(b="mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,this.hasEventListeners(b)){"contextmenu"===b&&d.DomEvent.preventDefault(a);var c=this.mouseEventToContainerPoint(a),e=this.containerPointToLayerPoint(c),f=this.layerPointToLatLng(e);this.fire(b,{latlng:f,layerPoint:e,containerPoint:c,originalEvent:a})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--;
this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var a=0,b=this._handlers.length;b>a;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,this):this.on("load",a,b),this},_layerAdd:function(a){a.onAdd(this);this.fire("layeradd",{layer:a})},_getMapPanePos:function(){return d.DomUtil.getPosition(this._mapPane)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},
_getNewTopLeftPoint:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewTopLeftPoint(c,b).add(this._getMapPanePos());return this.project(a,b)._subtract(c)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;a=
this.project(a,b);var e=this.getSize().divideBy(2),e=new d.Bounds(a.subtract(e),a.add(e));c=this._getBoundsOffset(e,c,b);return this.unproject(a.add(c),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),c=new d.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(c,b))},_getBoundsOffset:function(a,b,c){var e=this.project(b.getNorthWest(),c).subtract(a.min);b=this.project(b.getSouthEast(),c).subtract(a.max);a=this._rebound(e.x,-b.x);e=this._rebound(e.y,-b.y);
return new d.Point(a,e)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}});d.map=function(a,b){return new d.Map(a,b)};d.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(a){var b=d.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,e=Math.max(Math.min(c,a.lat),-c),c=this.R_MAJOR;a=a.lng*b*c;var b=
e*b,e=this.R_MINOR/c,e=Math.sqrt(1-e*e),f=e*Math.sin(b),f=Math.pow((1-f)/(1+f),0.5*e),e=Math.tan(0.5*(0.5*Math.PI-b))/f;return b=-c*Math.log(e),new d.Point(a,b)},unproject:function(a){var b,c=d.LatLng.RAD_TO_DEG,e=this.R_MAJOR,f=a.x*c/e,n=this.R_MINOR/e,n=Math.sqrt(1-n*n);a=Math.exp(-a.y/e);var e=Math.PI/2-2*Math.atan(a),p=15;for(b=0.1;1E-7<Math.abs(b)&&0<--p;)b=n*Math.sin(e),b=Math.PI/2-2*Math.atan(a*Math.pow((1-b)/(1+b),0.5*n))-e,e+=b;return new d.LatLng(e*c,f)}};d.CRS.EPSG3395=d.extend({},d.CRS,
{code:"EPSG:3395",projection:d.Projection.Mercator,transformation:function(){var a=0.5/(Math.PI*d.Projection.Mercator.R_MAJOR);return new d.Transformation(a,0.5,-a,0.5)}()});d.TileLayer=d.Class.extend({includes:d.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:d.Browser.mobile,updateWhenIdle:d.Browser.mobile},initialize:function(a,b){b=d.setOptions(this,b);b.detectRetina&&d.Browser.retina&&0<b.maxZoom&&
(b.tileSize=Math.floor(b.tileSize/2),b.zoomOffset++,0<b.minZoom&&b.minZoom--,this.options.maxZoom--);b.bounds&&(b.bounds=d.latLngBounds(b.bounds));this._url=a;var c=this.options.subdomains;"string"==typeof c&&(this.options.subdomains=c.split(""))},onAdd:function(a){this._map=a;this._animated=a._zoomAnimated;this._initContainer();a.on({viewreset:this._reset,moveend:this._update},this);this._animated&&a.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||(this._limitedUpdate=
d.Util.limitExecByInterval(this._update,150,this),a.on("move",this._limitedUpdate,this));this._reset();this._update()},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this._container.parentNode.removeChild(this._container);a.off({viewreset:this._reset,moveend:this._update},this);this._animated&&a.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||a.off("move",this._limitedUpdate,this);this._map=this._container=null},bringToFront:function(){var a=
this._map._panes.tilePane;return this._container&&(a.appendChild(this._container),this._setAutoZIndex(a,Math.max)),this},bringToBack:function(){var a=this._map._panes.tilePane;return this._container&&(a.insertBefore(this._container,a.firstChild),this._setAutoZIndex(a,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=
a,this._updateZIndex(),this},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==c&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a,b){var c,d,e,f=a.children,p=-b(1/0,-1/0);d=0;for(e=f.length;e>d;d++)f[d]!==this._container&&(c=parseInt(f[d].style.zIndex,10),isNaN(c)||(p=b(p,c)));this.options.zIndex=this._container.style.zIndex=
(isFinite(p)?p:0)+b(1,-1)},_updateOpacity:function(){var a,b=this._tiles;if(d.Browser.ielt9)for(a in b)d.DomUtil.setOpacity(b[a],this.options.opacity);else d.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var a=this._map._panes.tilePane;this._container||((this._container=d.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated)?(this._bgBuffer=d.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=d.DomUtil.create("div",
"leaflet-tile-container",this._container)):this._tileContainer=this._container,a.appendChild(this._container),1>this.options.opacity&&this._updateOpacity())},_reset:function(a){for(var b in this._tiles)this.fire("tileunload",{tile:this._tiles[b]});this._tiles={};this._tilesToLoad=0;this.options.reuseTiles&&(this._unusedTiles=[]);this._tileContainer.innerHTML="";this._animated&&a&&a.hard&&this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var a=this._map,b=a.getZoom()+this.options.zoomOffset,
c=this.options.maxNativeZoom,d=this.options.tileSize;return c&&b>c&&(d=Math.round(a.getZoomScale(b)/a.getZoomScale(c)*d)),d},_update:function(){if(this._map){var a=this._map,b=a.getPixelBounds(),a=a.getZoom(),c=this._getTileSize();a>this.options.maxZoom||a<this.options.minZoom||(b=d.bounds(b.min.divideBy(c)._floor(),b.max.divideBy(c)._floor()),this._addTilesFromCenterOut(b),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(b))}},_addTilesFromCenterOut:function(a){var c,
e,f,m=[],n=a.getCenter();for(c=a.min.y;c<=a.max.y;c++)for(e=a.min.x;e<=a.max.x;e++)f=new d.Point(e,c),this._tileShouldBeLoaded(f)&&m.push(f);a=m.length;if(0!==a){m.sort(function(a,b){return a.distanceTo(n)-b.distanceTo(n)});c=b.createDocumentFragment();this._tilesToLoad||this.fire("loading");this._tilesToLoad+=a;for(e=0;a>e;e++)this._addTile(m[e],c);this._tileContainer.appendChild(c)}},_tileShouldBeLoaded:function(a){if(a.x+":"+a.y in this._tiles)return!1;var b=this.options;if(!b.continuousWorld){var c=
this._getWrapTileNum();if(b.noWrap&&(0>a.x||a.x>=c.x)||0>a.y||a.y>=c.y)return!1}return b.bounds&&(c=b.tileSize,a=a.multiplyBy(c),c=a.add([c,c]),a=this._map.unproject(a),c=this._map.unproject(c),b.continuousWorld||b.noWrap||(a=a.wrap(),c=c.wrap()),!b.bounds.intersects([a,c]))?!1:!0},_removeOtherTiles:function(a){var b,c,d;for(d in this._tiles)b=d.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),(c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&this._removeTile(d)},_removeTile:function(a){var b=this._tiles[a];
this.fire("tileunload",{tile:b,url:b.src});this.options.reuseTiles?(d.DomUtil.removeClass(b,"leaflet-tile-loaded"),this._unusedTiles.push(b)):b.parentNode===this._tileContainer&&this._tileContainer.removeChild(b);d.Browser.android||(b.onload=null,b.src=d.Util.emptyImageUrl);delete this._tiles[a]},_addTile:function(a,b){var c=this._getTilePos(a),e=this._getTile();d.DomUtil.setPosition(e,c,d.Browser.chrome);this._tiles[a.x+":"+a.y]=e;this._loadTile(e,a);e.parentNode!==this._tileContainer&&b.appendChild(e)},
_getZoomForUrl:function(){var a=this.options,b=this._map.getZoom();return a.zoomReverse&&(b=a.maxZoom-b),b+=a.zoomOffset,a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getTilePos:function(a){var b=this._map.getPixelOrigin(),c=this._getTileSize();return a.multiplyBy(c).subtract(b)},getTileUrl:function(a){return d.Util.template(this._url,d.extend({s:this._getSubdomain(a),z:a.z,x:a.x,y:a.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},
_adjustTilePoint:function(a){var b=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(a.x=(a.x%b.x+b.x)%b.x);this.options.tms&&(a.y=b.y-a.y-1);a.z=this._getZoomForUrl()},_getSubdomain:function(a){a=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[a]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var a=this._unusedTiles.pop();return this._resetTile(a),a}return this._createTile()},_resetTile:function(){},_createTile:function(){var a=
d.DomUtil.create("img","leaflet-tile");return a.style.width=a.style.height=this._getTileSize()+"px",a.galleryimg="no",a.onselectstart=a.onmousemove=d.Util.falseFn,d.Browser.ielt9&&this.options.opacity!==c&&d.DomUtil.setOpacity(a,this.options.opacity),d.Browser.mobileWebkit3d&&(a.style.WebkitBackfaceVisibility="hidden"),a},_loadTile:function(a,b){a._layer=this;a.onload=this._tileOnLoad;a.onerror=this._tileOnError;this._adjustTilePoint(b);a.src=this.getTileUrl(b);this.fire("tileloadstart",{tile:a,url:a.src})},
_tileLoaded:function(){this._tilesToLoad--;this._animated&&d.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(d.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var a=this._layer;this.src!==d.Util.emptyImageUrl&&(d.DomUtil.addClass(this,"leaflet-tile-loaded"),a.fire("tileload",{tile:this,url:this.src}));a._tileLoaded()},_tileOnError:function(){var a=
this._layer;a.fire("tileerror",{tile:this,url:this.src});var b=a.options.errorTileUrl;b&&(this.src=b);a._tileLoaded()}});d.tileLayer=function(a,b){return new d.TileLayer(a,b)};d.TileLayer.WMS=d.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,b){this._url=a;var c=d.extend({},this.defaultWmsParams),e=b.tileSize||this.options.tileSize;c.width=c.height=b.detectRetina&&d.Browser.retina?2*e:
e;for(var f in b)this.options.hasOwnProperty(f)||"crs"===f||(c[f]=b[f]);this.wmsParams=c;d.setOptions(this,b)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;d.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._map,c=this.options.tileSize,e=a.multiplyBy(c),c=e.add([c,c]),e=this._crs.project(b.unproject(e,a.z)),b=this._crs.project(b.unproject(c,a.z)),
b=1.3<=this._wmsVersion&&this._crs===d.CRS.EPSG4326?[b.y,e.x,e.y,b.x].join():[e.x,b.y,b.x,e.y].join();a=d.Util.template(this._url,{s:this._getSubdomain(a)});return a+d.Util.getParamString(this.wmsParams,a,!0)+"&BBOX="+b},setParams:function(a,b){return d.extend(this.wmsParams,a),b||this.redraw(),this}});d.tileLayer.wms=function(a,b){return new d.TileLayer.WMS(a,b)};d.TileLayer.Canvas=d.TileLayer.extend({options:{async:!1},initialize:function(a){d.setOptions(this,a)},redraw:function(){this._map&&(this._reset({hard:!0}),
this._update());for(var a in this._tiles)this._redrawTile(this._tiles[a]);return this},_redrawTile:function(a){this.drawTile(a,a._tilePoint,this._map._zoom)},_createTile:function(){var a=d.DomUtil.create("canvas","leaflet-tile");return a.width=a.height=this.options.tileSize,a.onselectstart=a.onmousemove=d.Util.falseFn,a},_loadTile:function(a,b){a._layer=this;a._tilePoint=b;this._redrawTile(a);this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}});
d.tileLayer.canvas=function(a){return new d.TileLayer.Canvas(a)};d.ImageOverlay=d.Class.extend({includes:d.Mixin.Events,options:{opacity:1},initialize:function(a,b,c){this._url=a;this._bounds=d.latLngBounds(b);d.setOptions(this,c)},onAdd:function(a){this._map=a;this._image||this._initImage();a._panes.overlayPane.appendChild(this._image);a.on("viewreset",this._reset,this);a.options.zoomAnimation&&d.Browser.any3d&&a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image);
a.off("viewreset",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var a=this._map._panes.overlayPane;return this._image&&a.insertBefore(this._image,a.firstChild),this},setUrl:function(a){this._url=a;this._image.src=
this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=d.DomUtil.create("img","leaflet-image-layer");this._map.options.zoomAnimation&&d.Browser.any3d?d.DomUtil.addClass(this._image,"leaflet-zoom-animated"):d.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity();d.extend(this._image,{galleryimg:"no",onselectstart:d.Util.falseFn,onmousemove:d.Util.falseFn,onload:d.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(a){var b=
this._map,c=this._image,e=b.getZoomScale(a.zoom),f=this._bounds.getNorthWest(),n=this._bounds.getSouthEast(),f=b._latLngToNewLayerPoint(f,a.zoom,a.center);a=b._latLngToNewLayerPoint(n,a.zoom,a.center)._subtract(f);a=f._add(a._multiplyBy(0.5*(1-1/e)));c.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(a)+" scale("+e+") "},_reset:function(){var a=this._image,b=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),c=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(b);d.DomUtil.setPosition(a,
b);a.style.width=c.x+"px";a.style.height=c.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){d.DomUtil.setOpacity(this._image,this.options.opacity)}});d.imageOverlay=function(a,b,c){return new d.ImageOverlay(a,b,c)};d.Icon=d.Class.extend({options:{className:""},initialize:function(a){d.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);
if(!c){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}var d;return d=b&&"IMG"===b.tagName?this._createImg(c,b):this._createImg(c),this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c,e=this.options,f=d.point(e[b+"Size"]);c=d.point("shadow"===b?e.shadowAnchor||e.iconAnchor:e.iconAnchor);!c&&f&&(c=f.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+e.className;c&&(a.style.marginLeft=-c.x+"px",a.style.marginTop=-c.y+"px");f&&(a.style.width=f.x+"px",
a.style.height=f.y+"px")},_createImg:function(a,c){return c=c||b.createElement("img"),c.src=a,c},_getIconUrl:function(a){return d.Browser.retina&&this.options[a+"RetinaUrl"]?this.options[a+"RetinaUrl"]:this.options[a+"Url"]}});d.icon=function(a){return new d.Icon(a)};d.Icon.Default=d.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var b=a+"Url";if(this.options[b])return this.options[b];d.Browser.retina&&"icon"===a&&(a+="-2x");
b=d.Icon.Default.imagePath;if(!b)throw Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return b+"/marker-"+a+".png"}});d.Icon.Default.imagePath=function(){var a,c,d,e,f=b.getElementsByTagName("script"),n=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;a=0;for(c=f.length;c>a;a++)if(d=f[a].src,d.match(n))return e=d.split(n)[0],(e?e+"/":"")+"images"}();d.Marker=d.Class.extend({includes:d.Mixin.Events,options:{icon:new d.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,
zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(a,b){d.setOptions(this,b);this._latlng=d.latLng(a)},onAdd:function(a){this._map=a;a.on("viewreset",this.update,this);this._initIcon();this.update();this.fire("add");a.options.zoomAnimation&&a.options.markerZoomAnimation&&a.on("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this.dragging&&this.dragging.disable();this._removeIcon();this._removeShadow();this.fire("remove");
a.off({viewreset:this.update,zoomanim:this._animateZoom},this);this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update(),this},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();
this._setPos(a)}return this},_initIcon:function(){var a=this.options,b=this._map,c=b.options.zoomAnimation&&b.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",e=a.icon.createIcon(this._icon),b=!1;e!==this._icon&&(this._icon&&this._removeIcon(),b=!0,a.title&&(e.title=a.title),a.alt&&(e.alt=a.alt));d.DomUtil.addClass(e,c);a.keyboard&&(e.tabIndex="0");this._icon=e;this._initInteraction();a.riseOnHover&&d.DomEvent.on(e,"mouseover",this._bringToFront,this).on(e,"mouseout",this._resetZIndex,
this);var e=a.icon.createShadow(this._shadow),f=!1;e!==this._shadow&&(this._removeShadow(),f=!0);e&&d.DomUtil.addClass(e,c);this._shadow=e;1>a.opacity&&this._updateOpacity();a=this._map._panes;b&&a.markerPane.appendChild(this._icon);e&&f&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&d.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&
this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(a){d.DomUtil.setPosition(this._icon,a);this._shadow&&d.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.clickable){var a=this._icon,b=["dblclick",
"mousedown","mouseover","mouseout","contextmenu"];d.DomUtil.addClass(a,"leaflet-clickable");d.DomEvent.on(a,"click",this._onMouseClick,this);d.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<b.length;c++)d.DomEvent.on(a,b[c],this._fireMouseEvent,this);d.Handler.MarkerDrag&&(this.dragging=new d.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(a){var b=this.dragging&&this.dragging.moved();(this.hasEventListeners(a.type)||b)&&d.DomEvent.stopPropagation(a);
b||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(a.type,{originalEvent:a,latlng:this._latlng})},_onKeyPress:function(a){13===a.keyCode&&this.fire("click",{originalEvent:a,latlng:this._latlng})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a,latlng:this._latlng});"contextmenu"===a.type&&this.hasEventListeners(a.type)&&d.DomEvent.preventDefault(a);"mousedown"!==a.type?d.DomEvent.stopPropagation(a):d.DomEvent.preventDefault(a)},setOpacity:function(a){return this.options.opacity=
a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){d.DomUtil.setOpacity(this._icon,this.options.opacity);this._shadow&&d.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});d.marker=function(a,b){return new d.Marker(a,b)};d.DivIcon=d.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(a){a=a&&"DIV"===a.tagName?a:b.createElement("div");
var c=this.options;return a.innerHTML=!1!==c.html?c.html:"",c.bgPos&&(a.style.backgroundPosition=-c.bgPos.x+"px "+-c.bgPos.y+"px"),this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});d.divIcon=function(a){return new d.DivIcon(a)};d.Map.mergeOptions({closePopupOnClick:!0});d.Popup=d.Class.extend({includes:d.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(a,
b){d.setOptions(this,a);this._source=b;this._animated=d.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(a){this._map=a;this._container||this._initLayout();var b=a.options.fadeAnimation;b&&d.DomUtil.setOpacity(this._container,0);a._panes.popupPane.appendChild(this._container);a.on(this._getEvents(),this);this.update();b&&d.DomUtil.setOpacity(this._container,1);this.fire("open");a.fire("popupopen",{popup:this});this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(a){return a.addLayer(this),
this},openOn:function(a){return a.openPopup(this),this},onRemove:function(a){a._panes.popupPane.removeChild(this._container);d.Util.falseFn(this._container.offsetWidth);a.off(this._getEvents(),this);a.options.fadeAnimation&&d.DomUtil.setOpacity(this._container,0);this._map=null;this.fire("close");a.fire("popupclose",{popup:this});this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this._map&&(this._updatePosition(),
this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var a={viewreset:this._updatePosition};return this._animated&&(a.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:
this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a,b=this._container=d.DomUtil.create("div","leaflet-popup "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"));this.options.closeButton&&(a=this._closeButton=d.DomUtil.create("a","leaflet-popup-close-button",b),a.href="#close",a.innerHTML="&#215;",d.DomEvent.disableClickPropagation(a),
d.DomEvent.on(a,"click",this._onCloseButtonClick,this));a=this._wrapper=d.DomUtil.create("div","leaflet-popup-content-wrapper",b);d.DomEvent.disableClickPropagation(a);this._contentNode=d.DomUtil.create("div","leaflet-popup-content",a);d.DomEvent.disableScrollPropagation(this._contentNode);d.DomEvent.on(a,"contextmenu",d.DomEvent.stopPropagation);this._tipContainer=d.DomUtil.create("div","leaflet-popup-tip-container",b);this._tip=d.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==
typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="";b.whiteSpace="nowrap";var c=a.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth);b.width=c+1+"px";b.whiteSpace="";b.height="";var c=a.offsetHeight,e=this.options.maxHeight;
e&&c>e?(b.height=e+"px",d.DomUtil.addClass(a,"leaflet-popup-scrolled")):d.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=this._animated,c=d.point(this.options.offset);b&&d.DomUtil.setPosition(this._container,a);this._containerBottom=-c.y-(b?0:a.y);this._containerLeft=-Math.round(this._containerWidth/2)+c.x+(b?0:a.x);this._container.style.bottom=this._containerBottom+
"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);d.DomUtil.setPosition(this._container,a)},_adjustPan:function(){if(this.options.autoPan){var a=this._map,b=this._container.offsetHeight,c=this._containerWidth,e=new d.Point(this._containerLeft,-b-this._containerBottom);this._animated&&e._add(d.DomUtil.getPosition(this._container));var e=a.layerPointToContainerPoint(e),f=d.point(this.options.autoPanPadding),
n=d.point(this.options.autoPanPaddingTopLeft||f),f=d.point(this.options.autoPanPaddingBottomRight||f),p=a.getSize(),q=0,s=0;e.x+c+f.x>p.x&&(q=e.x+c-p.x+f.x);0>e.x-q-n.x&&(q=e.x-n.x);e.y+b+f.y>p.y&&(s=e.y+b-p.y+f.y);0>e.y-s-n.y&&(s=e.y-n.y);(q||s)&&a.fire("autopanstart").panBy([q,s])}},_onCloseButtonClick:function(a){this._close();d.DomEvent.stop(a)}});d.popup=function(a,b){return new d.Popup(a,b)};d.Map.include({openPopup:function(a,b,c){(this.closePopup(),a instanceof d.Popup)||(a=(new d.Popup(c)).setLatLng(b).setContent(a));
return a._isOpen=!0,this._popup=a,this.addLayer(a)},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&(this.removeLayer(a),a._isOpen=!1),this}});d.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():
this.openPopup()),this},bindPopup:function(a,b){var c=d.point(this.options.icon.options.popupAnchor||[0,0]);return c=c.add(d.Popup.prototype.options.offset),b&&b.offset&&(c=c.add(b.offset)),b=d.extend({offset:c},b),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),a instanceof d.Popup?(d.setOptions(a,b),this._popup=a):this._popup=(new d.Popup(b,this)).setContent(a),this},setPopupContent:function(a){return this._popup&&
this._popup.setContent(a),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});d.LayerGroup=d.Class.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;c>b;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);
return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(a){return a?a in this._layers||this.getLayerId(a)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(a){var b,c,d=Array.prototype.slice.call(arguments,1);for(b in this._layers)c=this._layers[b],
c[a]&&c[a].apply(c,d);return this},onAdd:function(a){this._map=a;this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a);this._map=null},addTo:function(a){return a.addLayer(this),this},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d.stamp(a)}});
d.layerGroup=function(a){return new d.LayerGroup(a)};d.FeatureGroup=d.LayerGroup.extend({includes:d.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(a){return this.hasLayer(a)?this:("on"in a&&a.on(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?
(a in this._layers&&(a=this._layers[a]),a.off(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.removeLayer.call(this,a),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:a})):this},bindPopup:function(a,b){return this._popupContent=a,this._popupOptions=b,this.invoke("bindPopup",a,b)},openPopup:function(a){for(var b in this._layers){this._layers[b].openPopup(a);break}return this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},
bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new d.LatLngBounds;return this.eachLayer(function(b){a.extend(b instanceof d.Marker?b.getLatLng():b.getBounds())}),a},_propagateEvent:function(a){a=d.extend({layer:a.target,target:this},a);this.fire(a.type,a)}});d.featureGroup=function(a){return new d.FeatureGroup(a)};d.Path=d.Class.extend({includes:[d.Mixin.Events],statics:{CLIP_PADDING:function(){var b=((d.Browser.mobile?1280:2E3)/Math.max(a.outerWidth,a.outerHeight)-
1)/2;return Math.max(0,Math.min(0.5,b))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:0.5,fill:!1,fillColor:null,fillOpacity:0.2,clickable:!0},initialize:function(a){d.setOptions(this,a)},onAdd:function(a){this._map=a;this._container||(this._initElements(),this._initEvents());this.projectLatlngs();this._updatePath();this._container&&this._map._pathRoot.appendChild(this._container);this.fire("add");a.on({viewreset:this.projectLatlngs,moveend:this._updatePath},
this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){a._pathRoot.removeChild(this._container);this.fire("remove");this._map=null;d.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null);a.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(a){return d.setOptions(this,a),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}});
d.Map.include({_updatePathViewport:function(){var a=d.Path.CLIP_PADDING,b=this.getSize(),c=d.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(b.multiplyBy(a)._round()),a=c.add(b.multiplyBy(1+2*a)._round());this._pathViewport=new d.Bounds(c,a)}});d.Path.SVG_NS="http://www.w3.org/2000/svg";d.Browser.svg=!(!b.createElementNS||!b.createElementNS(d.Path.SVG_NS,"svg").createSVGRect);d.Path=d.Path.extend({statics:{SVG:d.Browser.svg},bringToFront:function(){var a=this._map._pathRoot,b=this._container;
return b&&a.lastChild!==b&&a.appendChild(b),this},bringToBack:function(){var a=this._map._pathRoot,b=this._container,c=a.firstChild;return b&&c!==b&&a.insertBefore(b,c),this},getPathString:function(){},_createElement:function(a){return b.createElementNS(d.Path.SVG_NS,a)},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle()},_initPath:function(){this._container=this._createElement("g");this._path=this._createElement("path");this.options.className&&d.DomUtil.addClass(this._path,
this.options.className);this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round"));this.options.fill&&this._path.setAttribute("fill-rule","evenodd");this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents);this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none");this._updateStyle()},_updateStyle:function(){this.options.stroke?
(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke",
"none");this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var a=this.getPathString();a||(a="M0 0");this._path.setAttribute("d",a)},_initEvents:function(){if(this.options.clickable){!d.Browser.svg&&d.Browser.vml||d.DomUtil.addClass(this._path,"leaflet-clickable");d.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var a=
"dblclick mousedown mouseover mouseout mousemove contextmenu".split(" "),b=0;b<a.length;b++)d.DomEvent.on(this._container,a[b],this._fireMouseEvent,this)}},_onMouseClick:function(a){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this.hasEventListeners(a.type)){var b=this._map,c=b.mouseEventToContainerPoint(a),e=b.containerPointToLayerPoint(c),b=b.layerPointToLatLng(e);this.fire(a.type,{latlng:b,layerPoint:e,containerPoint:c,originalEvent:a});
"contextmenu"===a.type&&d.DomEvent.preventDefault(a);"mousemove"!==a.type&&d.DomEvent.stopPropagation(a)}}});d.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=d.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&d.Browser.any3d?(d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",
this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(a){var b=this.getZoomScale(a.zoom);a=this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._pathViewport.min);this._pathRoot.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(a)+" scale("+b+") ";this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,c=a.max,a=c.x-b.x,c=c.y-b.y,e=this._pathRoot,
f=this._panes.overlayPane;d.Browser.mobileWebkit&&f.removeChild(e);d.DomUtil.setPosition(e,b);e.setAttribute("width",a);e.setAttribute("height",c);e.setAttribute("viewBox",[b.x,b.y,a,c].join(" "));d.Browser.mobileWebkit&&f.appendChild(e)}}});d.Path.include({bindPopup:function(a,b){return a instanceof d.Popup?this._popup=a:((!this._popup||b)&&(this._popup=new d.Popup(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),
this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(a){return this._popup&&(a=a||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:a})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(a){this._popup.setLatLng(a.latlng);this._map.openPopup(this._popup)}});
d.Browser.vml=!d.Browser.svg&&function(){try{var a=b.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&"object"==typeof c.adj}catch(d){return!1}}();d.Path=d.Browser.svg||!d.Browser.vml?d.Path:d.Path.extend({statics:{VML:!0,CLIP_PADDING:0.02},_createElement:function(){try{return b.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return b.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return b.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var a=this._container=this._createElement("shape");d.DomUtil.addClass(a,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:""));this.options.clickable&&d.DomUtil.addClass(a,"leaflet-clickable");a.coordsize="1 1";this._path=this._createElement("path");a.appendChild(this._path);this._map._pathRoot.appendChild(a)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var a=this._stroke,
b=this._fill,c=this.options,e=this._container;e.stroked=c.stroke;e.filled=c.fill;c.stroke?(a||(a=this._stroke=this._createElement("stroke"),a.endcap="round",e.appendChild(a)),a.weight=c.weight+"px",a.color=c.color,a.opacity=c.opacity,a.dashStyle=c.dashArray?d.Util.isArray(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):"",c.lineCap&&(a.endcap=c.lineCap.replace("butt","flat")),c.lineJoin&&(a.joinstyle=c.lineJoin)):a&&(e.removeChild(a),this._stroke=null);c.fill?(b||(b=this._fill=
this._createElement("fill"),e.appendChild(b)),b.color=c.fillColor||c.color,b.opacity=c.fillOpacity):b&&(e.removeChild(b),this._fill=null)},_updatePath:function(){var a=this._container.style;a.display="none";this._path.v=this.getPathString()+" ";a.display=""}});d.Map.include(d.Browser.svg||!d.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var a=this._pathRoot=b.createElement("div");a.className="leaflet-vml-container";this._panes.overlayPane.appendChild(a);this.on("moveend",this._updatePathViewport);
this._updatePathViewport()}}});d.Browser.canvas=!!b.createElement("canvas").getContext;d.Path=d.Path.SVG&&!a.L_PREFER_CANVAS||!d.Browser.canvas?d.Path:d.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(a){return d.setOptions(this,a),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(a){a.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this);this.options.clickable&&
(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this));this._requestUpdate();this._map=null},_requestUpdate:function(){this._map&&!d.Path._updateRequest&&(d.Path._updateRequest=d.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){d.Path._updateRequest=null;this.fire("moveend")},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;a.stroke&&(this._ctx.lineWidth=
a.weight,this._ctx.strokeStyle=a.color);a.fill&&(this._ctx.fillStyle=a.fillColor||a.color)},_drawPath:function(){var a,b,c,e,f,n;this._ctx.beginPath();a=0;for(c=this._parts.length;c>a;a++){b=0;for(e=this._parts[a].length;e>b;b++)f=this._parts[a][b],n=(0===b?"move":"line")+"To",this._ctx[n](f.x,f.y);this instanceof d.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var a=this._ctx,b=this.options;this._drawPath();a.save();
this._updateStyle();b.fill&&(a.globalAlpha=b.fillOpacity,a.fill());b.stroke&&(a.globalAlpha=b.opacity,a.stroke());a.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(a){this._containsPoint(a.layerPoint)&&this.fire("click",a)},_onMouseMove:function(a){this._map&&!this._map._animatingZoom&&(this._containsPoint(a.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=
!0,this.fire("mouseover",a)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",a)))}});d.Map.include(d.Path.SVG&&!a.L_PREFER_CANVAS||!d.Browser.canvas?{}:{_initPathRoot:function(){var a,c=this._pathRoot;c||(c=this._pathRoot=b.createElement("canvas"),c.style.position="absolute",a=this._canvasCtx=c.getContext("2d"),a.lineCap="round",a.lineJoin="round",this._panes.overlayPane.appendChild(c),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",
this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,a=a.max.subtract(b),c=this._pathRoot;d.DomUtil.setPosition(c,b);c.width=a.x;c.height=a.y;c.getContext("2d").translate(-b.x,-b.y)}}});d.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,
c),this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var d=a.length,e=new (typeof Uint8Array!=c+""?Uint8Array:Array)(d);e[0]=e[d-1]=1;this._simplifyDPStep(a,e,b,0,d-1);var f,n=[];for(f=0;d>f;f++)e[f]&&n.push(a[f]);return n},_simplifyDPStep:function(a,b,c,d,e){var f,p,q,s=0;for(p=d+1;e-1>=p;p++)q=this._sqClosestPointOnSegment(a[p],
a[d],a[e],!0),q>s&&(f=p,s=q);s>c&&(b[f]=1,this._simplifyDPStep(a,b,c,d,f),this._simplifyDPStep(a,b,c,f,e))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;f>d;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return f-1>e&&c.push(a[f-1]),c},clipSegment:function(a,b,c,d){var e,f,p=d?this._lastCode:this._getBitCode(a,c),q=this._getBitCode(b,c);for(this._lastCode=q;;){if(!(p|q))return[a,b];if(p&q)return!1;d=p||q;e=this._getEdgeIntersection(a,b,d,c);f=this._getBitCode(e,c);d===p?(a=e,
p=f):(b=e,q=f)}},_getEdgeIntersection:function(a,b,c,e){var f=b.x-a.x;b=b.y-a.y;var n=e.min;e=e.max;return 8&c?new d.Point(a.x+f*(e.y-a.y)/b,e.y):4&c?new d.Point(a.x+f*(n.y-a.y)/b,n.y):2&c?new d.Point(e.x,a.y+b*(e.x-a.x)/f):1&c?new d.Point(n.x,a.y+b*(n.x-a.x)/f):void 0},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,e){var f,n=
b.x;b=b.y;var p=c.x-n,q=c.y-b,s=p*p+q*q;return 0<s&&(f=((a.x-n)*p+(a.y-b)*q)/s,1<f?(n=c.x,b=c.y):0<f&&(n+=p*f,b+=q*f)),p=a.x-n,q=a.y-b,e?p*p+q*q:new d.Point(n,b)}};d.Polyline=d.Path.extend({initialize:function(a,b){d.Path.prototype.initialize.call(this,b);this._latlngs=this._convertLatLngs(a)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;b>a;a++)this._originalPoints[a]=this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=
0,b=this._parts.length,c="";b>a;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=this._convertLatLngs(a),this.redraw()},addLatLng:function(a){return this._latlngs.push(d.latLng(a)),this.redraw()},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),a},closestLayerPoint:function(a){for(var b,c,e=1/0,f=this._parts,n=null,p=0,q=f.length;q>
p;p++)for(var s=f[p],t=1,u=s.length;u>t;t++){b=s[t-1];c=s[t];var v=d.LineUtil._sqClosestPointOnSegment(a,b,c,!0);e>v&&(e=v,n=d.LineUtil._sqClosestPointOnSegment(a,b,c))}return n&&(n.distance=Math.sqrt(e)),n},getBounds:function(){return new d.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(a,b){var c,e,f=b?a:[];c=0;for(e=a.length;e>c;c++){if(d.Util.isArray(a[c])&&"number"!=typeof a[c][0])return;f[c]=d.latLng(a[c])}return f},_initEvents:function(){d.Path.prototype._initEvents.call(this)},
_getPathPartStr:function(a){for(var b,c=d.Path.VML,e=0,f=a.length,n="";f>e;e++)b=a[e],c&&b._round(),n+=(e?"L":"M")+b.x+" "+b.y;return n},_clipPoints:function(){var a,b,c,e=this._originalPoints,f=e.length;if(this.options.noClip)return void(this._parts=[e]);var n=this._parts=[],p=this._map._pathViewport,q=d.LineUtil;for(b=a=0;f-1>a;a++)(c=q.clipSegment(e[a],e[a+1],p,a))&&(n[b]=n[b]||[],n[b].push(c[0]),(c[1]!==e[a+1]||a===f-2)&&(n[b].push(c[1]),b++))},_simplifyPoints:function(){for(var a=this._parts,
b=d.LineUtil,c=0,e=a.length;e>c;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),d.Path.prototype._updatePath.call(this))}});d.polyline=function(a,b){return new d.Polyline(a,b)};d.PolyUtil={};d.PolyUtil.clipPolygon=function(a,b){var c,e,f,n,p,q,s,t,u=[1,4,2,8],v=d.LineUtil;e=0;for(q=a.length;q>e;e++)a[e]._code=v._getBitCode(a[e],b);for(n=0;4>n;n++){s=u[n];c=[];e=0;q=a.length;for(f=q-1;q>e;f=e++)p=a[e],f=a[f],p._code&
s?f._code&s||(t=v._getEdgeIntersection(f,p,s,b),t._code=v._getBitCode(t,b),c.push(t)):(f._code&s&&(t=v._getEdgeIntersection(f,p,s,b),t._code=v._getBitCode(t,b),c.push(t)),c.push(p));a=c}return a};d.Polygon=d.Polyline.extend({options:{fill:!0},initialize:function(a,b){d.Polyline.prototype.initialize.call(this,a,b);this._initWithHoles(a)},_initWithHoles:function(a){var b,c;if(a&&d.Util.isArray(a[0])&&"number"!=typeof a[0][0])for(this._latlngs=this._convertLatLngs(a[0]),this._holes=a.slice(1),a=0,b=
this._holes.length;b>a;a++)c=this._holes[a]=this._convertLatLngs(this._holes[a]),c[0].equals(c[c.length-1])&&c.pop();a=this._latlngs;2<=a.length&&a[0].equals(a[a.length-1])&&a.pop()},projectLatlngs:function(){if(d.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var a,b,c,e;a=0;for(c=this._holes.length;c>a;a++)for(this._holePoints[a]=[],b=0,e=this._holes[a].length;e>b;b++)this._holePoints[a][b]=this._map.latLngToLayerPoint(this._holes[a][b])}},setLatLngs:function(a){return a&&
d.Util.isArray(a[0])&&"number"!=typeof a[0][0]?(this._initWithHoles(a),this.redraw()):d.Polyline.prototype.setLatLngs.call(this,a)},_clipPoints:function(){var a=[];if(this._parts=[this._originalPoints].concat(this._holePoints),!this.options.noClip){for(var b=0,c=this._parts.length;c>b;b++){var e=d.PolyUtil.clipPolygon(this._parts[b],this._map._pathViewport);e.length&&a.push(e)}this._parts=a}},_getPathPartStr:function(a){return d.Polyline.prototype._getPathPartStr.call(this,a)+(d.Browser.svg?"z":"x")}});
d.polygon=function(a,b){return new d.Polygon(a,b)};(function(){function a(b){return d.FeatureGroup.extend({initialize:function(a,b){this._layers={};this._options=b;this.setLatLngs(a)},setLatLngs:function(a){var c=0,d=a.length;for(this.eachLayer(function(b){d>c?b.setLatLngs(a[c++]):this.removeLayer(b)},this);d>c;)this.addLayer(new b(a[c++],this._options));return this},getLatLngs:function(){var a=[];return this.eachLayer(function(b){a.push(b.getLatLngs())}),a}})}d.MultiPolyline=a(d.Polyline);d.MultiPolygon=
a(d.Polygon);d.multiPolyline=function(a,b){return new d.MultiPolyline(a,b)};d.multiPolygon=function(a,b){return new d.MultiPolygon(a,b)}})();d.Rectangle=d.Polygon.extend({initialize:function(a,b){d.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=d.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});d.rectangle=function(a,b){return new d.Rectangle(a,
b)};d.Circle=d.Path.extend({initialize:function(a,b,c){d.Path.prototype.initialize.call(this,c);this._latlng=d.latLng(a);this._mRadius=b},options:{fill:!0},setLatLng:function(a){return this._latlng=d.latLng(a),this.redraw()},setRadius:function(a){return this._mRadius=a,this.redraw()},projectLatlngs:function(){var a=this._getLngRadius(),b=this._latlng,a=this._map.latLngToLayerPoint([b.lat,b.lng-a]);this._point=this._map.latLngToLayerPoint(b);this._radius=Math.max(this._point.x-a.x,1)},getBounds:function(){var a=
this._getLngRadius(),b=this._mRadius/40075017*360,c=this._latlng;return new d.LatLngBounds([c.lat-b,c.lng-a],[c.lat+b,c.lng+a])},getLatLng:function(){return this._latlng},getPathString:function(){var a=this._point,b=this._radius;return this._checkIfEmpty()?"":d.Browser.svg?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-0.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/
40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(d.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.max.x||c.y-b>a.max.y||c.x+b<a.min.x||c.y+b<a.min.y}});d.circle=function(a,b,c){return new d.Circle(a,b,c)};d.CircleMarker=d.Circle.extend({options:{radius:10,weight:2},initialize:function(a,b){d.Circle.prototype.initialize.call(this,a,null,b);this._radius=this.options.radius},
projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){d.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius)},setLatLng:function(a){return d.Circle.prototype.setLatLng.call(this,a),this._popup&&this._popup._isOpen&&this._popup.setLatLng(a),this},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius}});d.circleMarker=function(a,b){return new d.CircleMarker(a,
b)};d.Polyline.include(d.Path.CANVAS?{_containsPoint:function(a,b){var c,e,f,n,p,q,s,t=this.options.weight/2;d.Browser.touch&&(t+=10);c=0;for(n=this._parts.length;n>c;c++)for(s=this._parts[c],e=0,p=s.length,f=p-1;p>e;f=e++)if((b||0!==e)&&(q=d.LineUtil.pointToSegmentDistance(a,s[f],s[e]),t>=q))return!0;return!1}}:{});d.Polygon.include(d.Path.CANVAS?{_containsPoint:function(a){var b,c,e,f,n,p,q,s=!1;if(d.Polyline.prototype._containsPoint.call(this,a,!0))return!0;f=0;for(p=this._parts.length;p>f;f++)for(b=
this._parts[f],n=0,q=b.length,e=q-1;q>n;e=n++)c=b[n],e=b[e],c.y>a.y!=e.y>a.y&&a.x<(e.x-c.x)*(a.y-c.y)/(e.y-c.y)+c.x&&(s=!s);return s}}:{});d.Circle.include(d.Path.CANVAS?{_drawPath:function(){var a=this._point;this._ctx.beginPath();this._ctx.arc(a.x,a.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(a){var b=this.options.stroke?this.options.weight/2:0;return a.distanceTo(this._point)<=this._radius+b}}:{});d.CircleMarker.include(d.Path.CANVAS?{_updateStyle:function(){d.Path.prototype._updateStyle.call(this)}}:
{});d.GeoJSON=d.FeatureGroup.extend({initialize:function(a,b){d.setOptions(this,b);this._layers={};a&&this.addData(a)},addData:function(a){var b,c,e=d.Util.isArray(a)?a:a.features;if(e){a=0;for(b=e.length;b>a;a++)c=e[a],(c.geometries||c.geometry||c.features||c.coordinates)&&this.addData(e[a]);return this}e=this.options;if(!e.filter||e.filter(a))return b=d.GeoJSON.geometryToLayer(a,e.pointToLayer,e.coordsToLatLng,e),b.feature=d.GeoJSON.asFeature(a),b.defaultOptions=b.options,this.resetStyle(b),e.onEachFeature&&
e.onEachFeature(a,b),this.addLayer(b)},resetStyle:function(a){var b=this.options.style;b&&(d.Util.extend(a.options,a.defaultOptions),this._setLayerStyle(a,b))},setStyle:function(a){this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});d.extend(d.GeoJSON,{geometryToLayer:function(a,b,c,e){var f,n,p,q="Feature"===a.type?a.geometry:a,s=q.coordinates,t=[];switch(c=c||this.coordsToLatLng,q.type){case "Point":return f=
c(s),b?b(a,f):new d.Marker(f);case "MultiPoint":n=0;for(p=s.length;p>n;n++)f=c(s[n]),t.push(b?b(a,f):new d.Marker(f));return new d.FeatureGroup(t);case "LineString":return n=this.coordsToLatLngs(s,0,c),new d.Polyline(n,e);case "Polygon":if(2===s.length&&!s[1].length)throw Error("Invalid GeoJSON object.");return n=this.coordsToLatLngs(s,1,c),new d.Polygon(n,e);case "MultiLineString":return n=this.coordsToLatLngs(s,1,c),new d.MultiPolyline(n,e);case "MultiPolygon":return n=this.coordsToLatLngs(s,2,
c),new d.MultiPolygon(n,e);case "GeometryCollection":n=0;for(p=q.geometries.length;p>n;n++)t.push(this.geometryToLayer({geometry:q.geometries[n],type:"Feature",properties:a.properties},b,c,e));return new d.FeatureGroup(t);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new d.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){var d,e,f,p=[];e=0;for(f=a.length;f>e;e++)d=b?this.coordsToLatLngs(a[e],b-1,c):(c||this.coordsToLatLng)(a[e]),p.push(d);return p},latLngToCoords:function(a){var b=
[a.lng,a.lat];return a.alt!==c&&b.push(a.alt),b},latLngsToCoords:function(a){for(var b=[],c=0,e=a.length;e>c;c++)b.push(d.GeoJSON.latLngToCoords(a[c]));return b},getFeature:function(a,b){return a.feature?d.extend({},a.feature,{geometry:b}):d.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var f={toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"Point",coordinates:d.GeoJSON.latLngToCoords(this.getLatLng())})}};d.Marker.include(f);
d.Circle.include(f);d.CircleMarker.include(f);d.Polyline.include({toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"LineString",coordinates:d.GeoJSON.latLngsToCoords(this.getLatLngs())})}});d.Polygon.include({toGeoJSON:function(){var a,b,c,e=[d.GeoJSON.latLngsToCoords(this.getLatLngs())];if(e[0].push(e[0][0]),this._holes)for(a=0,b=this._holes.length;b>a;a++)c=d.GeoJSON.latLngsToCoords(this._holes[a]),c.push(c[0]),e.push(c);return d.GeoJSON.getFeature(this,{type:"Polygon",coordinates:e})}});
(function(){function a(b){return function(){var a=[];return this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)}),d.GeoJSON.getFeature(this,{type:b,coordinates:a})}}d.MultiPolyline.include({toGeoJSON:a("MultiLineString")});d.MultiPolygon.include({toGeoJSON:a("MultiPolygon")});d.LayerGroup.include({toGeoJSON:function(){var b,c=this.feature&&this.feature.geometry,e=[];if(c&&"MultiPoint"===c.type)return a("MultiPoint").call(this);var f=c&&"GeometryCollection"===c.type;return this.eachLayer(function(a){a.toGeoJSON&&
(b=a.toGeoJSON(),e.push(f?b.geometry:d.GeoJSON.asFeature(b)))}),f?d.GeoJSON.getFeature(this,{geometries:e,type:"GeometryCollection"}):{type:"FeatureCollection",features:e}}})})();d.geoJson=function(a,b){return new d.GeoJSON(a,b)};d.DomEvent={addListener:function(a,b,c,e){var f,n,p,q=d.stamp(c),s="_leaflet_"+b+q;return a[s]?this:(f=function(b){return c.call(e||a,b||d.DomEvent._getEvent())},d.Browser.pointer&&0===b.indexOf("touch")?this.addPointerListener(a,b,f,q):(d.Browser.touch&&"dblclick"===b&&
this.addDoubleTapListener&&this.addDoubleTapListener(a,f,q),"addEventListener"in a?"mousewheel"===b?(a.addEventListener("DOMMouseScroll",f,!1),a.addEventListener(b,f,!1)):"mouseenter"===b||"mouseleave"===b?(n=f,p="mouseenter"===b?"mouseover":"mouseout",f=function(b){return d.DomEvent._checkMouse(a,b)?n(b):void 0},a.addEventListener(p,f,!1)):"click"===b&&d.Browser.android?(n=f,f=function(a){return d.DomEvent._filterClick(a,n)},a.addEventListener(b,f,!1)):a.addEventListener(b,f,!1):"attachEvent"in a&&
a.attachEvent("on"+b,f),a[s]=f,this))},removeListener:function(a,b,c){c=d.stamp(c);var e="_leaflet_"+b+c,f=a[e];return f?(d.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,c):d.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,c):"removeEventListener"in a?"mousewheel"===b?(a.removeEventListener("DOMMouseScroll",f,!1),a.removeEventListener(b,f,!1)):"mouseenter"===b||"mouseleave"===b?a.removeEventListener("mouseenter"===b?"mouseover":"mouseout",
f,!1):a.removeEventListener(b,f,!1):"detachEvent"in a&&a.detachEvent("on"+b,f),a[e]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,d.DomEvent._skipped(a),this},disableScrollPropagation:function(a){var b=d.DomEvent.stopPropagation;return d.DomEvent.on(a,"mousewheel",b).on(a,"MozMousePixelScroll",b)},disableClickPropagation:function(a){for(var b=d.DomEvent.stopPropagation,c=d.Draggable.START.length-1;0<=c;c--)d.DomEvent.on(a,d.Draggable.START[c],
b);return d.DomEvent.on(a,"click",d.DomEvent._fakeStop).on(a,"dblclick",b)},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return d.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new d.Point(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new d.Point(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/
120),a.detail&&(b=-a.detail/3),b},_skipEvents:{},_fakeStop:function(a){d.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(d){return!1}return c!==a},_getEvent:function(){var b=a.event;if(!b)for(var c=arguments.callee.caller;c&&(b=c.arguments[0],!b||a.Event!==b.constructor);)c=c.caller;return b},_filterClick:function(a,b){var c=
a.timeStamp||a.originalEvent.timeStamp,e=d.DomEvent._lastClick&&c-d.DomEvent._lastClick;return e&&100<e&&1E3>e||a.target._simulatedClick&&!a._simulated?void d.DomEvent.stop(a):(d.DomEvent._lastClick=c,b(a))}};d.DomEvent.on=d.DomEvent.addListener;d.DomEvent.off=d.DomEvent.removeListener;d.Draggable=d.Class.extend({includes:d.Mixin.Events,statics:{START:d.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},
MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b){this._element=a;this._dragStartTarget=b||a},enable:function(){if(!this._enabled){for(var a=d.Draggable.START.length-1;0<=a;a--)d.DomEvent.on(this._dragStartTarget,d.Draggable.START[a],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var a=d.Draggable.START.length-1;0<=a;a--)d.DomEvent.off(this._dragStartTarget,d.Draggable.START[a],this._onDown,
this);this._moved=this._enabled=!1}},_onDown:function(a){if(this._moved=!1,!(a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(d.DomEvent.stopPropagation(a),d.Draggable._disabled||(d.DomUtil.disableImageDrag(),d.DomUtil.disableTextSelection(),this._moving)))){var c=a.touches?a.touches[0]:a;this._startPoint=new d.Point(c.clientX,c.clientY);this._startPos=this._newPos=d.DomUtil.getPosition(this._element);d.DomEvent.on(b,d.Draggable.MOVE[a.type],this._onMove,this).on(b,d.Draggable.END[a.type],this._onUp,
this)}},_onMove:function(a){if(a.touches&&1<a.touches.length)return void(this._moved=!0);var c=a.touches&&1===a.touches.length?a.touches[0]:a,c=(new d.Point(c.clientX,c.clientY)).subtract(this._startPoint);(c.x||c.y)&&(d.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=d.DomUtil.getPosition(this._element).subtract(c),d.DomUtil.addClass(b.body,"leaflet-dragging"),d.DomUtil.addClass(a.target||a.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(c),
this._moving=!0,d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))},_updatePosition:function(){this.fire("predrag");d.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(a){d.DomUtil.removeClass(b.body,"leaflet-dragging");d.DomUtil.removeClass(a.target||a.srcElement,"leaflet-drag-target");for(var c in d.Draggable.MOVE)d.DomEvent.off(b,d.Draggable.MOVE[c],this._onMove).off(b,d.Draggable.END[c],
this._onUp);d.DomUtil.enableImageDrag();d.DomUtil.enableTextSelection();this._moved&&this._moving&&(d.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1}});d.Handler=d.Class.extend({initialize:function(a){this._map=a},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}});d.Map.mergeOptions({dragging:!0,
inertia:!d.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:d.Browser.touch?32:18,easeLinearity:0.25,worldCopyJump:!1});d.Map.Drag=d.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new d.Draggable(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),a.on("viewreset",this._onViewReset,
this),a.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var a=this._map;a._panAnim&&a._panAnim.stop();a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var a=this._lastTime=+new Date,b=this._lastPos=this._draggable._newPos;this._positions.push(b);this._times.push(a);
200<a-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var a=this._map.getSize()._divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,a=(d+b+c)%a-b-c,c=Math.abs(e+c)<Math.abs(a+c)?e:a;this._draggable._newPos.x=c},
_onDragEnd:function(a){var b=this._map,c=b.options,e=+new Date-this._lastTime,f=!c.inertia||e>c.inertiaThreshold||!this._positions[0];if(b.fire("dragend",a),f)b.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var n=c.easeLinearity;a=a.multiplyBy(n/((this._lastTime+e-this._times[0])/1E3));f=a.distanceTo([0,0]);e=Math.min(c.inertiaMaxSpeed,f);a=a.multiplyBy(e/f);var p=e/(c.inertiaDeceleration*n),q=a.multiplyBy(-p/2).round();q.x&&q.y?(q=b._limitOffset(q,b.options.maxBounds),d.Util.requestAnimFrame(function(){b.panBy(q,
{duration:p,easeLinearity:n,noMoveStart:!0})})):b.fire("moveend")}}});d.Map.addInitHook("addHandler","dragging",d.Map.Drag);d.Map.mergeOptions({doubleClickZoom:!0});d.Map.DoubleClickZoom=d.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom()+(a.originalEvent.shiftKey?-1:1);"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,
c)}});d.Map.addInitHook("addHandler","doubleClickZoom",d.Map.DoubleClickZoom);d.Map.mergeOptions({scrollWheelZoom:!0});d.Map.ScrollWheelZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);d.DomEvent.on(this._map._container,"MozMousePixelScroll",d.DomEvent.preventDefault);this._delta=0},removeHooks:function(){d.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll);d.DomEvent.off(this._map._container,"MozMousePixelScroll",
d.DomEvent.preventDefault)},_onWheelScroll:function(a){var b=d.DomEvent.getWheelDelta(a);this._delta+=b;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);b=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(d.bind(this._performZoom,this),b);d.DomEvent.preventDefault(a);d.DomEvent.stopPropagation(a)},_performZoom:function(){var a=this._map,b=this._delta,c=a.getZoom(),b=0<b?Math.ceil(b):Math.floor(b),b=Math.max(Math.min(b,
4),-4),b=a._limitZoom(c+b)-c;this._delta=0;this._startTime=null;b&&("center"===a.options.scrollWheelZoom?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}});d.Map.addInitHook("addHandler","scrollWheelZoom",d.Map.ScrollWheelZoom);d.extend(d.DomEvent,{_touchstart:d.Browser.msPointer?"MSPointerDown":d.Browser.pointer?"pointerdown":"touchstart",_touchend:d.Browser.msPointer?"MSPointerUp":d.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,e){function f(a){var b;if(d.Browser.pointer?
(v.push(a.pointerId),b=v.length):b=a.touches.length,!(1<b)){b=Date.now();var c=b-(n||b);p=a.touches?a.touches[0]:a;q=0<c&&s>=c;n=b}}function m(a){if(d.Browser.pointer){a=v.indexOf(a.pointerId);if(-1===a)return;v.splice(a,1)}if(q){if(d.Browser.pointer){var b={},e;for(e in p)a=p[e],b[e]="function"==typeof a?a.bind(p):a;p=b}p.type="dblclick";c(p);n=null}}var n,p,q=!1,s=250,t=this._touchstart,u=this._touchend,v=[];a["_leaflet_"+t+e]=f;a["_leaflet_"+u+e]=m;e=d.Browser.pointer?b.documentElement:a;return a.addEventListener(t,
f,!1),e.addEventListener(u,m,!1),d.Browser.pointer&&e.addEventListener(d.DomEvent.POINTER_CANCEL,m,!1),this},removeDoubleTapListener:function(a,c){return a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1),(d.Browser.pointer?b.documentElement:a).removeEventListener(this._touchend,a["_leaflet_"+this._touchend+c],!1),d.Browser.pointer&&b.documentElement.removeEventListener(d.DomEvent.POINTER_CANCEL,a["_leaflet_"+this._touchend+c],!1),this}});d.extend(d.DomEvent,{POINTER_DOWN:d.Browser.msPointer?
"MSPointerDown":"pointerdown",POINTER_MOVE:d.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:d.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:d.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(a,b,c,d){switch(b){case "touchstart":return this.addPointerListenerStart(a,b,c,d);case "touchend":return this.addPointerListenerEnd(a,b,c,d);case "touchmove":return this.addPointerListenerMove(a,b,c,d);default:throw"Unknown touch event type";
}},addPointerListenerStart:function(a,c,e,f){var m=this._pointers;c=function(a){d.DomEvent.preventDefault(a);for(var b=!1,c=0;c<m.length;c++)if(m[c].pointerId===a.pointerId){b=!0;break}b||m.push(a);a.touches=m.slice();a.changedTouches=[a];e(a)};(a["_leaflet_touchstart"+f]=c,a.addEventListener(this.POINTER_DOWN,c,!1),this._pointerDocumentListener)||(a=function(a){for(var b=0;b<m.length;b++)if(m[b].pointerId===a.pointerId){m.splice(b,1);break}},b.documentElement.addEventListener(this.POINTER_UP,a,!1),
b.documentElement.addEventListener(this.POINTER_CANCEL,a,!1),this._pointerDocumentListener=!0);return this},addPointerListenerMove:function(a,b,c,d){function e(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons){for(var b=0;b<f.length;b++)if(f[b].pointerId===a.pointerId){f[b]=a;break}a.touches=f.slice();a.changedTouches=[a];c(a)}}var f=this._pointers;return a["_leaflet_touchmove"+d]=e,a.addEventListener(this.POINTER_MOVE,e,!1),this},addPointerListenerEnd:function(a,
b,c,d){var e=this._pointers;b=function(a){for(var b=0;b<e.length;b++)if(e[b].pointerId===a.pointerId){e.splice(b,1);break}a.touches=e.slice();a.changedTouches=[a];c(a)};return a["_leaflet_touchend"+d]=b,a.addEventListener(this.POINTER_UP,b,!1),a.addEventListener(this.POINTER_CANCEL,b,!1),this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];switch(b){case "touchstart":a.removeEventListener(this.POINTER_DOWN,c,!1);break;case "touchmove":a.removeEventListener(this.POINTER_MOVE,c,!1);break;
case "touchend":a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1)}return this}});d.Map.mergeOptions({touchZoom:d.Browser.touch&&!d.Browser.android23,bounceAtZoomLimits:!0});d.Map.TouchZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===
a.touches.length&&!c._animatingZoom&&!this._zooming){var e=c.mouseEventToLayerPoint(a.touches[0]),f=c.mouseEventToLayerPoint(a.touches[1]),m=c._getCenterLayerPoint();this._startCenter=e.add(f)._divideBy(2);this._startDist=e.distanceTo(f);this._moved=!1;this._zooming=!0;this._centerOffset=m.subtract(this._startCenter);c._panAnim&&c._panAnim.stop();d.DomEvent.on(b,"touchmove",this._onTouchMove,this).on(b,"touchend",this._onTouchEnd,this);d.DomEvent.preventDefault(a)}},_onTouchMove:function(a){var b=
this._map;if(a.touches&&2===a.touches.length&&this._zooming){var c=b.mouseEventToLayerPoint(a.touches[0]),e=b.mouseEventToLayerPoint(a.touches[1]);this._scale=c.distanceTo(e)/this._startDist;this._delta=c._add(e)._divideBy(2)._subtract(this._startCenter);1===this._scale||!b.options.bounceAtZoomLimits&&(b.getZoom()===b.getMinZoom()&&1>this._scale||b.getZoom()===b.getMaxZoom()&&1<this._scale)||(this._moved||(d.DomUtil.addClass(b._mapPane,"leaflet-touching"),b.fire("movestart").fire("zoomstart"),this._moved=
!0),d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),d.DomEvent.preventDefault(a))}},_updateOnMove:function(){var a=this._map,b=this._getScaleOrigin(),b=a.layerPointToLatLng(b),c=a.getScaleZoom(this._scale);a._animateZoom(b,c,this._startCenter,this._scale,this._delta)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var a=this._map;this._zooming=!1;d.DomUtil.removeClass(a._mapPane,
"leaflet-touching");d.Util.cancelAnimFrame(this._animRequest);d.DomEvent.off(b,"touchmove",this._onTouchMove).off(b,"touchend",this._onTouchEnd);var c=this._getScaleOrigin(),e=a.layerPointToLatLng(c),f=a.getZoom(),m=a.getScaleZoom(this._scale)-f,m=0<m?Math.ceil(m):Math.floor(m),f=a._limitZoom(f+m),m=a.getZoomScale(f)/this._scale;a._animateZoom(e,f,c,m)},_getScaleOrigin:function(){var a=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(a)}});d.Map.addInitHook("addHandler",
"touchZoom",d.Map.TouchZoom);d.Map.mergeOptions({tap:!0,tapTolerance:15});d.Map.Tap=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(d.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var c=a.touches[0];a=c.target;this._startPos=this._newPos=
new d.Point(c.clientX,c.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&d.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(d.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1E3);d.DomEvent.on(b,"touchmove",this._onMove,this).on(b,"touchend",this._onUp,this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),d.DomEvent.off(b,"touchmove",this._onMove,this).off(b,"touchend",this._onUp,this),this._fireClick&&a&&
a.changedTouches){a=a.changedTouches[0];var c=a.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&d.DomUtil.removeClass(c,"leaflet-active");this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new d.Point(a.clientX,a.clientY)},_simulateEvent:function(c,d){var e=b.createEvent("MouseEvents");e._simulated=!0;d.target._simulatedClick=!0;e.initMouseEvent(c,
!0,!0,a,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(e)}});d.Browser.touch&&!d.Browser.pointer&&d.Map.addInitHook("addHandler","tap",d.Map.Tap);d.Map.mergeOptions({boxZoom:!0});d.Map.BoxZoom=d.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._moved=!1},addHooks:function(){d.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){d.DomEvent.off(this._container,
"mousedown",this._onMouseDown);this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(a){return this._moved=!1,!a.shiftKey||1!==a.which&&1!==a.button?!1:(d.DomUtil.disableTextSelection(),d.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),void d.DomEvent.on(b,"mousemove",this._onMouseMove,this).on(b,"mouseup",this._onMouseUp,this).on(b,"keydown",this._onKeyDown,this))},_onMouseMove:function(a){this._moved||(this._box=d.DomUtil.create("div","leaflet-zoom-box",
this._pane),d.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var b=this._startLayerPoint,c=this._box,e=this._map.mouseEventToLayerPoint(a);a=e.subtract(b);b=new d.Point(Math.min(e.x,b.x),Math.min(e.y,b.y));d.DomUtil.setPosition(c,b);this._moved=!0;c.style.width=Math.max(0,Math.abs(a.x)-4)+"px";c.style.height=Math.max(0,Math.abs(a.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=
"");d.DomUtil.enableTextSelection();d.DomUtil.enableImageDrag();d.DomEvent.off(b,"mousemove",this._onMouseMove).off(b,"mouseup",this._onMouseUp).off(b,"keydown",this._onKeyDown)},_onMouseUp:function(a){this._finish();var b=this._map;a=b.mouseEventToLayerPoint(a);this._startLayerPoint.equals(a)||(a=new d.LatLngBounds(b.layerPointToLatLng(this._startLayerPoint),b.layerPointToLatLng(a)),b.fitBounds(a),b.fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});d.Map.addInitHook("addHandler",
"boxZoom",d.Map.BoxZoom);d.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1});d.Map.Keyboard=d.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(a){this._map=a;this._setPanOffset(a.options.keyboardPanOffset);this._setZoomOffset(a.options.keyboardZoomOffset)},addHooks:function(){var a=this._map._container;-1===a.tabIndex&&(a.tabIndex="0");d.DomEvent.on(a,"focus",this._onFocus,this).on(a,"blur",
this._onBlur,this).on(a,"mousedown",this._onMouseDown,this);this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var a=this._map._container;d.DomEvent.off(a,"focus",this._onFocus,this).off(a,"blur",this._onBlur,this).off(a,"mousedown",this._onMouseDown,this);this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var c=b.body,d=b.documentElement,e=c.scrollTop||d.scrollTop,
c=c.scrollLeft||d.scrollLeft;this._map._container.focus();a.scrollTo(c,e)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanOffset:function(a){var b,c,d=this._panKeys={},e=this.keyCodes;b=0;for(c=e.left.length;c>b;b++)d[e.left[b]]=[-1*a,0];b=0;for(c=e.right.length;c>b;b++)d[e.right[b]]=[a,0];b=0;for(c=e.down.length;c>b;b++)d[e.down[b]]=[0,a];b=0;for(c=e.up.length;c>b;b++)d[e.up[b]]=[0,-1*a]},_setZoomOffset:function(a){var b,
c,d=this._zoomKeys={},e=this.keyCodes;b=0;for(c=e.zoomIn.length;c>b;b++)d[e.zoomIn[b]]=a;b=0;for(c=e.zoomOut.length;c>b;b++)d[e.zoomOut[b]]=-a},_addHooks:function(){d.DomEvent.on(b,"keydown",this._onKeyDown,this)},_removeHooks:function(){d.DomEvent.off(b,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){var b=a.keyCode,c=this._map;if(b in this._panKeys){if(c._panAnim&&c._panAnim._inProgress)return;c.panBy(this._panKeys[b]);c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds)}else{if(!(b in
this._zoomKeys))return;c.setZoom(c.getZoom()+this._zoomKeys[b])}d.DomEvent.stop(a)}});d.Map.addInitHook("addHandler","keyboard",d.Map.Keyboard);d.Handler.MarkerDrag=d.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new d.Draggable(a,a));this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);this._draggable.enable();d.DomUtil.addClass(this._marker._icon,
"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);this._draggable.disable();d.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,b=a._shadow,c=d.DomUtil.getPosition(a._icon),
e=a._map.layerPointToLatLng(c);b&&d.DomUtil.setPosition(b,c);a._latlng=e;a.fire("move",{latlng:e}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}});d.Control=d.Class.extend({options:{position:"topright"},initialize:function(a){d.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},
addTo:function(a){this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition();a=a._controlCorners[c];return d.DomUtil.addClass(b,"leaflet-control"),-1!==c.indexOf("bottom")?a.insertBefore(b,a.firstChild):a.appendChild(b),this},removeFrom:function(a){var b=this.getPosition();return a._controlCorners[b].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(a),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}});d.control=function(a){return new d.Control(a)};
d.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.removeFrom(this),this},_initControlPos:function(){function a(g,f){b[g+f]=d.DomUtil.create("div",c+g+" "+c+f,e)}var b=this._controlCorners={},c="leaflet-",e=this._controlContainer=d.DomUtil.create("div",c+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}});d.Control.Zoom=
d.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b=d.DomUtil.create("div","leaflet-control-zoom leaflet-bar");return this._map=a,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut,this),this._updateDisabled(),
a.on("zoomend zoomlevelschange",this._updateDisabled,this),b},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(a){this._map.zoomIn(a.shiftKey?3:1)},_zoomOut:function(a){this._map.zoomOut(a.shiftKey?3:1)},_createButton:function(a,b,c,e,f,n){c=d.DomUtil.create("a",c,e);c.innerHTML=a;c.href="#";c.title=b;a=d.DomEvent.stopPropagation;return d.DomEvent.on(c,"click",a).on(c,"mousedown",a).on(c,"dblclick",a).on(c,"click",d.DomEvent.preventDefault).on(c,"click",
f,n).on(c,"click",this._refocusOnMap,n),c},_updateDisabled:function(){var a=this._map;d.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");d.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMinZoom()&&d.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMaxZoom()&&d.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});d.Map.mergeOptions({zoomControl:!0});d.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new d.Control.Zoom,
this.addControl(this.zoomControl))});d.control.zoom=function(a){return new d.Control.Zoom(a)};d.Control.Attribution=d.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){d.setOptions(this,a);this._attributions={}},onAdd:function(a){this._container=d.DomUtil.create("div","leaflet-control-attribution");d.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&
this.addAttribution(a._layers[b].getAttribution());return a.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(a){a.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):void 0},removeAttribution:function(a){return a?
(this._attributions[a]&&(this._attributions[a]--,this._update()),this):void 0},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}},_onLayerAdd:function(a){a.layer.getAttribution&&this.addAttribution(a.layer.getAttribution())},_onLayerRemove:function(a){a.layer.getAttribution&&this.removeAttribution(a.layer.getAttribution())}});
d.Map.mergeOptions({attributionControl:!0});d.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new d.Control.Attribution).addTo(this))});d.control.attribution=function(a){return new d.Control.Attribution(a)};d.Control.Scale=d.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(a){this._map=a;var b=d.DomUtil.create("div","leaflet-control-scale"),c=this.options;return this._addScales(c,"leaflet-control-scale",
b),a.on(c.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=d.DomUtil.create("div",b+"-line",c));a.imperial&&(this._iScale=d.DomUtil.create("div",b+"-line",c))},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,a=6378137*Math.PI*Math.cos(b*Math.PI/180)*(a.getNorthEast().lng-a.getSouthWest().lng)/180,b=this._map.getSize(),
c=this.options,d=0;0<b.x&&(d=c.maxWidth/b.x*a);this._updateScales(c,d)},_updateScales:function(a,b){a.metric&&b&&this._updateMetric(b);a.imperial&&b&&this._updateImperial(b)},_updateMetric:function(a){var b=this._getRoundNum(a);this._mScale.style.width=this._getScaleWidth(b/a)+"px";this._mScale.innerHTML=1E3>b?b+" m":b/1E3+" km"},_updateImperial:function(a){var b,c,d;a*=3.2808399;var e=this._iScale;5280<a?(b=a/5280,c=this._getRoundNum(b),e.style.width=this._getScaleWidth(c/b)+"px",e.innerHTML=c+" mi"):
(d=this._getRoundNum(a),e.style.width=this._getScaleWidth(d/a)+"px",e.innerHTML=d+" ft")},_getScaleWidth:function(a){return Math.round(this.options.maxWidth*a)-10},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return a=10<=a?10:5<=a?5:3<=a?3:2<=a?2:1,b*a}});d.control.scale=function(a){return new d.Control.Scale(a)};d.Control.Layers=d.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(a,b,c){d.setOptions(this,c);this._layers=
{};this._lastZIndex=0;this._handlingClick=!1;for(var e in a)this._addLayer(a[e],e);for(e in b)this._addLayer(b[e],e,!0)},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._update(),this},addOverlay:function(a,b){return this._addLayer(a,
b,!0),this._update(),this},removeLayer:function(a){a=d.stamp(a);return delete this._layers[a],this._update(),this},_initLayout:function(){var a=this._container=d.DomUtil.create("div","leaflet-control-layers");a.setAttribute("aria-haspopup",!0);d.Browser.touch?d.DomEvent.on(a,"click",d.DomEvent.stopPropagation):d.DomEvent.disableClickPropagation(a).disableScrollPropagation(a);var b=this._form=d.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){d.Browser.android||d.DomEvent.on(a,
"mouseover",this._expand,this).on(a,"mouseout",this._collapse,this);var c=this._layersLink=d.DomUtil.create("a","leaflet-control-layers-toggle",a);c.href="#";c.title="Layers";d.Browser.touch?d.DomEvent.on(c,"click",d.DomEvent.stop).on(c,"click",this._expand,this):d.DomEvent.on(c,"focus",this._expand,this);d.DomEvent.on(b,"click",function(){setTimeout(d.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=d.DomUtil.create("div",
"leaflet-control-layers-base",b);this._separator=d.DomUtil.create("div","leaflet-control-layers-separator",b);this._overlaysList=d.DomUtil.create("div","leaflet-control-layers-overlays",b);a.appendChild(b)},_addLayer:function(a,b,c){var e=d.stamp(a);this._layers[e]={layer:a,name:b,overlay:c};this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";var a,b,c=!1,
d=!1;for(a in this._layers)b=this._layers[a],this._addItem(b),d=d||b.overlay,c=c||!b.overlay;this._separator.style.display=d&&c?"":"none"}},_onLayerChange:function(a){var b=this._layers[d.stamp(a.layer)];b&&(this._handlingClick||this._update(),(a=b.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null)&&this._map.fire(a,b))},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';c&&(d+=' checked="checked"');
var d=d+"/>",e=b.createElement("div");return e.innerHTML=d,e.firstChild},_addItem:function(a){var c,e=b.createElement("label"),f=this._map.hasLayer(a.layer);a.overlay?(c=b.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=f):c=this._createRadioElement("leaflet-base-layers",f);c.layerId=d.stamp(a.layer);d.DomEvent.on(c,"click",this._onInputClick,this);f=b.createElement("span");f.innerHTML=" "+a.name;e.appendChild(c);e.appendChild(f);return(a.overlay?
this._overlaysList:this._baseLayersList).appendChild(e),e},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),e=d.length;this._handlingClick=!0;for(a=0;e>a;a++)b=d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=
this._container.className.replace(" leaflet-control-layers-expanded","")}});d.control.layers=function(a,b,c){return new d.Control.Layers(a,b,c)};d.PosAnimation=d.Class.extend({includes:d.Mixin.Events,run:function(a,b,c,e){this.stop();this._el=a;this._inProgress=!0;this._newPos=b;this.fire("start");a.style[d.DomUtil.TRANSITION]="all "+(c||0.25)+"s cubic-bezier(0,0,"+(e||0.5)+",1)";d.DomEvent.on(a,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this);d.DomUtil.setPosition(a,b);d.Util.falseFn(a.offsetWidth);
this._stepTimer=setInterval(d.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(d.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),d.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var a=this._getPos();return a?(this._el._leaflet_pos=a,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var b,c,e=a.getComputedStyle(this._el);if(d.Browser.any3d){if(c=e[d.DomUtil.TRANSFORM].match(this._transformRe),
!c)return;b=parseFloat(c[1]);c=parseFloat(c[2])}else b=parseFloat(e.left),c=parseFloat(e.top);return new d.Point(b,c,!0)},_onTransitionEnd:function(){d.DomEvent.off(this._el,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this);this._inProgress&&(this._inProgress=!1,this._el.style[d.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}});d.Map.include({setView:function(a,b,e){if(b=b===c?this._zoom:this._limitZoom(b),a=this._limitCenter(d.latLng(a),
b,this.options.maxBounds),e=e||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!e.reset&&!0!==e)if(e.animate!==c&&(e.zoom=d.extend({animate:e.animate},e.zoom),e.pan=d.extend({animate:e.animate},e.pan)),this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,e.zoom):this._tryAnimatedPan(a,e.pan))return clearTimeout(this._sizeTimer),this;return this._resetView(a,b),this},panBy:function(a,b){if(a=d.point(a).round(),b=b||{},!a.x&&!a.y)return this;if(this._panAnim||(this._panAnim=new d.PosAnimation,
this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){d.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a);this._panAnim.run(this._mapPane,c,b.duration||0.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){d.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");
this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return!0===(b&&b.animate)||this.getSize().contains(c)?(this.panBy(c,b),!0):!1}});d.PosAnimation=d.DomUtil.TRANSITION?d.PosAnimation:d.PosAnimation.extend({run:function(a,b,c,e){this.stop();this._el=a;this._inProgress=!0;this._duration=c||0.25;this._easeOutPower=1/Math.max(e||0.5,0.2);this._startPos=d.DomUtil.getPosition(a);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");
this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=d.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(){var a=+new Date-this._startTime,b=1E3*this._duration;b>a?this._runFrame(this._easeOut(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){a=this._startPos.add(this._offset.multiplyBy(a));d.DomUtil.setPosition(this._el,a);this.fire("step")},_complete:function(){d.Util.cancelAnimFrame(this._animId);
this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});d.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});d.DomUtil.TRANSITION&&d.Map.addInitHook(function(){(this._zoomAnimated=this.options.zoomAnimation&&d.DomUtil.TRANSITION&&d.Browser.any3d&&!d.Browser.android23&&!d.Browser.mobileOpera)&&d.DomEvent.on(this._mapPane,d.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)});d.Map.include(d.DomUtil.TRANSITION?{_catchTransitionEnd:function(a){this._animatingZoom&&
0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),e=this._getCenterOffset(a)._divideBy(1-1/d),f=this._getCenterLayerPoint()._add(e);return!0===
c.animate||this.getSize().contains(e)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(a,b,f,d,null,!0),!0):!1},_animateZoom:function(a,b,c,e,f,n){this._animatingZoom=!0;d.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim");this._animateToCenter=a;this._animateToZoom=b;d.Draggable&&(d.Draggable._disabled=!0);this.fire("zoomanim",{center:a,zoom:b,origin:c,scale:e,delta:f,backwards:n})},_onZoomTransitionEnd:function(){this._animatingZoom=!1;d.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim");
this._resetView(this._animateToCenter,this._animateToZoom,!0,!0);d.Draggable&&(d.Draggable._disabled=!1)}}:{});d.TileLayer.include({_animateZoom:function(a){this._animating||(this._animating=!0,this._prepareBgBuffer());var b=this._bgBuffer,c=d.DomUtil.TRANSFORM,e=a.delta?d.DomUtil.getTranslateString(a.delta):b.style[c],f=d.DomUtil.getScaleString(a.scale,a.origin);b.style[c]=a.backwards?f+" "+e:e+" "+f},_endZoomAnim:function(){var a=this._tileContainer,b=this._bgBuffer;a.style.visibility="";a.parentNode.appendChild(a);
d.Util.falseFn(b.offsetWidth);this._animating=!1},_clearBgBuffer:function(){var a=this._map;!a||a._animatingZoom||a.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[d.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var a=this._tileContainer,b=this._bgBuffer,c=this._getLoadedTilesPercentage(b),e=this._getLoadedTilesPercentage(a);return b&&0.5<c&&0.5>e?(a.style.visibility="hidden",void this._stopLoadingImages(a)):(b.style.visibility="hidden",b.style[d.DomUtil.TRANSFORM]="",
this._tileContainer=b,b=this._bgBuffer=a,this._stopLoadingImages(b),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(a){var b,c=a.getElementsByTagName("img"),d=0;a=0;for(b=c.length;b>a;a++)c[a].complete&&d++;return d/b},_stopLoadingImages:function(a){var b,c,e=Array.prototype.slice.call(a.getElementsByTagName("img"));a=0;for(b=e.length;b>a;a++)c=e[a],c.complete||(c.onload=d.Util.falseFn,c.onerror=d.Util.falseFn,c.src=d.Util.emptyImageUrl,c.parentNode.removeChild(c))}});
d.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1E4,maximumAge:0,enableHighAccuracy:!1},locate:function(a){if(a=this._locateOptions=d.extend(this._defaultLocateOptions,a),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=d.bind(this._handleGeolocationResponse,this),c=d.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,
c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code;a=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,
c=a.coords.longitude,e=new d.LatLng(b,c),f=180*a.coords.accuracy/40075017,n=f/Math.cos(d.LatLng.DEG_TO_RAD*b),b=d.latLngBounds([b-f,c-n],[b+f,c+n]),c=this._locateOptions;c.setView&&(c=Math.min(this.getBoundsZoom(b),c.maxZoom),this.setView(e,c));var e={latlng:e,bounds:b,timestamp:a.timestamp},p;for(p in a.coords)"number"==typeof a.coords[p]&&(e[p]=a.coords[p]);this.fire("locationfound",e)}})}(window,document);function InputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)}InputStream.prototype.seek=function(a){this.offset=a};
InputStream.prototype.getBytes=function(a){var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};InputStream.prototype.getVarints=function(){var a,b=0,c=0;do a=this.buffer[this.offset++],b|=(a&127)<<c,c+=7;while(a&128);return b};InputStream.prototype.getUint8=function(){return this.buffer[this.offset++]};InputStream.prototype.getUint16=function(){this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};
InputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};InputStream.prototype.getInt32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};InputStream.prototype.getUint32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
InputStream.prototype.getFloat32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};InputStream.prototype.getFloat64=function(){for(var a=this.buffer,b=this.convUint8,c=this.offset,e=0;8>e;e++)b[e]=a[c+e];this.offset+=8;return this.convFloat64[0]};InputStream.prototype.getString=function(a){for(var b=this.buffer,c="",e=this.offset,d=this.offset+a;e<d;e++)c+=String.fromCharCode(b[e]);this.offset+=a;return decodeURIComponent(escape(c))};
InputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};VBUtils={deduceUVRepetition:function(a){for(var b in a.vblayout)if(0==b.indexOf("uv"))for(var c=a.vbstride,e=a.vb,d=a.vb.length/c,f=0,g=a.vblayout[b].offset;f<d;f++,g+=c){var h=e[g],k=e[g+1];if(2<h||0>h||2<k||0>k){a.vblayout[b].isPattern=!0;break}}},computeBounds3D:function(a){var b=Infinity,c=Infinity,e=Infinity,d=-Infinity,f=-Infinity,g=-Infinity,h,k,l,m,n,p=a.vbstride,q=a.vblayout.position.offset,s=a.vb,t=a.vb.length/p;h=0;for(k=q;h<t;h++,k+=p)l=s[k],m=s[k+1],n=s[k+2],b>l&&(b=l),c>m&&(c=m),e>n&&
(e=n),d<l&&(d=l),f<m&&(f=m),g<n&&(g=n);h=a.boundingBox=new THREE.Box3;h.min.set(b,c,e);h.max.set(d,f,g);b=0.5*(b+d);c=0.5*(c+f);e=0.5*(e+g);a=a.boundingSphere=new THREE.Sphere;a.center.set(b,c,e);h=g=0;for(k=q;h<t;h++,k+=p)l=s[k],m=s[k+1],n=s[k+2],q=l-b,m-=c,n-=e,n=q*q+m*m+n*n,n>g&&(g=n);a.radius=Math.sqrt(g)},computeBounds2D:function(a){if(!a.boundingBox){var b=Infinity,c=Infinity,e=-Infinity,d=-Infinity,f,g,h,k,l=a.vbstride;g=a.vblayout.position.offset;var m=a.vb,n=a.vb.length/l;f=0;for(k=g;f<n;f++,
k+=l)g=m[k],h=m[k+1],b>g&&(b=g),c>h&&(c=h),e<g&&(e=g),d<h&&(d=h);f=a.boundingBox=new THREE.Box3;l=Math.max(e-b,d-c);f.min.set(b,c,0.001*-l);f.max.set(e,d,0.001*l)}b=a.boundingSphere=new THREE.Sphere;b.center.copy(a.boundingBox.center());b.radius=0.5*a.boundingBox.size().length()}};var VBB_LINE_SEGMENT=16,VBB_ARC_CIRCULAR=32,VBB_ARC_ELLIPTICAL=48,VBB_TEX_QUAD=64,VBB_SEG_START_RIGHT=1,VBB_SEG_START_LEFT=2,VBB_SEG_END_RIGHT=3,VBB_SEG_END_LEFT=4,TAU=2*Math.PI;function VertexBufferBuilder(){this.stride=8;this.vb=new ArrayBuffer(262144*this.stride);this.vbf=new Float32Array(this.vb);this.vbi=new Int32Array(this.vb);this.vcount=0;this.ib=new Uint16Array(65536);this.icount=0;this.minx=this.miny=Infinity;this.maxx=this.maxy=-Infinity}
VertexBufferBuilder.prototype.expandStride=function(){var a=this.stride;if(!(8<a)){for(var b=this.stride+4,c=new ArrayBuffer(this.vb.byteLength/a*b),e=new Uint8Array(this.vb),d=new Uint8Array(c),f=0,g=this.vcount;f<g;f++)for(var h=f*a*4,k=f*b*4,l=0;l<4*a;l++)d[k+l]=e[h+l];this.vb=c;this.vbf=new Float32Array(c);this.vbi=new Int32Array(c);this.stride=b}};
VertexBufferBuilder.prototype.addVertex=function(a,b,c,e,d,f,g,h){var k=this.vcount,l=k*this.stride,m=this.vbf;m[l]=a;m[l+1]=b;m[l+2]=c;m[l+3]=e;m[l+4]=d;this.vbi[l+5]=f;this.vbi[l+6]=g;this.vbi[l+7]=0|h<<16;this.vcount++;return k};VertexBufferBuilder.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a);a>this.maxx&&(this.maxx=a);b<this.miny&&(this.miny=b);b>this.maxy&&(this.maxy=b)};
VertexBufferBuilder.prototype.addVertexLine=function(a,b,c,e,d,f,g,h,k,l){var m=this.vcount,n=m*this.stride,p=this.vbf;void 0===l&&(l=VBB_LINE_SEGMENT);p[n]=a;p[n+1]=b;p[n+2]=c;p[n+3]=e;p[n+4]=d;this.vbi[n+5]=f;this.vbi[n+6]=g;this.vbi[n+7]=l|k|h<<16;this.vcount++;return m};
VertexBufferBuilder.prototype.addVertexArc=function(a,b,c,e,d,f,g,h,k,l,m,n){var p=this.vcount,q=p*this.stride,s=this.vbf,t=d==f?VBB_ARC_CIRCULAR:VBB_ARC_ELLIPTICAL;s[q]=a;s[q+1]=b;s[q+2]=c;s[q+3]=e;s[q+4]=h;this.vbi[q+5]=k;this.vbi[q+6]=l;this.vbi[q+7]=t|n|m<<16;s[q+8]=d;s[q+9]=f;s[q+10]=g;s[q+11]=0;this.vcount++;return p};VertexBufferBuilder.prototype.addVertexPolytriangle=function(a,b,c,e,d,f,g,h){this.addVertex(a,b,c,e,d,f,g,h);this.addToBounds(a,b)};
VertexBufferBuilder.prototype.setVertexColor=function(a,b){this.vbi[a*this.stride+5]=b};VertexBufferBuilder.prototype.addTriangle=function(a,b,c){var e=this.ib,d=this.icount;if(d+3>=e.length){for(var f=new Uint16Array(2*e.length),g=0;g<d;g++)f[g]=e[g];this.ib=e=f}e[d]=a;e[d+1]=b;e[d+2]=c;this.icount+=3};
VertexBufferBuilder.prototype.addSegment=function(a,b,c,e,d,f,g,h){var k=c-a,l=e-b,m=0;if(k||l)m=Math.atan2(l,k);var n=Math.sqrt(k*k+l*l);d*=0.5;var k=this.addVertexLine(a,b,m,n,d,f,g,h,VBB_SEG_START_RIGHT),l=this.addVertexLine(a,b,m,n,d,f,g,h,VBB_SEG_END_RIGHT),p=this.addVertexLine(a,b,m,n,d,f,g,h,VBB_SEG_END_LEFT);d=this.addVertexLine(a,b,m,n,d,f,g,h,VBB_SEG_START_LEFT);this.addTriangle(k,l,p);this.addTriangle(k,p,d);this.addToBounds(a,b);this.addToBounds(c,e)};
VertexBufferBuilder.prototype.addCircularArc=function(a,b,c,e,d,f,g,h,k){this.expandStride();var l=Math.abs(c-e);if(1E-4<l&&1E-4<Math.abs(l-TAU)){var l=a+d*Math.cos(c),m=b+d*Math.sin(c);this.addSegment(l,m,l,m,f,g,h,k);l=a+d*Math.cos(e);m=b+d*Math.sin(e);this.addSegment(l,m,l,m,f,g,h,k)}else this.addToBounds(a-d,b-d),this.addToBounds(a+d,b+d);f*=0.5;var l=this.addVertexArc(a,b,c,e,d,d,0,f,g,h,k,VBB_SEG_START_RIGHT),m=this.addVertexArc(a,b,c,e,d,d,0,f,g,h,k,VBB_SEG_END_RIGHT),n=this.addVertexArc(a,
b,c,e,d,d,0,f,g,h,k,VBB_SEG_END_LEFT);a=this.addVertexArc(a,b,c,e,d,d,0,f,g,h,k,VBB_SEG_START_LEFT);this.addTriangle(l,m,n);this.addTriangle(l,n,a)};
VertexBufferBuilder.prototype.addEllipticalArc=function(a,b,c,e,d,f,g,h,k,l,m){this.expandStride();var n=Math.abs(c-e);if(1E-4<Math.abs(n-TAU)){var n=a+d*Math.cos(c),p=b+f*Math.sin(c);this.addSegment(n,p,n,p,h,k,l,m);n=a+d*Math.cos(e);p=b+f*Math.sin(e);this.addSegment(n,p,n,p,h,k,l,m)}else this.addToBounds(a-d,b-f),this.addToBounds(a+d,b+f);h*=0.5;var n=this.addVertexArc(a,b,c,e,d,f,g,h,k,l,m,VBB_SEG_START_RIGHT),p=this.addVertexArc(a,b,c,e,d,f,g,h,k,l,m,VBB_SEG_END_RIGHT),q=this.addVertexArc(a,b,
c,e,d,f,g,h,k,l,m,VBB_SEG_END_LEFT);a=this.addVertexArc(a,b,c,e,d,f,g,h,k,l,m,VBB_SEG_START_LEFT);this.addTriangle(n,p,q);this.addTriangle(n,q,a)};
VertexBufferBuilder.prototype.addTexturedQuad=function(a,b,c,e,d,f){var g=0.5*e,h=this.addVertexLine(a,b+g,0,c,-g,4278255615,d,f,VBB_SEG_START_RIGHT,VBB_TEX_QUAD),k=this.addVertexLine(a,b+g,0,c,-g,4278255615,d,f,VBB_SEG_END_RIGHT,VBB_TEX_QUAD),l=this.addVertexLine(a,b+g,0,c,-g,4278255615,d,f,VBB_SEG_END_LEFT,VBB_TEX_QUAD);d=this.addVertexLine(a,b+g,0,c,-g,4278255615,d,f,VBB_SEG_START_LEFT,VBB_TEX_QUAD);this.addTriangle(h,k,l);this.addTriangle(h,l,d);this.addToBounds(a,b);this.addToBounds(a+c,b+e)};
VertexBufferBuilder.prototype.isFull=function(a){a||(a=3);return 32767<=this.vcount+a};
VertexBufferBuilder.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4));a.vbstride=this.stride;a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.vblayout={position:{offset:0,itemSize:3,bytesPerItem:4},uv:{offset:3,itemSize:2,bytesPerItem:4},color4b:{offset:5,itemSize:4,bytesPerItem:1,normalize:!0},dbId4b:{offset:6,itemSize:4,bytesPerItem:1,normalize:!0},flags4b:{offset:7,itemSize:4,bytesPerItem:1,normalize:!1}};8<this.stride&&(a.vblayout.extraParams=
{offset:8,itemSize:4,bytesPerItem:4,normalize:!1});var b=a.boundingBox=new THREE.Box3,c=Math.max(this.maxx-this.minx,this.maxy-this.miny);b.min.set(this.minx,this.miny,0.001*-c);b.max.set(this.maxx,this.maxy,0.001*c);VBUtils.computeBounds2D(a);return a};function readOpenCTM_RAW(a,b){var c=a.getString(4);if("INDX"!=c)return null;for(var e=b.vertexCount,d=b.triangleCount,f=b.indices=new Uint16Array(3*d),c=0,d=3*d;c<d;c++)f[c]=a.getInt32();c=a.getString(4);if("VERT"!=c)return null;for(var f=b.vbstride,d=b.vb,c=0,g=b.vblayout.position.offset;c<e;c++,g+=f)d[g]=a.getFloat32(),d[g+1]=a.getFloat32(),d[g+2]=a.getFloat32();if(b.flags&1){c=a.getString(4);if("NORM"!=c)return null;c=0;for(g=b.vblayout.normal.offset;c<e;c++,g+=f)d[g]=a.getFloat32(),d[g+1]=a.getFloat32(),
d[g+2]=a.getFloat32()}for(var h=0;h<b.texMapCount;h++){c=a.getString(4);if("TEXC"!=c)return null;c={name:a.getString(a.getInt32()),file:a.getString(a.getInt32())};b.uvs.push(c);g="uv";h&&(g+=(h+1).toString());c=0;for(g=b.vblayout[g].offset;c<e;c++,g+=f)d[g]=a.getFloat32(),d[g+1]=a.getFloat32()}for(h=0;h<b.attribMapCount;h++){c=a.getString(4);if("ATTR"!=c)return null;c={name:a.getString(a.getInt32())};if(-1!=c.name.indexOf("Color"))for(c=0,g=b.vblayout.color.offset;c<e;c++,g+=f)d[g]=a.getFloat32(),
d[g+1]=a.getFloat32(),d[g+2]=a.getFloat32(),a.getFloat32();else b.attrs.push(c),a.getBytes(16*e)}}
var readOpenCTM=function(a){if("OCTM"!=a.getString(4)||5!=a.getInt32())return null;var b=a.getString(3);a.getUint8();var c={stream:null,vertices:null,indices:null,normals:null,colors:null,uvs:[],attrs:[]};c.vertexCount=a.getInt32();c.triangleCount=a.getInt32();c.texMapCount=a.getInt32();c.attribMapCount=a.getInt32();c.flags=a.getInt32();c.comment=a.getString(a.getInt32());c.vbstride=3;c.flags&1&&(c.vbstride+=3);c.vbstride+=2*(c.texMapCount||0);0<c.attribMapCount&&(c.vbstride+=3);c.vblayout={};var e=
0;c.vblayout.position={offset:e,itemSize:3};e+=3;c.flags&1&&(c.vblayout.normal={offset:e,itemSize:3},e+=3);if(c.texMapCount)for(var d=0;d<c.texMapCount;d++){var f="uv";d&&(f+=(d+1).toString());c.vblayout[f]={offset:e,itemSize:2};e+=2}c.attribMapCount&&(c.vblayout.color={offset:e,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);return"RAW"==b?(readOpenCTM_RAW(a,c),VBUtils.deduceUVRepetition(c),VBUtils.computeBounds3D(c),c):"MG2"==b?(readOpenCTM_MG2(a,c),VBUtils.deduceUVRepetition(c),VBUtils.computeBounds3D(c),
c):null},readLines=function(a,b){var c={isLines:!0,vertices:null,indices:null,colors:null,normals:null,uvs:[],attrs:[]},e,d;1<b.version?(c.vertexCount=a.readU16(),e=a.readU16(),d=a.readU16()):(c.vertexCount=a.readU32V(),e=a.readU32V(),d=a.readU32V());var f=0!=a.stream.getUint8();c.vbstride=3;f&&(c.vbstride+=3);c.vblayout={};var g=0;c.vblayout.position={offset:g,itemSize:3};f&&(c.vblayout.color={offset:g+3,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);for(var h=c.vb,k=c.vbstride,l=a.stream,
m=0,g=c.vblayout.position.offset,n=c.vertexCount;m<n;m++,g+=k)h[g]=l.getFloat32(),h[g+1]=l.getFloat32(),h[g+2]=l.getFloat32();if(f)for(m=0,g=c.vblayout.color.offset,f=c.vertexCount;m<f;m++,g+=k)h[g]=l.getFloat32(),h[g+1]=l.getFloat32(),h[g+2]=l.getFloat32(),l.getFloat32();m=function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.length)};1<b.version?(e=new Uint16Array(m(l.getBytes(2*e))),l=new Uint16Array(m(l.getBytes(2*d)))):(e=new Int32Array(m(l.getBytes(4*e))),l=new Int32Array(m(l.getBytes(4*
d))));c.indices=new Uint16Array(2*(l[d-1]-d+1));for(m=g=0;m+1<d;m++)for(h=l[m];h+1<l[m+1];h++)c.indices[g++]=e[h],c.indices[g++]=e[h+1];VBUtils.computeBounds3D(c);return c};function readGeometry(a,b,c){return(b=a.seekToEntry(b))?"Autodesk.CloudPlatform.OpenCTM"==b.entryType?readOpenCTM(a.stream):"Autodesk.CloudPlatform.Lines"==b.entryType?readLines(a,b):null:null};function convertMaterials(a){var b=function(a,b){var c=new THREE.Color;if(!a||!a.colors)return c.setRGB(1,0,0);var d=a.colors[b];if(!d)return c.setRGB(0,0,0);d=d.values;if(!d||!d.length)return c.setRGB(1,0,0);d=d[0];return c.setRGB(d.r,d.g,d.b)},c=function(a,b){if(!a||!a.scalars)return 0;var c=a.scalars[b];return c?c.values[0]:void 0},e=function(a,b){if(!a||!a.booleans)return 0;var c=a.booleans;return c?c[b]:void 0},d=a.materials.materials;a.simplemats={};for(var f in d){var g=d[f],h=g.materials,
k=h[g.userassets[0]];if(k&&"SimplePhong"==k.definition){var g=k.properties,l={};l.ambient=b(g,"generic_ambient");l.color=b(g,"generic_diffuse");l.specular=b(g,"generic_specular");l.emissive=b(g,"generic_emissive");var m=c(g,"generic_glossiness");m||(m=30);l.shininess=m;(m=c(g,"generic_transparency"))||(m=0);l.opacity=1-m;(m=c(g,"generic_reflectivity_at_0deg"))||(m=0);l.reflectivity=m;m=e(g,"generic_is_metal");void 0!==m&&(l.metal=m);m=e(g,"generic_backface_cull");void 0!==m&&(l.doubleSided=!m);l.transparent=
k.transparent;var k=k.textures,n;for(n in k){var m=h[k[n].connections[0]].properties,p=m.uris.unifiedbitmap_Bitmap.values[0],q=null;if(p)if("generic_diffuse"==n){if(q="map",!l.color||0==l.color.r&&0==l.color.g&&0==l.color.b)l.color=new THREE.Color(1,1,1)}else"generic_bump"==n?(q=e(g,"generic_bump_is_normal")?"normalMap":"bumpMap",l.bumpScale=c(g,"generic_bump_amount")):"generic_specular"==n?q="specularMap":"generic_reflection"!=n&&"generic_alpha"==n&&(q="opacityMap");q&&(l["uri_"+q]=p,(p=c(m,"texture_UScale"))&&
(l["uscale_"+q]=p),(p=c(m,"texture_VScale"))&&(l["vscale_"+q]=p))}a.simplemats[f]=l}}};function readLightDefinition(a,b){var c=a.seekToEntry(b);if(!c||1<c.version)return null;c=a.stream;return{position:a.readVector3f(),dir:a.readVector3f(),r:c.getFloat32(),g:c.getFloat32(),b:c.getFloat32(),intensity:c.getFloat32(),spotAngle:c.getFloat32(),size:c.getFloat32(),type:c.getUint8()}};function readCameraDefinition(a,b){var c=a.seekToEntry(b.definition);if(!c||2<c.version)return null;var e=a.stream,d={isPerspective:!e.getUint8(),position:a.readVector3f(),target:a.readVector3f(),up:a.readVector3f(),aspect:e.getFloat32(),fov:THREE.Math.radToDeg(e.getFloat32())};2>c.version&&(e.getFloat32(),e.getFloat32());d.orthoScale=e.getFloat32();d.inst=b;return d};function FragList(){this.numLoaded=this.length=0;this.mesh2frag=this.fragId2dbId=this.entityIndexes=this.packIds=this.materials=this.transforms=this.boxes=null}
function readGeometryMetadata(a,b){var c=a.getEntryCounts(),e=a.stream;b.length=c;for(var d=b.fragTypes=new Uint8Array(c),f=b.primCounts=new Uint16Array(c),g=b.packIds=new Int32Array(c),h=b.entityIndexes=new Int32Array(c),k=0;k<c&&a.seekToEntry(k);k++)d[k]=e.getUint8(),e.seek(e.offset+24),f[k]=e.getUint16(),g[k]=parseInt(a.readString()),h[k]=a.readU32V()}
function readFragments(a,b){function c(a){a*=6;for(var b=0;6>b;b++)g[a++]=f.getFloat32()}function e(a,b,c){a*=6;for(var d=0;6>d;d++)g[a++]=f.getFloat32()+b[c+d%3]}var d=a.getEntryCounts(),f=a.stream;b.length=d;b.numLoaded=0;for(var g=b.boxes=new Float32Array(6*d),h=b.transforms=new Float32Array(16*d),k=b.materials=new Int32Array(d),l=b.packIds=new Int32Array(d),m=b.entityIndexes=new Int32Array(d),n=b.geomDataIndexes=new Int32Array(d),d=b.fragId2dbId=new Int32Array(d),p=0,q=b.length;p<q;p++){var s=
a.seekToEntry(p);if(!s)break;if(5<s.version)break;4<s.version&&a.readU8();k[p]=a.readU32V();2<s.version?n[p]=a.readU32V():(l[p]=parseInt(a.readString()),m[p]=a.readU32V());a.readTransform(p,h,16*p);3<s.version?e(p,h,16*p+12):c(p);1<s.version&&(d[p]=a.readU32V())}}
function filterFragments(a,b){a.length=b.length;a.numLoaded=0;for(var c=a.length,e=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],d=new Float32Array(6*c),f=new Float32Array(16*c),g=new Int32Array(c),h=new Int32Array(c),c=new Int32Array(c),k={},l=0;l<b.length;++l){for(var m=b[l],n=6*m,p=6*l,q=0;6>q;++q)d[p++]=a.boxes[n++];n=16*m;p=16*l;for(q=0;16>q;++q)f[p++]=a.transforms[n++];g[l]=a.materials[m];h[l]=a.packIds[m];c[l]=a.entityIndexes[m];q=a.packIds[m]+":"+a.entityIndexes[m];m=k[q];void 0==
m?k[q]=l:Array.isArray(m)?m.push(l):k[q]=[m,l];m=6*l;for(q=0;3>q;++q)d[m+q]<e[q]&&(e[q]=d[m+q]);for(q=3;6>q;++q)d[m+q]>e[q]&&(e[q]=d[m+q])}a.boxes=d;a.transforms=f;a.materials=g;a.packIds=h;a.entityIndexes=c;a.mesh2frag=k;return e};function readInstance(a,b){var c=a.seekToEntry(b);if(!c||2<c.version)return null;1<c.version&&a.readU8();return{definition:a.stream.getUint32(),transform:a.readTransform(),instanceNodePath:a.readPathID()}};function Package(){this.fragments=this.metadata=this.simplemats=this.materials=this.manifest=null;this.geompacks=[];this.instances=[];this.cameras=[];this.lights=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[]};this.bbox=null;this.pendingRequests=0}
Package.prototype.loadAsyncResource=function(a,b,c,e){function d(b){f.pendingRequests--;this.response&&(b=new Uint8Array(this.response),31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress()),e(b));0==f.pendingRequests&&f.postLoad(a)}if(c)e(c);else{var f=this;this.pendingRequests++;(new Xhr(a.errorHandler,a.auth,a.viewing_url)).get(a.basePath+b,a.headers,"arraybuffer",d,"",a.queryParams)}};
Package.prototype.load=function(a,b){var c=this,e=new Zlib.Unzip(b),d=e.decompress("manifest.json");if(!d)return!1;var f=new InputStream(d),g=JSON.parse(f.getString(d.byteLength)),d=e.decompress("metadata.json"),f=new InputStream(d);3<d.byteLength&&0!==d[3]&&(this.metadata=JSON.parse(f.getString(d.byteLength)).metadata)&&(f=this.metadata["world bounding box"],this.bbox=new THREE.Box3({x:f.minXYZ[0],y:f.minXYZ[1],z:f.minXYZ[2]},{x:f.maxXYZ[0],y:f.maxXYZ[1],z:f.maxXYZ[2]}));this.manifest=g;for(var h=
g.typesets,f={},d=0;d<h.length;d++){var k=h[d];f[k.id]=k.types}g=g.assets;for(d=0;d<g.length;d++){k=g[d];h=k.type;0==h.indexOf("Autodesk.CloudPlatform.")&&(h=h.substr(23));var l=k.URI,m=k.typeset?f[k.typeset]:null;0!=l.indexOf("embed:/")&&("PackFile"==h?"Autodesk.CloudPlatform.Geometry"==(m?m[0]["class"]:null)&&this.geompacks.push({id:k.id,uri:l}):"PropertyAttributes"==h?this.propertydb.attrs.push(l):"PropertyAVs"==h?this.propertydb.avs.push(l):"PropertyIDs"==h?this.propertydb.ids.push(l):"PropertyOffsets"==
h?this.propertydb.offsets.push(l):"PropertyValues"==h&&this.propertydb.values.push(l));var k=k.URI,n;0==k.indexOf("embed:/")&&(k=k.substr(7),n=e.decompress(k));"ProteinMaterials"==h?-1==k.indexOf("Protein")?this.loadAsyncResource(a,k,n,function(a){var b=new InputStream(a);a=a.byteLength;0<a?(c.materials=JSON.parse(b.getString(a)),convertMaterials(c)):c.materials=null}):this.loadAsyncResource(a,k,n,function(a){var b=new InputStream(a);a=a.byteLength;c.proteinMaterials=0<a?JSON.parse(b.getString(a)):
null}):"FragmentList"==h?this.loadAsyncResource(a,k,n,function(a){a=new PackFileReader(a);var b=c.fragments=new FragList;readFragments(a,b)}):"GeometryMetadataList"==h?this.loadAsyncResource(a,k,n,function(a){a=new PackFileReader(a);c.geomMetadata={};readGeometryMetadata(a,c.geomMetadata)}):"PackFile"==h&&(-1!=k.indexOf("CameraDefinitions.bin")?this.loadAsyncResource(a,k,n,function(a){c.camDefPack=new PackFileReader(a)}):-1!=k.indexOf("CameraList.bin")?this.loadAsyncResource(a,k,n,function(a){c.camInstPack=
new PackFileReader(a)}):-1!=k.indexOf("LightDefinitions.bin")?this.loadAsyncResource(a,k,n,function(a){c.lightDefPack=new PackFileReader(a)}):-1!=k.indexOf("LightList.bin")&&this.loadAsyncResource(a,k,n,function(a){c.lightInstPack=new PackFileReader(a)}))}0==this.pendingRequests&&this.postLoad(a)};
Package.prototype.postLoad=function(a){if(this.camDefPack&&this.camInstPack){for(var b=0,c=this.camInstPack.getEntryCounts();b<c;b++){var e=readInstance(this.camInstPack,b);this.cameras.push(readCameraDefinition(this.camDefPack,e))}delete this.camDefPack;delete this.camInstPack}if(this.lightDefPack&&this.lightInstPack){b=0;for(c=this.lightInstPack.getEntryCounts();b<c;b++)e=readInstance(this.lightInstPack,b),this.lights.push(readLightDefinition(this.lightDefPack,e.definition));delete this.lightInstPack;
delete this.lightDefPack}e=this.fragments;if(this.geomMetadata){for(var c=this.geomMetadata,b=0,d=e.length;b<d;b++){var f=e.geomDataIndexes[b];e.entityIndexes[b]=c.entityIndexes[f];e.packIds[b]=c.packIds[f]}delete this.geomMetadata}for(var f=e.mesh2frag={},c=e.packIds,g=e.entityIndexes,b=0,d=e.length;b<d;b++){var h=c[b]+":"+g[b],k=f[h];void 0===k?f[h]=b:Array.isArray(k)?k.push(b):f[h]=[k,b]}if(!this.bbox){c=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];d=e.boxes;f=0;for(e=e.length;f<
e;f++){g=6*f;for(b=0;3>b;b++)d[g+b]<c[b]&&(c[b]=d[g+b]);for(b=3;6>b;b++)d[g+b]>c[b]&&(c[b]=d[g+b])}this.bbox=new THREE.Box3(new THREE.Vector3(c[0],c[1],c[2]),new THREE.Vector3(c[3],c[4],c[5]))}f=a.objectIds;if(null!=f){c=[];e=[];for(b=0;b<f.length;++b)for(d=0;d<this.fragments.length;++d)this.fragments.fragId2dbId[d]==f[b]&&(c.push(this.fragments.packIds[d]),e.push(d));d=1;f=c.length;for(b=1;b<f;){for(;b<f&&c[b]==c[b-1];)++b;if(f==b)break;c[d++]=c[b++]}c.splice(d-1,f-d);f=[];for(b=0;b<this.geompacks.length;++b)for(d=
0;d<c.length;++d)parseInt(this.geompacks[b].id)==c[d]&&f.push(this.geompacks[b]);this.geompacks=f;b=filterFragments(this.fragments,e);this.bbox=new THREE.Box3(new THREE.Vector3(b[0],b[1],b[2]),new THREE.Vector3(b[3],b[4],b[5]))}a.loadDoneCB(!0)};function PackFileReader(a){31==a[0]&&139==a[1]&&(a=(new Zlib.Gunzip(a)).decompress());this.tempQuat=new THREE.Quaternion;this.tempTrans=new THREE.Vector3;this.tempScale=new THREE.Vector3;this.tempMat=new THREE.Matrix4;a=this.stream=new InputStream(a);var b=a.getInt32();this.type=a.getString(b);this.version=a.getInt32();this.types=null;this.entryOffsets=[];a.seek(a.byteLength-8);var c=a.getUint32();this.typesOffset=a.getUint32();a.seek(this.typesOffset);var e=this.readU32V();this.types=[];for(b=0;b<
e;++b)this.types.push({entryClass:this.readString(),entryType:this.readString(),version:this.readU32V()});a.seek(c);c=this.readU32V();e=this.entryOffsets;for(b=0;b<c;++b)e.push(a.getUint32());a.seek(0)}PackFileReader.prototype.readVarint=function(){var a,b=0,c=0;do a=this.stream.getUint8(),b|=(a&127)<<c,c+=7;while(a&128);return b};PackFileReader.prototype.readU32V=PackFileReader.prototype.readVarint;PackFileReader.prototype.readU16=function(){return this.stream.getUint16()};
PackFileReader.prototype.readU8=function(){return this.stream.getUint8()};PackFileReader.prototype.readString=function(){return this.stream.getString(this.readU32V())};PackFileReader.prototype.readVector3f=function(){var a=this.stream;return new THREE.Vector3(a.getFloat32(),a.getFloat32(),a.getFloat32())};
PackFileReader.prototype.readTransform=function(a,b,c){function e(a){a.set(g.getFloat32(),g.getFloat32(),g.getFloat32(),g.getFloat32())}function d(a){a.set(g.getFloat64(),g.getFloat64(),g.getFloat64())}function f(){m.identity();for(var a=0;3>a;++a)for(var b=0;3>b;++b)m.elements[4*a+b]=g.getFloat32()}var g=this.stream,h=this.tempTrans,k=this.tempQuat,l=this.tempScale,m=this.tempMat;switch(g.getUint8()){case 4:m.identity();break;case 0:d(h);m.makeTranslation(h.x,h.y,h.z);break;case 1:e(k);d(h);m.compose(h,
k,l.set(1,1,1));break;case 2:var n=g.getFloat32();e(k);d(h);m.compose(h,k,l.set(n,n,n));break;case 3:f(),d(h),m.setPosition(h)}if(void 0!==a)for(a=m.elements,h=0;16>h;h++)b[c++]=a[h];else return(new THREE.Matrix4).copy(m)};PackFileReader.prototype.getEntryCounts=function(){return this.entryOffsets.length};
PackFileReader.prototype.seekToEntry=function(a){var b=this.getEntryCounts();if(a>=b)return null;this.stream.seek(this.entryOffsets[a]);a=this.stream.getUint32();return a>=this.types.length?null:this.types[a]};
PackFileReader.prototype.readPathID=function(){var a=this.stream;if(2>this.version){var b=a.getUint16();if(!b)return null;a.getUint16();if(1==b)return"";for(var c=a.getUint16(),e=2;e<b;++e)c+="/"+a.getUint16()}else{b=this.readU32V();if(!b)return null;this.readU32V();if(1==b)return"";c=this.readU32V();for(e=2;e<b;++e)c+="/"+this.readU32V()}return c};function PropertyDatabase(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function c(a,b){for(var c=b,d="";c<a.length-1;){var e=a[c];if(44==e&&(10==a[c+1]||13==a[c+1]))break;if(10==e||13==e)break;d+=String.fromCharCode(e);c++}c=decodeURIComponent(escape(d));return JSON.parse(c)}function e(a,b){for(var c=0,d=0,e=a.length;d<e;d++)44==a[d]&&c++;c++;for(var e=new Uint32Array(c+(b?1:0)),d=0,g=a.length;91!=a[d]&&d<g;)d++;
if(d==a.length)return null;d++;for(var f=!1,h=c=0;d<g;){var k=a[d];48<=k&&57>=k?(h=10*h+(k-48),f=!0):44==k||93==k?f&&(e[c++]=h,f=!1,h=0):(f=!1,h=0);d++}return e}function d(a){for(var b=0,c=a.length-1,d=0;d<c;d++)44!=a[d]||10!=a[d+1]&&13!=a[d+1]||b++;if(!b)return null;b++;for(var e=new Uint32Array(b),b=d=0;91!=a[d]&&d<c;)d++;d++;e[b++]=d;for(var f=!1;d<c;)10==a[d]||13==a[d]?f=!0:f&&(f=!1,e[b++]=d),d++;return e}function f(a){var b=0<=a?Math.floor(a):Math.ceil(a);return{intPart:b,fracPart:a-b}}function g(a,
b,c){var d="";0===a&&(a=0);c&&0===a&&(d+="-");0===f(a).fracPart?d+=a:0<b?(a=a.toFixed(b),b=/^\-?([0-9]+)\.0+$/.exec(a),d=null!==b?d+b[1]:d+a):d+=a.toFixed(0);return d}var h,k,l,m,n,p,q,s,t,u,v,w,B;for(B in a.attrs){h=b(a.attrs[B]);for(var A=0;A<h.length;A++){var D=h[A][1];"__parent__"==D?t=A:"__child__"==D?s=A:"__name__"==D?u=A:"__instanceof__"==D?v=A:"__viewable_in__"==D&&(w=A)}break}for(B in a.avs){l=e(a.avs[B],0);delete a.avs;break}for(B in a.offsets){k=e(a.offsets[B],1);k[k.length-1]=l.length/
2;delete a.offsets;break}for(B in a.values){m=a.values[B];n=d(m);break}for(B in a.ids){p=a.ids[B];q=d(p);break}this.getObjectCount=function(){return k.length-1};this.getValueAt=function(a){return c(m,n[a])};this.getIntValueAt=function(a){var b=0;a=n[a];for(34==m[a]&&a++;a<m.length-1;){var c=m[a];if(44==c&&(10==m[a+1]||13==m[a+1]))break;if(10==c||13==c||34==c)break;48<=c&&57>=c&&(b+=10*b+(c-48));a++}return b};this.getIdAt=function(a){return c(p,q[a])};this.getObjectProperties=function(a){var b={dbId:a,
name:"",properties:[]},c=null,d=2*k[a+1];for(a=2*k[a];a<d;a+=2){var e=l[a];if(e==u)e=this.getValueAt(l[a+1]),b.name=e;else if(e==v)(e=this.getObjectProperties(this.getValueAt(l[a+1])))&&e.properties&&(c=e);else if(e!=t&&e!=s&&e!=w){var f=h[e];if(!((f[6]?f[6]:0)&1)){var g=f[5]?f[5]:f[0],e=this.getValueAt(l[a+1]);b.properties.push({displayName:g,displayValue:this.formatValueWithUnits(e,f[3],f[2])})}}}if(c){d={};e=b.properties;for(a=0;a<e.length;a++)d[e[a].displayName]=1;b.name||(b.name=c.name);c=c.properties;
for(a=0;a<c.length;a++)d.hasOwnProperty(c[a].displayName)||e.push(c[a])}return b};this.findRootNodes=function(){for(var a=[],b=1,c=k.length;b<c;b++){for(var d=!1,e=!1,f=!1,g=2*k[b+1],h=2*k[b];h<g;h+=2){var m=l[h];m==t?this.getIntValueAt(l[h+1])&&(e=!0):m==s?d=!0:m==u&&(f=!0)}d&&f&&!e&&a.push(b)}return a};this.getNodeNameAndChildren=function(a,b){for(var c=a.dbId,d=2*k[c+1],e,c=2*k[c];c<d;c+=2){var f=l[c];f!=t&&(f!=s||b?f==u?(f=this.getValueAt(l[c+1]),a.name=f):f==v&&(f={dbId:this.getValueAt(l[c+1]),
name:null},this.getNodeNameAndChildren(f,!0),f&&f.name&&!a.name&&(a.name=f.name)):(f=this.getValueAt(l[c+1]),f={dbId:f,parent:a},e?e.push(f):e=[f]))}return e};this.buildObjectTree=function(a,b,c,d){c>d[0]&&(d[0]=c);var e=this.getNodeNameAndChildren(a);if(e){for(var f=0;f<e.length;f++)this.buildObjectTree(e[f],b,c+1,d);for(f=0;f<e.length;f++)if(e[f].children||void 0!==e[f].fragIds)a.children?a.children.push(e[f]):a.children=[e[f]]}else b=b[a.dbId],void 0!==b&&(a.fragIds=b)};this.bruteForceSearch=function(a){a=
a.toLowerCase();for(var b=[],c=[],d=0,e=n.length;d<e;d++){var f=this.getValueAt(d);"string"==typeof f?-1!=f.toLowerCase().indexOf(a)&&c.push(d):-1!=f.toString().toLowerCase().indexOf(a)&&c.push(d)}a=1;for(e=k.length;a<e;a++)for(f=2*k[a+1],d=2*k[a];d<f;d+=2)if(-1!=c.indexOf(l[d+1])){b.push(a);break}return b};this.formatValueWithUnits=function(a,b,c){1==c?a=a?"Yes":"No":"ft"===b||"feet"===b||"foot"===b?a=this.formatFeet(12*a):"in"===b||"inch"===b?a=this.formatFeet(a):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),
b=b.replace("^3",String.fromCharCode(179)),a=g(a,2)+" "+b):a=b?a+" "+b:3==c?g(a,3):a;return a};this.formatFeet=function(a){if(isNaN(a))return"NaN";var b="",c=16,d=0>a;a=0<a?a+0.5/c:a-0.5/c;var e=f(a/12).intPart,b=b+(g(e,0,d)+"' "),d=a-12*e;0>d&&(d=-d);a=f(d).intPart;d=f((d-a)*c).intPart;if(0===d||0!==a)b+=g(a,0);if(0!==d){for(0>a&&0>d&&(d=-d);0===d%2;)d/=2,c/=2;0!==a&&(b+="-");b+=g(d,0)+"/"+g(c,0)}return b+'"'}};function Fydo(a){this.metadata=a;this.scaleY=this.scaleX=1;this.bbox=new THREE.Box3;this.is2d=!0;this.layersList=[];if(a){this.paperWidth=parseFloat(a.page_dimensions.page_width);this.paperHeight=parseFloat(a.page_dimensions.page_height);this.bbox.min.set(0,0,0);this.bbox.max.set(this.paperWidth,this.paperHeight,0);for(var b in a.layers){var c=parseInt(b),e=a.layers[c];e||(e="Default Layer");this.layersList.push({name:e,index:c})}this.layersList.length&&this.layersList.sort(function(a,b){return a.index-
b.index})}this.layersList.length||this.layersList.push({name:"0",index:0});this.opCount=0;this.fontFaces=[];this.fontFamilies=[];this.clip=null;this.layer=this.imageNumber=this.objectNumber=0;this.bgColor=4294967295;this.contrastColor=this.color=this.fillColor=4278190080;this.currentVbb=new VertexBufferBuilder(!1);this.meshes=[];this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0;this.metadata&&(a=this.paperWidth,b=this.paperHeight,this.currentVbb.addVertexPolytriangle(0,0,0,0,0,
4294967295,0,0),this.currentVbb.addVertexPolytriangle(a,0,0,0,0,4294967295,0,0),this.currentVbb.addVertexPolytriangle(a,b,0,0,0,4294967295,0,0),this.currentVbb.addVertexPolytriangle(0,b,0,0,0,4294967295,0,0),this.currentVbb.addTriangle(0,1,2),this.currentVbb.addTriangle(0,2,3),c=0.0075*a,this.currentVbb.addVertexPolytriangle(c,-c,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,-c,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(c,
0,0,0,0,4283782485,0,0),this.currentVbb.addTriangle(4,5,6),this.currentVbb.addTriangle(4,6,7),this.currentVbb.addVertexPolytriangle(a,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,b-c,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a,b-c,0,0,0,4283782485,0,0),this.currentVbb.addTriangle(8,9,10),this.currentVbb.addTriangle(8,10,11),this.currentVbb.addSegment(0,0,a,0,1E-6,4278190080,0,0),this.currentVbb.addSegment(a,
0,a,b,1E-6,4278190080,0,0),this.currentVbb.addSegment(a,b,0,b,1E-6,4278190080,0,0),this.currentVbb.addSegment(0,b,0,0,1E-6,4278190080,0,0));this.fragments={};this.fragments.mesh2frag={};this.fragments.materials=[];this.fragments.length=0;this.error=!1}Fydo.prototype.load=function(a,b){31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress());this.data=b;this.parse();a.loadDoneCB(!0)};Fydo.prototype.loadFrames=function(a,b){this.data=b;this.parseFrames();a.loadDoneCB(!0)};
var FydoOpcode={kClip:75,kBackColor:66,kColor:67,kFill:70,kLayer:76,kLink:72,kLineCaps:69,kLineJoin:74,kLinePatternDef:68,kLineWeight:87,kMiterLimit:109,kMarkup:77,kObject:79,kResource:82,kFontFace:78,kFontFamily:110,kClipOff:107,kFillOff:102,kLinePatternRef:100,kArc:65,kPolyline:80,kRaster:73,kText:84,kExtended:88,kPolytriangle:83,kUndefined:89},F2dDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_int:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,
dt_double_drray:35,dt_varint_array:36,dt_point_int_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},F2dSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_sheet:42,
st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_end_object:63,st_last_semantic_type:127};Fydo.prototype.readColor=function(){var a=this.stream;a.getVarints();a.getVarints();return a.getUint32()};Fydo.prototype.readFontFace=function(){for(var a=this.stream,b=a.getUint16(),c={name:a.getString(b),resources:[]},e=a.getUint16(),d=0;d<e;d++)b=a.getUint16(),c.resources.push(a.getString(b));c.flags=a.getUint8();c.panose=a.getBytes(10);this.fontFaces.push(c)};
Fydo.prototype.readFontFamily=function(){for(var a=this.stream,b={id:a.getUint16(),names:[]},c=a.getUint16(),e=0;e<c;e++)b.names.push(a.getString(a.getUint16()));this.fontFamilies.push(b)};Fydo.prototype.readClip=function(){var a=this.stream,b=a.getUint16();this.clip=[];for(var c=0;c<b;c++){for(var e=a.getUint16(),d=new Float32Array(2*e),f=0;f<e;f++)d[2*f]=this.tx(a.getInt32()),d[2*f+1]=this.ty(a.getInt32());this.clip.push(d)}};
Fydo.prototype.readPolyline=function(){var a=this.stream,b=this.objectNumber,c=this.color,e=this.lineWeight,d=this.layer,f=a.getUint32();if(f){this.flushBuffer();var g=this.currentVbb;this.numPolylines++;this.numLineSegs+=f-1;if(this.fill)for(var e=g.vcount,h,k,l,m,n=0;n<f;n++){var p=this.tx(a.getInt32()),q=this.ty(a.getInt32());g.addVertexPolytriangle(p,q,0,0,0,c,b,d);2<=n&&(0<(l-h)*(q-k)-(p-h)*(m-k)?g.addTriangle(e,e+n-1,e+n):g.addTriangle(e,e+n,e+n-1));h=l;k=m;l=p;m=q}else for(h=this.tx(a.getInt32()),
k=this.ty(a.getInt32()),n=1;n<f;n++)l=this.tx(a.getInt32()),m=this.ty(a.getInt32()),this.currentVbb.addSegment(h,k,l,m,e,c,b,d,1==n,n==f-1,!0),h=l,k=m}};
Fydo.prototype.readArc=function(){var a=this.stream,b=this.tx(a.getInt32()),c=this.ty(a.getInt32()),e=this.sx(a.getInt32()),d=this.sy(a.getInt32()),f=a.getFloat32(),g=a.getFloat32()%(2*Math.PI),h=a.getFloat32()%(2*Math.PI);a.getUint8();a.getUint8();a=0.001>Math.abs(h-g);0.01>Math.abs(1-e/d)?(a&&this.fill?(this.flushBuffer(),this.currentVbb.addSegment(b,c,b,c,2*e,this.color,this.objectNumber,this.layer,!0,!1,!0)):(this.flushBuffer(),this.currentVbb.addCircularArc(b,c,a?0:g+f,a?2*Math.PI:h+f,e,this.lineWeight,
this.color,this.objectNumber,this.layer)),this.numCircles++):(this.currentVbb.addEllipticalArc(b,c,g,h,e,d,f,this.lineWeight,this.color,this.objectNumber,this.layer),this.numEllipses++)};
Fydo.prototype.readPolytriangle=function(){var a=this.stream,b,c=a.getUint32();this.flushBuffer(c);var e=this.currentVbb,d=this.currentVbb.vcount;for(b=0;b<c;b++){var f=this.tx(a.getInt32()),g=this.ty(a.getInt32());e.addVertexPolytriangle(f,g,0,0,0,this.color,this.objectNumber,this.layer)}c=a.getUint32();for(b=0;b<c;b+=3){var f=a.getUint16(),g=a.getUint16(),h=a.getUint16();e.addTriangle(d+f,d+g,d+h)}c=a.getUint32();for(b=0;b<c;b++)f=a.getInt32(),e.setVertexColor(d+b,f)};
Fydo.prototype.readRaster=function(){function a(a){for(var b="",c=0,d=a.length,e,f,g;c<d;){e=a[c++]&255;if(c==d){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4);b+="==";break}f=a[c++];if(c==d){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&
15)<<2);b+="=";break}g=a[c++];b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&15)<<2|(g&192)>>6);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g&63)}return b}var b=this.stream;this.flushBuffer(4,!0);var c=this.tx(b.getInt32()),e=this.ty(b.getInt32()),d=b.getUint32(),
f=b.getUint32(),g=this.tx(b.getFloat32()),h=this.ty(b.getFloat32()),b={isPng:b.getUint8(),bits:b.getBytes(b.getUint32()),width:d,height:f};b.dataURI=b.isPng?"data:image/png;base64,"+a(b.bits):"data:image/jpg;base64,"+a(b.bits);b.bits=null;this.currentVbb.addTexturedQuad(c,e-f*h,d*g,f*h,this.objectNumber,this.layer);this.currentImage=b;this.flushBuffer(0,!0)};
Fydo.prototype.readLinePatternDef=function(){var a=this.stream,b={};b.id=a.getUint16();for(var c=a.getUint16(),e=b.def=[],d=0;d<c;d++)e.push(a.getFloat32()),e.push(a.getFloat32());this.linePatterns[b.id]=b};
Fydo.prototype.flushBuffer=function(a,b){if(this.currentVbb.vcount){var c;if(c=b||this.currentVbb.isFull(a))c=this.currentVbb.toMesh(),this.bbox.union(c.boundingBox),this.meshes.push(c),c.material={},this.currentImage&&(c.material.image=this.currentImage,c.material.image.name=this.imageNumber++,this.currentImage=null),this.currentVbb=new VertexBufferBuilder}};Fydo.prototype.tx=function(a){return this.sx(a)};Fydo.prototype.ty=function(a){return this.sy(a)};Fydo.prototype.sx=function(a){return a*this.scaleX};
Fydo.prototype.sy=function(a){return a*this.scaleY};Fydo.prototype.invertColor=function(a){var b,c,e;b=255-(a>>16&255);c=255-(a>>8&255);e=255-(a&255);return(a>>24&255)<<24|b<<16|c<<8|e};Fydo.prototype.mapColor=function(a){return a};Fydo.prototype.parserAssert=function(a,b,c){return a!=b?(debug("Expect "+b+"; actual type is "+a+"; in function "+c),this.error=!0):!1};
Fydo.prototype.parseObject=function(){var a=this.stream.getVarints();switch(a){case F2dSemanticType.st_sheet:this.paperColor=this.readColor();break;case F2dSemanticType.st_clip:this.parseClip();break;case F2dSemanticType.st_polytriangle:this.parsePolyTriangle();break;case F2dSemanticType.st_end_object:break;case F2dSemanticType.st_raster:this.parseRaster();break;default:this.error=!0,debug("Unhandled semantic type: "+a)}};
Fydo.prototype.parseRaster=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dDataType.dt_point_int,"parseRaster")||(this.parsePoint(),b=a.getVarints(),this.parserAssert(b,F2dDataType.dt_varint,"parseRaster")||(this.parseVarint(),b=a.getVarints(),this.parserAssert(b,F2dDataType.dt_varint,"parseRaster")||(this.parseVarint(),b=a.getVarints(),this.parserAssert(b,F2dDataType.dt_varint,"parseRaster")||(this.parseVarint(),this.parseEndOfObject()))))};
Fydo.prototype.parsePoint=function(){var a=this.stream;a.getVarints();a.getVarints();a.getVarints()};Fydo.prototype.parseVarintArray=function(){var a=this.stream,b=a.getVarints();debug("Varint array sema type: "+b);for(var b=a.getVarints(),c=0;c<b;++c)a.getVarints()};
Fydo.prototype.parsePolyTriangle=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dDataType.dt_point_int_array,"parsePolyTriangle")||(this.parsePointsArray(),b=a.getVarints(),this.parserAssert(b,F2dDataType.dt_varint_array,"parsePolyTriangle")||(this.parseVarintArray(),b=a.getVarints(),b==F2dDataType.dt_object?(a=a.getVarints(),this.parserAssert(a,F2dSemanticType.st_end_object,"parsePolyTriangle")):this.parserAssert(b,F2dDataType.dt_int_array,"parsePolyTriangle")||(this.parseIntArray(),
this.parseEndOfObject())))};Fydo.prototype.parseClip=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dDataType.dt_int_array,"parseClip")||(this.parseIntArray(),b=a.getVarints(),this.parserAssert(b,F2dDataType.dt_point_int_array,"parseClip")||(this.parsePointsArray(),this.parseEndOfObject()))};
Fydo.prototype.parseEndOfObject=function(){var a=this.stream,b=a.getVarints(),a=a.getVarints();this.parserAssert(b,F2dDataType.dt_object,"parseEndOfObject")||this.parserAssert(a,F2dSemanticType.st_end_object,"parseEndOfObject")};Fydo.prototype.parsePointsArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),b=b/2,c=0;c<b;++c)a.getVarints(),a.getVarints()};Fydo.prototype.parseIntArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.getUint32()};
Fydo.prototype.parseInt=function(){var a=this.stream,b=a.getVarints();debug("parseInt sema type : "+b);F2dSemanticType.st_color&&a.getUint32()};Fydo.prototype.parseVoid=function(){this.stream.getVarints()};Fydo.prototype.parseVarint=function(){var a=this.stream;a.getVarints();return a.getVarints()};Fydo.prototype.parseFloat=function(){var a=this.stream;a.getVarints();return a.getFloat32()};
Fydo.prototype.parseCircularArc=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dSemanticType.st_arc,"parseCircularArc")||(a.getVarints(),a.getVarints(),a.getVarints(),a.getFloat32(),a.getFloat32())};Fydo.prototype.parseCircle=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dSemanticType.st_arc,"parseCircle")||(a.getVarints(),a.getVarints(),a.getVarints())};
Fydo.prototype.parseArc=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dSemanticType.st_arc,"parseArc")||(a.getVarints(),a.getVarints(),a.getVarints(),a.getVarints(),a.getFloat32(),a.getFloat32(),a.getFloat32())};
Fydo.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case F2dDataType.dt_void:this.parseVoid();break;case F2dDataType.dt_int:this.parseInt();break;case F2dDataType.dt_object:this.parseObject();break;case F2dDataType.dt_varint:this.parseVarint();break;case F2dDataType.dt_float:this.parseFloat();break;case F2dDataType.dt_point_int_array:this.parsePointsArray();break;case F2dDataType.dt_circular_arc:this.parseCircularArc();break;case F2dDataType.dt_circle:this.parseCircle();
break;case F2dDataType.dt_arc:this.parseArc();break;default:this.error=!0,debug("Data type not supported yet: "+a)}};
Fydo.prototype.parse=function(){var a;a=this.stream=new InputStream(this.data);var b=a.getString(3);if("F2D"!=b)debug("Invalid F2D header : "+b);else if(b=a.getString(2),"01"!=b)debug("Only support f2d major version 1; actual version is : "+b);else if("."!=a.getString(1))debug("Invalid version delimiter.");else{for(a.getString(2);a.offset<a.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}this.flushBuffer(0,!0);this.currentVbb=null;this.fragments.length=this.meshes.length;for(a=
0;a<this.meshes.length;a++)this.fragments.mesh2frag["0:"+a]=a;this.data=this.stream=null}};function FydoProbe(){this.data=null;this.frameEnd=this.frameStart=0;this.stream=null;this.opCount=0}FydoProbe.prototype.load=function(a,b){this.data=a;this.frameStart=b;this.stream?(this.stream.reset(this.data),this.stream.seek(b)):(this.stream=new CheckedInputStream(this.data),this.stream.seek(14));this.probe();return{frameStart:this.frameStart,frameEnd:this.frameEnd}};
var FydoProbeOpcode={kClip:75,kBackColor:66,kColor:67,kFill:70,kLayer:76,kLink:72,kLineCaps:69,kLineJoin:74,kLinePatternDef:68,kLineWeight:87,kMiterLimit:109,kMarkup:77,kObject:79,kResource:82,kFontFace:78,kFontFamily:110,kClipOff:107,kFillOff:102,kLinePatternRef:100,kArc:65,kPolyline:80,kRaster:73,kText:84,kExtended:88,kPolytriangle:83,kUndefined:89};FydoProbe.prototype.readColor=function(){this.stream.getInt32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.readFontFace=function(){var a=this.stream;a.getString(a.getUint16());for(var b=a.getUint16(),c=0;c<b;c++)a.getString(a.getUint16());a.getUint8();a.getBytes(10);this.frameEnd=this.stream.offset};FydoProbe.prototype.readFontFamily=function(){var a=this.stream;a.getUint16();for(var b=a.getUint16(),c=0;c<b;c++)a.getString(a.getUint16());this.frameEnd=this.stream.offset};
FydoProbe.prototype.readClip=function(){for(var a=this.stream,b=a.getUint16(),c=0;c<b;c++)for(var e=a.getUint16(),d=0;d<e;d++)a.getInt32(),a.getInt32();this.frameEnd=this.stream.offset};FydoProbe.prototype.readPolyline=function(){var a=this.stream,b=a.getUint32();if(b){if(this.fill)var c=0;else a.getInt32(),a.getInt32(),c=1;for(;c<b;c++)a.getInt32(),a.getInt32();this.frameEnd=this.stream.offset}};
FydoProbe.prototype.readArc=function(){var a=this.stream;a.getInt32();a.getInt32();a.getInt32();a.getInt32();a.getFloat32();a.getFloat32();a.getFloat32();a.getUint8();a.getUint8();this.frameEnd=this.stream.offset};FydoProbe.prototype.readPolytriangle=function(){var a=this.stream,b,c=a.getUint32();for(b=0;b<c;b++)a.getInt32(),a.getInt32();c=a.getUint32();for(b=0;b<c;b+=3)a.getUint16(),a.getUint16(),a.getUint16();c=a.getUint32();for(b=0;b<c;b++)a.getInt32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.readRaster=function(){var a=this.stream;a.getInt32();a.getInt32();a.getUint32();a.getUint32();a.getFloat32();a.getFloat32();a.getUint8();a.getBytes(a.getUint32());this.frameEnd=this.stream.offset};FydoProbe.prototype.readLinePatternDef=function(){var a=this.stream;a.getUint16();for(var b=a.getUint16(),c=0;c<b;c++)a.getFloat32(),a.getFloat32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.probe=function(){var a=this.stream,b=!1;try{for(;;){var c=a.getUint8();switch(c){case FydoProbeOpcode.kBackColor:this.bgColor=this.readColor();break;case FydoProbeOpcode.kFontFace:this.readFontFace();break;case FydoProbeOpcode.kFontFamily:this.readFontFamily();break;case FydoProbeOpcode.kClip:this.readClip();break;case FydoProbeOpcode.kClipOff:this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kResource:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kObject:a.getUint32();
this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineCaps:a.getUint8();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineWeight:a.getInt16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineJoin:a.getUint8();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kMiterLimit:a.getFloat32();a.getFloat32();this.frameEnd=this.stream.offset;break;case FydoOpcode.kLinePatternDef:this.readLinePatternDef();break;case FydoOpcode.kLinePatternRef:a.getUint16();
this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kColor:this.readColor();break;case FydoProbeOpcode.kFillOff:this.fill=!1;this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kFill:this.fill=!0;this.readColor();break;case FydoProbeOpcode.kLayer:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kMarkup:a.getUint32();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLink:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kPolyline:this.readPolyline();
break;case FydoProbeOpcode.kArc:this.readArc();break;case FydoProbeOpcode.kRaster:this.readRaster();break;case FydoProbeOpcode.kPolytriangle:this.readPolytriangle();break;default:debug("error probing fydo with op code: "+c),b=!0}if(b){debug("bad op code : "+c);break}this.opCount++}}catch(e){}};function CheckedInputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)}
function OutOfBoundsBufferAccessException(a){this.offset=a;this.message="try to access an offset that is out of bounds: "+this.offset;this.toString=function(){return this.message}}CheckedInputStream.prototype.boundsCheck=function(a){if(a>=this.byteLength)throw new OutOfBoundsBufferAccessException(a);};CheckedInputStream.prototype.seek=function(a){this.boundsCheck(a);this.offset=a};
CheckedInputStream.prototype.getBytes=function(a){this.boundsCheck(this.offset+a);var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};CheckedInputStream.prototype.getUint8=function(){this.boundsCheck(this.offset+1);return this.buffer[this.offset++]};CheckedInputStream.prototype.getUint16=function(){this.boundsCheck(this.offset+2);this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};
CheckedInputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};CheckedInputStream.prototype.getInt32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};
CheckedInputStream.prototype.getUint32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};CheckedInputStream.prototype.getFloat32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};
CheckedInputStream.prototype.getFloat64=function(){this.boundsCheck(this.offset+8);for(var a=this.buffer,b=this.convUint8,c=this.offset,e=0;8>e;e++)b[e]=a[c+e];this.offset+=8;return this.convFloat64[0]};CheckedInputStream.prototype.getString=function(a){this.boundsCheck(this.offset+a);for(var b=this.buffer,c="",e=this.offset,d=this.offset+a;e<d;e++)c+=String.fromCharCode(b[e]);this.offset+=a;return decodeURIComponent(escape(c))};
CheckedInputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};AutodeskNamespace("Autodesk.Viewing.Private");var VIEWER2D_NAVIGATION_MODE={PAN:1,ZOOM:2};Autodesk.Viewing.Private.Viewer2DImpl=function(a,b){this.api=a;this.config=b;this.parent=b.domElement;this.navigationMode=null};Autodesk.Viewing.Private.Viewer2DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer2DImpl;
Autodesk.Viewing.Private.Viewer2DImpl.prototype.initialize=function(){var a=document.createElement("canvas");a.width=1;a.height=1;this.selCtx=a.getContext("2d");this.selCtx.globalCompositeOperation="copy";this.selCtx.imageSmoothingEnabled=!1;this.container=document.createElement("div");this.container.style.width="100%";this.container.style.height="100%";this.parent.appendChild(this.container);return 0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.load=function(a){var b=this.config.tileSize?this.config.tileSize:1024,c=this.config.maxZoom?this.config.maxZoom:5,e=a.indexOf("urn:");-1!=e&&(a=a.substr(0,e)+encodeURIComponent(a.substr(e)));var e=[a],d=[];for(a=0;a<e.length;a++){var f=L.tileLayer(e[a]+"/{z}/{x}/c{y}.png",{maxZoom:c,noWrap:!0,continuousWorld:!1,detectRetina:!0,tileSize:b});d.push(f)}var g=this.map=L.map(this.container,{center:new L.LatLng(0,0),zoom:0,zoomControl:!1,attributionControl:!1,
layers:[d[0]]});g.options.crs.scale=function(a){return b*Math.pow(2,a)};c={};for(a=0;a<e.length;a++)c[e[a]]=d[3*a];L.control.layers(c,void 0).addTo(g);c=document.getElementsByClassName("leaflet-control-layers");for(a=0;a<c.length;a++)c[a].style.visibility="hidden";g.on("baselayerchange",function(a){console.log(a);var b=[],c;for(c in g._layers){var d=g._layers[c];d!=a.layer&&b.push(d)}for(c=0;c<b.length;c++)g.removeLayer(b[c]);a.layer.idTileLayer&&(g.addLayer(a.layer.idTileLayer),g.addLayer(a.layer.canvasLayer))});
var h=this,k=!1,l,m,n,p,q;this.mousemove=function(a){if(k&&h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){var b=a.clientX-l,c=a.clientY-m,c=-c;if(2<Math.abs(b)||2<Math.abs(c))b=Math.abs(b)>Math.abs(c)?b:c,b=Math.round(n+b/q),b=Math.max(g.getMinZoom(),Math.min(b,g.getMaxZoom())),g.setZoomAround(p,b,{animate:!0}),a.preventDefault(),a.stopPropagation()}};g.on("mousedown",function(a){k=!0;if(h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){l=a.originalEvent.clientX;m=a.originalEvent.clientY;n=g.getZoom();
p=g.getCenter();var b=g.getSize(),b=b.x<b.y?b.x:b.y,c=g.getMaxZoom()-g.getMinZoom();q=b/(2*c);g.scrollWheelZoom.disable();window.addEventListener("mousemove",h.mousemove,!1);a.originalEvent.preventDefault();a.originalEvent.stopPropagation()}});g.on("mouseup",function(a){k=!1;h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM&&(g.scrollWheelZoom.enable(),window.removeEventListener("mousemove",h.mousemove,!1),a.originalEvent.preventDefault(),a.originalEvent.stopPropagation())});this.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN);
this.keyup=function(a){var b=document.activeElement.nodeName;if("INPUT"!==b&&"TEXTAREA"!==b){b=!1;if(27===a.keyCode)h.api.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT}),b=!0;else if(36===a.keyCode||70===a.keyCode||72===a.keyCode)h.goHome(),b=!0;b&&(a.preventDefault(),a.stopPropagation())}};window.addEventListener("keyup",this.keyup,!1);g.fitWorld();return!0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.uninitialize=function(){window.removeEventListener("mousemove",this.mousemove,!1);window.removeEventListener("keyup",this.keyup,!1);this.map.remove()};Autodesk.Viewing.Private.Viewer2DImpl.prototype.resize=function(){this.map.invalidateSize(!1)};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.setNavigationMode=function(a){var b=!1;this.navigationMode!==a&&(this.navigationMode=a,this.map&&(a===VIEWER2D_NAVIGATION_MODE.PAN?(this.map.dragging.enable(),window.removeEventListener("mousemove",this.mousemove,!1)):a===VIEWER2D_NAVIGATION_MODE.ZOOM&&this.map.dragging.disable()),this.api.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,value:a}),b=!0);return b};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.goHome=function(){this.map.setView([0,0],0,{reset:!0})};var Xhr=function(){var a=function(a,c,e){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=e;this.auth=c};a.prototype.generateUrl=function(a,c,e){var d=a.indexOf("urn:");0===d&&this.viewing_url&&((e=e&&e.feature?e.feature:null)?"render"==e?(a=a.substr(4),a=this.viewing_url+"/"+e+"/"+encodeURIComponent(a)):a=this.viewing_url+"/"+e+"/"+encodeURIComponent(a.substr(d)):a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(d)));c&&(a=a+"?"+c);return a};a.prototype.addHeaders=
function(a){a["Access-Control-Allow-Credentials"]=!0;a["Access-Control-Allow-Origin"]="*";for(var c in a)this.xhr.setRequestHeader(c,a[c])};a.prototype.get=function(a,c,e,d,f,g){a=this.generateUrl(a,g,{feature:f});try{this.xhr.open("GET",a,!!d),this.xhr.responseType=e,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),d&&(this.xhr.onload=d),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200);return this.xhr.response};
a.prototype.post=function(a,c,e,d,f,g){a=this.generateUrl(a,null,{feature:g});c["Content-Type"]="application/json";try{this.xhr.open("POST",a,!!f),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),f&&(this.xhr.onload=f),this.addHeaders(c),this.xhr.send(e)}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.getRange=function(a,c,e,d,f,g){a=this.generateUrl(path);c.Range="bytes="+d+
"-"+f;try{this.xhr.open("GET",a,!!g),this.xhr.responseType=e,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),g&&(this.xhr.onload=g),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,206);return this.xhr.response};a.prototype.head=function(a){a=this.generateUrl(path);try{this.xhr.open("GET",a,!1),this.success=!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(c){return this.errorHandler&&
this.errorHandler.networkFailure(a,c),null}this.errorCheck(a,200);a=[];a["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges");a["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return a};a.prototype.errorCheck=function(a,c){4===this.xhr.readyState&&this.xhr.status&&this.xhr.status!=c?this.errorHandler&&this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=
!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,e){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:e}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",
{url:a,httpStatus:c,httpStatusText:e}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:e}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:a,httpStatus:c,httpStatusText:e})};return a}();AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.Logger=function(a){this.queue=[];this.console=a.console;this.viewingservice=a.viewingservice;this.webstorage=a.webstorage;this.endpoint=a.endpoint+"/logs/";this.flushThreshold=a.flushThreshold;this.viewingservice&&(this.xhr=new XMLHttpRequest);this.lastFlushTime=Date.now()};Autodesk.Viewing.Private.Logger.prototype.bindURN=function(a){this.urn=a};
Autodesk.Viewing.Private.Logger.prototype.flush=function(){if(this.queue.length){var a=JSON.stringify(this.queue);this.console&&console.log(a);if(this.viewingservice)try{var b=this.xhr;b.open("POST",this.endpoint+encodeURIComponent(this.urn),!0);b.setRequestHeader("Access-Control-Allow-Credentials","true");b.setRequestHeader("Access-Control-Allow-Origin","*");b.setRequestHeader("Content-Type","application/json;charset=utf-8");b.withCredentials=!0;b.send(a)}catch(c){}this.queue=[];this.lastFlushTime=
Date.now()}};Autodesk.Viewing.Private.Logger.prototype.log=function(a,b){this.queue.push(a);(this.queue.length>this.flushThreshold||b)&&this.flush()};var propdb=null,propdbFailed=!1;function loadAsyncResource(a,b,c){}
function loadPropertyPacks(a,b){if(propdb)return!0;if(propdbFailed)return!1;var c=a.propertydb;if(!c)return!1;var e={ids:{},attrs:{},offsets:{},values:{},avs:{}},d=0,f,g;f=c.attrs.length?c.attrs[0]:"objects_attrs.json.gz";(g=requestFile(a.url+f,a))&&(e.attrs[f]=g);d+=!!g;f=c.values.length?c.values[0]:"objects_vals.json.gz";(g=requestFile(a.url+f,a))&&(e.values[f]=g);d+=!!g;f=c.avs.length?c.avs[0]:"objects_avs.json.gz";(g=requestFile(a.url+f,a))&&(e.avs[f]=g);d+=!!g;f=c.offsets.length?c.offsets[0]:
"objects_offs.json.gz";(g=requestFile(a.url+f,a))&&(e.offsets[f]=g);d+=!!g;if(4==d)return propdb=new PropertyDatabase(e),!0;f="objects_attrs.json";g=requestFile(a.url+f,a);e.attrs[f]=g;d+=!!g;f="objects_vals.json";g=requestFile(a.url+f,a);e.values[f]=g;d+=!!g;f="objects_avs.json";g=requestFile(a.url+f,a);e.avs[f]=g;d+=!!g;f="objects_offs.json";g=requestFile(a.url+f,a);e.offsets[f]=g;if(4==d+!!g)return propdb=new PropertyDatabase(e),!0;propdbFailed=!0;return!1}
function doPropertyGet(a,b){var c=b.dbId,e=null;loadPropertyPacks(b,c)&&(e=propdb.getObjectProperties(c));a.postMessage({result:e,dbId:c})}
function computeTreeBBoxes(a,b,c){var e=6*a.dbId;b[e]=b[e+1]=b[e+2]=Infinity;b[e+3]=b[e+4]=b[e+5]=-Infinity;var d=a.children;if(d)for(var f=0,g=d.length;f<g;f++){computeTreeBBoxes(d[f],b,c);for(var h=6*(d[f].dbId|0),k=0;3>k;k++)b[e+k]>b[h+k]&&(b[e+k]=b[h+k]),b[e+k+3]<b[h+k+3]&&(b[e+k+3]=b[h+k+3])}if(void 0!==a.fragIds)if(!Array.isArray(a.fragIds))for(d=6*(a.fragIds|0),k=0;3>k;k++)b[e+k]>c[d+k]&&(b[e+k]=c[d+k]),b[e+k+3]<c[d+k+3]&&(b[e+k+3]=c[d+k+3]);else if(a.fragIds.length)for(f=0;f<a.fragIds.length;f++)for(d=
6*(a.fragIds[f]|0),k=0;3>k;k++)b[e+k]>c[d+k]&&(b[e+k]=c[d+k]),b[e+k+3]<c[d+k+3]&&(b[e+k+3]=c[d+k+3])}function buildDbIdToFragMap(a){for(var b={},c=0,e=a.length;c<e;c++){var d=a[c],f=b[d];void 0===f?b[d]=c:Array.isArray(f)?f.push(c):b[d]=[f,c]}return b}
function doObjectTreeParse(a,b){if(loadPropertyPacks(b,null)){var c=buildDbIdToFragMap(b.fragToDbId),e=propdb.findRootNodes(),d,f=[0];if(1==e.length)d={dbId:e[0]},propdb.buildObjectTree(d,c,0,f);else{d={dbId:0,children:[]};for(var g=0;g<e.length;g++){var h={dbId:e[g]};d.children.push(h);propdb.buildObjectTree(h,c,0,f)}}a.postMessage({instanceTree:d,maxTreeDepth:f[0]});b.fragBoxes&&(c=new Float32Array(6*propdb.getObjectCount()),computeTreeBBoxes(d,c,b.fragBoxes),a.postMessage({instanceBoxes:c}))}else a.postMessage({instanceTree:null,
maxTreeDepth:0})}function doPropertySearch(a,b){var c=[];loadPropertyPacks(b,null)&&(c=propdb.bruteForceSearch(b.searchText));a.postMessage(c)};function doGeomLoad(a,b){var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer",null,"",b.queryParams);if(c.success){a.postMessage({url:b.url,workerId:b.workerId,progress:0.5});try{var d=new PackFileReader(new Uint8Array(e))}catch(f){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading pack file",{url:b.url,exception:f.toString(),stack:f.stack});a.postMessage(null);return}for(var e=c=!1,g={packId:b.packId,meshIndex:0,mesh:null,workerId:b.workerId,
progress:0},h=0,k=d.getEntryCounts();h<k;h++){try{var l=readGeometry(d,h,null)}catch(m){e||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading geometry",{url:b.url,exception:m.toString(),stack:m.stack}),c=e=!0),l=null}g.meshIndex=h;g.mesh=l;g.progress=0.5+(h+1)/k*0.5;if(l)if(_isIE11)a.postMessage(g);else{var n=[];n.push(l.vb.buffer);a.postMessage(g,n)}else c||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unable to load geometry",{url:b.url}),c=!0),a.postMessage(g)}}else a.postMessage(null)}
;function doLoadSvf(a,b){b.basePath="";var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1));var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer",null,"",b.queryParams);if(c.success){a.postMessage({progress:0.5});var d=new Package;b.loadDoneCB=function(c){c?a.postMessage({svf:d}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading SVF",{url:b.url}),a.postMessage(null))};try{d.load(b,new Uint8Array(e))}catch(f){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,
"Unhandled exception while loading SVF",{url:b.url,exception:f.toString(),stack:f.stack}),a.postMessage(null)}}else a.postMessage(null)};var ENABLE_OCTM_MG2=!1,IS_WORKER="undefined"!==typeof self&&"undefined"===typeof window;
if(IS_WORKER){var fydo=null;IS_CONCAT_BUILD||(importScripts("../AutodeskNamespace.js"),importScripts("../compatibility.js"),importScripts("../render/adsk_three.js"),importScripts("../zlib/gunzip.min.js"),importScripts("../zlib/unzip.min.js"),ENABLE_OCTM_MG2&&(importScripts("../zlib/inflate.min.js"),importScripts("../lmvtk/octm_mg2.js")),importScripts("../lmvtk/InputStream.js"),importScripts("../lmvtk/VbUtils.js"),importScripts("../lmvtk/VertexBufferBuilder.js"),importScripts("../lmvtk/PackReader.js"),
importScripts("../lmvtk/Geoms.js"),importScripts("../lmvtk/Materials.js"),importScripts("../lmvtk/Lights.js"),importScripts("../lmvtk/Cameras.js"),importScripts("../lmvtk/Fragments.js"),importScripts("../lmvtk/Instances.js"),importScripts("../lmvtk/Package.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Propdb.js"),importScripts("../lmvtk/Fydo.js"),importScripts("../lmvtk/FydoProbe.js"),importScripts("../lmvtk/CheckedInputStream.js"),importScripts("../net/Xhr.js"),importScripts("GeomWorker.js"),
importScripts("SvfWorker.js"),importScripts("PropWorker.js"),importScripts("FydoParseWorker.js"),importScripts("FydoStreamWorker.js"),importScripts("CloudRenderingWorker.js"),importScripts("../../api/Viewer.js"),importScripts("../../api/ErrorCodes.js"));self.addEventListener("message",function(a){var b=a.data;b.errorHandler=new XhrErrorHandler(self);a=a.data.operation;"LOAD_GEOMETRY"==a?doGeomLoad(self,b):"LOAD_SVF"==a?doLoadSvf(self,b):"GET_PROPERTIES"==a?doPropertyGet(self,b):"SEARCH_PROPERTIES"==
a?doPropertySearch(self,b):"GET_OBJECT_TREE"==a?doObjectTreeParse(self,b):"PARSE_FYDO"==a?doParseFydo(self,b):"PARSE_FYDO_FRAME"==a?doParseFydoFrame(self,b):"STREAM_FYDO"==a?doStreamFydo(self,b):"CLOUD_RENDERING"==a&&doCloudRendering(self,b)},!1);self.raiseError=function(a,b,c){self.postMessage({error:{code:a,msg:b,args:c}})};var requestFile=function(a,b){b.errorHandler.ignoreFileNotFound=!0;var c=new Xhr(b.errorHandler,b.auth,b.viewing_url);if(-1!==a.indexOf(".gz",a.length-3)){var e=c.get(a,b.headers,
"arraybuffer",null,"",b.queryParams);if(c.success)try{var d=new Uint8Array(e);31==d[0]&&139==d[1]&&(d=(new Zlib.Gunzip(d)).decompress());return d}catch(f){return self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:f.toString(),stack:f.stack}),null}else return null}else return e=c.get(a,b.headers,"arraybuffer",null,"",b.queryParams),c.success?new Uint8Array(e):null},debug=function(a){self.postMessage({debug:1,message:a})}};function doLoadFydo(a,b){b.basePath="";var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1));var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer",null,"",b.queryParams);if(c.success){a.postMessage({progress:0.5});var d=new Fydo;b.loadDoneCB=function(c){c?a.postMessage({fydo:d}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{url:b.url}),a.postMessage(null))};try{d.load(b,new Uint8Array(e))}catch(f){debug("Error in fydo parsing worker : "+
f.toString()+" ; with stack trace: "+f.stack.toString()),a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading FYDO",{url:b.url,exception:f.toString(),stack:f.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseFydo(a,b){if(b.data){a.postMessage({progress:0.5});var c=new Fydo(b.metadata);b.loadDoneCB=function(b){b?a.postMessage({fydo:c}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{}),a.postMessage(null))};try{c.load(b,new Uint8Array(b.data))}catch(e){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading FYDO",{exception:e.toString(),stack:e.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseFydoFrame(a,b){if(b.data){a.postMessage({progress:0.5});fydo||(fydo=new Fydo(b.metadata),debug("Initialize Global Fydo Object."));b.loadDoneCB=function(b){b?a.postMessage({fydoframe:fydo}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{}),a.postMessage(null))};try{fydo.loadFrames(b,new Uint8Array(b.data))}catch(c){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading FYDO",{exception:c.toString(),stack:c.stack}),a.postMessage(null)}}else a.postMessage(null)}
;function doStreamFydo(a,b){var c=b.url;b.basePath="";var e=b.url.lastIndexOf("/");-1!=e&&(b.basePath=b.url.substr(0,e+1));var d=new Xhr(null,b.auth,b.viewing_url);d.get(b.basePath+"bubble.json",b.headers,"json",null,"",b.queryParams);var f=d.get(b.basePath+"metadata.json",b.headers,"json",null,"",b.queryParams);try{d=new XMLHttpRequest;d.overrideMimeType("text/plain; charset=x-user-defined");var g=new FydoProbe;d.onreadystatechange=function(b,c){return function(){try{if(4==d.readyState){debug("total op code count yield from probing: "+
b.opCount);debug("fydo frame ends at offset: "+b.frameEnd);var c=textToArrayBuffer(d.responseText),e={type:"FYDOBLOB",metadata:f,buffer:c},g=[];g.push(c);a.postMessage(e,g)}}catch(h){debug(h.message)}}}(g,0);d.open("GET",c,!0);d.send()}catch(h){debug(h.message)}}function textToArrayBuffer(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b,0),e=0;e<a.length;e++)c[e]=a.charCodeAt(e)&255;return b}
function concatenateArrayBuffer(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer};var defaultCloudRenderConfig={ConsumerServiceKey:"Viewing",ProductVersion:"2014",UserInfo:{UserID:"",EmailFlag:"true"},Scenes:[{SceneInfo:{SourceFileInfo:{Type:"S3",AccessLevel:"Public"},FileUri:"",SceneId:"FireflyJSDefaultSceneId"},Renderings:[{ImageInfo:{Actions:["Render","ToneMap"],ProductionVersion:"SparkViewer",ImageParams:{RenderResolutionY:1500,RenderResolutionX:2E3,RenderImageFormat:"PNG"},Render:{RenderQuality:"standard",RenderCameraName:"",RenderingType:"image",ExposureType:"Advanced"},
ToneMap:{Type:"canon",ExposureValue:8,Highlights:0.25,Midtones:1,Shadows:0.2,Whitepoint:6500,Saturation:1},CameraOverride:{Units:"MILLIMETER",FocalDistance:0,Aperture:0,View:{Eye:[-4026.55,2722.32,-527.835],At:[0.834734,-0.454954,-0.310218],Up:[0.233914,-0.0868021,0.968375]},Projection:{isOrthographic:!1,Extent:1,ImageShift:[0,0],NativeAspect:1}}}}]}]};
function doCloudRendering(a,b){var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=defaultCloudRenderConfig,d=b.camera,f=b.canvas,g=new THREE.Vector3;g.x=d.target.x-d.position.x;g.y=d.target.y-d.position.y;g.z=d.target.z-d.position.z;g.normalize();var h=new THREE.Vector3;h.crossVectors(g,d.up);h.normalize();debug("Transform: "+h.x+" "+h.y+" "+h.z+" 0 "+d.up.x+" "+d.up.y+" "+d.up.z+" 0 "+g.x+" "+g.y+" "+g.z+" 0 "+d.position.x+" "+d.position.y+" "+d.position.z+" 1");e.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.Eye=
[d.position.x,d.position.y,d.position.z];e.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.At=[g.x,g.y,g.z];e.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.Up=[d.up.x,d.up.y,d.up.z];e.Scenes[0].Renderings[0].ImageInfo.ImageParams.RenderResolutionY=f.height;e.Scenes[0].Renderings[0].ImageInfo.ImageParams.RenderResolutionY=f.width;d=THREE.Math.degToRad(d.fov);0>=d&&(d=1E-4);e.Scenes[0].Renderings[0].ImageInfo.CameraOverride.Projection.Extent=d;debug("fov in radius = "+d);debug("CameraOverrides: "+
JSON.stringify(e.Scenes[0].Renderings[0].ImageInfo.CameraOverride));b.headers["x-ads-mode"]="verbatim";e=c.post(b.url,b.headers,JSON.stringify(e),"text",null,"render");debug(e);var k=JSON.parse(e)[0].JobId;debug("rendering job kicked off with render job id: "+k);a.postMessage({progress:"progress"});var l=setInterval(function(){var d=c.get(b.url,b.headers,"text",null,"render",b.queryParams?b.queryParams+"&jobid="+k:"jobid="+k);debug("from rendering worker : "+d);var d=JSON.parse(d).renderings[0],e=
d.JobInfo.JobStatus;"Complete"==e?(debug("rendering job :"+k+" finished."),d={renderings:{thumbnail:d.Storage.Output.Thumbnail,preview:d.Storage.Output.Preview,image:d.Storage.Output.Image,renderResolutionX:d.ImageParams.RenderResolutionX,renderResolutionY:d.ImageParams.RenderResolutionY}},a.postMessage(d),clearInterval(l)):"Error"==e&&(d={error:"error"},a.postMessage(d),clearInterval(l))},1E4)};var Autocam=Autocam||function(a,b,c,e){function d(b){q=!0;a.target.copy(l.center);a.pivot.copy(l.pivot);a.worldup?a.worldup.copy(l.sceneUpDirection):a.up.copy(l.sceneUpDirection);c&&c(b);q=!1}function f(a,b){var c=new THREE.Vector2(0,0);c.x=a/window.innerWidth;c.y=b/window.innerHeight;return c}function g(a,b,c){var d,e,f,g=0,h=null,k=null,m=l.snapOrbitDeadZone,n=l.orbitMultiplier;"h"==a?(a=l.snapOrbitThresholdH,d=l.snapOrbitAccelerationAX,e=l.snapOrbitAccelerationBX,f=1-l.snapOrbitAccelerationPointX,
k=l.lockDeltaX,h=l.lockedX):(a=l.snapOrbitThresholdV,d=l.snapOrbitAccelerationAY,e=l.snapOrbitAccelerationBY,f=1-l.snapOrbitAccelerationPointY,k=l.lockDeltaY,h=l.lockedY);h?(k+=c,k<-m?g=(k+m)*n*1/e:k>m&&(g=(k-m)*n*1/e)):(g=Math.abs(b)>a?c*n:Math.abs(b)>f*a?0<c*b?c*n*d:c*n*1/d:0<c*b?c*n*e:c*n*1/e,0<g*b&&Math.abs(g)>Math.abs(b)&&(this.lockDeltaX=this.lockDeltaY=0,g=b));return g}function h(a,b){var c=!1,d=window.innerWidth,e=a.x%d,f=window.innerHeight,g=a.y%f,f=0<g?g-b.y:f+g-b.y;30>Math.abs(0<e?e-b.x:
d+e-b.x)&&30>Math.abs(f)&&(c=!0);return c}function k(a,b,c){if(!M||!a){if(a){var d=new THREE.Vector2;d.x=(b.x-c.x)/window.innerWidth;b.x=c.x+(b.x-c.x)%window.innerWidth;d.y=(b.y-c.y)/window.innerHeight;b.y=c.y+(b.y-c.y)%window.innerHeight}M=a}}var l=this,m=null,n=null,p=null,q=!1;this.camera=a;this.renderer="WEBGL";this.startState={};this.navApi=b;var s=Date.now(),t,u=!1;this.showPivot=function(a){e&&e(a)};this.setViewCubeContainer=function(a){p=a};this.setWorldUpVector=function(a){!q&&a&&0<a.lengthSq()&&
!a.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(a),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),m&&requestAnimationFrame(m.render))};this.getWorldUpVector=function(){return this.sceneUpDirection.clone()};this.getWorldRightVector=function(){var a=this.sceneUpDirection.clone();Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};
this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()};this.goToView=function(a){a={position:a.position.clone(),up:a.up.clone(),center:a.center.clone(),pivot:a.pivot.clone(),fov:a.fov,worldUp:a.worldUp.clone()};l.elapsedTime=0;this.animateTransition(a)};this.setCurrentViewAsHome=function(b){b?(this.navApi.setRequestFitToView(!0),u=!0):this.homeVector={position:a.position.clone(),up:a.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),
fov:a.fov,worldUp:this.sceneUpDirection.clone()}};this.setHomeViewFrom=function(a){var b=a.pivot?a.pivot:this.center,c=a.target?a.target:this.pivot,d=a.worldup?a.worldup:this.sceneUpDirection;this.homeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone()};this.originalHomeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),worldFront:this.sceneFrontDirection.clone()}};this.goHome=
function(){this.navApi.getIsLocked()||(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))};this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position);this.homeVector.up.copy(this.originalHomeVector.up);this.homeVector.center.copy(this.originalHomeVector.center);this.homeVector.pivot.copy(this.originalHomeVector.pivot);this.homeVector.fov=this.originalHomeVector.fov;this.homeVector.worldUp.copy(this.originalHomeVector.worldUp);this.goHome()};this.getView=
function(){return this.center.clone().sub(a.position)};(function T(){requestAnimationFrame(T);var a=Date.now();t=a-s;s=a})();this.ortho=!1;this.center=a.target?a.target.clone():new THREE.Vector3(0,0,0);this.pivot=a.pivot?a.pivot.clone():this.center.clone();this.sceneUpDirection=a.up.clone();this.sceneFrontDirection=this.getWorldFrontVector();this.dir=this.getView();b=a.up.clone().cross(this.dir).normalize();a.up.copy(this.dir).cross(b).normalize();this.saveCenter=this.center.clone();this.savePivot=
this.pivot.clone();this.saveEye=a.position.clone();this.saveUp=a.up.clone();var v,w,B,A;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();this.setHomeViewFrom(a);var D=new THREE.Quaternion,W=new THREE.Quaternion,C=new THREE.Quaternion,P=new THREE.Quaternion,G,F;this.userPanSpeed=0.5;this.userLookSpeed=2;this.userHeightSpeed=5;this.walkMultiplier=1;this.userZoomSpeed=1.015;this.orbitMultiplier=5;this.currentlyAnimating=!1;this.alignOrbitUpDirection=this.preserveOrbitUpDirection=
a.keepSceneUpright=!0;this.doCustomOrbit=this.constrainOrbitVertical=this.constrainOrbitHorizontal=!1;this.snapOrbitDeadZone=0.045;this.snapOrbitThresholdH=this.snapOrbitThresholdV=THREE.Math.degToRad(15);this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5;this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2;this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=0.5;this.alignDirTable=Array(26);this.alignDirTable[0]=new THREE.Vector3(-1,0,0);this.alignDirTable[1]=new THREE.Vector3(1,
0,0);this.alignDirTable[2]=new THREE.Vector3(0,-1,0);this.alignDirTable[3]=new THREE.Vector3(0,1,0);this.alignDirTable[4]=new THREE.Vector3(0,0,-1);this.alignDirTable[5]=new THREE.Vector3(0,0,1);this.alignDirTable[6]=new THREE.Vector3(-1,-1,0);this.alignDirTable[7]=new THREE.Vector3(-1,1,0);this.alignDirTable[8]=new THREE.Vector3(1,-1,0);this.alignDirTable[9]=new THREE.Vector3(1,1,0);this.alignDirTable[10]=new THREE.Vector3(0,-1,-1);this.alignDirTable[11]=new THREE.Vector3(0,-1,1);this.alignDirTable[12]=
new THREE.Vector3(0,1,-1);this.alignDirTable[13]=new THREE.Vector3(0,1,1);this.alignDirTable[14]=new THREE.Vector3(-1,0,-1);this.alignDirTable[15]=new THREE.Vector3(1,0,-1);this.alignDirTable[16]=new THREE.Vector3(-1,0,1);this.alignDirTable[17]=new THREE.Vector3(1,0,1);this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1);this.alignDirTable[19]=new THREE.Vector3(-1,-1,1);this.alignDirTable[20]=new THREE.Vector3(-1,1,-1);this.alignDirTable[21]=new THREE.Vector3(-1,1,1);this.alignDirTable[22]=new THREE.Vector3(1,
-1,-1);this.alignDirTable[23]=new THREE.Vector3(1,-1,1);this.alignDirTable[24]=new THREE.Vector3(1,1,-1);this.alignDirTable[25]=new THREE.Vector3(1,1,1);this.useSnap=this.combined=!1;this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0);this.bottomLimit=this.topLimit=!1;this.maxSceneBound=this.minSceneBound=0;var N,z;this.zoomDelta=new THREE.Vector2;var M,H=new THREE.Vector3,Q=new THREE.Vector3;this.rewindParams=
{history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1};
this.viewCubeMenuOpen=!1;this.menuSize=new THREE.Vector2(0,0);this.menuOrigin=new THREE.Vector2(0,0);a.lookAt(this.center);this.setCube=function(a){m=a};this.loadObject=function(a,b,c){loader=new THREE.JSONLoader;loader.load(a,function(a,d){var e=new THREE.MeshPhongMaterial(d);mesh=new THREE.Mesh(a,e);mesh.scale=b;mesh.position=c;mesh.geometry.computeBoundingBox();e=mesh.geometry.boundingBox.clone();Q.set(e.max.x,e.max.y,e.max.z);H.set(e.min.x,e.min.y,e.min.z);Q.multiply(b);H.multiply(b);scene.add(mesh);
objects.push(mesh)})};this.setCameraUp=function(b){var c=this.dir.clone(),d=c.cross(b).normalize();0===d.lengthSq()&&(c.copy(this.dir),b.z>b.y?c.y-=1E-4:c.z+=1E-4,d=c.cross(b).normalize());a.up.copy(d).cross(this.dir).normalize()};this.sync=function(b){a.position.copy(b.position);a.fov=b.fov;b.target&&this.center.copy(b.target);b.pivot&&this.pivot.copy(b.pivot);this.dir.copy(this.center).sub(a.position);this.setCameraUp(b.up);b=b.worldup?b.worldup:b.up;1E-4<b.distanceToSquared(this.sceneUpDirection)&&
this.setWorldUpVector(b);u&&!this.navApi.getTransitionActive()&&(u=!1,this.setCurrentViewAsHome(!1));m&&requestAnimationFrame(m.render)};this.refresh=function(){m&&m.refreshCube()};THREE.Box2.prototype.setCenter=function(a){var b=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this};THREE.Box2.prototype.getIcon2DCoords=function(a,b){var c=this.center;b.set((a.x-c.x)/(this.size().x/2),(a.y-c.y)/(this.size().y/
2))};THREE.Matrix3.prototype.makeRotationFromQuaternion=function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,k=e+e;a=c*g;var l=c*h,c=c*k,m=d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;b[0]=1-(m+e);b[3]=l-f;b[6]=c+h;b[1]=l+f;b[4]=1-(a+e);b[7]=d-g;b[2]=c-h;b[5]=d+g;b[8]=1-(a+m);return this};THREE.Quaternion.prototype.setFromRotationMatrix3=function(a){var b=a.elements,c=b[0];a=b[3];var d=b[6],e=b[1],f=b[4],g=b[7],h=b[2],k=b[5],b=b[8],l=c+f+b;0<l?(c=0.5/Math.sqrt(l+1),this.w=0.25/c,this.x=(k-g)*
c,this.y=(d-h)*c,this.z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this.w=(k-g)/c,this.x=0.25*c,this.y=(a+e)/c,this.z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this.w=(d-h)/c,this.x=(a+e)/c,this.y=0.25*c,this.z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this.w=(e-a)/c,this.x=(d+h)/c,this.y=(g+k)/c,this.z=0.25*c);return this};THREE.Quaternion.prototype.rotate=function(a){var b=(new THREE.Matrix4).makeRotationFromQuaternion(this).elements,b=(new THREE.Matrix3).set(b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]);return a.applyMatrix3(b)};
THREE.Vector3.prototype.findAngleWith=function(a,b){var c=0,d=this.clone().normalize().clone().dot(a.clone().normalize()),c=this.clone().cross(a).clone().normalize();if(c.clone().length()<Number.MIN_VALUE)c=0<d?0:180;else{b=0<c.clone().dot(b.clone().normalize())?c:-c;var e=(new THREE.Quaternion).setFromAxisAngle(b,90*THREE.Math.degToRad),e=e.clone().rotate(a).clone().normalize().clone().dot(this),c=Math.acos(d)*THREE.Math.radToDeg;Math.abs(c-90)<Number.MIN_VALUE&&(c=90);if(90>c&&0<d*e||90<c&&0>d*
e||90==c&&0<e)c*=-1}return c=THREE.Math.degToRad(c)};"contains"in String.prototype||(String.prototype.contains=function(a,b){return-1!==String.prototype.indexOf.call(this,a,b)});Math.linearClamp=function(a,b,c){return a<=b?0:a>=c?1:(a-b)/(c-b)};Math.easeClamp=function(a,b,c){return a<=b?0:a>=c?1:0.5*(Math.sin(((a-b)/(c-b)-0.5)*Math.PI)+1)};Math.linearInterp=function(a,b,c){return b*(1-a)+c*a};Math.equalityClamp=function(a,b,c){return a<=b?b:a>=c?c:a};Math.round2=function(a){return Math.round(100*
a)/100};Math.round1=function(a){return Math.round(10*a)/10};this.animateTransition=function(b){if(b){var c=!1,e=0;if(1<=l.elapsedTime)e=1,l.center.copy(b.center),a.position.copy(b.position),a.up.copy(b.up),a.fov=b.fov,l.pivot.copy(b.pivot),(c=!b.worldUp.equals(this.sceneUpDirection))&&this.setWorldUpVector(b.worldUp),this.currentlyAnimating=!1,d(c),this.showPivot(!1),m&&requestAnimationFrame(m.render),this.addHistoryElement(),this.navApi.setTransitionActive(!1);else{this.currentlyAnimating=!0;this.showPivot(!0);
this.navApi.setTransitionActive(!0);e=Math.easeClamp(l.elapsedTime/1,0,1);oneMinusTime=1-e;l.elapsedTime+=t/500;var c=l.center.clone().multiplyScalar(oneMinusTime).add(b.center.clone().multiplyScalar(e)),f=a.position.clone().multiplyScalar(oneMinusTime).add(b.position.clone().multiplyScalar(e)),g=a.up.clone().multiplyScalar(oneMinusTime).add(b.up.clone().multiplyScalar(e)),h=a.pivot.clone().multiplyScalar(oneMinusTime).add(b.pivot.clone().multiplyScalar(e)),k=this.sceneUpDirection.clone().multiplyScalar(oneMinusTime).add(b.worldUp.clone().multiplyScalar(e)),
e=a.fov*oneMinusTime+b.fov*e;l.center.copy(c);a.position.copy(f);a.up.copy(g);a.fov=e;l.pivot.copy(h);(c=1E-4<k.distanceToSquared(this.sceneUpDirection))&&this.setWorldUpVector(k);a.lookAt(l.center);d(c);m&&requestAnimationFrame(m.render);requestAnimationFrame(function(){l.animateTransition(b)})}}};this.sphericallyInterpolateTransition=function(b){var c,e,f;c=0;this.currentlyAnimating=!0;this.navApi.setTransitionActive(!0);1<=l.elapsedTime?(c=1,this.currentlyAnimating=!1):(c=Math.easeClamp(l.elapsedTime/
1,0,1),l.elapsedTime+=t/500);1===c?(e=z.position,c=z.center,f=z.up):(f=new THREE.Matrix3,e=D.clone(),e.slerp(W,c),f.makeRotationFromQuaternion(e),e=Math.linearInterp(c,G,F),f=f.elements,c=N.center.clone().multiplyScalar(1-c).add(z.center.clone().multiplyScalar(c)),e=c.clone().sub((new THREE.Vector3(f[0],f[1],f[2])).multiplyScalar(e)),f=new THREE.Vector3(f[3],f[4],f[5]));l.center.copy(c);a.position.copy(e);a.up.copy(f);l.navApi.getUsePivotAlways()||l.pivot.copy(c);a.lookAt(l.center);d(!1);m&&requestAnimationFrame(m.render);
!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame(function(){l.sphericallyInterpolateTransition(b)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),b&&b())};this.getOrientation=function(){if(m){var b=Math.round1(a.up.x),c=Math.round1(a.up.y),d=Math.round1(a.up.z),e=this.sceneFrontDirection.clone(),f=this.sceneUpDirection.clone(),g=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();e.x=Math.round1(e.x);e.y=Math.round1(e.y);
e.z=Math.round1(e.z);f.x=Math.round1(f.x);f.y=Math.round1(f.y);f.z=Math.round1(f.z);g.x=Math.round1(g.x);g.y=Math.round1(g.y);g.z=Math.round1(g.z);var h=g.clone().multiplyScalar(-1),k=f.clone().multiplyScalar(-1),l=e.clone().multiplyScalar(-1);switch(m.currentFace){case "front":if(f.x==b&&f.y==c&&f.z==d)return"up";if(k.x==b&&k.y==c&&k.z==d)return"down";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case "right":if(f.x==b&&f.y==c&&f.z==d)return"up";if(k.x==b&&
k.y==c&&k.z==d)return"down";if(l.x==b&&l.y==c&&l.z==d)return"left";if(e.x==b&&e.y==c&&e.z==d)return"right";break;case "left":if(f.x==b&&f.y==c&&f.z==d)return"up";if(k.x==b&&k.y==c&&k.z==d)return"down";if(e.x==b&&e.y==c&&e.z==d)return"left";if(l.x==b&&l.y==c&&l.z==d)return"right";break;case "back":if(f.x==b&&f.y==c&&f.z==d)return"up";if(k.x==b&&k.y==c&&k.z==d)return"down";if(h.x==b&&h.y==c&&h.z==d)return"right";if(g.x==b&&g.y==c&&g.z==d)return"left";break;case "top":if(l.x==b&&l.y==c&&l.z==d)return"down";
if(e.x==b&&e.y==c&&e.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case "bottom":if(e.x==b&&e.y==c&&e.z==d)return"down";if(l.x==b&&l.y==c&&l.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left"}}};this.resetOrientation=function(){this.sceneUpDirection.copy(this.originalHomeVector.worldUp);this.sceneFrontDirection.copy(this.originalHomeVector.worldFront);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();
this.setCameraUp(this.sceneUpDirection);d(!0)};this.setCurrentViewAsFront=function(){m&&(m.currentFace="front");this.sceneUpDirection.copy(a.up.clone());this.sceneFrontDirection.copy(this.getView()).normalize();this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();d(!0)};this.setCurrentViewAsTop=function(){m&&(m.currentFace="front");this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize();this.sceneFrontDirection.copy(a.up);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();
d(!0)};this.calculateCubeTransform=function(b){var c=this.sceneUpDirection.clone(),d=this.sceneFrontDirection.clone(),e=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();N=a.clone();N.center=l.center.clone();N.pivot=l.pivot.clone();z=a.clone();z.center=l.center.clone();z.pivot=l.pivot.clone();var f=new THREE.Vector3(0,0,0);b.contains("back")&&(f=f.add(d));b.contains("front")&&(f=f.sub(d));b.contains("top")&&(f=f.add(c));b.contains("bottom")&&(f=f.sub(c));b.contains("right")&&
(f=f.add(e));b.contains("left")&&(f=f.sub(e));b=c;var g=f.clone().normalize();if(1-Math.abs(g.dot(c))<Number.MIN_VALUE)for(var h=this.getView().normalize(),d=[d.clone(),d.clone().multiplyScalar(-1),e.clone(),e.clone().multiplyScalar(-1)],c=0<g.dot(c)?1:-1,h=h.clone().add(a.up.clone().multiplyScalar(c)).normalize(),e=-2,g=0;4>g;g++){var k=h.dot(d[g]);k>e&&(e=k,b=d[g].multiplyScalar(c))}F=G=this.getView().length();z.position=z.center.clone().add(f.normalize().multiplyScalar(F));z.up=b;f=N.center.clone().sub(N.position).normalize();
b=f.clone().cross(N.up).normalize();d=b.clone().cross(f).normalize();c=new THREE.Matrix3(f.x,d.x,b.x,f.y,d.y,b.y,f.z,d.z,b.z);D.setFromRotationMatrix3(c);f=z.center.clone().sub(z.position).normalize();b=f.clone().cross(z.up).normalize();d=b.clone().cross(f).normalize();c.set(f.x,d.x,b.x,f.y,d.y,b.y,f.z,d.z,b.z);C.setFromAxisAngle(f,0);P.setFromAxisAngle(d,0);W.setFromRotationMatrix3(c);W.multiply(C).multiply(P).normalize()};this.centerShot=function(b){if(!N||b)l.elapsedTime=0,N=z=a.clone(),N.center=
l.center;b=l.pivot.clone();var c=b.clone().sub(N.position),e=N.center.clone().sub(N.position).normalize(),f=N.up.clone(),g=e.clone().cross(f).normalize(),f=g.clone().cross(e).normalize(),e=g.clone().multiplyScalar(g.dot(c)),c=f.clone().multiplyScalar(f.dot(c)),c=e.clone().add(c);z.position=N.position.clone().add(c);z.center=b;z.pivot=b;b=0;1<=l.elapsedTime?b=1:(b=Math.easeClamp(l.elapsedTime/1,0,1),l.elapsedTime+=t/2E3);c=a.position.clone().multiplyScalar(1-b).add(z.position.clone().multiplyScalar(b));
f=l.center.clone().multiplyScalar(1-b).add(z.center.clone().multiplyScalar(b));e=l.pivot.clone().multiplyScalar(1-b).add(z.pivot.clone().multiplyScalar(b));a.position.copy(c);l.center.copy(f);l.pivot.copy(e);a.lookAt(l.center);d(!1);1===b?this.addHistoryElement():requestAnimationFrame(function(){l.centerShot(!1)})};this.levelShot=function(){var b=this.getView(),c=b.length(),d=this.sceneUpDirection.clone(),e=a.up.clone().normalize(),b=b.normalize(),f=b.dot(d);1-Math.abs(f)>Number.MIN_VALUE?(e=b.clone().cross(d),
b=d.clone().cross(e),b.normalize()):b=e.clone();b.multiplyScalar(c);c={center:b.add(a.position),up:d,position:a.position,pivot:l.center.clone().add(b),fov:a.fov,worldUp:d};l.elapsedTime=0;l.animateTransition(c)};this.fitToWindow=function(){var b=this.getView(),c=a.up.clone();b.normalize();c.normalize();z=a.clone();z.center=l.center;var d=c,c=d.clone();if(!(Math.abs(c.clone().dot(b))<Number.MIN_VALUE)&&(b.normalize(),c=d.clone().dot(b),c=b.clone().multiplyScalar(c),c=d.clone().sub(c),c.length()<Number.MIN_VALUE)){for(var d=
new THREE.Vector3(0,0,0),c=[new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],e=0;7>e;e++)if(Math.abs(c[e].dot(b))<Number.MIN_VALUE){d=c[e];break}c=d}c.normalize();c.normalize();z.up=c;e=b.clone().cross(c);e.normalize();var f=H.clone(),g=Q.clone(),h=[f,g],d=new THREE.Vector3(g.x-f.x,g.y-f.y,g.z-f.z);h[2]=new THREE.Vector3(g.x,f.y,g.z);h[3]=new THREE.Vector3(g.x,f.y,f.z);h[4]=
new THREE.Vector3(g.x,g.y,f.z);h[5]=new THREE.Vector3(f.x,g.y,g.z);h[6]=new THREE.Vector3(f.x,g.y,f.z);h[7]=new THREE.Vector3(f.x,f.y,g.z);for(f=0;8>f;f++)g=h[f].clone().sub(a.position),h[f].setX(g.clone().dot(e)),h[f].setY(g.clone().dot(c)),h[f].setZ(g.clone().dot(b));var f=THREE.Math.degToRad(a.topFov),g=THREE.Math.degToRad(a.bottomFov),k=THREE.Math.degToRad(a.leftFov),m=THREE.Math.degToRad(a.rightFov),n,p,q,s;n=0<=k?Number.MAX_VALUE:Number.MIN_VALUE;p=0<=m?Number.MAX_VALUE:Number.MIN_VALUE;q=0<=
f?Number.MAX_VALUE:Number.MIN_VALUE;s=0<=g?Number.MAX_VALUE:Number.MIN_VALUE;for(var t=1/Math.tan(m),A=-1/Math.tan(k),u=1/Math.tan(f),w=-1/Math.tan(g),v=0;8>v;v++){var C=h[v].clone(),B=C.z-A*C.x;n=0<=k?Math.min(n,B):Math.max(n,B);B=C.z-t*C.x;p=0<=m?Math.min(p,B):Math.max(p,B);B=C.z-u*C.y;q=0<=f?Math.min(q,B):Math.max(q,B);B=C.z-w*C.y;s=0<=g?Math.min(s,B):Math.max(s,B)}h=(p-n)/(A-t);n=A*h+n;s=(s-q)/(u-w);q=u*s+q;u=0;n<=q?(f=(f-g)/2,Math.abs(f)>Number.MIN_VALUE&&(f=1/Math.tan(f),s=s-q/f+n/f),u=n):(f=
(m-k)/2,Math.abs(f)>Number.MIN_VALUE&&(f=1/Math.tan(f),h=h-n/f+q/f),u=q);f=new THREE.Vector3(h,s,u);e=e.clone().multiplyScalar(f.x);c=c.clone().multiplyScalar(f.y);f=b.clone().multiplyScalar(f.z);f=e.clone().add(c.clone().add(f));z.position.add(f);c=d.clone().sub(z.position).dot(b);z.center=z.position.clone().add(b.multiplyScalar(c));z.pivot=d.clone();b={center:z.center,up:z.up,position:z.position,pivot:z.pivot,fov:a.fov,worldUp:l.sceneUpDirection.clone()};l.elapsedTime=0;l.animateTransition(b)};
this.updatePivotPosition=function(b){var c;c=new THREE.Projector;var d=new THREE.Vector3(b.x/window.innerWidth*2-1,2*-(b.y/window.innerHeight)+1,0.5);c.unprojectVector(d,a);c=(new THREE.Raycaster(a.position,d.sub(a.position).normalize())).intersectObjects(objects);if("zoom"==l.mode)if(void 0!==c[0])b=c[0].point,l.pivot=b;else{b.y=Math.abs(b.y-window.innerHeight);var e=a.position;c=l.center.clone().sub(e);var d=a.up,f=c.clone().cross(d),g=c.clone().length(),h=g*Math.tan(THREE.Math.degToRad(a.leftFov)),
k=g*Math.tan(THREE.Math.degToRad(a.rightFov)),m=g*Math.tan(THREE.Math.degToRad(a.topFov)),g=g*Math.tan(THREE.Math.degToRad(a.bottomFov)),h=b.x*(h+k)/window.innerWidth-h;b=b.y*(m+g)/window.innerHeight-g;d=d.clone().normalize().clone().multiplyScalar(b);f=f.clone().normalize().clone().multiplyScalar(h);l.ortho?b=e.clone().add(f).clone().add(d):(b=e,c=c.clone().add(d).clone().add(f));l.pivot=b.clone().add(c)}else void 0!==c[0]?(wheel.cursorImage("pivot"),b=c[0].point,l.isMouseDown||(l.pivot=b)):wheel.cursorImage("SWInvalidArea")};
this.onDrawHeight=function(b,c,d,e,f){b=new THREE.Vector3(0,1,0);b=a.position.clone().dot(b);b=Math.linearClamp(b,l.minSceneBound,l.maxSceneBound)-0.5;p&&(p.find("img#updownImageA").remove(),p.prepend('<img src="'+f+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(d-86*b)+"px; left:"+c+'px;"/>'),e||p.prepend('<img src="'+f+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(d-86*b)+"px; left:"+c+'px;"/>'))};this.drawDropdownMenu=function(a,
b,c,d,e,f){var g=0;if(!n){var h=0;n=document.createElement("ul");n.className="dropDownMenu";for(var k=0;k<a.length;k++){var l=document.createElement("li");null==a[k]?(l.style.height="1px",h+=1,l.style.backgroundColor="#E0E0E0"):(l.id="menuItem"+g,g++,h+=25,l.className=b[k]?"dropDownMenuItem":"dropDownMenuItemDisabled",l.innerHTML=a[k]);n.appendChild(l)}this.menuSize.x=230;this.menuSize.y=h;n.style.height=h+"px"}a=d-15;b=c+1;b+this.menuSize.x>window.innerWidth&&(b=c-this.menuSize.x-1);a+this.menuSize.y>
window.innerHeight&&(a=window.innerHeight-this.menuSize.y);a-=f.y;b-=f.x;n.style.top=a+"px";n.style.left=b+"px";this.menuOrigin.x=b;this.menuOrigin.y=a;e.appendChild(n)};this.removeDropdownMenu=function(a){a.removeChild(n)};this.startInteraction=function(a,b){this.startCursor=new THREE.Vector2(a,b);this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()};this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=
0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0)};this.orbit=function(b,c,e,h){if(!this.navApi.getIsLocked()){var k="wheel";h&&(k="cube");"cube"==k?(this.saveCenter.copy(h.saveCenter),this.saveEye.copy(h.saveEye),this.savePivot.copy(h.savePivot),this.saveUp.copy(h.saveUp),this.doCustomOrbit=this.useSnap=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(a.position),this.saveUp.copy(a.up),this.doCustomOrbit=this.useSnap=!1);l.combined&&
void 0==w&&(w=this.saveCenter.clone(),v=this.saveEye.clone(),A=this.savePivot.clone(),B=this.saveUp.clone());if(this.preserveOrbitUpDirection){var k=f(b.x-c.x,b.y-c.y),m=f(e.x,e.y);c=this.sceneUpDirection.clone();var n=this.sceneFrontDirection.clone(),p=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();e=l.combined?A:this.savePivot;h=l.combined?v:this.saveEye;var q=l.combined?w:this.saveCenter,s=l.combined?B:this.saveUp,t=e.clone().sub(h).normalize(),u=q.clone().sub(h).normalize(),
z=u.clone().cross(s);b=h.clone().sub(e).length();h=h.clone().sub(q).length();t=t.clone().multiplyScalar(-1);u=u.clone().multiplyScalar(-1);s=s.clone();this.constrainOrbitHorizontal||(-0.009>c.dot(this.saveUp)&&(k.x=-k.x,m.x=-m.x),q=0,this.lastSnapRotateX=q=l.combined?m.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+g("h",0,-m.x):k.x*this.orbitMultiplier,q=(new THREE.Quaternion).setFromAxisAngle(c,-q),t.applyQuaternion(q),u.applyQuaternion(q),z.applyQuaternion(q),s.applyQuaternion(q));this.constrainOrbitVertical||
(n=n.clone().multiplyScalar(n.dot(z)),p=p.clone().multiplyScalar(p.dot(z)),p=n.clone().add(p),p.clone().normalize(),z=0,l.combined?z=m.y*this.orbitMultiplier:(m=g("v",0,m.y),z=this.useSnap?this.lastSnapRotateY+m:k.y*this.orbitMultiplier),k=(new THREE.Quaternion).setFromAxisAngle(p,-z),this.navApi.getOrbitPastWorldPoles()||(m=s.clone(),m.applyQuaternion(k).normalize(),0>c.dot(m)&&(m=u.clone(),m.applyQuaternion(k).normalize(),c=m.angleTo(c),Math.abs(c)>0.5*Math.PI&&(c-=0<c?Math.PI:-Math.PI),z-=c,k.setFromAxisAngle(p,
-z))),t.applyQuaternion(k).normalize(),u.applyQuaternion(k).normalize(),s.applyQuaternion(k).normalize(),this.lastSnapRotateY=z);e=t.multiplyScalar(b).add(e);a.position.copy(e);a.up.copy(s);this.center.copy(e);this.center.sub(u.multiplyScalar(h));l.combined&&(w.copy(this.center),v.copy(a.position),A.copy(this.pivot),B.copy(a.up))}a.lookAt(this.center);d(!1)}};this.look=function(b){if(!this.navApi.getIsLocked()){var c=f(b.x,b.y),e=this.userLookSpeed;b=this.getView();var g=a.up,h=b.clone().cross(g),
c=c.clone().multiplyScalar(e),h=(new THREE.Quaternion).setFromAxisAngle(h.normalize(),c.y);b=h.clone().rotate(b);g=h.clone().rotate(g);g.normalize();h=this.sceneUpDirection.clone();h=a.keepSceneUpright?h:g;c=(new THREE.Quaternion).setFromAxisAngle(h,-c.x);b=c.clone().rotate(b);g=c.clone().rotate(g);this.center=a.position.clone().add(b);a.up=g;a.lookAt(this.center);d(!1)}};this.pan=function(b){if(!this.navApi.getIsLocked()){b=f(b.x,b.y);var c=this.getView(),e=a.up.clone().cross(c),g=c.clone().cross(e);
e.normalize();g.normalize();c.normalize();var h=this.pivot.clone().sub(a.position),h=c.clone().dot(h),c=h*(Math.tan(THREE.Math.degToRad(a.leftFov))+Math.tan(THREE.Math.degToRad(a.rightFov))),h=h*(Math.tan(THREE.Math.degToRad(a.topFov))+Math.tan(THREE.Math.degToRad(a.bottomFov))),c=b.x*Math.abs(c);b=b.y*Math.abs(h);h=new THREE.Vector3;e=e.clone().multiplyScalar(c);g=g.clone().multiplyScalar(b);h=e.clone().add(g).clone().multiplyScalar(this.userPanSpeed);a.position.add(h);this.center.add(h);a.lookAt(this.center);
d(!1)}};this.zoom=function(b){if(!this.navApi.getIsLocked()){var c=this.userZoomSpeed,e=Number.MAX_VALUE;b=b.x+b.y;var f=Math.pow(c,b),g=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(f)),h=g.clone().add(l.D.clone().multiplyScalar(l.D.clone().dot(this.pivot.clone().sub(g).clone())));if(!(f>=e)){if(0<b){Math.pow(c,b-0);if(0>b)return;a.position=g;this.center=h;g.clone().sub(this.saveEye).dot(l.D)>e&&(a.position=this.saveEye.sub(l.D).clone().multiplyScalar(e))}else a.position=
g,this.center=h;a.lookAt(this.center);d(!1)}}};this.walk=function(b,c,e,g,l){if(!this.navApi.getIsLocked()){e=this.sceneUpDirection.clone();g=this.sceneFrontDirection.clone();l=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);h(b,c)?(wheel.cursorImage("SWWalk"),k(!0,b,c),x=c.x,y=c.y):k(!1,b,c);x=b.x;y=b.y;var m=f(x-c.x,y-c.y),n=-m.x,p=-m.y,q=0>n?-1:1,m=0>p?-1:1,s=Math.abs(n),t=Math.abs(p),t=new THREE.Vector2(30,30),t=f(t.x,t.y),s=h(b,c)?0:Math.abs(n)-t.x,t=h(b,c)?0:Math.abs(p)-t.y,s=
s/0.25,t=t/0.25,s=1>s?Math.easeClamp(s,0,1):Math.pow(s,1),t=1>t?Math.easeClamp(t,0,1):Math.pow(t,1),n=0<s?s*q:0,m=0<t?t*m:0;b=this.getView();c=b.length();b.normalize();b.clone().cross(a.up).normalize();l=l.clone().multiplyScalar(l.clone().dot(b));l=g.clone().multiplyScalar(g.clone().dot(b)).clone().add(l);l=l.clone().length()>Number.MIN_VALUE?l.normalize():a.up;g=1*m*this.walkMultiplier;m=Math.cos(0.65);1!=m&&(e.clone().dot(a.up)<-Number.MIN_VALUE&&e.clone().dot(b)<-m||e.clone().dot(a.up)>Number.MIN_VALUE&&
e.clone().dot(b)>m)&&(l=-l);n=-n*this.walkMultiplier*0.05;m=a.up;if(e.clone().dot(a.up)<-Number.MIN_VALUE||Math.abs(e.clone().dot(a.up))<Number.MIN_VALUE&&e.clone().dot(b)>Number.MIN_VALUE)n=-n;m=e;n=(new THREE.Quaternion).setFromAxisAngle(m,n);n.normalize();b=n.clone().rotate(b);b.normalize();a.up=n.clone().rotate(a.up);a.up.normalize();a.position.add(l.clone().multiplyScalar(g));this.center=a.position.clone().add(b.clone().multiplyScalar(c));e.normalize();a.lookAt(this.center);d(!1)}};this.updown=
function(b){if(!this.navApi.getIsLocked()){var c=Math.pow(b,2);0>b&&(c=-c);c=f(0,c);c.y=0.01*c.y*(l.maxSceneBound-l.minSceneBound);c=l.userHeightSpeed*c.y;var e=l.m_amount;if(0==b)c=0;else{var g=l.saveEye.clone().sub(worldUp.clone().multiplyScalar(e+c)),e=l.saveEye.clone().sub(worldUp.clone().multiplyScalar(e)),h=0,h=(l.maxSceneBound-l.minSceneBound)/1E3;l.topLimit&&0<b?(h=l.maxSceneBound-h,l.topLimit=!1):l.bottomLimit&&0>b?(h=l.minSceneBound+h,l.bottomLimit=!1):h=g.dot(worldUp);b=e.dot(worldUp);
h<l.minSceneBound?b<l.minSceneBound&&(l.bottomLimit=!0,c=0):h>l.maxSceneBound&&b>l.maxSceneBound&&(l.topLimit=!0,c=0)}l.m_amount+=c;b=new THREE.Vector3(0,1,0);c=l.saveEye.clone().sub(b.clone().multiplyScalar(l.m_amount));g=c.clone().dot(b);a.position=c;g<l.minSceneBound&&a.position.add(b.clone().multiplyScalar(l.minSceneBound-g));g>l.maxSceneBound&&a.position.add(b.clone().multiplyScalar(l.maxSceneBound-g));this.center=a.position.clone().add(l.saveCenter.clone().sub(l.saveEye));a.lookAt(this.center);
d(!1)}};this.addHistoryElement=function(){};this.addIntermediateHistoryElement=function(){this.rewindParams.history=this.rewindParams.snapped?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):0<this.rewindParams.slideOffset.x?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1);this.addHistoryElement()};this.clearHistory=function(){this.rewindParams.history.length=0;this.rewindParams.timelineIndex=
0;this.rewindParams.timelineIndexSlide=0;this.rewindParams.resetWeights=!0};this.openTimeline=function(a){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex;this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled);0==this.rewindParams.history.length&&this.addHistoryElement();for(var b=0;b<this.rewindParams.history.length;b++){var c=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize;this.rewindParams.history[b].thumbnailBounds.setCenter((new THREE.Vector2(a.x+
(b-this.rewindParams.timelineIndex)*c,a.y)).add(this.rewindParams.slideOffset));this.rewindParams.resetWeights&&(this.rewindParams.history[b].weight=b==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1);c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);this.rewindParams.open=!0;this.rewindParams.openLocation=a.clone();this.rewindParams.openLocationOrigin=a.clone();this.rewindParams.openBracket=a.clone();this.rewindParams.openBracketA=
new THREE.Vector2(c,a.y);this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-c,a.y);this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x&&(a=this.rewindParams.openBracketA.x,this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=a);this.rewindParams.locationOffset=new THREE.Vector2(0,0);this.rewindParams.snapOffset=new THREE.Vector2(0,0)};this.slideTimeline=function(a){if(this.rewindParams.open&&0!=this.rewindParams.history.length){var b=
a.clone().add(this.rewindParams.locationOffset),c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);a=window.innerWidth-c;var d=this.rewindParams.history[0].thumbnailBounds.center().x,e=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,f=0;b.x<this.rewindParams.openBracketA.x&&(f=b.x-this.rewindParams.openBracketA.x,d-=f,c<d&&(f=Math.min(f+(d-c),0)));b.x>this.rewindParams.openBracketB.x&&(f=b.x-this.rewindParams.openBracketB.x,c=e-f,a>c&&
(f=Math.max(f+(c-a),0)));this.rewindParams.openLocation.x+=f;this.rewindParams.openBracketA.x+=f;this.rewindParams.openBracketB.x+=f;this.rewindParams.openBracket.x=b.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x);a=new THREE.Vector2(-f,0);b=b.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin));a.x+=this.rewindParams.snapOffset.x;this.rewindParams.snapOffset.x=0;c=!1;if(this.rewindParams.snappingEnabled)for(e=0;e<this.rewindParams.history.length;e++)if(d=
this.rewindParams.history[e].thumbnailBounds.center().add(a),4>Math.abs(d.x-b.x)||this.rewindParams.snapped&&16>Math.abs(d.x-b.x)){c=!0;0!=f?(this.rewindParams.snapOffset.x=d.x-b.x,a.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=d.x-b.x;b.x=d.x;break}this.rewindParams.snapped=c;c=-1;for(e=f=0;e<this.rewindParams.history.length;e++){d=this.rewindParams.history[e].thumbnailBounds.clone();this.rewindParams.history[e].thumbnailBounds.setCenter(this.rewindParams.history[e].thumbnailBounds.center().add(a));
if(this.rewindParams.history[e].thumbnail){var g=this.rewindParams.history[e].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2;$("#rewindFrame"+e).css("left",g);$("#rewindBorder"+e).css("left",g-4)}g=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize));d.setFromCenterAndSize(d.center(),g);g=new THREE.Vector2(0,0);d.getIcon2DCoords(b,g);g=1-Math.abs(Math.equalityClamp(g.x,-1,1));
this.rewindParams.history[e].weight=g;0==e&&b.x<d.center().x&&(this.rewindParams.history[e].weight=1);e==this.rewindParams.history.length-1&&b.x>d.center().x&&(this.rewindParams.history[e].weight=1);f+=this.rewindParams.history[e].weight;this.rewindParams.history[e].weight>c&&(c=this.rewindParams.history[e].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[e].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[e].thumbnailBounds.center().x-
b.x,this.rewindParams.timelineIndexSlide=e)}for(a=0;a<this.rewindParams.history.length;a++)this.rewindParams.history[a].weight/=f;a=this.rewindParams.history[0].thumbnailBounds.center().x;b=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x;this.rewindParams.openBracket.x<a?(this.rewindParams.locationOffset.x+=a-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=a):this.rewindParams.openBracket.x>b&&(this.rewindParams.locationOffset.x+=b-this.rewindParams.openBracket.x,
this.rewindParams.openBracket.x=b)}};this.shiftBackOneElement=function(){0!=this.rewindParams.history.length&&(0<this.rewindParams.timelineIndex||0!=this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||0<this.rewindParams.slideOffset.x)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,l.elapsedTime=0,this.animateToRewindIndex())};this.animateToRewindIndex=function(){var b=this.rewindParams.timelineIndex,
c=0;1<=l.elapsedTime?c=1:(c=Math.easeClamp(l.elapsedTime/1,0,1),l.elapsedTime+=t/500);l.center=l.center.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.center.clone().multiplyScalar(c));a.position=a.position.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.position.clone().multiplyScalar(c));a.up=this.rewindParams.history[b].camera.up;l.pivot=l.center;a.lookAt(l.center);d(!1);m&&requestAnimationFrame(m.render);1!==c&&requestAnimationFrame(function(){l.animateToRewindIndex()})};
this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide);this.rewindParams.open=!1};this.getInterpolatedCamera=function(){var b=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1E4);b.center=new THREE.Vector3(0,0,0);b.pivot=new THREE.Vector3(0,0,0);b.leftFov=0;b.rightFov=0;b.topFov=0;b.bottomFov=0;b.up.set(0,0,0);for(var c=0;c<this.rewindParams.history.length;c++){var e=
this.rewindParams.history[c].camera,f=this.rewindParams.history[c].weight;b.center.add(e.center.clone().multiplyScalar(f));b.position.add(e.position.clone().multiplyScalar(f));b.up.add(e.up.clone().multiplyScalar(f));b.rotation.add(e.rotation.clone().multiplyScalar(f));b.pivot.add(e.pivot.clone().multiplyScalar(f));b.leftFov+=e.leftFov*f;b.rightFov+=e.rightFov*f;b.topFov+=e.topFov*f;b.bottomFov+=e.bottomFov*f}a.position=b.position;a.up=b.up;a.rotation=b.rotation;a.leftFov=b.leftFov;a.rightFov=b.rightFov;
a.topFov=b.topFov;a.bottomFov=b.bottomFov;l.center=b.center;l.pivot=b.pivot;a.lookAt(l.center);a.up.normalize();d(!1)}};Autocam.ViewCube=function(a,b,c){function e(a){var b=f.sceneFrontDirection.clone().cross(f.sceneUpDirection),c=Math.abs(Math.abs(a.dot(f.sceneUpDirection))-1),d=Math.abs(Math.abs(a.dot(f.sceneFrontDirection))-1);a=Math.abs(Math.abs(a.dot(b))-1);return 1E-5>c||1E-5>d||1E-5>a}var d=this,f=b,g=b.camera;b.setCube(this);var h=RESOURCE_ROOT+"textures/";d.currentFace="front";var k="top,front;top right;top,left;top,back;bottom,front;bottom,right;bottom,left;bottom,back;left,front;front,right;right,back;back,left".split(";"),
l="front,top,right back,top,right front,top,left back,top,left front,bottom,right back,bottom,right front,bottom,left back,bottom,left".split(" "),m=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],n=[!0,null,!1,!0,!1,null,!0,!0,!0,null,!0,!0,!0],p,q,s,t,u,v,w;d.camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,
1,2E3);d.camera.position.copy(g.position);d.center=new THREE.Vector3(0,0,0);d.camera.lookAt(d.center);var B,A,D,W,C,P,G=[],F,N=[],z=[],M=[],H=[],Q=[],V=null,T=null,I=null,E=0,J,ca=0,Y=!0,ga=!1,R=!1,la=!1,Z=-1!=navigator.userAgent.search("Chrome"),ia=-1!=navigator.platform.search("Win32"),wa=!1,oa=!1,ma=[];this.height=this.width=0;this.animSpeed=500;this.animate=!0;this.compass=!1;this.viewScaleFactorCompass=1.5;this.viewScale=1;this.draggable=!0;this.wantHomeButton=!1;this.wantContextMenu=this.wantRollArrows=
!0;this.inactiveOpacity=0.5;var xa=function(a){a=a.getBoundingClientRect();return{x:a.left,y:a.top,w:a.width,h:a.height}},Ba=function(a){a.preventDefault();a.stopPropagation();R=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c},ra=function(){f.navApi.getIsLocked()||(c.style.opacity="1.0",oa=!1);"undefined"!=typeof wheel&&(wheel.disabledMode=!0);requestAnimationFrame(d.render)},pa=function(a){if(oa||f.viewCubeMenuOpen||f.navApi.getIsLocked())f.navApi.getIsLocked()||
(c.style.opacity=1);else{var b=Math.max(4*Math.abs((a.clientX-J.x)/J.w-0.5)-1,0);a=Math.max(4*Math.abs((a.clientY-J.y)/J.h-0.5)-1,0);b=Math.max(0,Math.min(Math.sqrt(b*b+a*a),1));c.style.opacity=1-b*(1-d.inactiveOpacity)}},ua=function(){f.viewCubeMenuOpen||(c.style.opacity=d.inactiveOpacity,oa=!0,"undefined"!=typeof wheel&&(wheel.disabledMode=!1),requestAnimationFrame(d.render))},ba=function(a){var b=new Image;b.crossOrigin="anonymous";var c=new THREE.Texture(b);b.onload=function(){c.needsUpdate=!0;
ca++;14<=ca&&requestAnimationFrame(d.render)};b.src=a;return c},Ca=function(a,b,c){var d=new THREE.Projector,e=new THREE.Vector3;e.copy(a);d.unprojectVector(e,b);return(new THREE.Raycaster(b.position,e.sub(b.position).normalize())).intersectObjects(c)},Oa=function(a,b){var c=a.clientX-b.x,d=a.clientY-b.y,c=c/b.w*2-1,d=(b.h-d)/b.h*2-1;return new THREE.Vector3(c,d,0.5)},Za=function(a){a.preventDefault();a.stopPropagation();if(!f.navApi.getIsLocked()){J=xa(c);c.removeEventListener("mousemove",va,!1);
document.addEventListener("mouseup",sa,!1);f.navApi.getUsePivotAlways()||(f.pivot.copy(f.center),f.navApi.setPivotPoint(f.center),f.navApi.setPivotSetFlag(!1));f.startInteraction(a.pageX,a.pageY);var b;0==f.rewindParams.history.length&&f.addHistoryElement();f.rewindParams.snapped&&f.rewindParams.timelineIndex+1==f.rewindParams.history.length||f.addIntermediateHistoryElement();a=a||window.event;b=f.navApi.getUseLeftHandedInput()?1:3;a.which===b||f.currentlyAnimating||(0>=d.animSpeed?console.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation"):
(b=Oa(a,J),b=Ca(b,d.camera,Q),0<b.length&&(qa(),d.draggable&&(document.addEventListener("mousemove",Ma,!1),d.prevX=a.screenX,d.prevY=a.screenY,ga&&(c.requestPointerLock(),la=Z&&ia)))))}},Ma=function(a){a.preventDefault();a.stopPropagation();if(0>=d.animSpeed)document.removeEventListener("mousemove",Ma,!1),console.error("animSpeed cannot be 0 or less");else if(!f.currentlyAnimating){var b,c;ga?la?(la=!1,b=c=0):(b=a.movementX||a.mozMovementX||a.webkitMovementX||0,c=a.movementY||a.mozMovementY||a.webkitMovementY||
0):(b=a.screenX-d.prevX,c=a.screenY-d.prevY,d.prevX=a.screenX,d.prevY=a.screenY);R&&(300<b||300<c)&&(c=b=0);b===c&&0===b?f.currentlyAnimating=!1:(Y=!1,wa=!0,f.showPivot(!0),f.currentCursor=new THREE.Vector2(a.pageX,a.pageY),f.orbit(f.currentCursor,f.startCursor,new THREE.Vector3(-b,c,0),f.startState),d.camera.lookAt(d.center),requestAnimationFrame(d.render))}},da=function(a){a||document.removeEventListener("mouseup",sa,!1);document.removeEventListener("mousemove",Ma,!1);c.addEventListener("mousemove",
va,!1);R&&document.exitPointerLock()},sa=function(a){a.preventDefault();a.stopPropagation();var b,e,h;if(f.currentlyAnimating||wa)f.showPivot(!1),wa=!1,da(!1);else if(f.viewCubeMenuOpen){b=a.clientX-J.x;e=a.clientY-J.y;if(f.menuOrigin.x<=b&&b<=f.menuOrigin.x+f.menuSize.x&&f.menuOrigin.y<=e&&e<=f.menuOrigin.y+f.menuSize.y)switch(Math.floor((e-5-f.menuOrigin.y)/25)){case 0:f.goHome();break;case 4:f.setCurrentViewAsHome(!1);break;case 5:f.setCurrentViewAsHome(!0);break;case 6:f.resetHome();break;case 7:f.setCurrentViewAsFront();
break;case 8:f.setCurrentViewAsTop();break;case 9:f.resetOrientation()}f.viewCubeMenuOpen=!1;f.removeDropdownMenu(c);(a.clientX<J.x||a.clientX>J.w+J.x||a.clientY<J.y||a.clientY>J.h+J.y)&&ua();d.mouseMoveSave&&d.processMouseMove(d.mouseMoveSave);da(!1)}else if(b=f.navApi.getUseLeftHandedInput()?1:3,a.which===b)f.viewCubeMenuOpen=!0,f.drawDropdownMenu(m,n,a.clientX,a.clientY,c,J),da(!0);else{h=Oa(a,J);b=Ca(h,d.camera,Q);e=Ca(h,w,z);h=Ca(h,w,H);if(0<e.length&&Y){var k=f.getOrientation();switch(d.currentFace){case "front":switch(k){case "up":e[0].object===
z[0]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[1]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[2]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[3]&&(f.calculateCubeTransform("left"),d.currentFace="left");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[1]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[2]?(f.calculateCubeTransform("bottom"),
d.currentFace="bottom"):e[0].object===z[3]&&(f.calculateCubeTransform("top"),d.currentFace="top");break;case "down":e[0].object===z[0]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[1]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[2]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[3]&&(f.calculateCubeTransform("right"),d.currentFace="right");break;case "left":e[0].object===z[0]?(f.calculateCubeTransform("left"),d.currentFace=
"left"):e[0].object===z[1]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[2]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[3]&&(f.calculateCubeTransform("bottom"),d.currentFace="bottom")}break;case "right":switch(k){case "up":e[0].object===z[0]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[1]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[2]?(f.calculateCubeTransform("back"),d.currentFace="back"):
e[0].object===z[3]&&(f.calculateCubeTransform("front"),d.currentFace="front");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[1]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[2]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[3]&&(f.calculateCubeTransform("top"),d.currentFace="top");break;case "down":e[0].object===z[0]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===
z[1]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[2]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[3]&&(f.calculateCubeTransform("back"),d.currentFace="back");break;case "left":e[0].object===z[0]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[1]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[2]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[3]&&(f.calculateCubeTransform("bottom"),
d.currentFace="bottom")}break;case "left":switch(k){case "up":e[0].object===z[0]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[1]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[2]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[3]&&(f.calculateCubeTransform("back"),d.currentFace="back");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[1]?(f.calculateCubeTransform("bavk"),
d.currentFace="back"):e[0].object===z[2]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[3]&&(f.calculateCubeTransform("top"),d.currentFace="top");break;case "down":e[0].object===z[0]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[1]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[2]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[3]&&(f.calculateCubeTransform("front"),d.currentFace="front");break;
case "left":e[0].object===z[0]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[1]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[2]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[3]&&(f.calculateCubeTransform("bottom"),d.currentFace="bottom")}break;case "back":switch(k){case "up":e[0].object===z[0]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[1]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):
e[0].object===z[2]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[3]&&(f.calculateCubeTransform("right"),d.currentFace="right");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[1]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[2]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[3]&&(f.calculateCubeTransform("top"),d.currentFace="top");break;case "down":e[0].object===
z[0]?(f.calculateCubeTransform("bottom"),d.currentFace="bottom"):e[0].object===z[1]?(f.calculateCubeTransform("top"),d.currentFace="top"):e[0].object===z[2]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[3]&&(f.calculateCubeTransform("left"),d.currentFace="left");break;case "left":e[0].object===z[0]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[1]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[2]?(f.calculateCubeTransform("top"),
d.currentFace="top"):e[0].object===z[3]&&(f.calculateCubeTransform("bottom"),d.currentFace="bottom")}break;case "top":switch(k){case "up":e[0].object===z[0]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[1]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[2]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[3]&&(f.calculateCubeTransform("left"),d.currentFace="left");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("right"),
d.currentFace="right"):e[0].object===z[1]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[2]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[3]&&(f.calculateCubeTransform("back"),d.currentFace="back");break;case "down":e[0].object===z[0]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[1]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[2]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===
z[3]&&(f.calculateCubeTransform("right"),d.currentFace="right");break;case "left":e[0].object===z[0]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[1]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[2]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[3]&&(f.calculateCubeTransform("front"),d.currentFace="front")}break;case "bottom":switch(k){case "up":e[0].object===z[0]?(f.calculateCubeTransform("front"),d.currentFace="front"):
e[0].object===z[1]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[2]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[3]&&(f.calculateCubeTransform("left"),d.currentFace="left");break;case "right":e[0].object===z[0]?(f.calculateCubeTransform("right"),d.currentFace="right"):e[0].object===z[1]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[2]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[3]&&(f.calculateCubeTransform("front"),
d.currentFace="front");break;case "down":e[0].object===z[0]?(f.calculateCubeTransform("back"),d.currentFace="back"):e[0].object===z[1]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[2]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[3]&&(f.calculateCubeTransform("right"),d.currentFace="right");break;case "left":e[0].object===z[0]?(f.calculateCubeTransform("left"),d.currentFace="left"):e[0].object===z[1]?(f.calculateCubeTransform("right"),d.currentFace=
"right"):e[0].object===z[2]?(f.calculateCubeTransform("front"),d.currentFace="front"):e[0].object===z[3]&&(f.calculateCubeTransform("back"),d.currentFace="back")}}f.elapsedTime=0;f.sphericallyInterpolateTransition()}if(0<h.length){f.elapsedTime=0;if(d.wantHomeButton&&h[0].object===H[0]){f.goHome();da(!1);return}if(d.wantContextMenu&&h[0].object===H[4]){f.viewCubeMenuOpen=!0;f.drawDropdownMenu(m,n,a.clientX,a.clientY,c,J);da(!0);return}d.wantRollArrows&&Y&&(h[0].object===H[1]||h[0].object===H[2])&&
(e=h[0].object===H[2],h={center:f.center.clone(),position:g.position.clone(),pivot:g.pivot.clone(),fov:g.fov,worldUp:f.sceneUpDirection.clone()},k=f.center.clone().sub(g.position).normalize(),e?h.up=g.up.clone().cross(k):(h.up=g.up.clone().multiplyScalar(-1),h.up.cross(k)),h.up.normalize(),f.elapsedTime=0,f.animateTransition(h))}0<b.length&&(f.calculateCubeTransform(b[0].object.name),d.currentFace=b[0].object.name,f.elapsedTime=0,d.mouseMoveSave=a,f.sphericallyInterpolateTransition(function(){d.mouseMoveSave&&
d.processMouseMove(d.mouseMoveSave)}));da(!1)}};this.processMouseMove=function(a){var b,c;f.viewCubeMenuOpen||f.currentlyAnimating?d.mouseMoveSave=a:(d.mouseMoveSave=null,c=Oa(a,J),a=Ca(c,d.camera,M),b=Ca(c,w,z),c=Ca(c,w,H),V&&!wa&&(V.material.color.setHex(14540253),V=null,requestAnimationFrame(d.render)),0<b.length&&!wa&&(V=b[0].object,V.material.color.setHex(45055),requestAnimationFrame(d.render)),T&&!wa&&(T.material.opacity=0,T=null,requestAnimationFrame(d.render)),0<a.length&&!wa&&(T=a[0].object,
T.material.opacity=0.3,requestAnimationFrame(d.render)),0<c.length&&!wa)?I!==c[0].object&&(d.wantHomeButton&&c[0].object===H[0]?(I=c[0].object,H[0].material.map=ma[0]):d.wantRollArrows&&c[0].object===H[1]?(I=c[0].object,H[3].material.map=ma[1]):d.wantRollArrows&&c[0].object===H[2]?(I=c[0].object,H[3].material.map=ma[2]):d.wantContextMenu&&c[0].object===H[4]?(I=c[0].object,H[4].material.map=ma[6]):d.wantHomeButton&&I===H[0]?(I=null,H[0].material.map=ma[3]):!d.wantRollArrows||I!==H[1]&&I!==H[2]&&I!==
H[3]?d.wantContextMenu&&I===H[4]&&(I=null,H[4].material.map=ma[5]):(I=null,H[3].material.map=ma[4]),requestAnimationFrame(d.render)):null===I||wa||(d.wantHomeButton&&I===H[0]?(I=null,H[0].material.map=ma[3]):!d.wantRollArrows||I!==H[1]&&I!==H[2]&&I!==H[3]?d.wantContextMenu&&I===H[4]&&(I=null,H[4].material.map=ma[5]):(I=null,H[3].material.map=ma[4]),requestAnimationFrame(d.render))};var va=function(a){a.preventDefault();a.stopPropagation();f.navApi.getIsLocked()||d.processMouseMove(a)},Ea=function(){J=
xa(c);d.width=c.offsetWidth;d.height=c.offsetHeight;d.camera.aspect=d.width/d.height;d.camera.updateProjectionMatrix();d.camera.topFov=d.camera.bottomFov=d.camera.fov/2;d.camera.leftFov=d.camera.rightFov=d.camera.aspect*d.camera.fov/2;v.setSize(d.width,d.height);requestAnimationFrame(d.render)},ya=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(0,0,0);var e=new THREE.Vector3(60,-60,105),f=new THREE.Vector3(60,60,105),g=new THREE.Vector3(-60,60,105),h=new THREE.Vector3(-60,-60,105);d.vertices.push(c);
d.vertices.push(e);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.faces.push(new THREE.Face3(1,2,3));d.faces.push(new THREE.Face3(1,3,4));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},aa=function(a,b,c){var d=new THREE.Geometry,e=new THREE.Vector3(60,105,105),f=new THREE.Vector3(-60,
105,105),g=new THREE.Vector3(-60,60,105),h=new THREE.Vector3(60,60,105),k=new THREE.Vector3(60,105,60),l=new THREE.Vector3(-60,105,60),m=new THREE.Vector3(-60,105,105),n=new THREE.Vector3(60,105,105);d.vertices.push(e);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(l);d.vertices.push(m);d.vertices.push(n);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,5,6));d.faces.push(new THREE.Face3(4,6,7));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));
d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.applyMatrix((new THREE.Matrix4).makeRotationZ(c));d.computeFaceNormals();d.computeVertexNormals();a=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,a)},X=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(105,105,105);var e=new THREE.Vector3(60,105,105),f=new THREE.Vector3(60,60,105),g=new THREE.Vector3(105,60,105),h=new THREE.Vector3(105,105,60),k=new THREE.Vector3(105,105,105),
l=new THREE.Vector3(105,60,105),m=new THREE.Vector3(105,60,60),n=new THREE.Vector3(105,105,105),p=new THREE.Vector3(105,105,60),q=new THREE.Vector3(60,105,60),s=new THREE.Vector3(60,105,105);d.vertices.push(c);d.vertices.push(e);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(l);d.vertices.push(m);d.vertices.push(n);d.vertices.push(p);d.vertices.push(q);d.vertices.push(s);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,
5,6));d.faces.push(new THREE.Face3(4,6,7));d.faces.push(new THREE.Face3(8,9,10));d.faces.push(new THREE.Face3(8,10,11));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},ha=function(a){var b=f.cubeFront.clone(),c=f.sceneUpDirection.clone(),d=b.clone().cross(c);c.copy(d).cross(b);b.normalize();
c.normalize();d.normalize();var e=(new THREE.Vector3(b.x,c.x,d.x)).multiplyScalar(a.x);e.add((new THREE.Vector3(b.y,c.y,d.y)).multiplyScalar(a.y));e.add((new THREE.Vector3(b.z,c.z,d.z)).multiplyScalar(a.z));return e};this.render=function(){var a=d.compass?d.viewScaleFactorCompass*d.viewScale:d.viewScale,b=f.center.clone().sub(g.position).normalize(),c=g.up.normalize(),b=ha(b),c=ha(c);d.camera.position=b.multiplyScalar(-1).normalize().multiplyScalar(a);d.camera.up=c.normalize();d.camera.lookAt(d.center);
a=f.center.clone().sub(g.position).normalize();Y=e(a)&&e(g.up);if(!Y||oa||f.currentlyAnimating)qa();else{for(a=0;a<z.length;a++)z[a].material.opacity=1;for(a=3;a<H.length-1;a++)H[a].material.opacity=d.wantRollArrows?1:0}P.material.opacity=oa?0:d.wantContextMenu?1:0;W.material.opacity=oa?0:d.wantHomeButton?1:0;v.clear();v.render(p,d.camera);v.render(q,d.camera);v.render(t,d.camera);v.render(s,d.camera);v.render(u,w)};var qa=function(){for(var a=0;a<z.length;a++)z[a].material.opacity=0;for(a=3;a<H.length-
1;a++)H[a].material.opacity=0};this.refreshCube=function(){Ea()};this.setSize=function(a,b){d.width=a;d.height=b;if(1<c.children.length)for(var e=1;e<c.children.length;e++)c.children[e].style.bottom=(d.height/5).toString()+"px";Ea()};this.useTransparency=function(a){(oa=a)?(c.onmouseover=ra,c.onmousemove=pa,c.onmouseout=ua,ua()):(c.onmouseover=null,c.onmouseout=null,c.onmousemove=null,c.style.opacity="1.0")};(function(){var a=c.getBoundingClientRect();d.width=a.width;d.height=a.height;J=xa(c);w=new THREE.PerspectiveCamera(70,
d.height/d.width,1,1E4);w.position.set(0,0,500);p=new THREE.Scene;q=new THREE.Scene;s=new THREE.Scene;t=new THREE.Scene;u=new THREE.Scene;Y=!0;E=200;d.viewScale=3.5*E;var a=THREE.LinearFilter,b=[];b.push(ba(h+"VCface4.png"));N.push(new THREE.MeshBasicMaterial({map:b[0],overdraw:!1,shading:THREE.SmoothShading,transparent:!0,wireframe:!1}));b.push(ba(h+"VCface5.png"));N.push(new THREE.MeshBasicMaterial({map:b[1],overdraw:!1,shading:THREE.SmoothShading,transparent:!0,wireframe:!1}));b.push(ba(h+"VCface1.png"));
N.push(new THREE.MeshBasicMaterial({map:b[2],overdraw:!1,shading:THREE.SmoothShading,transparent:!0,wireframe:!1}));b.push(ba(h+"VCface2.png"));N.push(new THREE.MeshBasicMaterial({map:b[3],overdraw:!1,shading:THREE.SmoothShading,transparent:!0,wireframe:!1}));b.push(ba(h+"VCface3.png"));N.push(new THREE.MeshBasicMaterial({map:b[4],overdraw:!1,shading:THREE.SmoothShading,transparent:!0,wireframe:!1}));b.push(ba(h+"VCface6.png"));N.push(new THREE.MeshBasicMaterial({map:b[5],overdraw:!1,shading:THREE.SmoothShading,
transparent:!0,wireframe:!1}));for(var e=0;e<b.length;e++)b[e].minFilter=b[e].maxFilter=a;e=new THREE.BoxGeometry(E,E,E,5,5,5);b=new THREE.BoxGeometry(E+1,E+1,E+1,5,5,5);B=new THREE.Mesh(e,new THREE.MeshFaceMaterial(N));B.position.set(0,0,0);e=ba(h+"VCedge1.png");e.minFilter=e.maxFilter=a;A=new THREE.Mesh(b,new THREE.MeshBasicMaterial({map:e,overdraw:!1,transparent:!0,shading:THREE.SmoothShading}));A.position.set(0,0,0);D=new THREE.Object3D;D.add(B);q.add(D);t.add(A);var a=E,b=new THREE.Geometry,
e=new THREE.Vector3(-30,0,0),g=new THREE.Vector3(30,0,0),m=new THREE.Vector3(0,-30,0);b.vertices.push(e);b.vertices.push(g);b.vertices.push(m);b.faces.push(new THREE.Face3(1,0,2));b.computeFaceNormals();var g=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!0,opacity:1,shading:THREE.FlatShading}),n=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!0,opacity:1,shading:THREE.FlatShading}),m=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!0,
opacity:1,shading:THREE.FlatShading}),e=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!0,opacity:1,shading:THREE.FlatShading}),g=new THREE.Mesh(b,g);g.position.set(0,a,0);n=new THREE.Mesh(b,n);n.position.set(0,-a,0);n.rotation.z+=Math.PI;m=new THREE.Mesh(b,m);m.position.set(a,0,0);m.rotation.z-=Math.PI/2;b=new THREE.Mesh(b,e);b.position.set(-a,0,0);b.rotation.z+=Math.PI/2;F=new THREE.Object3D;F.position.set(0,0,0);F.add(g);F.add(n);F.add(m);F.add(b);u.add(F);z.push(g);z.push(n);
z.push(m);z.push(b);a=new THREE.PlaneGeometry(E/3,E/3,2,2);b=new THREE.MeshBasicMaterial({map:ba(h+"VChome.png"),transparent:!0,shading:THREE.FlatShading});W=new THREE.Mesh(a,b);W.position.set(-E,E,0);u.add(W);H.push(W);a=new THREE.PlaneGeometry(1.5*E,1.5*E,2,2);b=new THREE.MeshBasicMaterial({map:ba(h+"VCarrows.png"),shading:THREE.FlatShading,transparent:!0});a=new THREE.Mesh(a,b);a.position.set(0.5*E+20,0.5*E+20,0);b=new THREE.PlaneGeometry(0.75*E,0.5*E,2,2);e=new THREE.MeshBasicMaterial({transparent:!0,
opacity:0});b=new THREE.Mesh(b,e);b.position.set(0.5*E+20,E,0);e=new THREE.PlaneGeometry(0.5*E,0.75*E,2,2);g=new THREE.MeshBasicMaterial({transparent:!0,opacity:0});e=new THREE.Mesh(e,g);e.position.set(E,0.5*E+20,0);u.add(a);u.add(b);u.add(e);H.push(b);H.push(e);H.push(a);a=new THREE.PlaneGeometry(E/2.3,E/2.3,2,2);b=new THREE.MeshBasicMaterial({map:ba(h+"VCcontext.png"),transparent:!0,shading:THREE.FlatShading});P=new THREE.Mesh(a,b);P.position.set(E,-E,0);u.add(P);H.push(P);a=new THREE.Geometry;
a.vertices.push(new THREE.Vector3(0,0,0));a.vertices.push(new THREE.Vector3(-E/2,-E/2-20,-E/2));a.vertices.push(new THREE.Vector3(E/2,-E/2-20,-E/2));a.vertices.push(new THREE.Vector3(E/2,-E/2-20,E/2));a.vertices.push(new THREE.Vector3(-E/2,-E/2-20,E/2));a.faces.push(new THREE.Face3(4,3,2));a.faces.push(new THREE.Face3(4,2,1));b=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:0.5});C=new THREE.Mesh(a,b);p.add(C);b=[];e=[];b[0]=X(0,0);b[1]=X(0,Math.PI/2);b[2]=X(0,-Math.PI/2);b[3]=X(0,Math.PI);
b[4]=X(Math.PI/2,0);b[5]=X(Math.PI/2,Math.PI/2);b[6]=X(Math.PI/2,-Math.PI/2);b[7]=X(Math.PI/2,Math.PI);e[0]=aa(0,0,0);e[1]=aa(0,Math.PI/2,0);e[2]=aa(0,-Math.PI/2,0);e[3]=aa(0,Math.PI,0);e[4]=aa(Math.PI/2,0,0);e[5]=aa(Math.PI/2,Math.PI/2,0);e[6]=aa(Math.PI/2,-Math.PI/2,0);e[7]=aa(Math.PI/2,Math.PI,0);e[8]=aa(0,0,Math.PI/2);e[9]=aa(0,0,-Math.PI/2);e[10]=aa(-Math.PI/2,0,-Math.PI/2);e[11]=aa(-Math.PI,0,-Math.PI/2);G.push(ya(0,0));G[0].name="front";M.push(G[0]);Q.push(G[0]);s.add(G[0]);G.push(ya(0,Math.PI/
2));G[1].name="right";M.push(G[1]);Q.push(G[1]);s.add(G[1]);G.push(ya(0,Math.PI));G[2].name="back";M.push(G[2]);Q.push(G[2]);s.add(G[2]);G.push(ya(0,-Math.PI/2));G[3].name="left";M.push(G[3]);Q.push(G[3]);s.add(G[3]);G.push(ya(Math.PI/2,0));G[4].name="bottom";M.push(G[4]);Q.push(G[4]);s.add(G[4]);G.push(ya(-Math.PI/2,0));G[5].name="top";M.push(G[5]);Q.push(G[5]);s.add(G[5]);a=G.length;for(g=0;g<b.length;g++)G.push(b[g]),G[a+g].name=l[g],s.add(G[a+g]),M.push(G[a+g]),Q.push(G[a+g]);a=G.length;for(g=
0;g<e.length;g++)G.push(e[g]),G[a+g].name=k[g],s.add(G[a+g]),M.push(G[a+g]),Q.push(G[a+g]);"CANVAS"===f.renderer.toUpperCase()?v=new THREE.CanvasRenderer:"WEBGL"===f.renderer.toUpperCase()?v=new FireflyWebGLRenderer({alpha:!0}):(console.log("Incorrect use of Autocam.renderer property"),v=new THREE.CanvasRenderer);d.useTransparency(!0);d.setSize(d.width,d.height);d.camera.topFov=d.camera.bottomFov=d.camera.fov/2;d.camera.leftFov=d.camera.rightFov=d.camera.aspect*d.camera.fov/2;v.autoClear=!1;v.setSize(d.width,
d.height);v.sortObjects=!1;c.appendChild(v.domElement);c.addEventListener("mousedown",Za,!1);c.addEventListener("mousemove",va,!1);window.addEventListener("resize",Ea,!1);if(ga="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document)document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,c.requestPointerLock=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock,document.addEventListener("pointerlockchange",
Ba,!1),document.addEventListener("mozpointerlockchange",Ba,!1),document.addEventListener("webkitpointerlockchange",Ba,!1);ma.push(ba(h+"VChomeS.png"));ma.push(ba(h+"VCarrowsS0.png"));ma.push(ba(h+"VCarrowsS1.png"));ma.push(ba(h+"VChome.png"));ma.push(ba(h+"VCarrows.png"));ma.push(ba(h+"VCcontext.png"));ma.push(ba(h+"VCcontextS.png"))})()};function ViewController(a,b){function c(a){a=THREE.Math.degToRad(a);0>=a&&(a=1E-4);return Math.round(A/Math.tan(0.5*a))}function e(a){0>=a&&(a=1E-4);a=2*Math.atan(A/a);return THREE.Math.radToDeg(a)}function d(a,b){a=2*a-1;b=2*(1-b)-1;if(Ra)return E.intersectGroundViewport(a,b);var c=E.castRayViewport(a,b,!1);return c?c.intersectPoint:null}function f(a,b,c){b=2*(1-b)-1;a=new THREE.Vector3(2*a-1,b,0.5);db.unprojectVector(a,c);c=C.getPosition();a=a.sub(c).normalize();b=C.getPivotPoint().clone();var d=
C.getEyeVector(),e=a.dot(d);b=0!==e?b.sub(c).dot(d)/e:b.sub(c).length();return a.multiplyScalar(b).add(c)}function g(a,b,c){a=C.getPivotDistance();if(b=d(b,c))b=b.sub(C.getPosition()),c=C.getEyeVector().normalize(),a=Math.abs(c.dot(b));C.setTrackingDistance(a)}function h(a){var b=O.domElement.getBoundingClientRect(),c=b.width,b=b.height,d={};d.x=a.reduce(function(a,b){return a+b.x},0)/a.length;d.y=a.reduce(function(a,b){return a+b.y},0)/a.length;d.scaledX=d.x/c;d.scaledY=d.y/b;return d}function k(a){var b=
O.domElement.getBoundingClientRect(),c=b.width,d=b.height,b=a[0].x/c,e=a[0].y/d,c=a[1].x/c;a=a[1].y/d;return Math.sqrt((b-c)*(b-c)+(e-a)*(e-a))}function l(){for(var a=0;a<na.length;++a)na[a]=ea[a]}function m(a){var b=Math.abs(a.endX-a.startX),c=Math.abs(a.endY-a.startY);a=a.endTime-a.startTime<=M;return b<=N&&c<=N&&a}function n(a){return Date.now()-a.endTime>=H}function p(a,b){var c=b.startTime-a.endTime,d=Math.abs(b.endX-a.startX),e=Math.abs(b.endY-a.startY),c=c<=H;return d<=z&&e<=z&&c}function q(){null!==
Ua&&(clearTimeout(Ua),Ua=null);for(;0<ab.length;){var a=ab.shift();if(m(a))if(0<ab.length){var b=ab.shift();m(b)?p(a,b)?O.handleDoubleTap(a,b):(O.handleSingleTap(a),ab.unshift(b)):O.handleSingleTap(a)}else if(n(a))O.handleSingleTap(a);else{ab.unshift(a);Ua=setTimeout(function(){Ua=null;q()},H);break}}}var s=0.5*Math.PI,t=2*Math.PI,u=Math.sin(THREE.Math.degToRad(20)),v=-1!=navigator.userAgent.search("Mac OS"),w=-1!=navigator.userAgent.search("Firefox"),B=void 0,A=12,D=function(){var a=new THREE.Vector3;
return function(b,c,d,e){b=new THREE.Vector3(b,c,d);c=e.dot(b);a.copy(e);a.multiplyScalar(c);return b.sub(a)}}();this.setClickBehavior=function(a){this.clickConfig=a};this.getClickBehavior=function(){return this.clickConfig};var W=function(){var a=new THREE.Matrix4,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h){var k=a.elements;d.subVectors(g,f).normalize();0===d.lengthSq()&&(d.z=1);b.crossVectors(h,d).normalize();0===b.lengthSq()&&(h.z>h.y?d.y-=1E-4:d.z+=1E-4,
b.crossVectors(h,d).normalize());c.crossVectors(d,b);k[0]=b.x;k[4]=c.x;k[8]=d.x;k[1]=b.y;k[5]=c.y;k[9]=d.y;k[2]=b.z;k[6]=c.z;k[10]=d.z;e.setRotationFromMatrix(a)}}();THREE.EventDispatcher.call(this);this.camera=a.camera;this.domElement=a.canvas;this.downY=this.downX=-1;this.inTouch=this.isDragging=!1;var C=new function(a){var c=0,d=0,e=0,f=0,g=5,h=0.025,k=!1,l=!1,m=!1,n=!1,p=null,r=!1,q=new THREE.Vector3(0,0,0),A=a.position.clone(),w=new THREE.Vector2(0,0),z=a.up.clone();this.saveCOI=function(){p=
this.getPivotPoint().clone();r=b.navigation.getPivotSetFlag()};this.restoreCOI=function(){null!==p&&(this.setPivotPoint(p,!0,r),r||b.navigation.setPivotSetFlag(!1),p=null)};this.isDirty=function(){return k};this.cameraChanged=function(a){var b=l;a&&(l=!1);return b};this.getPosition=function(){return A.clone().add(this.getViewOffset())};this.setPosition=function(a){this.setView(a,q)};this.getPivotDistance=function(){return e};this.setPivotPoint=function(a,c,d){if(c){c=k;var e=this.getPosition(),f=
new THREE.Vector3;f.subVectors(a,e);var g=this.getCameraRightVector(),h=this.getCameraUpVector(),m=g.dot(f),f=h.dot(f);g.multiplyScalar(m);h.multiplyScalar(f);e.add(g);e.add(h);this.setView(e,a,-m,-f);k=c}else this.setView(A,a);b.navigation.setPivotPoint(this.getPivotPoint());d&&b.navigation.setPivotSetFlag(!0);k||(l=!0)};this.getPivotPoint=function(){return q};this.pivotIsSet=function(){return b.navigation.getPivotSetFlag()};this.getLookAtPoint=function(){return this.getEyeVector().add(A).add(this.getViewOffset())};
this.getForwardLookAtPoint=function(b){var c=this.getEyeVector().normalize(),d=this.getPosition();b=(b=b(0.5,0.5))?b.sub(d).length():0.5*(a.near+a.far);return d.add(c.multiplyScalar(b))};this.getCameraUpVector=function(){var b=this.getEyeVector();return 0===b.lengthSq()?a.up:this.getCameraRightVector().cross(b).normalize()};this.getCameraRightVector=function(){var b=new THREE.Vector3,c=this.getEyeVector();if(0===c.lengthSq())return b.set(1,0,0);var d=m?this.getCurrentUpVector().multiplyScalar(-1):
a.up;b.crossVectors(c,d);0===b.lengthSq()&&(d.z>d.y?c.y-=1E-4:c.z+=1E-4,b.crossVectors(c,d));return b.normalize()};this.checkCameraUp=function(){var b=this.getCameraRightVector(),c=this.getWorldUpVector(),b=b.dot(c);if(!(Math.abs(b)<u)){c.copy(a.up);var b=0<=c.x?c.x:-c.x,d=0<=c.y?c.y:-c.y,e=0<=c.z?c.z:-c.z;b>d&&b>e?c.set(0<c.x?1:-1,0,0):d>b&&d>e?c.set(0,0<c.y?1:-1,0):c.set(0,0,0<c.z?1:-1)}z.copy(c)};this.setWorldUpVector=function(c,d){b.navigation.setWorldUpVector(c);d&&(m=!1,a.up.copy(c),a.up.copy(this.getCameraUpVector()));
this.setView(A,q,w.x,w.y)};this.getCurrentUpVector=function(){return z.clone()};this.getCurrentRightVector=function(){var a=this.getCurrentUpVector();Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};this.getWorldUpVector=function(){return b.navigation.getWorldUpVector()};this.getWorldRightVector=function(){var a=this.getWorldUpVector();Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};
this.getEyeVector=function(){var a=new THREE.Vector3;a.subVectors(q,A);n&&a.set(-a.x,-a.y,-a.z);return a};this.setTrackingDistance=function(a){f=a};this.getWorldSize=function(c){var d=b.navigation.getScreenViewport(),d=d.width/d.height;c=2*c*Math.tan(THREE.Math.degToRad(0.5*a.fov));return new THREE.Vector2(c*d,c)};this.trackReset=function(){w.set(0,0);b.navigation.setPivotSetFlag(!1)};this.trackRelative=function(a,b){var c=this.getWorldSize(f);w.set(w.x+a*c.x,w.y+b*c.y);k=!0};this.getViewOffset=function(){var a=
this.getCameraUpVector(),b=this.getCameraRightVector().multiplyScalar(w.x),a=a.multiplyScalar(w.y);return b.add(a)};this.adjustDollyLookSpeed=function(a){0===a?(h=0.025,g=5):(h*=0<a?1.1:0.9,g*=0<a?1.1:0.9,1E-6>h&&(h=1E-6),1E-6>g&&(g=1E-6))};this.getDollySpeed=function(){var a=e*h;return 0.01>a?0.01:a};this.getLookSpeed=function(){return g};this.coiIsVisible=function(){if(n)return!1;var c=Math.abs(w.x),d=Math.abs(w.y),f=b.navigation.getScreenViewport(),g=e*Math.tan(THREE.Math.degToRad(0.5*a.fov));
return c<f.width/f.height*g&&d<g};this.coiIsActive=function(){return b.navigation.getPivotSetFlag()&&this.coiIsVisible()};this.orbitRelative=function(a,b){(1E-5<Math.abs(a)||1E-5<Math.abs(b))&&this.look(c-a*g,d+b*g,e,!0)};this.dollyRelativeTowardsPoint=function(a,b){1E-5>=Math.abs(a)||(this.saveCOI(),this.setPivotPoint(b,!0,!1),this.dollyRelativeTowardsCOI(a),this.restoreCOI())};this.dollyRelativeTowardsCOI=function(a){if(!(1E-5>=Math.abs(a))){a*=this.getDollySpeed();var b=q.clone().sub(A),c=b.length();
a=c+a;0.01>a&&(a=0.01);c=a/c;1E-5<Math.abs(c-1)&&(b.multiplyScalar(c),b.set(-b.x,-b.y,-b.z),b.add(q),this.setView(b,q,w.x*c,w.y*c))}};this.setView=function(a,b,c,d,e){var f=new THREE.Vector3;f.subVectors(a,b);var g=0,h=0,l=10,m=f.lengthSq();if(0<m){var h=this.getCurrentUpVector(),g=this.getCurrentRightVector(),l=g.clone().cross(h).normalize(),h=h.dot(f),g=g.dot(f),l=l.dot(f),fb=(new THREE.Vector2(g,l)).length(),h=Math.atan2(h,fb),g=Math.atan2(g,l),l=Math.sqrt(m);n=e?!1:0<f.dot(this.getEyeVector())}q.copy(b);
A.copy(a);w.set(c||0,d||0);k=!0;this.look(g,h,l,!1)};this.look=function(a,b,g,h){0.01>g&&(g=0.01);a>t?a-=t:0>a&&(a+=t);b+=s;b>t?b-=t:0>b&&(b+=t);m=b>Math.PI;b-=s;if(1E-5<Math.abs(c-a)||1E-5<Math.abs(d-b)||1E-5<Math.abs(e-g))k=!0;c=a;d=b;f=e=g;h&&(a=new THREE.Quaternion,b=this.getCurrentUpVector(),g=this.getCurrentRightVector(),h=g.clone().cross(b).normalize(),a.setFromAxisAngle(g,-d),h.applyQuaternion(a),a.setFromAxisAngle(b,c),h.applyQuaternion(a),A.set(q.x,q.y,q.z),A.add(h.multiplyScalar(e)),k=
!0)};this.updateCamera=function(){b.navigation.setView(this.getPosition(),this.getLookAtPoint());b.navigation.getPivotSetFlag()||(q.copy(a.target),A.copy(a.position),w.set(0,0));b.navigation.setPivotPoint(q);b.navigation.updateCamera();k=!1};this.oneStepTowards=function(b,c,d,e){var f;if(1<e){var g=1/e,h=1-g;b=b.clone().multiplyScalar(g);c=c.clone().multiplyScalar(g);e=w.x*h;f=w.y*h;A.multiplyScalar(h).add(b);q.multiplyScalar(h).add(c);a.fov=a.fov*h+d*g}else e=f=0,A.copy(b),q.copy(c),a.fov=d;this.setView(A,
q,e,f,!0)};this.changeFOV=function(b){6.88>b?b=6.88:100<b&&(b=100);if(b!==a.fov){if(this.coiIsVisible()){var f=THREE.Math.degToRad(a.fov),g=THREE.Math.degToRad(b),f=e*Math.tan(0.5*f)/Math.tan(0.5*g);this.look(c,d,f,!0)}a.fov=b;k=!0}}}(this.camera),P=Math.cos(45*Math.PI/180),G=Math.tan(45*Math.PI/180),F=Math.tan(20*Math.PI/180),N=8,z=32,M=300,H=300,Q=-1,V=!1,T=null,I=null,E=a,J=!1,ca=new THREE.Vector3,Y=new THREE.Vector3,ga=new THREE.Vector2,R=new THREE.Vector2,la=new THREE.Vector2,Z=0,ia=null,wa=
null,oa=!1,ma,xa,Ba=new THREE.Vector3,ra=[!1,!1,!1,!1,!1,!1],pa=0,ua=0,ba=0,Ca=0,Oa=0,Za=0,Ma=0,da=0,sa=0,va=0,Ea=0,ya=0,aa=-5,X=null,ha=new function(a){var b=0,c=new THREE.SphereGeometry(1),d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),e=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),f=new THREE.Mesh(c,e);a.createOverlayScene("pivot",d,e);f.visible=!1;this.shown=function(){return f.visible};this.show=function(c,g,h){f.scale.x=
g;f.scale.y=g;f.scale.z=g;f.position.set(c.x,c.y,c.z);e.opacity=0.6;d.opacity=0.6;f.visible=!0;a.addOverlay("pivot",f);b=h?Date.now()+750:0};this.hide=function(){f.visible&&(f.visible=!1,a.removeOverlay("pivot",f),b=0)};this.fade=function(){if(0<b){var a=b-Date.now();if(0>=a)return this.hide(),!0;a=a/750*0.6;d.opacity=a;e.opacity=a;return!0}return!1};this.fading=function(){return 0<b}}(a),qa=new function(a,b){function c(a,b){var d=Math.abs(a-b);return d>t?d:Math.min(t-d,d)}function d(a,b){var c=g(a);
if(1E-5>c.distanceToSquared(b))return!0;s.set(-b.x,-b.y,-b.z);return 1E-5>c.distanceToSquared(s)}function e(a){return a>t?a:0>=a?a+Math.PI:a-Math.PI}function f(a,b,g,h,k){if(!G){G=new THREE.Object3D;var l=new THREE.RingGeometry(0.49,0.5,60);v=l=new THREE.Mesh(l,p);var m=new THREE.BoxGeometry(0.93,0.007,0.007),n=new THREE.BoxGeometry(0.007,0.93,0.007),fb=new THREE.BoxGeometry(0.007,0.007,0.93);B=new THREE.Mesh(m,p);C=new THREE.Mesh(n,p);N=new THREE.Mesh(fb,p);G.add(B);G.add(C);G.add(N);P=new THREE.Mesh(new THREE.CircleGeometry(0.005),
p);G.add(P);F=Array(6);M=Array(6);for(m=0;6>m;++m)F[m]=new THREE.Mesh(new THREE.CircleGeometry(0.005,16),p),M[m]=new THREE.Mesh(new THREE.CircleGeometry(0.0025,16),p),M[m].visible=!1,F[m].add(M[m]),l.add(F[m]);G.add(l)}W(v,b,u.position,h);l=g.clone().normalize();m=Array(3);g=Array(6);m[0]=D(1,0,0,l);m[1]=D(0,1,0,l);m[2]=D(0,0,1,l);n=k.clone().cross(l).normalize();for(l=0;3>l;++l)fb=m[l],g[l]=fb.length(),g[l]<O?H[l]=I:(fb.multiplyScalar(1/g[l]),H[l]=Math.atan2(n.dot(fb),k.dot(fb)));H[3]=e(H[0]);H[4]=
e(H[1]);H[5]=e(H[2]);g[3]=g[0];g[4]=g[1];g[5]=g[2];k=E+V+2*Math.PI/180;for(l=0;6>l;++l)if(H[l]!==I)for(m=l+1;6>m;++m)if(H[m]!==I&&c(H[l],H[m])<k)if(g[l]<g[m]&&!d(l,h)||d(m,h)){H[l]=I;break}else H[m]=I;for(l=0;6>l;++l)H[l]!==I?(h=s.set(0,0,1),A.setFromAxisAngle(h,H[l]),h=s.set(0,0.54,0),h.applyQuaternion(A),F[l].position.copy(h),F[l].visible=!0):F[l].visible=!1;G.scale.x=a;G.scale.y=a;G.scale.z=a;G.position.copy(b);return G}function g(a){r.set(0,0,0);if(0<=a){var b=3<=a?-1:1;a%=3;0===a&&(r.x=b);1===
a&&(r.y=b);2===a&&(r.z=b)}T&&r.multiplyScalar(-1);return r}function h(a,b){for(var d=c(H[0],a),e=0,f=1;6>f;++f){var g=c(H[f],a);g<d&&(d=g,e=f)}return d<b?e:-1}function k(a,b){if(0!==a){var c=30*Math.PI/180,d=s.copy(u.position).sub(z).normalize();A.setFromAxisAngle(d,a);var e=r.copy(b.getWorldUp()),d=Math.abs(d.angleTo(e));(d<c||Math.PI-d<c)&&e.copy(b.getCameraUp());e.applyQuaternion(A);b.setWorldUp(e,!0)}}function l(a,b){0>a.dot(b)&&(b=b.clone().multiplyScalar(-1));W(P,z,u.position,b);P.position.copy(b.multiplyScalar(0.495));
for(var d=!1,e=J?V:E,f=0;6>f;++f){var h=c(H[f],Q),k;k=a;k=h<e?1E-5>g(f).distanceToSquared(k):!1;k&&(d=!0);h=k?4:3*(1-3*h/Math.PI);1>h&&(h=1);h*=w;M[f].visible=k;k=F[f];k.scale.x=h;k.scale.y=h;k.scale.z=h}B.visible=d;C.visible=d;return N.visible=d}function m(a,b){Q+=a;Q>Math.PI?Q-=t:Q<=-Math.PI&&(Q=t+Q);var c;a:{if(!J&&(c=h(Q,E),0<=c)){J=!0;Q=H[c];c=g(c);break a}c=!1}c?(R=Q,b.setWorldUp(c,!0)):(J&&0>h(Q,V)?(J=!1,c=!0):c=!1,c?(k(Q-R,b),R=0):J||k(a,b));return!0}var n=2*Math.tan(THREE.Math.degToRad(15)),
p=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:0.5,transparent:!0}),q=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:0.5,transparent:!0}),r=new THREE.Vector3,s=new THREE.Vector3,A=new THREE.Quaternion,u=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,b.far),w=1,z=null,v=null,B=null,C=null,N=null,G=null,P=null,F=null,M=null,H=Array(6),Q=0,T=!1,J=!0,R=0,E=5*Math.PI/180,V=7*Math.PI/180,I=1E3,O=0.1;a.createOverlayScene("roll",p,q,u);this.updateRollCamera=
function(a,c){u.position.copy(b.position);u.quaternion.copy(b.quaternion);u.up.copy(b.up);u.aspect=b.aspect;u.fov=30;a&&c&&(u.near=c-a,u.far=c+a);u.updateProjectionMatrix()};this.isSnapped=function(){return J};this.start=function(c,d,e){z=c;w=0.85/0.7;var g=r.copy(c).sub(b.position),h=g.length(),k=h*n*0.7;this.updateRollCamera(k,h);a.addOverlay("roll",f(k,c,g,d,e));R=Q=0;T=0>d.dot(e);J=l(d,e)};this.handleRoll=function(a,b,c,d){this.updateRollCamera();l(d.getWorldUp(),d.getCameraUp());return 0!==a||
0!==b?(a=c.x-a-0.5,b=c.y-b-0.5,m(Math.atan2(c.y-0.5,c.x-0.5)-Math.atan2(b,a),d)):!1};this.handleRollTouch=function(a,b,c,d,e){this.updateRollCamera();l(e.getWorldUp(),e.getCameraUp());a=Math.atan2(d.y-c.y,d.x-c.x)-Math.atan2(b.y-a.y,b.x-a.x);return m(a,e)};this.end=function(){a.removeOverlay("roll",G)}}(a,this.camera),La=!1,Na=!1,$a=!1,ka=!1,ja=0,Ha=null,Ta=0,r=null,bb=null,cb=null,na=[],ea=[],Ga=null,Ia=null,Ja=null,Pa=null,Va=0,db=new THREE.Projector,Wa=-1,eb=-1,Xa=-1,ab=[],Ua=null,Ra=!1,za={},
Ya=!1,O=this;this.homePosition=new THREE.Vector3(0,0,1);this.homeTarget=new THREE.Vector3(0,0,0);this.homeUp=new THREE.Vector3(0,1,0);this.homeFov=this.camera.fov;this.setAutocam=function(a){T=a;T.sync(this.camera,!0);T.orbitMultiplier=C.getLookSpeed()};this.setViewpoint=function(a,c,d){b.navigation.getIsLocked()||(C.setView(a,c,0,0,!0),d&&(this.camera.up.copy(d),C.checkCameraUp()))};this.setCOI=function(a,c,d,e){if(c&&!d||!b.navigation.getIsLocked())C.setPivotPoint(a,c,e),d?(c=C.getPosition(),this.transitionView(c,
a,this.camera.fov,this.getWorldUp()),this.pivotActive(C.pivotIsSet())):ha.shown()&&this.activatePivot(ha.fading())};this.syncCamera=function(){this.setViewpoint(this.camera.position,this.camera.target,this.camera.up);this.camera.pivot&&0<this.camera.pivot.distanceToSquared(this.camera.target)&&this.setCOI(this.camera.pivot,!0,!1)};this.setSelector=function(a){X=a};this.getNavigationMode=function(){return Q};this.setNavigationMode=function(a){if(a!==this.getNavigationMode())switch(Ea=ya=sa=va=0,a){case Autodesk.Viewing.NAVIGATION_MODE.PAN:sa=
1;break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:va=1;break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:ya=1;break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:Ea=1}};this.recordHomeView=function(){this.homePosition.copy(C.getPosition());this.homeTarget.copy(C.getLookAtPoint());this.homeUp.copy(C.getWorldUpVector());this.homeFov=this.camera.fov;T&&T.setHomeViewFrom(this.camera)};this.goHome=function(){b.navigation.getIsLocked()||(T?T.goHome():(b.navigation.setPivotSetFlag(!1),this.transitionView(this.homePosition,
this.homeTarget,this.homeFov,this.homeUp)))};this.getBoundingBox=function(a){var b;a||null===X||(b=X.getSelectionBounds());if(!b||b.empty())b=E.getVisibleBounds();return b};this.setWorldUp=function(a,b){a&&0<a.lengthSq()&&(C.setWorldUpVector(a,b),T&&T.setWorldUpVector(a),E.setWorldUp(a),Na=!0)};this.getCOI=function(){return C.getPivotPoint()};this.getLookAtPoint=function(){return C.getLookAtPoint()};this.transitionWorldUp=function(a,b,c){Ha=(new THREE.Vector3(a,b,c)).normalize();a=C.getWorldUpVector();
ja=10;b=Ha.clone().sub(a);b.multiplyScalar(1/ja);this.setWorldUp(a.add(b),!0);--ja};this.getWorldUp=function(){return C.getWorldUpVector()};this.getCameraUp=function(){return C.getCameraUpVector()};this.getFOV=function(){return this.camera.fov};this.setFOV=function(a){C.changeFOV(a)};this.getFocalLength=function(){return c(this.camera.fov)};this.setFocalLength=function(a){C.changeFOV(e(a))};this.transitionView=function(a,c,d,e){e=e||this.getWorldUp();if(T){var f;f=e;var g=c.clone().sub(a);if(0===
g.lengthSq())f=g.copy(f);else{var h=g.clone().cross(f);0===h.lengthSq()&&(f.z>up.y?g.y-=1E-4:g.z+=1E-4,h.crossVectors(g,up));f=h.cross(g).normalize()}targetView={position:a,up:f,center:c,pivot:c,fov:d,worldUp:e};T.goToView(targetView)}else b.navigation.setTransitionActive(!0),Ta=9,r=a,bb=c,cb=d,C.oneStepTowards(a,c,d,10),a=this.getWorldUp(),e!==a&&0<e.clone().sub(a).lengthSq()&&this.transitionWorldUp(e.x,e.y,e.z)};this.computeFit=function(a,c,d){var e=this.getBoundingBox(!1);return b.navigation.computeFit(a,
c,d,e)};this.fitToView=function(a,c){c||(c=this.getBoundingBox(!1));var d=b.navigation.fitBounds(a,c);this.activatePivot(!0);return d};this.handleEvent=function(a){if("function"===typeof this[a.type])this[a.type](a)};this.activatePivot=function(a){var c=2*C.getPivotDistance()*Math.tan(THREE.Math.degToRad(0.5*this.camera.fov)),d=b.navigation.getScreenViewport(),c=5*c/(d.height*(window.devicePixelRatio||1));ha.show(C.getPivotPoint(),c,a)};this.pivotActive=function(a,b){Ra||(b=b||!1,!a&&ha.shown()?ha.hide():
a&&this.activatePivot(b))};this.interactionStart=function(a,b){if(b||a>aa)aa=a,ka=!0,T&&(T.startInteraction(ga.x,ga.y),I=ga.clone()),this.pivotActive(C.pivotIsSet(),-1===a)};this.interactionCheck=function(){(ra[0]||ra[1]||ra[2]||ra[3]||ra[4]||ra[5]||pa||ba||ua||Ca)&&this.interactionStart(-4,!0);0<ea.length&&this.interactionStart(1===ea.length?-3:-2)};this.interactionEnd=function(a){a===aa&&(-1!==a&&this.pivotActive(!1),ka=!1)};this.autoMove=function(a,b){0>a?ra[0]=ra[1]=ra[2]=ra[3]=ra[4]=ra[5]=b:
ra[a]=b;b||this.interactionEnd(-4);this.interactionCheck()};this.getMotionDelta=function(a,c){var d=b.navigation,d=d&&d.getReverseZoomDirection()?-1.5:1.5;v&&(d*=-1);ra[0]&&(Y.x+=0.01,R.x+=20);ra[1]&&(Y.x-=0.01,R.x-=20);ra[2]&&(Y.y+=0.01,R.y+=20);ra[3]&&(Y.y-=0.01,R.y-=20);ra[4]&&(Y.z+=d);ra[5]&&(Y.z-=d);var d=Y.x-ca.x,e=Y.y-ca.y,f=Y.z-ca.z;0.001>Math.abs(d)&&(d=0);0.001>Math.abs(e)&&(e=0);0.001>Math.abs(f)&&(f=0);a.set(d,e,f);c&&c.set(R.x-ga.x,R.y-ga.y)};this.stepMotionDelta=function(a,b){b?(ca.x+=
0.6*a.x,ca.y+=0.6*a.y,ca.z+=0.6*a.z):ca.copy(Y);ga.copy(R)};this.getAccumulatedWheelDelta=function(){var a=Date.now(),b=0;wa&&100<a-wa?(b=0>Z&&-3<Z?-3:0<Z&&3>Z?3:Z,Z=0,wa=ia=null,oa=!1):ia&&100<a-ia&&(oa?3<=Math.abs(Z)&&(b=Z,Z=0):(b=0>Z&&-3<Z?-3:0<Z&&3>Z?3:Z,oa=!0,Z=0));return b};this.adjustSpeed=function(a){C.adjustDollyLookSpeed(a);T&&(T.orbitMultiplier=C.getLookSpeed())};this.checkInteractionMode=function(){var a=-2===aa&&2===ea.length&&(Q===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY||Q!==
Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL&&Va&12)?Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:-2===aa&&2===ea.length&&(Q===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL||Q!==Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY&&Va&16)?Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:ua&&pa||ya?Autodesk.Viewing.NAVIGATION_MODE.ROLL:ba&&pa||Ea?Autodesk.Viewing.NAVIGATION_MODE.FOV:2===aa&&pa&&!ua&&!ba||2===aa&&ua&&!pa&&!ba||1===aa&&ba&&!pa&&!ua||va&&!ua||0!==Ba.z?Autodesk.Viewing.NAVIGATION_MODE.DOLLY:2===
aa&&!pa&&!ua&&!ba||1===aa&&!pa&&!ba||1===aa&&ua&&!ba||pa&&!ba&&!ua&&1!==aa||sa&&!ua||Ca?Autodesk.Viewing.NAVIGATION_MODE.PAN:Autodesk.Viewing.NAVIGATION_MODE.ORBIT;if(a!==Q){if(Q===Autodesk.Viewing.NAVIGATION_MODE.ROLL||Q===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL)qa.end(),C.restoreCOI(),b.navigation.setIsLocked(!1),Na=!0;switch(a){case Autodesk.Viewing.NAVIGATION_MODE.ROLL:case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:var c=C.getLookAtPoint(),c=c.sub(this.camera.position),d=0.5*(this.camera.near+
this.camera.far);c.normalize().multiplyScalar(d);c=c.add(this.camera.position);C.saveCOI();C.setPivotPoint(c,!0,!1);this.pivotActive(!0);b.navigation.setIsLocked(!0);b.navigation.setPivotSetFlag(!0);qa.start(c,this.getWorldUp(),C.getCameraUpVector());Na=!0;break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:g(this.camera,Y.x,Y.y);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:g(this.camera,Ja.x,Ja.y);break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:Z=0,wa=ia=null,oa=!1}Q!==a&&(b.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,
value:a}),Q=a)}};this.update=function(){var a=!1,g=!1;this.camera.dirty&&this.syncCamera();b.navigation.getRequestFitToView()&&!b.navigation.getTransitionActive()&&(b.navigation.setRequestFitToView(!1),this.fitToView());b.navigation.getRequestHomeView()&&!b.navigation.getTransitionActive()&&(b.navigation.setRequestHomeView(!1),this.goHome());var m=b.navigation.getRequestTransition();m&&!b.navigation.getTransitionActive()&&(b.navigation.setRequestTransition(!1),this.transitionView(m.position,m.coi,
m.fov,m.worldUp));this.getMotionDelta(Ba,la);var n=Ba.x,p=Ba.y,m=Ba.z;Ia=Ga=Pa=Ja=null;Va=0;if(-2===aa){2===ea.length&&(Ia=k(ea),Ga=k(na));Pa=h(ea);Ja=h(na);for(var q=Pa,s=Ja,t=ea,A=na,u=q.x-s.x,w=q.y-s.y,z=Math.sqrt(u*u+w*w),v=6<z,B=0,D=0,N=0,H=0,W=0,M=0,J=A.length,O=0;O<J;++O){var Z=t[O].x-A[O].x,ba=t[O].y-A[O].y,ga=Math.sqrt(Z*Z+ba*ba);6<ga&&(B+=1,ga=(u*Z+w*ba)/(z*ga),v&&ga>P&&D++);var Z=t[O].x-q.x,ba=t[O].y-q.y,ia=A[O].x-s.x,X=A[O].y-s.y,da=Math.sqrt(ia*ia+X*X);0<da&&(ga=(Z*X-ba*ia)/da,Z=(Z*ia+
ba*X)/da-da,6<Math.abs(ga)&&Math.abs(Z)<=Math.abs(ga)*G&&(W++,0<ga&&M++),7<Math.abs(Z)&&Math.abs(ga)<=Math.abs(Z)*F&&(0<Z?N++:H++))}q=0;0!=B||v?(q|=2,1==J?q|=4:(0<B&&D<J&&N+H==J&&(q|=8),W!=J||0!=M&&M!=J||(q|=16),v&&D==J&&(q|=4))):q|=1;Va=q}V||this.checkInteractionMode();V=-1<aa;if(!((v=La)||(v=0!==n)||(v=0!==p)||(v=0!==m)))a:{for(v=0;v<ea.length;++v)if(ea[v].x!==na[v].x||ea[v].y!==na[v].y){v=!0;break a}v=!1}if(v){-1<aa&&(Ta=ja=0);La&&(Na=!0,La=!1);Ya||(Ya=!0);switch(Q){case Autodesk.Viewing.NAVIGATION_MODE.ORBIT:T&&
T.startState?(la.x=-la.x,T.orbit(R,I,la,T.startState)):C.orbitRelative(0.6*n,0.6*p);$a=!0;break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:m*=0.6;0<=aa||-3===aa?(p=-p,m=Math.abs(n)>Math.abs(p)?n:p,m*=100,g=n=0.5):(n=b.navigation.getScreenViewport(),g=(ma-n.left)/n.width,n=(xa-n.top)/n.height);b.navigation.getZoomTowardsPivot()?C.coiIsActive()?C.dollyRelativeTowardsCOI(m):(g=f(0.5,0.5,this.camera),C.dollyRelativeTowardsPoint(m,g)):(g=f(g,n,this.camera),C.dollyRelativeTowardsPoint(m,g));break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:C.trackRelative(-n,
p);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:g=d(Pa.scaledX,Pa.scaledY);g||(g=new THREE.Vector3(2*Pa.scaledX-1,2-2*Pa.scaledY,0),db.unprojectVector(g,this.camera),g=g.sub(C.getPosition()),n=C.getPivotDistance()/this.camera.near,g=g.multiplyScalar(n).add(C.getPosition()));C.dollyRelativeTowardsPoint(-60*(Ia-Ga),g);C.trackRelative(Pa.scaledX-Ja.scaledX,Pa.scaledY-Ja.scaledY);l();break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:La=qa.handleRoll(n,p,Y,this);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:La=
qa.handleRollTouch(na[0],na[1],ea[0],ea[1],this);l();break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:0<=aa||-3===aa?(p=-p,m=Math.abs(n)>Math.abs(p)?n:p,0!==m&&(m*=-1,C.changeFOV(this.camera.fov*(1+m)))):(g=this.getAccumulatedWheelDelta()/3,0!==g&&C.changeFOV(e(c(this.camera.fov)+g)))}g=!0}this.stepMotionDelta(Ba,Q!==Autodesk.Viewing.NAVIGATION_MODE.PAN&&Q!==Autodesk.Viewing.NAVIGATION_MODE.ROLL);-1===aa&&1E-5>Math.abs(m)&&(this.interactionEnd(-1),g=a=!0);!ka&&(a||-5<aa)&&(T||$a&&!qa.isSnapped()&&
this.setWorldUp(C.getCameraUpVector(),!1),-1<aa&&ca.copy(Y),aa=-5,$a=V=!1,this.interactionCheck(),this.checkInteractionMode(),Ya&&(Ya=!1));a=!1;0<ja&&Ha&&(m=Ha,1<ja&&(m=1/ja,n=1-m,m=C.getWorldUpVector().multiplyScalar(n).add(Ha.clone().multiplyScalar(m))),this.setWorldUp(m,!0),--ja,0===ja&&(a=!0));0<Ta&&r&&bb&&(C.oneStepTowards(r,bb,cb,Ta),g=!0,--Ta,0===Ta&&(a=!0,b.navigation.setTransitionActive(!1)));ha.shown()&&ha.fade()&&(E.overlayDirty=!0);m=!1;if(Na||C.isDirty())C.updateCamera(),Na=!1,m=!0;C.cameraChanged(!0)&&
(m=!0);g&&(g=C.pivotIsSet(),a?this.pivotActive(g,!0):this.pivotActive(g&&(ka||Ta||ja),-1===aa));m?this.moveDelay=Date.now()+150:0!==this.moveDelay&&(0<this.moveDelay-Date.now()?m=!0:this.moveDelay=0);return m};this.clientToCanvasCoords=function(a,b,c){var d=this.domElement.getBoundingClientRect(),e=d.width,f=d.height,g=a.clientX-d.left,d=a.clientY-d.top;a.canvasX=g;a.canvasY=d;a.normalizedX=g/e*2-1;a.normalizedY=(f-d)/f*2-1;b&&b.set(g/e,d/f,0);c&&c.set(g,d)};this.handleResize=function(){b.navigation.setScreenViewport(b.container.getBoundingClientRect())};
this.setCOIFromMouse=function(a,c,d,e){var g=null;Ra?g=E.intersectGround(a,c):(g=E.castRay(a,c,!0),g.intersectPoint?g=g.intersectPoint:d?g=E.intersectGround(a,c):(d=b.navigation.getScreenViewport(),g=f((a-d.left)/d.width,(c-d.top)/d.height,this.camera)));g&&this.setCOI(g,!0,!1,e)};this.handleSingleClick=function(a){if(0===aa){a=E.castRay(a.clientX,a.clientY,!1);var b="click";ba&&(b+="Ctrl");pa&&(b+="Shift");ua&&(b+="Alt");Ca&&(b+="Space");Oa&&(b+="F1");Za&&(b+="F2");Ma&&(b+="F3");da&&(b+="F4");var c=
"",c=a.node||a.intersectPoint?"onObject":"offObject";this.clickConfig&&this.clickConfig[b]&&this.clickConfig[b][c]&&this.handleAction(this.clickConfig[b][c],a)}else 1!==aa||!pa||ua||ba||(a=E.castRay(a.clientX,a.clientY,!1),a.intersectPoint&&(this.setCOI(a.intersectPoint,!0,!1,!0),this.pivotActive(!0,!0)))};this.handleAction=function(a,c){for(var d=0;d<a.length;++d)switch(a[d]){case "selectOnly":X&&c.node&&X.setSelection([c.node]);break;case "deselectAll":X&&X.setSelection([]);break;case "selectToggle":X&&
c.node&&X.toggleSelection(c.node);break;case "isolate":c.node&&b.isolate(c.node);break;case "showAll":E.visibilityManager.isolateNone();break;case "setCOI":c.intersectPoint&&(this.setCOI(c.intersectPoint,!0,!1,!0),this.pivotActive(!0,!0));break;case "hide":c.node&&E.hideMultiple([c.node]);break;case "show":c.node&&E.showMultiple([c.node]);break;case "toggleVisibility":c.node&&E.toggleVisibility(c.node);break;case "focus":X&&(c.node?X.setSelection([c.node]):X.setSelection([]),this.fitToView())}};this.handleDoubleClick=
function(a){var c=O.applyButtonMappings(a.button);null!=X&&0==c&&(a=E.castRay(a.clientX,a.clientY,!1),a.node?X.setSelection([a.node]):X.clearSelection(),this.fitToView());1==c&&(b.navigation.fitBounds(!1,this.getBoundingBox(!0)),b.navigation.setPivotSetFlag(!1))};this.handleSingleTap=function(a){a=E.castRay((a.startX+a.endX)/2,(a.startY+a.endY)/2,!1);a.intersectPoint&&(this.setCOI(a.intersectPoint,!0,!1,!0),this.pivotActive(!0,!0))};this.handleDoubleTap=function(a,b){var c=(a.startX+a.endX+b.startX+
b.endX)/4,d=(a.startY+a.endY+b.startY+b.endY)/4;null!=X&&(c=E.castRay(c,d,!1),c.node?X.setSelection([c.node]):X.clearSelection(),this.fitToView())};this.handleWheelInput=function(a){Ra&&O.setCOIFromMouse(ma,xa,!1);b.navigation.getReverseZoomDirection()&&(a*=-1);Y.z+=a;Z+=a;var c=Date.now();ia||(ia=c);wa=c;0!=a&&this.interactionStart(-1)};this.applyButtonMappings=function(a){b.navigation.getUseLeftHandedInput()&&(a=0===a?2:2===a?0:a);return a};this.resetKeys=function(){this.autoMove(-1,!1);da=Ma=Za=
Oa=Ca=ua=ba=pa=0};this.applyKeyMappings=function(a,b){switch(a.keyCode){case 91:case 93:case 224:return J=b,v&&J&&pa?null:17;case 16:return b&&v&&J?null:16;case 72:return 36;case 61:return 187;case 173:case 109:return 189}return a.keyCode};this.handleKeyDown=function(a){var b=!1;switch(this.applyKeyMappings(a,!0)){case 16:pa=1;b=!0;break;case 17:ba=1;b=!0;break;case 18:ua=1;b=!0;break;case 32:Ca=1;b=!0;break;case 112:Oa=1;break;case 113:Za=1;break;case 114:Ma=1;break;case 115:da=1;break;case 36:this.goHome();
break;case 70:this.fitToView();break;case 187:this.adjustSpeed(1);break;case 189:this.adjustSpeed(-1);break;case 48:this.adjustSpeed(0);break;case 37:this.autoMove(0,!0);break;case 39:this.autoMove(1,!0);break;case 33:this.autoMove(2,!0);break;case 34:this.autoMove(3,!0);break;case 38:this.autoMove(4,!0);break;case 40:this.autoMove(5,!0);break;default:return!1}b&&this.interactionStart(-4);return!0};this.handleKeyUp=function(a){var c=!1;switch(this.applyKeyMappings(a,!1)){case 16:pa=0;c=!0;break;case 17:ba=
0;c=!0;break;case 18:ua=0;c=!0;break;case 32:Ca=0;c=!0;break;case 112:Oa=0;break;case 113:Za=0;break;case 114:Ma=0;break;case 115:da=0;break;case 36:case 70:break;case 37:this.autoMove(0,!1);break;case 39:this.autoMove(1,!1);break;case 33:this.autoMove(2,!1);break;case 34:this.autoMove(3,!1);break;case 38:this.autoMove(4,!1);break;case 40:this.autoMove(5,!1);break;case 27:if(b.objectContextMenu&&b.objectContextMenu.hide())break;b.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT});this.resetKeys();this.interactionEnd(aa);
break;default:return!1}c&&this.interactionEnd(-4);return!0};this.handleButtonDown=function(a){this.interactionStart(a)};this.handleButtonUp=function(a){this.interactionEnd(a)};this.handleTouchChange=function(a,b){0===a?this.interactionStart(1===b?-3:-2):this.interactionEnd(1===a?-3:-2)};this.keydown=function(b){B!==a.canvas||v&&b.metaKey&&91!=b.keyCode&&93!=b.keyCode||!O.handleKeyDown(b)||(b.preventDefault(),b.stopPropagation())};this.keyup=function(a){v&&a.metaKey&&91!=a.keyCode&&93!=a.keyCode||
!O.handleKeyUp(a)||(a.preventDefault(),a.stopPropagation())};this.updateModifierState=function(a){ba=v&&a.metaKey||a.ctrlKey?1:0;pa=a.shiftKey?1:0;ua=a.altKey?1:0};this.mousedown=function(a){function c(a){O.applyButtonMappings(a.button)===d&&(document.removeEventListener("mouseup",c),O.mouseup(a))}if(!O.isDragging&&!O.inTouch){_isIE11&&inFullscreen()||document.activeElement.blur();a.preventDefault();a.stopPropagation();O.updateModifierState(a);O.clientToCanvasCoords(a,ca,ga);Y.copy(ca);R.copy(ga);
var d=O.applyButtonMappings(a.button);O.handleButtonDown(d);O.downX=a.canvasX;O.downY=a.canvasY;O.isDragging=!0;if(b.navigation.getUseLeftHandedInput()&&0===d||w&&1===d){var e=void 0!==za.time&&500>a.timeStamp-za.time,f=void 0!==za.x&&void 0!==za.y&&2>=Math.abs(za.x-a.canvasX)&&2>=Math.abs(za.y-a.canvasY);if(!e||!f||za.clickCount&&2<=za.clickCount)za.clickCount=0;za.clickCount?1===za.clickCount&&(za.clickCount=2):(za.clickCount=1,za.x=a.canvasX,za.y=a.canvasY,za.time=a.timeStamp)}document.addEventListener("mouseup",
c,!1)}};this.mousemove=function(a){if(!O.inTouch)if(O.isDragging){a.preventDefault();a.stopPropagation();O.updateModifierState(a);O.clientToCanvasCoords(a,Y,R);var b=O.downY-a.canvasY;if(2<Math.abs(O.downX-a.canvasX)||2<Math.abs(b))O.downX=-1,O.downY=-1}else ma=a.clientX,xa=a.clientY,Ra&&E.highlightObject(ma,xa)};this.mouseup=function(a){a.preventDefault();a.stopPropagation();O.updateModifierState(a);O.clientToCanvasCoords(a,Y,R);var c=O.applyButtonMappings(a.button);O.handleButtonUp(c);var d=O.downX-
a.canvasX,e=O.downY-a.canvasY;O.downX=-1;O.downY=-1;O.isDragging=!1;2>=Math.abs(d)&&2>=Math.abs(e)&&O.handleSingleClick(a);(b.navigation.getUseLeftHandedInput()&&0===c||w&&1===c)&&2===za.clickCount&&(O.handleDoubleClick(a),za.clickCount=0,za.x=void 0,za.y=void 0,za.time=void 0)};this.doubleclick=function(a){a.preventDefault();a.stopPropagation();O.clientToCanvasCoords(a,ca,ga);Y.copy(ca);O.downX=a.canvasX;O.downY=a.canvasY;O.handleDoubleClick(a)};this.mousewheel=function(a){a.preventDefault();a.stopPropagation();
if(!O.inTouch){var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail);O.handleWheelInput(b)}};this.touchstart=function(a){function b(a){ea.length!==a.targetTouches.length&&O.handleTouchChange(ea.length,a.targetTouches.length);na=[];ea=[];for(var c=0;c<a.targetTouches.length;++c){var d=a.targetTouches[c];d.clientX=d.pageX;d.clientY=d.pageY;O.clientToCanvasCoords(d);na.push({x:d.canvasX,y:d.canvasY});ea.push({x:d.canvasX,y:d.canvasY})}1===ea.length&&(O.clientToCanvasCoords(a.targetTouches[0],
ca,ga),Y.copy(ca))}function c(a){a.preventDefault();a.stopPropagation();0===a.targetTouches.length?(O.handleTouchChange(ea.length,0),document.removeEventListener("touchend",c),O.touchend(a)):b(a)}if(!O.isDragging){O.inTouch=!0;a.preventDefault();a.stopPropagation();b(a);if(1===ea.length){var d=ea[0];Wa=d.x;eb=d.y;Xa=Date.now()}else Wa=eb=Xa=-1;document.activeElement.blur();O.updateModifierState(a);1===a.targetTouches.length&&document.addEventListener("touchend",c,!1)}};this.touchmove=function(a){if(!O.isDragging){a.preventDefault();
a.stopPropagation();ea=[];for(var b=0;b<a.targetTouches.length;++b){var c=a.targetTouches[b];c.clientX=c.pageX;c.clientY=c.pageY;O.clientToCanvasCoords(c);ea.push({x:c.canvasX,y:c.canvasY})}2===ea.length&&2===na.length&&(b=Math.atan2(ea[1].y-ea[0].y,ea[1].x-ea[0].x),0>b&&(b+=t),c=Math.atan2(na[1].y-na[0].y,na[1].x-na[0].x),0>c&&(c+=t),b=Math.abs(b-c),b>Math.PI&&(b=t-b),2.9<b&&(b=ea[1],ea[1]=ea[0],ea[0]=b));1===ea.length&&O.clientToCanvasCoords(a.targetTouches[0],Y,R);O.updateModifierState(a)}};this.touchend=
function(a){O.inTouch=!1;if(-1!==Xa){var b=ea[0],b={startX:Wa,startY:eb,startTime:Xa,endX:b.x,endY:b.y,endTime:Date.now()};ab.push(b)}q();na=[];ea=[];O.updateModifierState(a)};this.set2DMode=function(a){(Ra=a)&&ha.hide()};this.blur=function(a){O.resetKeys();O.interactionEnd(aa)};this.domElement.addEventListener("mousedown",this.mousedown,!1);window.addEventListener("mousemove",this.mousemove,!1);this.domElement.addEventListener("dblclick",this.doubleclick,!1);this.domElement.addEventListener("mousewheel",
this.mousewheel,!1);this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1);this.domElement.addEventListener("touchstart",function(a){O.touchstart(a)},!1);this.domElement.addEventListener("touchmove",function(a){O.touchmove(a)},!1);window.addEventListener("keydown",this.keydown,!1);window.addEventListener("keyup",this.keyup,!1);this.mouseover=function(b){B=b.target;B!=a.canvas&&O.autoMove(-1,!1)};window.addEventListener("mouseover",this.mouseover,!1);window.addEventListener("blur",this.blur,
!1);this.uninitialize=function(){window.removeEventListener("mousemove",this.mousemove,!1);window.removeEventListener("keydown",this.keydown,!1);window.removeEventListener("keyup",this.keyup,!1);window.removeEventListener("mouseover",this.mouseover,!1);window.removeEventListener("blur",this.blur,!1)}}ViewController.prototype=Object.create(THREE.EventDispatcher.prototype);AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Selector=function(a){function b(a){var c=a.dbId||a.fragIds;if(0<g[c]){if(g[c]--,0==g[c]&&(c=a.fragIds,"undefined"!=typeof c)){Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;++d){var e=c[d],n=f.viewer.getRenderProxy(f.model,e);f.viewer.highlightFragment(f.model,e,!1);n.selectionProxy&&(f.viewer.removeOverlay("selection",n.selectionProxy),delete n.selectionProxy)}}}else if(0>g[c])throw"Selection State machine broken. Negatively selected object!";if(a.children)for(d=0;d<a.children.length;d++)b(a.children[d])}
function c(a,b){var d=a.dbId||a.fragIds;if(g[d])g[d]++;else{var e=a.fragIds;if("undefined"!=typeof e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;++n){var p=e[n],q=f.viewer.getRenderProxy(f.model,p);b?f.viewer.highlightFragment(f.model,p,!0):(q.selectionProxy=new THREE.Mesh(q.geometry,q.material,!0),q.selectionProxy.matrixWorld=q.matrixWorld,f.viewer.addOverlay("selection",q.selectionProxy))}}g[d]=1}if(a.children)for(n=0;n<a.children.length;n++)c(a.children[n],!0)}function e(a){-1==f.findSelection(a)&&
(f.selectedObjects.push(a),c(a))}function d(a){var c=f.findSelection(a);0<=c&&(b(a),f.selectedObjects.splice(c,1))}var f=this;this.viewer=a;this.model=null;this.selectedObjects=[];var g={};a.api.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){f.deselectInvisible()});a.api.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){f.deselectInvisible()});this.getSelectionLength=function(){return f.selectedObjects.length};this.getSelection=function(){return f.selectedObjects.slice(0)};this.clearSelection=
function(a){if(0<this.selectedObjects.length){for(var c=0;c<f.selectedObjects.length;c++)b(f.selectedObjects[c]);f.selectedObjects.length=0;a||this.fireSelectionChangedEvent()}};this.fireSelectionChangedEvent=function(){for(var a=[],b=[],c=0;c<f.selectedObjects.length;c++)a.push(f.selectedObjects[c].dbId),b.push(f.selectedObjects[c].fragIds);b={type:Autodesk.Viewing.SELECTION_CHANGED_EVENT,dbIdArray:a,fragIdsArray:b,nodeArray:this.getSelection()};Autodesk.Viewing.Private.logger.log({viewer_current_time:Date.now(),
viewer_event_type:"selection",viewer_event_on_object:a});this.viewer.api.fireEvent(b)};this.isSelected=function(a){return-1!=this.findSelection(a)};this.findSelection=function(a){return this.selectedObjects.indexOf(a)};this.toggleSelection=function(a){a&&(this.isSelected(a)?d(a):e(a),f.fireSelectionChangedEvent())};this.setSelectionIds=function(a){this.setSelection(this.model.getNodesByIds(a))};this.selectionIsEqual=function(a){if(this.selectedObjects.length!==a.length)return!1;for(var b=0;b<a.length;b++)if(!this.isSelected(a[b]))return!1;
return!0};this.setSelection=function(a){if(!this.selectionIsEqual(a)&&(this.clearSelection(!0),null!=a)){for(var b=0;b<a.length;b++)e(a[b]);this.fireSelectionChangedEvent()}};this.deselectInvisible=function(){for(var a=!1,b=0;b<f.selectedObjects.length;b++){var c=f.selectedObjects[b];!1==c.visible&&(d(c),a=!0)}a&&this.fireSelectionChangedEvent()};this.toggleSelectionId=function(a){this.toggleSelection(this.model.getNodeById(a))};this.isSelectedOrParentIsSelected=function(a){for(;a;){if(0<=this.findSelection(a))return!0;
a=a.parent}return!1};this.getSelectionFragIds=function(){return this.getFragIds(f.selectedObjects)};this.getFragIdsFromObjectIds=function(a){Array.isArray(a)||(a=[a]);return this.getFragIds(this.model.getNodesByIds(a))};this.getFragIds=function(a){for(var b=[],c=0;c<a.length;++c){var d=function(a){var c=a.fragIds;Array.isArray(c)||(c=[c]);for(var e=0;e<c.length;++e)b.push(c[e]);if(a.children)for(c=0;c<a.children.length;c++)d(a.children[c])};d(a[c])}return b};this.getSelectionBounds=function(){for(var a=
new THREE.Box3,b=new THREE.Box3,c=this.getSelectionFragIds(),d=this.viewer,e=this.model,f=0;f<c.length;++f){var g=d.getRenderProxy(e,c[f]);g&&(g.geometry.boundingBox.getTransformedBox(g.matrixWorld,b),a.union(b))}return a}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.VisibilityManager=function(a){this.viewerImpl=a;this.model=null};Autodesk.Viewing.Private.VisibilityManager.prototype.isolate=function(a){a?this.isolateMultiple([a]):this.isolateNone()};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateNone=function(){this.viewerImpl.setModelVisibility(this.model,!0);var a=this.model?this.model.getRoot():null;a&&this.setVisibiltyOnNode(a,!0);this.viewerImpl.resetIsolation(this.model);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:[]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateMultiple=function(a){if(a&&0!=a.length){var b=this.model?this.model.getRoot():null;b&&this.setVisibiltyOnNode(b,!1);this.viewerImpl.setModelVisibility(this.model,!1);for(b=0;b<a.length;b++)this.setVisibiltyOnNode(a[b],!0),this.viewerImpl.needGhostedPass=!0;this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:a})}else this.isolateNone();this.viewerImpl.needsClear=!0};
Autodesk.Viewing.Private.VisibilityManager.prototype.hideMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibiltyOnNode(a[b],!1);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.hide=function(a){this.setVisibiltyOnNode(a,!1);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.showMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibiltyOnNode(a[b],!0);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.show=function(a){this.setVisibiltyOnNode(a,!0);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.toggleVisibility=function(a){var b=Autodesk.Viewing.Private.VisibilityManager.isVisible(a);this.setVisibiltyOnNode(a,!b);this.viewerImpl.api.fireEvent(b?{type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]}:{type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.setVisibiltyOnNode=function(a,b){var c=this.viewerImpl,e=this.model;(function f(a){a.visible=b;var h=a.fragIds;if(void 0!==h)if(Array.isArray(h))for(var k=0;k<h.length;k++)c.setFragmentVisibility(e,h[k],b);else c.setFragmentVisibility(e,h,b);if(a.children)for(h=0;h<a.children.length;h++)f(a.children[h])})(a);this.viewerImpl.needGhostedPass=!0;this.viewerImpl.needsClear=!0};
Autodesk.Viewing.Private.VisibilityManager.isVisible=function(a){return null!=a.visible?a.visible:!0};Autodesk.Viewing.Private.VisibilityManager.prototype.areAllVisible=function(){return this.viewerImpl.isWholeModelVisible(this.model)};AutodeskNamespace("Autodesk.Viewing.Private");var USE_SERVER_SIDE_SEARCH=!1,NUM_WORKER_THREADS=3,NUM_PARALLEL_DOWNLOADS=2,WORKER_SCRIPT=null;LMV_WORKER_URL||(LMV_WORKER_URL="src/workers/MainWorker.js");void 0==ENABLE_INLINE_WORKER&&(ENABLE_INLINE_WORKER=!1);ENABLE_DEBUG&&(NUM_PARALLEL_DOWNLOADS=NUM_WORKER_THREADS=6);
var WORKER_LOAD_GEOMETRY="LOAD_GEOMETRY",WORKER_LOAD_SVF="LOAD_SVF",WORKER_SEARCH="SEARCH",WORKER_GET_PROPERTIES="GET_PROPERTIES",WORKER_SEARCH_PROPERTIES="SEARCH_PROPERTIES",WORKER_GET_OBJECT_TREE="GET_OBJECT_TREE",WORKER_PARSE_FYDO="PARSE_FYDO",WORKER_STREAM_FYDO="STREAM_FYDO",WORKER_PARSE_FYDO_FRAME="PARSE_FYDO_FRAME",WORKER_CLOUD_RENDERING="CLOUD_RENDERING";
Autodesk.Viewing.Private.SvfLoader=function(a){this.viewer3DImpl=a;this.next_pack=0;this.loading=!1;this.tmpMatrix=new THREE.Matrix4;this.getObjectTreeCallbacks=[];this.fydoMeshCounter=0;Autodesk.Viewing.Private.logger||(Autodesk.Viewing.Private.logger=new Autodesk.Viewing.Private.Logger({console:!0,viewingservice:!1,webstorage:!1,endpoint:"",flushThreshold:0}));this.logger=Autodesk.Viewing.Private.logger;this.loadTime=0};
Autodesk.Viewing.Private.SvfLoader.prototype.uninitialize=function(){this.viewer3DImpl=this.svf=null};Autodesk.Viewing.Private.SvfLoader.prototype.pathToURL=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvf=function(a,b,c,e,d){if(this.loading)return stderr("loading of SVF already in progress."),!1;var f=a.indexOf("urn:");-1!=f&&(this.logger.bindURN(a.substr(f,a.substr(f).indexOf("/"))),stderr("Extracted URN: "+this.logger.urn));this.sharedDbPath=c;var g=-1!=a.indexOf(".f2d");if(ENABLE_INLINE_WORKER){var h=new XMLHttpRequest;c=FORCE_USE_LOCAL_WORKER_SCRIPT?LMV_WORKER_URL:RESOURCE_ROOT+LMV_WORKER_URL;c+="?domain="+window.location.hostname;h.open("GET",
c,!0);h.setRequestHeader("Access-Control-Allow-Origin","*");var k=this;h.onload=function(){WORKER_SCRIPT=h.responseText;g?k.loadFydoCB(a,b,e,d):k.loadSvfCB(a,b,e,d)};h.send();return!0}return g?this.loadFydoCB(a,b,e,d):this.loadSvfCB(a,b,e,d)};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvfCB=function(a,b,c,e){this.t0=(new Date).getTime();this.failedToLoadSomeGeometryPacks=null;var d=createWorker(),f=this,g=function(b){var h=function(){d.removeEventListener("message",g);d.terminate();d=null};if(b.data&&b.data.svf){b=f.svf=b.data.svf;b.geomPolyCount=0;b.instancePolyCount=0;b.geomMemory=0;b.fragments.numLoaded=0;b.meshCount=0;b.gpuNumMeshes=0;b.gpuMeshMemory=0;b.basePath="";var m=a.lastIndexOf("/");-1!=m&&(b.basePath=a.substr(0,m+1));
f.failedToLoadSomeGeometryPacks&&(e&&e(f.failedToLoadSomeGeometryPacks.code,f.failedToLoadSomeGeometryPacks.msg),f.failedToLoadSomeGeometryPacks=null);f.onSvfLoadDone(b);c&&c(b);if(m=b.geompacks.length)for(var m=Math.min(m,NUM_PARALLEL_DOWNLOADS),n=0;n<m;n++){var p=b.geompacks[n];f.loadGeometryPack(p.id,p.uri);f.next_pack=n+1}else f.onGeomLoadDone();f.loading=!1;h()}else b.data&&b.data.progress||(b.data&&b.data.error?(f.loading=!1,h(),e&&e(b.data.error.code,b.data.error.msg)):b.data&&b.data.debug?
stderr(b.data.message):(stderr("SVF download failed."),f.loading=!1,h()))};d.addEventListener("message",g,!1);var h=this.pathToURL(a);d.postMessage({operation:WORKER_LOAD_SVF,url:h,headers:{},objectIds:b,auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadFydoCB=function(a,b,c,e){this.t0=(new Date).getTime();var d=createWorker(),f=createWorker(),g=this;d.addEventListener("message",function(a){a.data&&"FYDOBLOB"==a.data.type?(a={operation:WORKER_PARSE_FYDO,data:a.data.buffer,metadata:a.data.metadata},f.postMessage(a)):a.data&&"FYDOSTREAM"==a.data.type?(a={operation:WORKER_PARSE_FYDO_FRAME,data:a.data.frames,metadata:a.data.metadata},f.postMessage(a)):a.data&&!0==a.data.finished?d.terminate():a.data&&
a.data.debug?stderr(a.data.message):a.data&&a.data.error?(g.loading=!1,d.terminate(),e&&e.call(a.data.error.code,a.data.error.msg)):(stderr("FYDO download failed."),g.loading=!1,d.terminate())},!1);f.addEventListener("message",function(b){if(b.data&&b.data.fydo){b=g.svf=b.data.fydo;stderr("Num polylines: "+b.numPolylines);stderr("Line segments: "+b.numLineSegs);stderr("Circular arcs: "+b.numCircles);stderr("Ellipitcal arcs:"+b.numEllipses);stderr("Total # of op codes generated by fydo.parse: "+b.opCount);
b.basePath="";var d=a.lastIndexOf("/");-1!=d&&(b.basePath=a.substr(0,d+1));g.onSvfLoadDone(b);c&&c(b);for(d=0;d<b.meshes.length;d++){var h={mesh:b.meshes[d],packId:"0",meshIndex:d};b.fragments.materials[d]=g.viewer3DImpl.create2DMaterial(b.meshes[d].material);g.processReceivedMesh(h)}g.onGeomLoadDone();b.loadDone=!0;g.loading=!1;f.terminate()}else if(b.data&&b.data.fydoframe){stderr("# of op codes generated by fydo.parseFrame: "+b.data.fydoframe.opCount);b=g.svf=b.data.fydoframe;b.basePath="";d=a.lastIndexOf("/");
-1!=d&&(b.basePath=a.substr(0,d+1));g.onSvfLoadDone(b);c&&!g.fydoMeshCounter&&c(b);for(d=g.fydoMeshCounter;d<b.meshes.length;d++,g.fydoMeshCounter++)h={mesh:b.meshes[d],packId:"0",meshIndex:d},b.fragments.materials[d]=g.viewer3DImpl.create2DMaterial(b.meshes[d].material),g.processReceivedMesh(h);g.onGeomLoadDone();b.loadDone=!0;g.loading=!1}else b.data&&b.data.progress||(b.data&&b.data.debug?stderr(b.data.message):b.data&&b.data.error?(g.loading=!1,f.terminate(),e&&e.call(b.data.error.code,b.data.error.msg)):
(stderr("FYDO download failed."),g.loading=!1,f.terminate()))},!1);var h=this.pathToURL(a);d.postMessage({operation:WORKER_STREAM_FYDO,url:h,headers:{},objectIds:b,auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadGeometryPack=function(a,b){var c,e,d,f=this;if(!this.pack_workers){this.pack_workers=[];var g=function(a){if(a.data&&a.data.mesh){if(f.processReceivedMesh(a.data),1<=a.data.progress){f.pack_workers[a.data.workerId].queued-=1;a=!0;for(d=0;d<f.pack_workers.length;d++)if(0!=f.pack_workers[d].queued){a=!1;break}if(a){for(d=0;d<NUM_WORKER_THREADS;d++)f.pack_workers[d].terminate(),f.pack_workers[d].removeEventListener("message",g);f.pack_workers=null}f.svf.fragments.numLoaded==
f.svf.fragments.length&&(f.onGeomLoadDone(),f.loadTextures())}}else a.data&&a.data.progress?(f.pack_workers[a.data.workerId].queued-=1,f.next_pack<f.svf.geompacks.length&&(a=f.svf.geompacks[f.next_pack++],f.loadGeometryPack(a.id,a.uri))):a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?f.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:f.pack_workers[a.data.workerId].queued-=2};for(c=0;c<NUM_WORKER_THREADS;c++)e=createWorker(),e.addEventListener("message",
g,!1),e.queued=0,this.pack_workers.push(e)}e=0;var h=this.pack_workers[0].queued;for(c=1;c<NUM_WORKER_THREADS;c++)this.pack_workers[c].queued<h&&(e=c);c=this.pack_workers[e];c.queued+=2;h=this.pathToURL(this.svf.basePath+b);e={operation:WORKER_LOAD_GEOMETRY,url:h,packId:parseInt(a),headers:{},workerId:e,auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname};c.postMessage(e)};
Autodesk.Viewing.Private.SvfLoader.prototype.convertMaterials=function(){var a=this.svf;if(a.materials){var b=a.materials.materials,c;for(c in b)if(b=a.simplemats[c]){b.color=(new THREE.Color).copy(b.color);b.ambient=(new THREE.Color).copy(b.ambient);b.specular=(new THREE.Color).copy(b.specular);b.emissive=(new THREE.Color).copy(b.emissive);var e=new THREE.MeshPhongMaterial(b);e.metal=b.metal;!_isIE11&&(b.doubleSided||a.metadata&&a.metadata.hasOwnProperty("double sided geometry")&&a.metadata["double sided geometry"].value)&&
(e.side=THREE.DoubleSide);for(var d in b)0==d.indexOf("uri_")&&(e[d]=b[d]),0==d.indexOf("uscale_")&&(e[d]=b[d]),0==d.indexOf("vscale_")&&(e[d]=b[d]);this.viewer3DImpl.addMaterial(c,e)}else this.viewer3DImpl.addMaterial(c,new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading}))}};
Autodesk.Viewing.Private.SvfLoader.prototype.loadTextures=function(){var a=this.svf,b=this;b.textures={};for(var c in b.viewer3DImpl.materials){var e=b.viewer3DImpl.materials[c];if(e){var d=function(a){for(var c=b.textures[a.name],d=0;d<c.mats.length;d++)c.mats[d][c.slots[d]]=a;b.viewer3DImpl.addTexture(c)},f=["map","bumpMap","specularMap","normalMap","envMap"];e.bumpScale&&1<=e.bumpScale&&(e.bumpScale=0.03);for(var g=0;g<f.length;g++){var h=e["uri_"+f[g]];if(h)if(b.textures[h])b.textures[h].mats.push(e),
b.textures[h].slots.push(f[g]);else{var k="envMap"==f[g],h=h.replace(/\\/g,"/"),l=b.pathToURL(a.basePath+h),m=l.indexOf("urn:");-1!=m&&(l=l.substr(0,m)+encodeURIComponent(l.substr(m)),l+="?domain="+window.location.hostname);var m=e["uscale_"+f[g]],n=e["vscale_"+f[g]];m||(m=1);n||(n=1);auth&&(-1!=l.indexOf("/items/")?THREE.ImageUtils.crossOrigin="use-credentials":THREE.ImageUtils.crossOrigin="");l=k?THREE.ImageUtils.loadTexture(l,new THREE.SphericalReflectionMapping,d):THREE.ImageUtils.loadTexture(l,
new THREE.UVMapping,d);l.name=h;b.textures[h]={mats:[e],slots:[f[g]],tex:l};l.anisotropy="bumpMap"==f[g]||"normalMap"==f[g]?0:b.viewer3DImpl.renderer.getMaxAnisotropy();l.repeat.set(m,n);l.wrapS=THREE.RepeatWrapping;l.wrapT=THREE.RepeatWrapping;l.flipY=!k;k&&(a.envMap=l)}}}}};
function meshToGeometry(a){var b=a.mesh,c=new THREE.BufferGeometry;a.byteSize=0;c.vb=b.vb;c.vbstride=b.vbstride;c.isLines=b.isLines;for(var e in b.vblayout){var d=b.vblayout[e];c.attributes[e]={itemSize:d.itemSize,itemOffset:d.offset,bytesPerItem:d.bytesPerItem,normalize:d.normalize,isPattern:d.isPattern}}a.byteSize+=b.vb.byteLength;c.attributes.index={itemSize:1,array:b.indices};a.byteSize+=b.indices.byteLength;c.freeCPUBuffers=!1;65535<b.vb.length/b.vbstride&&stderr("Mesh with >65535 vertices. It will fail to draw.");
c.boundingBox=(new THREE.Box3).copy(b.boundingBox);c.boundingSphere=(new THREE.Sphere).copy(b.boundingSphere);a.geometry=c;a.geometry.isLines=!0===a.mesh.isLines;delete a.mesh}function getFragmentTransform(a,b,c){c*=16;b=b.transforms;if(!b)return null;for(var e=!0,d=0;16>d;d++)if(d%5&&0!=b[c+d]||!(d%5)&&1!=b[c+d]){e=!1;break}if(e)return null;for(e=0;16>e;e++)a.elements[e]=b[c+e];return a}
Autodesk.Viewing.Private.SvfLoader.prototype.processReceivedMesh=function(a){meshToGeometry(a);var b=a.packId+":"+a.meshIndex,c=this.svf,e=c.fragments,d=e.mesh2frag[b];if(void 0===d)stderr("Mesh "+b+" was not referenced by any fragments.");else{c.meshCount++;var f=MAX_FRAGS_PER_GROUP;if(67108864>c.gpuMeshMemory&&c.gpuNumMeshes<f)a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1;else if(134217728<c.gpuMeshMemory||2E3<c.gpuNumMeshes)a.geometry.streamingDraw=!0,a.geometry.streamingIndex=!0;else{var g;
Array.isArray(d)?g=d.length*a.byteSize:300>(0|d)?(a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1):g=a.byteSize;1E5>g&&(a.geometry.streamingDraw=!0,a.geometry.streamingIndex=!0)}a.geometry.streamingDraw||(c.gpuMeshMemory+=a.byteSize,c.gpuNumMeshes+=1);if(Array.isArray(d))for(g=0;g<d.length;g++){var h=0|d[g],f=e.materials[h];this.viewer3DImpl.addMeshInstance(a.geometry,h,f,getFragmentTransform(this.tmpMatrix,e,h))}else g=getFragmentTransform(this.tmpMatrix,e,0|d),f=e.materials[d],this.viewer3DImpl.addMeshInstance(a.geometry,
0|d,f,g);delete e.mesh2frag[b];b=a.geometry.attributes.index.array.length/3;c.geomPolyCount+=b;c.instancePolyCount+=b*(d.length||1);c.geomMemory+=a.byteSize;a=!e.numLoaded;e.numLoaded+=d.length||1;d=e.numLoaded;e=e.length;c=d/e;b=0|e/d;if(a||0==(b&b-1)&&this.lastRepaintFract!=b)this.lastRepaintFract=b,this.viewer3DImpl.needsRender=!0;1==c&&(this.viewer3DImpl.needsClear=!0);1>c&&0==d%10&&this.viewer3DImpl.signalProgress(100*c,"fragment "+d+" / "+e)}};
Autodesk.Viewing.Private.SvfLoader.prototype.onSvfLoadDone=function(a){var b=Date.now();this.loadTime+=b-this.t0;stderr("SVF load: "+(b-this.t0));this.convertMaterials();this.t0=b;a.bbox=new THREE.Box3(a.bbox.min,a.bbox.max);stderr("scene bounds: "+JSON.stringify(a.bbox));this.viewer3DImpl.signalProgress(5,"Hold on, getting the model...")};
Autodesk.Viewing.Private.SvfLoader.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0;delete this.svf.fragments.entityIndexes;delete this.svf.fragments.packIds;var a=Date.now(),b="Fragments load time: "+(a-this.t0);this.loadTime+=a-this.t0;this.viewer3DImpl.signalProgress(100,b);this.viewer3DImpl.api.fireEvent({type:Autodesk.Viewing.GEOMETRY_LOADED_EVENT});stderr(b);stderr("Total geometry size: "+this.svf.geomMemory/1048576+" MB");stderr("Number of meshes: "+this.svf.meshCount);stderr("Num Meshes on GPU: "+
this.svf.gpuNumMeshes);stderr("Net GPU geom memory used: "+this.svf.gpuMeshMemory);a={viewer_current_time:Date.now(),viewer_model_stats_total_load_time:this.loadTime,viewer_model_stats_total_geometry_size:this.svf.geomMemory/1048576,viewer_model_stats_total_meshes_count:this.svf.meshCount,viewer_model_stats_total_meshes_on_gpu:this.svf.gpuNumMeshes,viewer_model_stats_total_gpu_memory_used:this.svf.gpuMeshMemory/1048576};this.logger.log(a,!0)};
Autodesk.Viewing.Private.SvfLoader.prototype.getProperties=function(a,b,c){this.propWorker||(this.propWorker=createWorker());var e=this,d=function(f){f.data&&f.data.error?c&&c(f.data.error.code,f.data.error.msg,f.data.error.args):f.data&&f.data.debug?stderr(f.data.message):f.data&&f.data.dbId===a&&(b(f.data.result),e.propWorker.removeEventListener("message",d))};this.propWorker.addEventListener("message",d,!1);var f=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&
(f=this.sharedDbPath,stderr("Using shared property db: "+f));this.propWorker.postMessage({operation:WORKER_GET_PROPERTIES,url:f,propertydb:this.svf.propertydb,dbId:a,headers:{},auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname})};
Autodesk.Viewing.Private.SvfLoader.prototype.searchProperties=function(a,b,c){var e=this;if(USE_SERVER_SIDE_SEARCH){this.searchWorker||(this.searchWorker=createWorker());var d=function(a){a.data&&a.data.error?c&&c(a.data.error.code,a.data.error.msg):a.data&&a.data.debug?stderr(a.data.message):(a=JSON.parse(a.data),"debug"==a.type?stderr(a.debug):"response"==a.type&&(b&&b(a.response),e.searchWorker.removeEventListener("message",d)))};this.searchWorker.addEventListener("message",d,!1);this.searchWorker.postMessage({operation:WORKER_SEARCH,
keyword:a,url:this.pathToURL(this.svf.basePath),id:this.svf.manifest.adskID})}else{this.propWorker||(this.propWorker=createWorker());d=function(a){a.data&&a.data.error?c&&c(a.data.error.code,a.data.error.msg):a.data&&a.data.debug?stderr(a.data.message):(b&&b(a.data),e.propWorker.removeEventListener("message",d))};this.propWorker.addEventListener("message",d,!1);var f=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(f=this.sharedDbPath,stderr("Using shared property db: "+
f));this.propWorker.postMessage({operation:WORKER_SEARCH_PROPERTIES,url:f,propertydb:this.svf.propertydb,searchText:a,headers:{},auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname})}};
Autodesk.Viewing.Private.SvfLoader.prototype.createFragToNodeMapping=function(){var a=this.svf,b=a.fragments.fragId2dbId;if(a.instanceTree&&b){var c=a.fragments.fragToDbNode=Array(b.length);(function d(a){var b=a.fragIds;if(void 0!==b)if(Array.isArray(b))for(var h=0;h<b.length;h++)c[b[h]]=a;else c[b]=a;if(a.children)for(b=0;b<a.children.length;b++)d(a.children[b])})(a.instanceTree);a.fragToNodeDone=!0;this.viewer3DImpl.api.fireEvent({type:Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT})}};
Autodesk.Viewing.Private.SvfLoader.prototype.getObjectTree=function(a,b){function c(){for(var a=0;a<e.getObjectTreeCallbacks.length;a++)e.getObjectTreeCallbacks[a](e.svf.instanceTree);e.getObjectTreeCallbacks=[]}var e=this;this.propWorker||(this.propWorker=createWorker());this.getObjectTreeCallbacks.push(a);if(e.svf.instanceTree)c();else{var d=function(a){if(!a.data||!a.data.error)if(a.data&&a.data.debug)stderr(a.data.message);else{var b=a.data.instanceTree,f=a.data.instanceBoxes;b&&!e.svf.instanceTree&&
(e.svf.instanceTree=b,e.svf.maxTreeDepth=a.data.maxTreeDepth,e.createFragToNodeMapping());c();f&&(e.svf.instanceBoxes=f,e.propWorker.removeEventListener("message",d))}};this.propWorker.addEventListener("message",d,!1);var f=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(f=this.sharedDbPath,stderr("Using shared property db: "+f));this.propWorker.postMessage({operation:WORKER_GET_OBJECT_TREE,url:f,propertydb:this.svf.propertydb,headers:{},fragToDbId:this.svf.fragments.fragId2dbId,
fragBoxes:this.svf.fragments.boxes,auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname})}};function createWorker(){if(ENABLE_DEBUG||!ENABLE_INLINE_WORKER)return new Worker(LMV_WORKER_URL);var a;window.URL=window.URL||window.webkitURL;try{a=new Blob([WORKER_SCRIPT],{type:"application/javascript"})}catch(b){a=new BlobBuilder,a.append(WORKER_SCRIPT),a=a.getBlob()}return new Worker(URL.createObjectURL(a))}
Autodesk.Viewing.Private.SvfLoader.prototype.testCloudRendering=function(a){var b=createWorker(),c=function(e){var d=function(){b.removeEventListener("message",c);b.terminate();b=null};e.data&&e.data.renderings?(e=e.data.renderings,a.raaSPanel.loadThumbnail(e.thumbnail),a.raaSPanel.loadImage(e.image),stderr(e)):e.data&&e.data.progress||(e.data&&e.data.error?(a.raaSPanel.imageError(),d()):e.data&&e.data.debug?console.log(e.data.message):(console.log("Unexpected error in cloud rendering worker."),d()))};
b.addEventListener("message",c,!1);b.postMessage({operation:WORKER_CLOUD_RENDERING,url:"urn:dXJuOmFkc2suczM6ZnMuZmlsZTp6aGFuZ3l1bi9yYWFzL0xhbWJvL2NvcmUuc3Bk",headers:{},auth:auth,viewing_url:VIEWING_URL,queryParams:"domain="+window.location.hostname,camera:this.viewer3DImpl.camera,canvas:{width:this.viewer3DImpl.canvas.width,height:this.viewer3DImpl.canvas.height}})};var Stats=function(){var a=Date.now(),b=a,c=0,e=Infinity,d=0,f=0,g=Infinity,h=0,k=0,l=0,m=document.createElement("div");m.id="stats";m.addEventListener("mousedown",function(a){a.preventDefault();w(++l%2)},!1);m.style.cssText="width:80px;opacity:0.9;cursor:pointer";var n=document.createElement("div");n.id="fps";n.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";m.appendChild(n);var p=document.createElement("div");p.id="fpsText";p.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
p.innerHTML="FPS";n.appendChild(p);var q=document.createElement("div");q.id="fpsGraph";q.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(n.appendChild(q);74>q.children.length;){var s=document.createElement("span");s.style.cssText="width:1px;height:30px;float:left;background-color:#113";q.appendChild(s)}var t=document.createElement("div");t.id="ms";t.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";m.appendChild(t);var u=document.createElement("div");
u.id="msText";u.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";u.innerHTML="MS";t.appendChild(u);var v=document.createElement("div");v.id="msGraph";v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(t.appendChild(v);74>v.children.length;)s=document.createElement("span"),s.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(s);var w=function(a){l=a;switch(l){case 0:n.style.display=
"block";t.style.display="none";break;case 1:n.style.display="none",t.style.display="block"}};return{REVISION:11,domElement:m,setMode:w,begin:function(){a=Date.now()},end:function(){var l=Date.now();c=l-a;e=Math.min(e,c);d=Math.max(d,c);u.textContent=c+" MS ("+e+"-"+d+")";var m=Math.min(30,30-c/200*30);v.appendChild(v.firstChild).style.height=m+"px";k++;l>b+2E3&&(f=Math.round(1E3*k/(l-b)),g=Math.min(g,f),h=Math.max(h,f),p.textContent=f+" FPS ("+g+"-"+h+")",m=Math.min(30,30-f/100*30),q.appendChild(q.firstChild).style.height=
m+"px",b=l,k=0,e=Infinity,d=0);return l},update:function(){a=this.end()}}};var MAX_FRAGS_PER_GROUP=333;
function RenderQueue(a,b,c){function e(a,b){var c=p,d=0,e=c.length;if(b)for(;d<e;d++)c[d]|=a;else for(var f=~a;d<e;d++)c[d]&=f}var d=0,f=-1,g=!0,h=!1,k=new THREE.Box3,l,m=new THREE.Box3,n=Array(a),p=new Uint8Array(a),q=new THREE.Raycaster;this.prototypeScene=b;var s=0,t=!1;a=0|(a+MAX_FRAGS_PER_GROUP-1)/MAX_FRAGS_PER_GROUP;for(var u=Array(a),v=0;v<a;v++)(u[v]=new THREE.Scene(!0)).__lights=b.__lights;this.visibleBoundsDirty=!1;c&&k.copy(c);this.addMesh=function(a,b){var c=n[a];c&&(stderr("duplicate fragment."),
c.parent.remove(c));n[a]=b;p[a]=1;b.fragId=a;var c=0|a/MAX_FRAGS_PER_GROUP,d=u[c];d||(u[c]=d=new THREE.Scene(!0),d.__lights=this.prototypeScene.__lights);m.copy(b.geometry.boundingBox);m.applyMatrix4(b.matrixWorld);k.union(m);d.add(b);this.visibleBoundsDirty=!0};this.renderSome=function(a,b){var c=d,e=u.length,g=p,h=Date.now(),k=!0,l=0==c;l&&!t&&(f=-1,t=!0);for(;c<e;c++){var m=u[c],n=!1;l&&0<f?(c==f&&(n=!0),k=!1):k?(0>=b&&(n=!0),k=!1):b<=0.5*m.avgFrameTime&&(n=!0);if(n)break;var n=m.children,q=!0;
if(2==s)for(var v=0,H=n.length;v<H;v++){var Q=n[v],V=!(g[Q.fragId]&1);Q.visible=V;q=q&&!V}else if(1==s)for(v=0,H=n.length;v<H;v++)Q=n[v],V=!!(g[Q.fragId]&2),Q.visible=V,q=q&&!V;else for(v=0,H=n.length;v<H;v++)Q=n[v],V=1==g[Q.fragId],Q.visible=V,q=q&&!V;q||a(m);n=Date.now();q=n-h;h=n;m.avgFrameTime=void 0===m.avgFrameTime?q:0.95*m.avgFrameTime+0.05*q;d=c+1;b-=m.avgFrameTime}l&&-1==f&&(f=c);c!=e&&l||(f=-1,t=!1);return b};this.isDone=function(){return d==u.length};this.reset=function(a){d=0};this.drawNormalObjectsOnly=
function(){s=0};this.drawHighlightedObjectsOnly=function(){s=1};this.drawHiddenObjectsOnly=function(){s=2};this.setOverrideMaterial=function(a){for(var b=0,c=u.length;b<c;b++)u[b].overrideMaterial=a};this.setHightlighted=function(a,b){var c=p[a];p[a]=b?c|2:c&-3;this.visibleBoundsDirty=!0};this.setVisibility=function(a,b){var c=p[a];p[a]=b?c|1:c&-2;this.visibleBoundsDirty=h=!0};this.setAllHighlighted=function(a){e(2,a);this.visibleBoundsDirty=!0};this.setAllVisibility=function(a){e(1,a);g=a;h=!1;this.visibleBoundsDirty=
!0};this.hideLines=function(a){var b=p,c=0,d=b.length;if(a)for(;c<d;c++)n[c]&&n[c].isLine&&(b[c]|=4);else for(;c<d;c++)n[c]&&n[c].isLine&&(b[c]&=-5);h=!0};this.isFragVisible=function(a){return 1==(p[a]&3)};this.areAllVisible=function(){if(h){g=!0;h=!1;for(var a=p,b=0,c=a.length;b<c;b++)if(0==(a[b]&1)){g=!1;break}}return g};this.getVisibleBounds=function(a){if(!this.visibleBoundsDirty&&a==l)return k;l=a;var b=p;k.makeEmpty();for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e&1||a&&0==e)if(e=n[c])e.geometry.boundingBox.getTransformedBox(e.matrixWorld,
m),k.union(m)}this.visibleBoundsDirty=!1;return k};this.rayIntersect=function(a,b,c){q.set(a,b);a=q.intersectObjects(u,!0);for(var d=b=null,e=0;e<a.length;e++){var f=a[e].object,g=f.visible;void 0!==f.fragId&&(g=this.isFragVisible(f.fragId));if(g&&(!c||!a[e].object.material.transparent)){b=a[e].object;d=a[e].point;break}}return[b,d]};this.getRenderProgress=function(){return d/u.length};this.getVizmesh=function(a){return n[a]};this.getSceneCount=function(){return u.length}};function RenderContext(){var a,b,c,e,d,f,g,h,k,l,m,n=!1,p,q=null,s=null,t=null,u=null,v=null,w=null,B=1.7,A=0,D,W,C=new Uint8Array(4),P={r:0,g:0,b:0},G=!1,F={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!1};this.settings=F;this.init=function(a,c,d){G=-1!=window.navigator.userAgent.indexOf("Firefox")&&-1!=window.navigator.userAgent.indexOf("Mac OS");b=a;D=c;W=d;this.initPostPipeline(F.sao,F.antialias,!1)};this.beginScene=function(b,c,f){e=c;n=!1;f&&(a.setClearColor(P,0),
a.clearTarget(s,!1,!0,!1),d.render(a,s,null));w&&(a.setClearColor(P,0),a.clearTarget(w,!0,!1,!1));F.sao&&(f&&(a.setClearColor(P,0),a.clearTarget(p,!0,!1,!1)),g.uniforms.cameraNear.value=c.near,g.uniforms.cameraFar.value=c.far,k.uniforms.cameraNear.value=c.near,k.uniforms.cameraInvNearFar.value=1/(c.near-c.far),c=c.projectionMatrix.elements,g.uniforms.projInfo.value.set(-2/(s.width*c[0]),-2/(s.height*c[5]),(1-c[8])/c[0],(1-c[9])/c[5]),g.uniforms.projScale.value=0.125*s.height*c[5]);this.renderScenePart(b,
!1)};this.renderScenePart=function(b,d){n=!1;if(this.hasMRT())F.idbuffer?a.render(b,e,[s,w]):F.sao?a.render(b,e,[s,p]):a.render(b,e,s);else if(a.render(b,e,s),F.sao&&!d){var f=b.overrideMaterial;b.overrideMaterial=c;a.render(b,e,p);b.overrideMaterial=f}};this.clearAllOverlays=function(){a.clearTarget(t,!0,!1,!1)};this.renderOverlays=function(b){var c=0,d;for(d in b)if(b.hasOwnProperty(d)){var f=b[d],g=f.scene,h=f.camera?f.camera:e;g.children.length&&(c||(c=1,a.setClearColor(P,0),a.clearTarget(t,!0,
!1,!1)),f.materialPre&&(g.overrideMaterial=f.materialPre,a.render(g,h,t,!1)),f.materialPost&&(g.overrideMaterial=f.materialPost,a.context.depthFunc(a.context.GREATER),a.render(g,h,t,!1),a.context.depthFunc(a.context.LEQUAL)),g.overrideMaterial=null)}m.uniforms.useOverlay.value=c};this.composeFinalFrame=function(b){if(!b&&F.sao){if(!n){if(q){b=q[0];k.uniforms.resolution.value.set(1/b.width,1/b.height);k.render(a,b,p);for(var c=1;c<q.length;c++){var d=q[c];h.uniforms.resolution.value.set(1/d.width,
1/d.height);h.render(a,d,b);b=d}}g.render(a,v,s);f.uniforms.axis.value.set(1,0);f.render(a,u,v);f.uniforms.axis.value.set(0,1);f.render(a,v,u);n=!0}m.uniforms.useAO.value=1}else m.uniforms.useAO.value=0;l?(m.render(a,u,s),l.render(a,null,u)):m.render(a,null,s);a.endFrame()};this.setSize=function(b,c,d){D=b;W=c;a.setSize(b,c);var e=0|b*a.devicePixelRatio,h=0|c*a.devicePixelRatio;F.logicalWidth=b;F.logicalHeight=c;F.deviceWidth=e;F.deviceHeight=h;b=!1;if(F.useSSAA){if(F.antialias){e*=3/a.devicePixelRatio;
h*=3/a.devicePixelRatio;for(b=1;b<e;)b*=2;for(c=1;c<h;)c*=2;e=b;h=c}d=b=!0}if(d||!s||s.width!=e||s.height!=h)if(s=new THREE.WebGLRenderTarget(e,h,{minFilter:b?THREE.LinearMipMapLinearFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,type:F.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:b}),t=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),t.shareDepthFrom=
s,v=u=p=null,q=[],F.antialias||F.sao)u=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1});if(F.sao){if(d||!p||p.width!=e||p.height!=h){p=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.FloatType,stencilBuffer:!1});p.shareDepthFrom=s;q=[];for(c=0;5>c;c++){var k=new THREE.WebGLRenderTarget(0|e/(2<<c),0|h/(2<<c),{minFilter:THREE.NearestFilter,
magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});k.generateMipmaps=!1;q.push(k);g.uniforms["tDepth_mip"+(c+1)].value=k}a.verifyMRTWorks([s,p]);v=u.clone()}w=null}!F.idbuffer||!d&&w&&w.width==e&&w.height==h||(w=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:b}),w.shareDepthFrom=s,a.verifyMRTWorks([s,w]),q=p=null);g&&(g.uniforms.size.value.set(e,
h),g.uniforms.tDepth.value=p,f.uniforms.size.value.set(e,h),f.uniforms.resolution.value.set(1/e,1/h));l&&l.uniforms.resolution.value.set(1/e,1/h);m.uniforms.tOverlay.value=t;m.uniforms.tAO.value=v;m.uniforms.useAO.value=F.sao?1:0;m.uniforms.resolution.value.set(1/e,1/h);m.uniforms.tID.value=w};this.getMaxAnisotropy=function(){return a.getMaxAnisotropy()};this.hasMRT=function(){return!G&&a.supportsMRT()};this.initPostPipeline=function(e,n,p){function q(a){a.blending=THREE.NoBlending;a.depthWrite=!1;
a.depthTest=!1}F.sao=e&&!_isIE11;F.antialias=n&&!_isIE11;if(F.idbuffer=p)F.sao=!1;a||((e=window.devicePixelRatio)||(e=1),this.screenCaptureRenderer=a=new FireflyWebGLRenderer({canvas:b,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1,depth:!1,devicePixelRatio:e}),a.autoClear=!1,a.sortObjects=!1);F.sao&&!g&&(e=NormalsShader,c=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:THREE.UniformsUtils.clone(e.uniforms)}),c.blending=
THREE.NoBlending,F.haveTwoSided&&(c.side=THREE.DoubleSide),g=new THREE.ShaderPass(SAOShader),q(g.material),f=new THREE.ShaderPass(SAOBlurShader),q(f.material),k=new THREE.ShaderPass(SAOMinifyFirstShader),q(k.material),h=new THREE.ShaderPass(SAOMinifyShader),q(h.material));F.antialias?l||(l=new THREE.ShaderPass(FXAAShader),q(l.material)):l=null;m||(m=new THREE.ShaderPass(BlendShader),q(m.material));d||(d=new THREE.ShaderPass(BackgroundShader),q(d.material));this.setSize(D,W)};this.setClearColors=function(a,
b){d.uniforms.color2.value.copy(a);b?d.uniforms.color1.value.copy(b):d.uniforms.color1.value.set(0,0,0,1)};this.setAOOptions=function(a,b){g&&(void 0!==a&&(g.uniforms.radius.value=a),void 0!==b&&(g.uniforms.intensity.value=b),n=!1)};this.setGamma=function(a){m&&(B=a,m.uniforms.gamma.value=1/a)};this.getGamma=function(){return B};this.setExposureBias=function(a,b){m&&(A=a,m.uniforms.exposureBias.value=Math.pow(2,a),d.uniforms.luminance.value=Math.pow(2,-a))};this.getExposureBias=function(){return A};
this.getWhiteScale=function(){return m.uniforms.whiteScale.value};this.setTonemapMethod=function(b){m&&(0==b?(F.useHdrTarget&&(F.useHdrTarget=!1,this.setSize(D,W,!0)),a.gammaInput=!1):(F.useHdrTarget||(F.useHdrTarget=!0,this.setSize(D,W,!0)),a.gammaInput=!0),m.uniforms.toneMapMethod.value=b);d&&(d.uniforms.linearize.value=0==b?0:1)};this.getToneMapMethod=function(){return m.uniforms.toneMapMethod.value};this.toggleTwoSided=function(a){F.haveTwoSided!=a&&c&&(c.side=a?THREE.DoubleSide:THREE.FrontSide,
c.needsUpdate=!0);F.haveTwoSided=a};this.idAtPixel=function(b,c){if(!w)return 0;a.readPixels(w,0.5*(b+1)*w.width,0.5*(c+1)*w.height,1,1,C);return C[2]<<16|C[1]<<8|C[0]};this.highlightObjectViewport=function(a,b){var c=this.idAtPixel(a,b);0==c&&(C[0]=C[1]=C[2]=C[3]=0);m.uniforms.objID.value=c;m.uniforms.objIDv3.value.set(C[0]/255,C[1]/255,C[2]/255)}};FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\n#define FXAA_SPAN_MAX     8.0\n#define FXAA_EDGE_THRESHOLD_MIN (1.0/24.0)\n#define FXAA_EDGE_THRESHOLD (1.0/8.0)\n#define FXAA_SEARCH_THRESHOLD (1.0/4.0)\n#define FXAA_SEARCH_STEPS 24\n#define FXAA_SUBPIX_TRIM (1.0/4.0)\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n#define FXAA_SUBPIX_CAP (3.0/4.0)\nvec4 getColor(sampler2D tex, vec2 uv) {\nvec4 c = texture2D(tex, uv);\nreturn c;\n}\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x; }\nvec4 FxaaFilterReturn(vec4 rgba) {\nreturn rgba;}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) +\n((a * vec3(amountOfA)) + b); }\nvec4 FxaaTex(sampler2D tex, vec2 pos) {\nreturn getColor(tex, pos.xy);}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 offset, vec2 resolution) {\nvec2 uv = pos.xy + offset * resolution;\nreturn getColor(tex, uv);}\nvoid main() {\nvec3 rgbN = FxaaTexOff( tDiffuse, vUv, vec2(0.0,-1.0), resolution ).xyz;\nvec3 rgbE = FxaaTexOff( tDiffuse, vUv, vec2(1.0, 0.0), resolution ).xyz;\nvec3 rgbW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,0.0), resolution ).xyz;\nvec3 rgbS = FxaaTexOff( tDiffuse, vUv, vec2(0.0, 1.0), resolution ).xyz;\nvec4 rgbaM = FxaaTex( tDiffuse, vUv);\nvec3 rgbM  = rgbaM.xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaS = FxaaLuma(rgbS);\nfloat lumaM = FxaaLuma(rgbM);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\ngl_FragColor = FxaaFilterReturn(rgbaM); return;}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,-1.0), resolution ).xyz;\nvec3 rgbNE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,-1.0), resolution ).xyz;\nvec3 rgbSW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,1.0), resolution ).xyz;\nvec3 rgbSE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,1.0), resolution ).xyz;\nfloat opacity  = rgbaM.w;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma( rgbNW);\nfloat lumaNE = FxaaLuma( rgbNE);\nfloat lumaSW = FxaaLuma( rgbSW);\nfloat lumaSE = FxaaLuma( rgbSE);\nfloat edgeVert = abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz = abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -resolution.y : -resolution.x;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nbool pairN = gradientN >= gradientS;\nif(!pairN) lumaN = lumaS;\nif(!pairN) gradientN = gradientS;\nif(!pairN) lengthSign *= -1.0;\nvec2 posN;\nposN.x = vUv.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = vUv.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(resolution.x, 0.0) : vec2(0.0, resolution.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTex( tDiffuse, posN.xy).xyz);\nif(!doneP) lumaEndP = FxaaLuma(FxaaTex( tDiffuse, posP.xy).xyz);\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) break;\nif(!doneN) posN -= offNP;\nif(!doneP) posP += offNP; }\nfloat dstN = horzSpan ? vUv.x - posN.x : vUv.y - posN.y;\nfloat dstP = horzSpan ? posP.x - vUv.x : posP.y - vUv.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\nlengthSign = 0.0;\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = FxaaTex(tDiffuse, vec2(\nvUv.x + (horzSpan ? 0.0 : subPixelOffset),\nvUv.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\ngl_FragColor = FxaaFilterReturn(vec4(FxaaLerp3(rgbL, rgbF, blendL), opacity));\n}"};TonemapShaderChunk="float luminance_post(vec3 rgb) {\nreturn dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\nreturn dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\nvec3 R = vec3( 3.240479, -1.537150, -0.498535);\nvec3 G = vec3(-0.969256,  1.875992,  0.041556);\nvec3 B = vec3( 0.055648, -0.204043,  1.057311);\nvec3 rgb;\nrgb.b = dot(xyz, B);\nrgb.g = dot(xyz, G);\nrgb.r = dot(xyz, R);\nreturn rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\nvec3 X = vec3(0.412453, 0.35758, 0.180423);\nvec3 Y = vec3(0.212671, 0.71516, 0.0721688);\nvec3 Z = vec3(0.0193338, 0.119194, 0.950227);\nvec3 xyz;\nxyz.x = dot(rgb, X);\nxyz.y = dot(rgb, Y);\nxyz.z = dot(rgb, Z);\nreturn xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\nfloat sum = xyz.x + xyz.y + xyz.z;\nsum = 1.0 / sum;\nvec3 xyY;\nxyY.z = xyz.y;\nxyY.x = xyz.x * sum;\nxyY.y = xyz.y * sum;\nreturn xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\nfloat x = xyY.x;\nfloat y = xyY.y;\nfloat Y = xyY.z;\nvec3 xyz;\nxyz.y = Y;\nxyz.x = x * (Y / y);\nxyz.z = (1.0 - x - y) * (Y / y);\nreturn xyz;\n}\nvec3 toneMapUncharted2(vec3 x)\n{\nfloat A = 0.22;\nfloat B = 0.30;\nfloat C = 0.10;\nfloat D = 0.20;\nfloat E = 0.01;\nfloat F = 0.30;\nreturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\nvec3 toneMapReinhard(vec3 rgb, float scale, float Lmax) {\nfloat L = luminance_pre(rgb);\nfloat sL = L * scale;\nfloat tmL = scale * (1.0 + sL / (Lmax * Lmax))/ (1.0 + sL);\nrgb *= tmL;\nreturn rgb;\n}\nvec3 toneMapReinhardYxy(vec3 rgb, float scale, float Lmax) {\nvec3 xyY = xyz2xyY(rgb2xyz(rgb));\nfloat L = xyY.z;\nfloat sL = L * scale;\nfloat tmL = scale * (1.0 + sL / (Lmax * Lmax))/ (1.0 + sL);\nxyY.z *= tmL;\nreturn xyz2rgb(xyY2xyz(xyY));\n}\nvec3 toneMapExpRgb(vec3 rgb) {\nrgb = vec3(1.0) - vec3(exp(rgb * vec3(exposure)));\nreturn rgb;\n}\nfloat TonemapMin = -2.152529302052785809;\nfloat TonemapMax = 1.163792197947214113;\nvec3 log10(vec3 x) { return log(x) * (1.0 / log(10.0));}\nfloat toneMapCanon(float x) {\nfloat x2 = x  * x;\nfloat x3 = x  * x2;\nfloat x4 = x2 * x2;\nfloat x5 = x2 * x3;\nfloat x6 = x3 * x3;\nvec3 coeff1 = vec3( 23.921, -70.678,  71.943);\nvec4 coeff2 = vec4(-29.707,  5.9189, -0.4027, 0.0071);\nreturn dot(coeff1, vec3(x6, x5, x4)) + dot(coeff2, vec4(x3, x2, x, 1.0));\n}";BlendShader={uniforms:{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},objID:{type:"i",value:0},objIDv3:{type:"v3",value:new THREE.Vector3(0,0,0)},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)},gamma:{type:"f",value:1},whiteScale:{type:"f",value:1},exposureBias:{type:"f",value:1},toneMapMethod:{type:"i",value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:["uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform vec2 resolution;\nuniform float whiteScale;\nuniform float gamma;\nuniform float exposureBias;\nuniform int toneMapMethod;\nuniform int objID;\nuniform vec3 objIDv3;\nuniform sampler2D tID;\nvarying vec2 vUv;\nfloat exposure = log(1.0 - 0.6) / (whiteScale * 0.5);",TonemapShaderChunk,"vec4 fetchOverlayTexel(vec2 uv, vec2 offset) {\nreturn texture2D(tOverlay, uv + resolution * offset);\n}\nvec4 overlayEdgeDetect(vec2 vUv) {\nint has_zero = 0;\nvec4 center;\nvec4 non_zero_pixel;\nfloat max_alpha = 0.0;\nfor (int j=-1; j<=1; j++) {\nfor (int i=-1; i<=1; i++) {\nvec4 c = fetchOverlayTexel(vUv, vec2(i, j));\nmax_alpha = max(max_alpha, c.a);\nif (i==0 && j==0)\ncenter = c;\nif (c.a == 0.0)\nhas_zero++;\nelse\nnon_zero_pixel = c;\n}\n}\nif (has_zero != 0 && has_zero != 9)\n{\nif (center == vec4(0.0))\ncenter = non_zero_pixel;\nfloat maxComponent = max(center.r, max(center.g, center.b));\ncenter.rgb /= maxComponent;\ncenter.rgb = sqrt(center.rgb);\ncenter.a = 0.5 + 0.5 * max_alpha * 0.125 * float(has_zero);\n}\nif (has_zero == 0) {\ncenter.a = -center.a;\n}\nreturn center;\n}\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\nfloat ao = (useAO != 0) ? texture2D(tAO, vUv).r : 1.0;\ntexel.rgb *= ao;\nif (toneMapMethod == 1) {\ntexel.rgb *= exposureBias / whiteScale;\n} else if (toneMapMethod == 2) {\ntexel.rgb = toneMapReinhard(texel.rgb, exposureBias, whiteScale);\n} else if (toneMapMethod == 3) {\ntexel.rgb = toneMapUncharted2(texel.rgb * exposureBias);\ntexel.rgb *= 1.0 / toneMapUncharted2(vec3(whiteScale));\n} else if (toneMapMethod == 4) {\ntexel.rgb = toneMapExpRgb(texel.rgb * exposureBias);\n} else if (toneMapMethod == 5) {\nvec3 indexColor = log10(max(vec3(0.000000001), texel.rgb * exposureBias));\nindexColor = min(vec3(1.0), max(vec3(0.0), (indexColor.rgb - TonemapMin) / (TonemapMax - TonemapMin)));\ntexel.rgb = vec3(toneMapCanon(indexColor.r), toneMapCanon(indexColor.g), toneMapCanon(indexColor.b));\n}\ntexel.rgb = pow(texel.rgb, vec3(gamma));\nif (useOverlay!=0) {\nvec4 overlay = overlayEdgeDetect(vUv);\nif (overlay.a < 0.0) {\noverlay.a = -overlay.a;\nif (overlay.a >= 0.99) {\noverlay.a = 0.75;\ntexel.rgb = vec3(luminance_post(texel.rgb));\n}\n}\ntexel.rgb = mix(texel.rgb, pow(overlay.rgb, vec3(gamma)), overlay.a);\n}\nif (objID != 0) {\nvec4 idAtPixel = texture2D(tID, vUv);\nvec3 idDelta = abs(idAtPixel.rgb - objIDv3.rgb);\nif (max(max(idDelta.r, idDelta.g), idDelta.b) < 1e-3) {\ntexel.rgb = mix(texel.rgb, vec3(1.0,1.0,0.0), 0.25);\n}\n}\ngl_FragColor = texel;\n}"].join("\n")};THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader});this.renderToScreen=!1;this.needsSwap=this.enabled=!0;this.clear=!1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);var c=new THREE.BufferGeometry,e=new Float32Array(9);e[0]=-1;e[1]=-1;e[2]=0;e[3]=3;e[4]=-1;e[5]=0;e[6]=-1;e[7]=3;e[8]=0;var d=new Float32Array(6);
d[0]=0;d[1]=0;d[2]=2;d[3]=0;d[4]=0;d[5]=2;c.attributes.position={itemSize:3,array:e};c.attributes.uv={itemSize:2,array:d};this.quad=new THREE.Mesh(c,this.material);this.scene=new THREE.Scene;this.scene.add(this.quad)};THREE.ShaderPass.prototype={render:function(a,b,c,e){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c);this.renderToScreen||!b?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}};SAOShader={uniforms:{tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:10},bias:{type:"f",value:0.01},projScale:{type:"f",value:500},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},intensity:{type:"f",value:0.75},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}},
vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#extension GL_OES_standard_derivatives : enable\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (7)\nuniform float           projScale;\nuniform sampler2D tDepth;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nfloat intensityDivR6 = intensity / pow(radius, 6.0);\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\nfloat angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\nreturn clamp(z * (1.0 / -cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\nfloat temp = floor(key * 256.0);\np.x = temp * (1.0 / 256.0);\np.y = key * 256.0 - temp;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\nfloat depth = dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\nif (depth == 0.0)\nreturn -cameraFar * 1.0e10;\nreturn depth * (cameraNear - cameraFar) - cameraNear;\n}\nuniform vec4 projInfo;\nvec3 reconstructCSPosition(vec2 S, float z) {\nreturn vec3((S.xy * projInfo.xy + projInfo.zw) * z, z);\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\nreturn normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\nreturn cross(dFdy(C), dFdx(C));\n}\nvec2 sizeM1 = vec2(1.0/(size.x), 1.0/(size.y));\nvec3 getPosition(ivec2 ssP, float depth) {\nvec3 P;\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\nreturn P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\nivec2 ssP = ivec2(ssR * unitOffset) + ssC;\nvec3 P;\nvec2 screenUV = (vec2(ssP) + vec2(0.5)) * sizeM1;\n#ifdef USE_MIPMAP\nint mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\nif (mipLevel == 0) {\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n}\nelse if (mipLevel == 1)\nP.z = unpackDepth(texture2D(tDepth_mip1, screenUV));\nelse if (mipLevel == 2)\nP.z = unpackDepth(texture2D(tDepth_mip2, screenUV));\nelse if (mipLevel == 3)\nP.z = unpackDepth(texture2D(tDepth_mip3, screenUV));\nelse if (mipLevel == 4)\nP.z = unpackDepth(texture2D(tDepth_mip4, screenUV));\nelse if (mipLevel == 5)\nP.z = unpackDepth(texture2D(tDepth_mip5, screenUV));\n#else\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\nreturn P;\n}\nfloat radius2 = radius * radius;\nfloat invRadius2 = 1.0 / radius2;\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\nfloat ssR;\nvec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\nssR *= ssDiskRadius;\nvec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\nvec3 v = Q - C;\nfloat vv = dot(v, v);\nfloat vn = dot(v, n_C);\nconst float epsilon = 0.01;\nfloat f = max(radius2 - vv, 0.0); return f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n}\nconst bool useNoise = true;\nvec2 rand( const vec2 coord ) {\nvec2 noise;\nif ( useNoise ) {\nfloat nx = dot ( coord, vec2( 12.9898, 78.233 ) );\nfloat ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );\nnoise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );\n} else {\nfloat ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );\nfloat gg = fract( coord.t * ( size.y / 2.0 ) );\nnoise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;\n}\nreturn ( noise * 2.0  - 1.0 );\n}\nfloat getRandomAngle(vec2 pos) {\nvec2 rnd = rand(pos);\nreturn atan(rnd.y, rnd.x);\n}\nvoid main() {\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 nrmz = texture2D(tDepth, vUv);\nif (nrmz.z == 0.0) {\ngl_FragColor.r = 1.0;\ngl_FragColor.a = 0.0;\npackKey(1.0, gl_FragColor.gb);\nreturn;\n}\nvec3 C = getPosition(ssC, nrmz.z);\npackKey(CSZToKey(C.z), gl_FragColor.gb);\nfloat randomPatternRotationAngle = getRandomAngle(vUv);\nvec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\nfloat ssDiskRadius = -projScale * radius / C.z;\nfloat sum = 0.0;\nfor (int i = 0; i < NUM_SAMPLES; ++i) {\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, i, randomPatternRotationAngle);\n}\nfloat A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\nif (abs(dFdx(C.z)) < 0.02) {\nA -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n}\nif (abs(dFdy(C.z)) < 0.02) {\nA -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n}\ngl_FragColor.r = A;\ngl_FragColor.a = 1.0;\n}"};SAOBlurShader={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},axis:{type:"v2",value:new THREE.Vector2(1,0)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define EDGE_SHARPNESS     (1.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);  // stddev = 2.0\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nivec2 axisi = ivec2(axis);\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\nreturn p.x * (256.0 / 257.0) + p.y * (1.0 / 257.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\nfloat gaussian[R + 1];\n#       if R == 3\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;  // stddev = 2.0\n#       elif R == 4\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;  // stddev = 2.0\n#       elif R == 6\ngaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 temp = texture2D(tDiffuse, vUv);\ngl_FragColor.gb = temp.KEY_COMPONENTS;\ngl_FragColor.a = temp.a;\nVALUE_TYPE sum = temp.VALUE_COMPONENTS;\nif (temp.a == 0.0) {\nresult = sum;\nreturn;\n}\nfloat key = unpackKey(keyPassThrough);\nfloat BASE = gaussian[0];\nfloat totalWeight = BASE;\nsum *= totalWeight;\nfor (int r = -R; r <= R; ++r) {\nif (r != 0) {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[r<0?-r:r];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\n}\nconst float epsilon = 0.0001;\nresult = sum / (totalWeight + epsilon);\n}"};SAOMinifyFirstShader={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;\nvarying vec2 vUv;\nvec4 packDepth( const in float depth ) {\nvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\nreturn enc;\n}\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\nfloat depth = texture2D(tDiffuse, ssP).z;\nif (depth != 0.0)\ndepth = (depth + cameraNear) * cameraInvNearFar;\ngl_FragColor = packDepth(depth);\n}"};
SAOMinifyShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\ngl_FragColor = texture2D(tDiffuse, ssP);\n}"};NormalsShader={uniforms:{},vertexShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvNormal = normalize( normalMatrix * normal );\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ndepth = mvPosition.z;\nvec4 p_Position = projectionMatrix * mvPosition;\ngl_Position = p_Position;\n}",fragmentShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvec3 n = vNormal;\nn = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nn = normalize( n );\ngl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}"};BackgroundShader={uniforms:{color1:{type:"v4",value:new THREE.Vector4(1/255,2/255,3/255,1)},color2:{type:"v4",value:new THREE.Vector4(41/255,76/255,120/255,1)},luminance:{type:"f",value:1},linearize:{type:"i",value:1}},vertexShader:"uniform vec4 color1;\nuniform vec4 color2;\nuniform float luminance;\nuniform int linearize;\nvarying vec4 vcolor;\nvoid main() {\nif (uv.y == 0.0)\nvcolor = color1;\nelse\nvcolor = color2;\nif (linearize != 0)\nvcolor *= vcolor;\nvcolor *= luminance;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"const vec4 c0 = vec4(1.0, 13.0, 4.0, 16.0);\nconst vec4 c1 = vec4(9.0, 5.0, 12.0, 8.0);\nconst vec4 c2 = vec4(3.0, 15.0, 2.0, 14.0);\nconst vec4 c3 = vec4(11.0, 7.0, 10.0, 6.0);\nvarying vec4 vcolor;\nvoid main() {\nvec4 c = vcolor;\nint i = int(mod(float(gl_FragCoord.x), 4.0));\nint j = int(mod(float(gl_FragCoord.y), 4.0));\nvec4 col;\nif (i==0) col = c0; else if (i==1) col = c1; else if (i==2) col = c2; else col = c3;\nfloat bias;\nif (j==0) bias = col.x; else if (j==1) bias = col.y; else if (j==2) bias = col.z; else bias = col.w;\nc.xyz += bias * (1.0/(17.0*256.0));\ngl_FragColor = c;\n}"};LineShader={uniforms:{pixelsPerUnit:{type:"f",value:1},unitsPerPixel:{type:"f",value:1},highlightId:{type:"v4",value:new THREE.Vector4(0,0,0,0)},tLayerMask:{type:"t",value:null},tRaster:{type:"t",value:null}},attributes:{flags4b:0,color4b:0,dbId4b:0,extraParams:0},defines:{},vertexShader:"#define TAU 6.28318530718\n#define PI 3.14159265358979\n#define HALF_PI 1.57079632679\n#define VBB_LINE_SEGMENT     16.0\n#define VBB_ARC_CIRCULAR     32.0\n#define VBB_ARC_ELLIPTICAL   48.0\n#define VBB_TEX_QUAD         64.0\n#define VBB_SEG_START_RIGHT  1.0\n#define VBB_SEG_START_LEFT   2.0\n#define VBB_SEG_END_RIGHT    3.0\n#define VBB_SEG_END_LEFT     4.0\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nattribute vec4 flags4b;\nattribute vec4 extraParams;\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nvarying vec4 outColor;\nvarying vec4 dbId;\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nuniform sampler2D tLayerMask;\nvarying float halfWidth;\nvoid strokeLineSegment(float vertexId) {\nfloat distanceAlong = uv.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = position.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth + 0.5 * unitsPerPixel;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(-offset.y, offset.x);\ncentralVertex.xy += isLeftSide * vec2(-offset.y, offset.x);\nmultipurpose.x = -moveDist;\n}\nelse {\nvec2 along = vec2(cos(position.z), sin(position.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(offset.y, -offset.x);\ncentralVertex.xy += isLeftSide * vec2(offset.y, -offset.x);\nmultipurpose.x = multipurpose.y + moveDist;\n}\n}\nvoid strokeTexQuad(float vertexId) {\nfloat distanceAlong = uv.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = position.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 1.0;\nhalfWidth = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(0.0, offset.x);\nmultipurpose.x = 0.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\nelse {\nvec2 along = vec2(cos(position.z), sin(position.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(0.0, -offset.x);\nmultipurpose.x = 1.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\n}\nvoid strokeCircularArc(float vertexId) {\nvec2 angles = vec2(position.z, uv.x);\nfloat r = extraParams.x;\nbool isStart = (vertexId < VBB_SEG_END_RIGHT);\nbool isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT);\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(position.x) + r * cos(angles);\nvec2 endsY = vec2(position.y) + r * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + r));\nmaxPt = max(maxPt, vec2(position.x, position.y + r));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(position.x - r, position.y));\nmaxPt = max(maxPt, vec2(position.x - r, position.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - r));\nmaxPt = max(maxPt, vec2(position.x, position.y - r));\n}\n}\nelse {\nminPt = min(minPt, vec2(position.x + r, position.y));\nmaxPt = max(maxPt, vec2(position.x + r, position.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + r));\nmaxPt = max(maxPt, vec2(position.x, position.y + r));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(position.x - r, position.y));\nmaxPt = max(maxPt, vec2(position.x - r, position.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - r));\nmaxPt = max(maxPt, vec2(position.x, position.y - r));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -r;\nmultipurpose.z = angles.y;\nmultipurpose.w = -r;\n}\nvoid strokeEllipticalArc(float vertexId) {\nvec2 angles = vec2(position.z, uv.x);\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nfloat major = extraParams.x;\nfloat minor = extraParams.y;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(position.x) + major * cos(angles);\nvec2 endsY = vec2(position.y) + minor * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + minor));\nmaxPt = max(maxPt, vec2(position.x, position.y + minor));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(position.x - major, position.y));\nmaxPt = max(maxPt, vec2(position.x - major, position.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - minor));\nmaxPt = max(maxPt, vec2(position.x, position.y - minor));\n}\n}\nelse {\nminPt = min(minPt, vec2(position.x + major, position.y));\nmaxPt = max(maxPt, vec2(position.x + major, position.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + minor));\nmaxPt = max(maxPt, vec2(position.x, position.y + minor));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(position.x - major, position.y));\nmaxPt = max(maxPt, vec2(position.x - major, position.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - minor));\nmaxPt = max(maxPt, vec2(position.x, position.y - minor));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart < 0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft < 0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -major;\nmultipurpose.z = angles.y;\nmultipurpose.w = minor;\n}\nvoid main() {\noffsetPosition = position.xy;\ncentralVertex = position.xy;\nvec4 layerBit = texture2D(tLayerMask, flags4b.ba / 255.0);\nif (layerBit.r == 0.0) {\noutColor = vec4(0.0);\n}\nelse {\nfloat vertexId = mod(flags4b.x, 16.0);\nfloat geomType = flags4b.x - vertexId;\nfloat lineWeight = uv.y;\nif (lineWeight > 0.0) {\nif (lineWeight * pixelsPerUnit < 0.33)\nlineWeight = 0.33 * unitsPerPixel;\n}\nelse {\nlineWeight = abs(lineWeight);\n}\nhalfWidth = lineWeight;\noutColor = color4b;\ndbId = dbId4b;\nif (geomType == VBB_LINE_SEGMENT)\nstrokeLineSegment(vertexId);\nelse if (geomType == VBB_ARC_CIRCULAR)\nstrokeCircularArc(vertexId);\nelse if (geomType == VBB_ARC_ELLIPTICAL)\nstrokeEllipticalArc(vertexId);\nelse if (geomType == VBB_TEX_QUAD)\nstrokeTexQuad(vertexId);\nelse\nhalfWidth = 0.0;\n}\ngl_Position = projectionMatrix * modelViewMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n}",
fragmentShader:"#extension GL_OES_standard_derivatives : enable\n#define TAU 6.28318530718\n#define PI 3.14159265358979\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nfloat aaRange = 0.5 * unitsPerPixel;\nuniform sampler2D tRaster;\nvarying vec4 outColor;\nvarying vec4 dbId;\n#ifdef MRT_ID_BUFFER\n#extension GL_EXT_draw_buffers : enable\n#define gl_FragColor gl_FragData[0]\n#endif\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nfloat curveGaussian(float r, float width) {\nfloat amt = clamp(abs(r / (width * 1.0)), 0.0, 1.0);\namt = max(amt - 0.0, 0.0);\nfloat exponent = amt * 3.5;\nexponent *= -exponent;\nreturn clamp(exp(exponent), 0.0, 1.0);\n}\nvoid fillLineSegment() {\nfloat radius = halfWidth;\nfloat parametricDistance = multipurpose.x;\nfloat segmentLength = multipurpose.y;\nif (parametricDistance < 0.0) {\nradius = sqrt(max(0.0, radius * radius - parametricDistance * parametricDistance));\n} else if (parametricDistance >= segmentLength) {\nfloat d = parametricDistance - segmentLength;\nradius = sqrt(max(0.0, radius * radius - d * d));\n}\nfloat dist = distance(centralVertex, offsetPosition);\nfloat range =  dist - radius;\nif (range > aaRange) {\ndiscard;\n}\nelse if (range < -aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range+aaRange, 2.0 * unitsPerPixel);\n}\n}\nvoid fillCircularArc() {\nfloat dist = distance(centralVertex, offsetPosition);\nfloat radius = abs(multipurpose.y);\nfloat range =  abs(dist - radius);\nif (range > aaRange + halfWidth) {\ndiscard;\n}\nvec2 angles = multipurpose.xz;\nvec2 direction = offsetPosition - centralVertex;\nfloat angle = atan(direction.y, direction.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\nif (range < halfWidth - aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range-halfWidth+aaRange, 2.0 * unitsPerPixel);\n}\n}\nelse {\ndiscard;\n}\n}\nfloat DistancePointEllipseApprox(vec2 e, vec2 pos) { \nvec2 dx = dFdx(pos);\nvec2 dy = dFdy(pos);\nvec2 esqr = e * e;\nvec2 possqr = pos * pos;\nvec2 posDivEsqr = pos / esqr;\nvec2 pos2DivE2 = pos * posDivEsqr;\nvec2 dPos = 2.0 * posDivEsqr;\nvec2 dPosx = dPos * dx;\nvec2 dPosy = dPos * dy;\nvec2 dfdxy = vec2(dPosx.x + dPosx.y, dPosy.x + dPosy.y);\nfloat sd = (pos2DivE2.x + pos2DivE2.y - 1.0) / length(dfdxy);\nreturn abs(sd) * unitsPerPixel * 0.745;\n}\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\nfloat dist;\nvec2 esqr = e * e;\nvec2 ey = e * y;\nfloat t0 = -esqr[1] + ey[1];\nfloat t1 = -esqr[1] + length(ey);\nfloat t;\nvec2 r;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nif (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\nreturn dist;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nfloat ecc = 1.0 +  0.1 * e[0] / e[1];\nif (dist > max(ecc * (width + aaRange), e[0] * 0.001))\nreturn dist;\nif (dist < (width - aaRange) / ecc)\nreturn dist;\nfor (int i = 0; i < 10; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nreturn dist;\n}\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\nvec2 locE, locY;\nfloat diff = sign(e[0] - e[1]);\nvec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\nlocE.x = dot(e, swizzle.xy);\nlocE.y = dot(e, swizzle.yx);\nlocY.x = dot(y, swizzle.xy);\nlocY.y = dot(y, swizzle.yx);\nvec2 refl = sign(locY);\nlocY *= refl;\nvec2 x;\nfloat distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\nx *= refl;\nlocX.x = dot(x, swizzle.xy);\nlocX.y = dot(x, swizzle.yx);\nreturn distance;\n}\nvoid fillEllipticalArc() {\nvec2 radii = abs(multipurpose.yw);\nvec2 dir = offsetPosition - centralVertex;\nfloat lenDirSq = dot(dir, dir);\nfloat minRad = min(radii.x, radii.y) - (halfWidth + aaRange);\nif (lenDirSq < minRad * minRad)\ndiscard;\nvec2 pos;\nfloat range = DistancePointEllipse(radii, dir, pos, halfWidth, aaRange);\nif (range > halfWidth + aaRange)\ndiscard;\nfloat ar = radii[0] / radii[1];\nvec2 angles = multipurpose.xz;\nfloat angle = atan(ar * pos.y, pos.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\nif (range < halfWidth - aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range-halfWidth+aaRange, 2.0 * unitsPerPixel);\n}\n}\nelse {\ndiscard;\n}\n}\nvoid main() {\nif (outColor.a == 0.0) {\ndiscard;\n}\nif (halfWidth == 0.0) {\nif (multipurpose.z != 0.0)\ngl_FragColor = texture2D(tRaster, multipurpose.xy);\nelse\ngl_FragColor = outColor;\n}\nelse if (multipurpose.y >= 0.0)\nfillLineSegment();\nelse if (multipurpose.y == multipurpose.w)\nfillCircularArc();\nelse\nfillEllipticalArc();\n#ifdef MRT_ID_BUFFER\ngl_FragData[1] = vec4(dbId.rgb, 1.0);\n#elif defined(ID_COLOR)\noutColor = vec4(dbId.rgba);\n#endif\n}"};FireflyWebGLRenderer=function(a){function b(a,b){var f=b.geometry,g=a.faces3,h=3*g.length,k=1*g.length,l=3*g.length,g=c(b,a),m=d(g),n=e(g),p=g.vertexColors?g.vertexColors:!1;a.__vertexArray=new Float32Array(3*h);n&&(a.__normalArray=new Float32Array(3*h));f.hasTangents&&(a.__tangentArray=new Float32Array(4*h));p&&(a.__colorArray=new Float32Array(3*h));m&&(0<f.faceVertexUvs.length&&(a.__uvArray=new Float32Array(2*h)),1<f.faceVertexUvs.length&&(a.__uv2Array=new Float32Array(2*h)));b.geometry.skinWeights.length&&
b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*h),a.__skinWeightArray=new Float32Array(4*h));a.__faceArray=new Uint16Array(3*k);a.__lineArray=new Uint16Array(2*l);a.__webglFaceCount=3*k;a.__webglLineCount=2*l;if(g.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var q in g.attributes){var f=g.attributes[q],k={},s;for(s in f)k[s]=f[s];if(!k.__webglInitialized||k.createUniqueBuffers)k.__webglInitialized=!0,l=1,"v2"===k.type?l=2:"v3"===
k.type?l=3:"v4"===k.type?l=4:"c"===k.type&&(l=3),k.size=l,k.array=new Float32Array(h*l),k.buffer=r.createBuffer(),k.buffer.belongsToAttribute=q,f.needsUpdate=!0,k.__original=f;a.__webglCustomAttributesList.push(k)}}a.__inittedArrays=!0}function c(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function e(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===THREE.SmoothShading?
THREE.SmoothShading:THREE.FlatShading}function d(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a instanceof THREE.ShaderMaterial?!0:!1}function f(a,b,c,d){var e,f,h,k=!1;if(c.vb){if(c.streamingDraw){var l=qa.interleavedVB;l||(l=r.createBuffer(),qa.interleavedVB=l);r.bindBuffer(r.ARRAY_BUFFER,l);r.bufferData(r.ARRAY_BUFFER,c.vb,r.STREAM_DRAW)}else r.bindBuffer(r.ARRAY_BUFFER,c.vbbuffer);l=c.vbstride;for(h in b)if("index"!=h&&(f=b[h],e=c.attributes[h],0<=f&&e))if(void 0!==e.itemOffset){var m=
r.FLOAT;e.hasOwnProperty("bytesPerItem")&&1==e.bytesPerItem&&(m=r.UNSIGNED_BYTE);g(f);r.vertexAttribPointer(f,e.itemSize,m,e.normalize,4*l,4*(e.itemOffset+d*l))}else k=!0}else k=!0;if(k)for(h in b)"index"!=h&&(f=b[h],e=c.attributes[h],0<=f&&(e?void 0===e.itemOffset&&(c.streamingDraw?(l=qa[h],l||(l=r.createBuffer(),qa[h]=l),r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,e.array,r.DYNAMIC_DRAW)):r.bindBuffer(r.ARRAY_BUFFER,e.buffer),m=r.FLOAT,e.hasOwnProperty("bytesPerItem")&&1==e.bytesPerItem&&
(m=r.UNSIGNED_BYTE),g(f),r.vertexAttribPointer(f,e.itemSize,m,e.normalize,0,d*e.itemSize*4)):a.defaultAttributeValues&&(2===a.defaultAttributeValues[h].length?r.vertexAttrib2fv(f,a.defaultAttributeValues[h]):3===a.defaultAttributeValues[h].length&&r.vertexAttrib3fv(f,a.defaultAttributeValues[h]))))}function g(a){ha[a]||(r.enableVertexAttribArray(a),ha[a]=!0)}function h(){for(var a=0,b=ha.length;a<b;a++)ha[a]&&(r.disableVertexAttribArray(a),ha[a]=!1)}function k(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}
function l(a,b,c){if(a.length)for(var d=0,e=a.length;d<e;d++)ia=ga=null,la=Z=xa=ma=Ca=ba=Ba=-1,Ha=!0,a[d].render(b,c,aa,X),ia=ga=null,la=Z=xa=ma=Ca=ba=Ba=-1,Ha=!0}function m(a,b,c,d,e,f,g,h){var k,l,m,n;b?(l=a.length-1,n=b=-1):(l=0,b=a.length,n=1);for(var p=l;p!==b;p+=n)if(k=a[p],k.render){l=k.object;m=k.buffer;if(h)k=h;else{k=k[c];if(!k)continue;g&&J.setBlending(k.blending,k.blendEquation,k.blendSrc,k.blendDst);J.setDepthTest(k.depthTest);J.setDepthWrite(k.depthWrite);A(k.polygonOffset,k.polygonOffsetFactor,
k.polygonOffsetUnits)}J.setMaterialFaces(k);m instanceof THREE.BufferGeometry?J.renderBufferDirect(d,e,f,k,m,l):J.renderBuffer(d,e,f,k,m,l)}}function n(a,c){var d,e,f,g;if(void 0===a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new THREE.Matrix4,a._normalMatrix=new THREE.Matrix3,void 0!==a.geometry&&void 0===a.geometry.__webglInit&&(a.geometry.__webglInit=!0,a.geometry.addEventListener("dispose",Ua)),e=a.geometry,void 0!==e))if(e instanceof THREE.BufferGeometry)if(e.streamingDraw)!e.streamingIndex&&
(e=e.attributes.index)&&(e.buffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.array,r.STATIC_DRAW));else{e.vb&&(e.vbbuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.vbbuffer),r.bufferData(r.ARRAY_BUFFER,e.vb,r.STATIC_DRAW));var h,k;for(h in e.attributes)g=e.attributes[h],g.array&&(k="index"===h?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER,g.buffer=r.createBuffer(),r.bindBuffer(k,g.buffer),r.bufferData(k,g.array,r.STATIC_DRAW))}else if(a instanceof
THREE.Mesh){f=a.material;if(void 0===e.geometryGroups){k=e;var l,m,n;h={};var q=k.morphTargets.length,s=k.morphNormals.length,t=f instanceof THREE.MeshFaceMaterial;k.geometryGroups={};f=0;for(l=k.faces.length;f<l;f++)m=k.faces[f],m=t?m.materialIndex:0,void 0===h[m]&&(h[m]={hash:m,counter:0}),n=h[m].hash+"_"+h[m].counter,void 0===k.geometryGroups[n]&&(k.geometryGroups[n]={faces3:[],materialIndex:m,vertices:0,numMorphTargets:q,numMorphNormals:s}),65535<k.geometryGroups[n].vertices+3&&(h[m].counter+=
1,n=h[m].hash+"_"+h[m].counter,void 0===k.geometryGroups[n]&&(k.geometryGroups[n]={faces3:[],materialIndex:m,vertices:0,numMorphTargets:q,numMorphNormals:s})),k.geometryGroups[n].faces3.push(f),k.geometryGroups[n].vertices+=3;k.geometryGroupsList=[];for(g in k.geometryGroups)k.geometryGroups[g].id=wa++,k.geometryGroupsList.push(k.geometryGroups[g])}for(d in e.geometryGroups)g=e.geometryGroups[d],g.__webglVertexBuffer||(k=g,k.__webglVertexBuffer=r.createBuffer(),k.__webglNormalBuffer=r.createBuffer(),
k.__webglTangentBuffer=r.createBuffer(),k.__webglColorBuffer=r.createBuffer(),k.__webglUVBuffer=r.createBuffer(),k.__webglUV2Buffer=r.createBuffer(),k.__webglSkinIndicesBuffer=r.createBuffer(),k.__webglSkinWeightsBuffer=r.createBuffer(),k.__webglFaceBuffer=r.createBuffer(),k.__webglLineBuffer=r.createBuffer(),J.info.memory.geometries++,b(g,a),e.verticesNeedUpdate=!0,e.morphTargetsNeedUpdate=!0,e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0,e.normalsNeedUpdate=!0,e.tangentsNeedUpdate=!0,e.colorsNeedUpdate=
!0)}else if(a instanceof THREE.Line&&!e.__webglVertexBuffer){g=e;g.__webglVertexBuffer=r.createBuffer();g.__webglColorBuffer=r.createBuffer();g.__webglLineDistanceBuffer=r.createBuffer();J.info.memory.geometries++;g=e;h=g.vertices.length;g.__vertexArray=new Float32Array(3*h);g.__colorArray=new Float32Array(3*h);g.__lineDistanceArray=new Float32Array(1*h);g.__webglLineCount=h;h=g.vertices.length;q=a.material;if(q.attributes)for(k in void 0===g.__webglCustomAttributesList&&(g.__webglCustomAttributesList=
[]),q.attributes){s=q.attributes[k];if(!s.__webglInitialized||s.createUniqueBuffers)s.__webglInitialized=!0,f=1,"v2"===s.type?f=2:"v3"===s.type?f=3:"v4"===s.type?f=4:"c"===s.type&&(f=3),s.size=f,s.array=new Float32Array(h*f),s.buffer=r.createBuffer(),s.buffer.belongsToAttribute=k,s.needsUpdate=!0;g.__webglCustomAttributesList.push(s)}e.verticesNeedUpdate=!0;e.colorsNeedUpdate=!0;e.lineDistancesNeedUpdate=!0}if(void 0===a.__webglActive){if(a instanceof THREE.Mesh)if(e=a.geometry,e instanceof THREE.BufferGeometry)p(c.__webglObjects,
e,a);else{if(e instanceof THREE.Geometry)for(d in e.geometryGroups)g=e.geometryGroups[d],p(c.__webglObjects,g,a)}else a instanceof THREE.Line&&(e=a.geometry,p(c.__webglObjects,e,a));a.__webglActive=!0}}function p(a,b,c){a.push({id:null,buffer:b,object:c,opaque:null,transparent:null,z:0})}function q(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function s(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function t(a,b){if(a instanceof THREE.Mesh||a instanceof
THREE.Line)for(var c=b.__webglObjects,d=c.length-1;0<=d;d--)c[d].object===a&&c.splice(d,1);delete a.__webglActive}function u(a,b,c,d,e){oa=0;d.needsUpdate&&(d.program&&ib(d),J.initMaterial(d,b,c,e),d.needsUpdate=!1);var f=!1,g=d.program,h=g.uniforms,k=d.uniforms;g!==ga&&(r.useProgram(g),ga=g,f=!0);d.id!==la&&(la=d.id,f=!0);if(f||a!==ia)r.uniformMatrix4fv(h.projectionMatrix,!1,a.projectionMatrix.elements),a!==ia&&(ia=a);if(f){c&&d.fog&&(k.fogColor.value=c.color,c instanceof THREE.Fog?(k.fogNear.value=
c.near,k.fogFar.value=c.far):c instanceof THREE.FogExp2&&(k.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Ha){var l,m=0,n=0,p=0,q,s,t,u=Ta,A=u.directional.colors,z=u.directional.positions,D=u.point.colors,G=u.point.positions,W=u.point.distances,H=u.spot.colors,M=u.spot.positions,N=u.spot.distances,Q=u.spot.directions,R=u.spot.anglesCos,T=u.spot.exponents,E=u.hemi.skyColors,I=u.hemi.groundColors,V=u.hemi.positions,O=0,Y=0,
Z=0,aa=0,ca=0,ba=0,X=0,ea=0,fa=l=0;c=t=fa=0;for(f=b.length;c<f;c++)if(l=b[c],!l.onlyShadow)if(q=l.color,s=l.intensity,t=l.distance,l instanceof THREE.AmbientLight)l.visible&&(J.gammaInput?(m+=q.r*q.r,n+=q.g*q.g,p+=q.b*q.b):(m+=q.r,n+=q.g,p+=q.b));else if(l instanceof THREE.DirectionalLight){if(ca+=1,l.visible&&(ja.setFromMatrixPosition(l.matrixWorld),ka.setFromMatrixPosition(l.target.matrixWorld),ja.sub(ka),ja.normalize(),0!==ja.x||0!==ja.y||0!==ja.z))l=3*O,z[l]=ja.x,z[l+1]=ja.y,z[l+2]=ja.z,J.gammaInput?
w(A,l,q,s*s):B(A,l,q,s),O+=1}else l instanceof THREE.PointLight?(ba+=1,l.visible&&(fa=3*Y,J.gammaInput?w(D,fa,q,s*s):B(D,fa,q,s),ka.setFromMatrixPosition(l.matrixWorld),G[fa]=ka.x,G[fa+1]=ka.y,G[fa+2]=ka.z,W[Y]=t,Y+=1)):l instanceof THREE.SpotLight?(X+=1,l.visible&&(fa=3*Z,J.gammaInput?w(H,fa,q,s*s):B(H,fa,q,s),ka.setFromMatrixPosition(l.matrixWorld),M[fa]=ka.x,M[fa+1]=ka.y,M[fa+2]=ka.z,N[Z]=t,ja.copy(ka),ka.setFromMatrixPosition(l.target.matrixWorld),ja.sub(ka),ja.normalize(),Q[fa]=ja.x,Q[fa+1]=
ja.y,Q[fa+2]=ja.z,R[Z]=Math.cos(l.angle),T[Z]=l.exponent,Z+=1)):l instanceof THREE.HemisphereLight&&(ea+=1,l.visible&&(ja.setFromMatrixPosition(l.matrixWorld),ja.normalize(),0!==ja.x||0!==ja.y||0!==ja.z))&&(t=3*aa,V[t]=ja.x,V[t+1]=ja.y,V[t+2]=ja.z,q=l.color,l=l.groundColor,J.gammaInput?(s*=s,w(E,t,q,s),w(I,t,l,s)):(B(E,t,q,s),B(I,t,l,s)),aa+=1);c=3*O;for(f=Math.max(A.length,3*ca);c<f;c++)A[c]=0;c=3*Y;for(f=Math.max(D.length,3*ba);c<f;c++)D[c]=0;c=3*Z;for(f=Math.max(H.length,3*X);c<f;c++)H[c]=0;c=
3*aa;for(f=Math.max(E.length,3*ea);c<f;c++)E[c]=0;c=3*aa;for(f=Math.max(I.length,3*ea);c<f;c++)I[c]=0;u.directional.length=O;u.point.length=Y;u.spot.length=Z;u.hemi.length=aa;u.ambient[0]=m;u.ambient[1]=n;u.ambient[2]=p;Ha=!1}c=Ta;k.ambientLightColor.value=c.ambient;k.directionalLightColor.value=c.directional.colors;k.directionalLightDirection.value=c.directional.positions;k.pointLightColor.value=c.point.colors;k.pointLightPosition.value=c.point.positions;k.pointLightDistance.value=c.point.distances;
k.spotLightColor.value=c.spot.colors;k.spotLightPosition.value=c.spot.positions;k.spotLightDistance.value=c.spot.distances;k.spotLightDirection.value=c.spot.directions;k.spotLightAngleCos.value=c.spot.anglesCos;k.spotLightExponent.value=c.spot.exponents;k.hemisphereLightSkyColor.value=c.hemi.skyColors;k.hemisphereLightGroundColor.value=c.hemi.groundColors;k.hemisphereLightDirection.value=c.hemi.positions}if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof
THREE.MeshPhongMaterial){k.opacity.value=d.opacity;J.gammaInput?k.diffuse.value.copyGammaToLinear(d.color):k.diffuse.value.copy(d.color);k.map.value=d.map;k.lightMap.value=d.lightMap;k.specularMap.value=d.specularMap;d.bumpMap&&(k.bumpMap.value=d.bumpMap,k.bumpScale.value=d.bumpScale);d.normalMap&&(k.normalMap.value=d.normalMap,k.normalScale.value.copy(d.normalScale));var S,da;d.map?S=d.map:d.specularMap&&(S=d.specularMap);void 0!==S&&(c=S.offset,S=S.repeat,k.offsetRepeat.value.set(c.x,c.y,S.x,S.y));
d.normalMap?da=d.normalMap:d.bumpMap&&(da=d.bumpMap);void 0!==da&&(c=da.offset,S=da.repeat,k.offsetRepeatBump.value.set(c.x,c.y,S.x,S.y));k.envMap.value=d.envMap;k.irradianceMap&&(k.irradianceMap.value=d.irradianceMap);k.reflectivity.value=J.gammaInput?d.reflectivity*d.reflectivity:d.reflectivity;k.refractionRatio.value=d.refractionRatio;k.combine.value=d.combine;k.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(k.diffuse.value=
d.color,k.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(k.diffuse.value=d.color,k.opacity.value=d.opacity,k.dashSize.value=d.dashSize,k.totalSize.value=d.dashSize+d.gapSize,k.scale.value=d.scale):d instanceof THREE.MeshPhongMaterial?(k.shininess.value=d.shininess,J.gammaInput?(k.ambient.value.copyGammaToLinear(d.ambient),k.emissive.value.copyGammaToLinear(d.emissive),k.specular.value.copyGammaToLinear(d.specular)):(k.ambient.value.copy(d.ambient),k.emissive.value.copy(d.emissive),
k.specular.value.copy(d.specular)),d.wrapAround&&k.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(J.gammaInput?(k.ambient.value.copyGammaToLinear(d.ambient),k.emissive.value.copyGammaToLinear(d.emissive)):(k.ambient.value.copy(d.ambient),k.emissive.value.copy(d.emissive)),d.wrapAround&&k.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(k.mNear.value=a.near,k.mFar.value=a.far,k.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(k.opacity.value=
d.opacity);if(e.receiveShadow&&!d._shadowPass&&k.shadowMatrix)for(S=da=0,c=b.length;S<c;S++)f=b[S],f.castShadow&&(f instanceof THREE.SpotLight||f instanceof THREE.DirectionalLight&&!f.shadowCascade)&&(k.shadowMap.value[da]=f.shadowMap,k.shadowMapSize.value[da]=f.shadowMapSize,k.shadowMatrix.value[da]=f.shadowMatrix,k.shadowDarkness.value[da]=f.shadowDarkness,k.shadowBias.value[da]=f.shadowBias,da++);b=d.uniformsList;k=0;for(da=b.length;k<da;k++)if(c=g.uniforms[b[k][1]])if(S=b[k][0],f=S.type,n=S.value,
"i"===f)r.uniform1i(c,n);else if("f"===f)r.uniform1f(c,n);else if("v2"===f)r.uniform2f(c,n.x,n.y);else if("v3"===f)r.uniform3f(c,n.x,n.y,n.z);else if("v4"===f)r.uniform4f(c,n.x,n.y,n.z,n.w);else if("c"===f)r.uniform3f(c,n.r,n.g,n.b);else if("iv1"===f)r.uniform1iv(c,n);else if("iv"===f)r.uniform3iv(c,n);else if("fv1"===f)r.uniform1fv(c,n);else if("fv"===f)n.length&&r.uniform3fv(c,n);else if("v2v"===f){void 0===S._array&&(S._array=new Float32Array(2*n.length));f=0;for(m=n.length;f<m;f++)p=2*f,S._array[p]=
n[f].x,S._array[p+1]=n[f].y;r.uniform2fv(c,S._array)}else if("v3v"===f){void 0===S._array&&(S._array=new Float32Array(3*n.length));f=0;for(m=n.length;f<m;f++)p=3*f,S._array[p]=n[f].x,S._array[p+1]=n[f].y,S._array[p+2]=n[f].z;r.uniform3fv(c,S._array)}else if("v4v"===f){void 0===S._array&&(S._array=new Float32Array(4*n.length));f=0;for(m=n.length;f<m;f++)p=4*f,S._array[p]=n[f].x,S._array[p+1]=n[f].y,S._array[p+2]=n[f].z,S._array[p+3]=n[f].w;r.uniform4fv(c,S._array)}else if("m4"===f)void 0===S._array&&
(S._array=new Float32Array(16)),n.flattenToArray(S._array),r.uniformMatrix4fv(c,!1,S._array);else if("m4v"===f){void 0===S._array&&(S._array=new Float32Array(16*n.length));f=0;for(m=n.length;f<m;f++)n[f].flattenToArrayOffset(S._array,16*f);r.uniformMatrix4fv(c,!1,S._array)}else if("t"===f){if(p=n,n=v(),r.uniform1i(c,n),p)if(p.image instanceof Array&&6===p.image.length){if(S=p,c=n,6===S.image.length)if(S.needsUpdate){S.image.__webglTextureCube||(S.addEventListener("dispose",Ra),S.image.__webglTextureCube=
r.createTexture(),J.info.memory.textures++);r.activeTexture(r.TEXTURE0+c);r.bindTexture(r.TEXTURE_CUBE_MAP,S.image.__webglTextureCube);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,S.flipY);c=S instanceof THREE.CompressedTexture;f=[];for(m=0;6>m;m++)J.autoScaleCubemaps&&!c?(n=f,p=m,u=S.image[m],z=Va,u.width<=z&&u.height<=z||(D=Math.max(u.width,u.height),A=Math.floor(u.width*z/D),z=Math.floor(u.height*z/D),D=document.createElement("canvas"),D.width=A,D.height=z,D.getContext("2d").drawImage(u,0,0,u.width,u.height,
0,0,A,z),u=D),n[p]=u):f[m]=S.image[m];m=f[0];n=C(m.width)&&C(m.height);p=F(S.format);u=F(S.type);P(r.TEXTURE_CUBE_MAP,S,n&&u!=r.FLOAT);for(m=0;6>m;m++)if(c)for(z=f[m].mipmaps,D=0,G=z.length;D<G;D++)A=z[D],S.format!==THREE.RGBAFormat?r.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+m,D,p,A.width,A.height,0,A.data):r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+m,D,p,A.width,A.height,0,p,u,A.data);else f[m].data?r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,f[m].width,f[m].height,0,p,u,f[m].data):
r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,p,u,f[m]);S.generateMipmaps&&n&&r.generateMipmap(r.TEXTURE_CUBE_MAP);S.needsUpdate=!1;if(S.onUpdate)S.onUpdate()}else r.activeTexture(r.TEXTURE0+c),r.bindTexture(r.TEXTURE_CUBE_MAP,S.image.__webglTextureCube)}else J.setTexture(p,n)}else if("tv"===f){void 0===S._array&&(S._array=[]);f=0;for(m=S.value.length;f<m;f++)S._array[f]=v();r.uniform1iv(c,S._array);f=0;for(m=S.value.length;f<m;f++)p=S.value[f],n=S._array[f],p&&J.setTexture(p,n)}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+
f);(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==h.cameraPosition&&(ka.setFromMatrixPosition(a.matrixWorld),r.uniform3f(h.cameraPosition,ka.x,ka.y,ka.z));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)null!==h.viewMatrix&&r.uniformMatrix4fv(h.viewMatrix,!1,a.matrixWorldInverse.elements),null!==h.viewMatrixInverse&&r.uniformMatrix4fv(h.viewMatrixInverse,!1,$a.elements)}r.uniformMatrix4fv(h.modelViewMatrix,
!1,e._modelViewMatrix.elements);h.normalMatrix&&r.uniformMatrix3fv(h.normalMatrix,!1,e._normalMatrix.elements);null!==h.modelMatrix&&r.uniformMatrix4fv(h.modelMatrix,!1,e.matrixWorld.elements);return g}function v(){var a=oa;a>=Pa&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+Pa);oa+=1;return a}function w(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function B(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function A(a,b,c){Oa!==a&&(a?r.enable(r.POLYGON_OFFSET_FILL):
r.disable(r.POLYGON_OFFSET_FILL),Oa=a);!a||Za===b&&Ma===c||(r.polygonOffset(b,c),Za=b,Ma=c)}function D(a){a=a.split("\n");for(var b=0,c=a.length;b<c;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function W(a,b){var c;"fragment"===a?c=r.createShader(r.FRAGMENT_SHADER):"vertex"===a&&(c=r.createShader(r.VERTEX_SHADER));r.shaderSource(c,b);r.compileShader(c);return r.getShaderParameter(c,r.COMPILE_STATUS)?c:(console.error(r.getShaderInfoLog(c)),console.error(D(b)),null)}function C(a){return 0===(a&a-1)}
function P(a,b,c){c?(r.texParameteri(a,r.TEXTURE_WRAP_S,F(b.wrapS)),r.texParameteri(a,r.TEXTURE_WRAP_T,F(b.wrapT)),r.texParameteri(a,r.TEXTURE_MAG_FILTER,F(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,F(b.minFilter))):(r.texParameteri(a,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(a,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(a,r.TEXTURE_MAG_FILTER,G(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,G(b.minFilter)));ea&&b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy)&&
(r.texParameterf(a,ea.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,db)),b.__oldAnisotropy=b.anisotropy)}function G(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?r.NEAREST:r.LINEAR}function F(a){if(a===THREE.RepeatWrapping)return r.REPEAT;if(a===THREE.ClampToEdgeWrapping)return r.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return r.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return r.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return r.NEAREST_MIPMAP_NEAREST;
if(a===THREE.NearestMipMapLinearFilter)return r.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return r.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return r.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return r.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return r.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return r.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return r.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return r.UNSIGNED_SHORT_5_6_5;
if(a===THREE.ByteType)return r.BYTE;if(a===THREE.ShortType)return r.SHORT;if(a===THREE.UnsignedShortType)return r.UNSIGNED_SHORT;if(a===THREE.IntType)return r.INT;if(a===THREE.UnsignedIntType)return r.UNSIGNED_INT;if(a===THREE.FloatType)return r.FLOAT;if(a===THREE.HalfFloatType)return 36193;if(a===THREE.AlphaFormat)return r.ALPHA;if(a===THREE.RGBFormat)return r.RGB;if(a===THREE.RGBAFormat)return r.RGBA;if(a===THREE.LuminanceFormat)return r.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return r.LUMINANCE_ALPHA;
if(a===THREE.AddEquation)return r.FUNC_ADD;if(a===THREE.SubtractEquation)return r.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return r.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return r.ZERO;if(a===THREE.OneFactor)return r.ONE;if(a===THREE.SrcColorFactor)return r.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return r.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return r.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return r.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return r.DST_ALPHA;
if(a===THREE.OneMinusDstAlphaFactor)return r.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return r.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return r.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return r.SRC_ALPHA_SATURATE;if(void 0!==Ga){if(a===THREE.RGB_S3TC_DXT1_Format)return Ga.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return Ga.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return Ga.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return Ga.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}
console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var N=void 0!==a.canvas?a.canvas:document.createElement("canvas"),z=void 0!==a.precision?a.precision:"highp",M=void 0!==a.alpha?a.alpha:!1,H=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,Q=void 0!==a.antialias?a.antialias:!1,V=void 0!==a.stencil?a.stencil:!0,T=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!0,I=new THREE.Color(0),E=0;this.domElement=N;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:
void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=
[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var J=this,ca=[],Y=0,ga=null,R=null,la=-1,Z=null,ia=null,wa=0,oa=0,ma=-1,xa=-1,Ba=-1,ra=-1,pa=-1,ua=-1,ba=-1,Ca=-1,Oa=null,Za=null,Ma=null,da=null,sa=0,va=0,Ea=N.width,ya=N.height,aa=0,X=0,ha=[],qa={},La=new THREE.Frustum,Na=new THREE.Matrix4,$a=new THREE.Matrix4,ka=new THREE.Vector3,ja=new THREE.Vector3,Ha=!0,Ta={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],
positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},r,bb,cb,na,ea,Ga,Ia,Ja=!1;(function(){try{var a={alpha:M,premultipliedAlpha:H,antialias:Q,stencil:V,preserveDrawingBuffer:T};r=N.getContext("webgl",a)||N.getContext("experimental-webgl",a);if(null===r)throw"Error creating WebGL context.";}catch(b){console.error(b)}bb=r.getExtension("OES_texture_float");cb=r.getExtension("OES_texture_half_float");
r.getExtension("OES_texture_float_linear");na=r.getExtension("OES_standard_derivatives");Ia=r.getExtension("WEBGL_draw_buffers");r.getExtension("OES_element_index_uint");Ja=!!Ia;ea=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");Ga=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
bb||console.log("THREE.WebGLRenderer: Float textures not supported.");cb||console.log("THREE.WebGLRenderer: Half float textures not supported.");na||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");ea||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");Ga||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");Ia||console.log("THREE.WebGLRenderer: Multiple render targets not supported.");void 0===r.getShaderPrecisionFormat&&
(r.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})})();r.clearColor(0,0,0,1);r.clearDepth(1);r.clearStencil(0);r.enable(r.DEPTH_TEST);r.depthFunc(r.LEQUAL);r.frontFace(r.CCW);r.cullFace(r.BACK);r.enable(r.CULL_FACE);r.enable(r.BLEND);r.blendEquation(r.FUNC_ADD);r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);r.viewport(sa,va,Ea,ya);r.clearColor(I.r,I.g,I.b,E);this.context=r;var Pa=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);a=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS);
r.getParameter(r.MAX_TEXTURE_SIZE);var Va=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),db=ea?r.getParameter(ea.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Wa=0<a;Ga&&r.getParameter(r.COMPRESSED_TEXTURE_FORMATS);var eb=r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT);a=r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT);r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.LOW_FLOAT);var Xa=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT),ab=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT);
r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.LOW_FLOAT);r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_INT);r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_INT);r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.LOW_INT);r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_INT);r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_INT);r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.LOW_INT);eb=0<eb.precision&&0<Xa.precision;a=0<a.precision&&0<ab.precision;"highp"!==z||eb||(a?(z="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):
(z="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==z||a||(z="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return r};this.supportsVertexTextures=function(){return Wa};this.supportsFloatTextures=function(){return bb};this.supportsStandardDerivatives=function(){return na};this.supportsCompressedTextureS3TC=function(){return Ga};this.supportsMRT=function(){return Ja};this.getMaxAnisotropy=function(){return db};
this.getPrecision=function(){return z};this.setSize=function(a,b,c){N.width=a*this.devicePixelRatio;N.height=b*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==c&&(N.style.width=a+"px",N.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){sa=a*this.devicePixelRatio;va=b*this.devicePixelRatio;Ea=c*this.devicePixelRatio;ya=d*this.devicePixelRatio;r.viewport(sa,va,Ea,ya)};this.setScissor=function(a,b,c,d){r.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?r.enable(r.SCISSOR_TEST):
r.disable(r.SCISSOR_TEST)};this.setClearColor=function(a,b){I.set(a);E=void 0!==b?b:1;r.clearColor(I.r,I.g,I.b,E)};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=function(){return I};this.getClearAlpha=function(){return E};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=r.COLOR_BUFFER_BIT;if(void 0===b||b)d|=r.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=r.STENCIL_BUFFER_BIT;
r.clear(d)};this.clearColor=function(){r.clear(r.COLOR_BUFFER_BIT)};this.clearDepth=function(){r.clear(r.DEPTH_BUFFER_BIT)};this.clearStencil=function(){r.clear(r.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this);this.renderPluginsPre.push(a)};this.updateShadowMap=function(a,b){ga=null;la=Z=Ca=ba=Ba=-1;Ha=!0;xa=ma=-1;this.shadowMapPlugin.update(a,
b)};var Ua=function(a){a=a.target;a.removeEventListener("dispose",Ua);a.__webglInit=void 0;if(a instanceof THREE.BufferGeometry){void 0!==a.vbbuffer&&r.deleteBuffer(a.vbbuffer);var b=a.attributes,c;for(c in b)void 0!==b[c].buffer&&r.deleteBuffer(b[c].buffer);J.info.memory.geometries--}else if(void 0!==a.geometryGroups)for(b in a.geometryGroups)O(a.geometryGroups[b]);else O(a)},Ra=function(a){a=a.target;a.removeEventListener("dispose",Ra);a.image&&a.image.__webglTextureCube?r.deleteTexture(a.image.__webglTextureCube):
a.__webglInit&&(a.__webglInit=!1,r.deleteTexture(a.__webglTexture));J.info.memory.textures--},za=function(a){a=a.target;a.removeEventListener("dispose",za);a&&a.__webglTexture&&(r.deleteTexture(a.__webglTexture),r.deleteFramebuffer(a.__webglFramebuffer),r.deleteRenderbuffer(a.__webglRenderbuffer));J.info.memory.textures--},Ya=function(a){a=a.target;a.removeEventListener("dispose",Ya);ib(a)},O=function(a){void 0!==a.__webglVertexBuffer&&r.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&
r.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&r.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&r.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&r.deleteBuffer(a.__webglUVBuffer);void 0!==a.__webglUV2Buffer&&r.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&r.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&r.deleteBuffer(a.__webglSkinWeightsBuffer);void 0!==a.__webglFaceBuffer&&r.deleteBuffer(a.__webglFaceBuffer);
void 0!==a.__webglLineBuffer&&r.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&r.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)r.deleteBuffer(a.__webglCustomAttributesList[b].buffer);J.info.memory.geometries--},ib=function(a){var b=a.program;if(void 0!==b){a.program=void 0;var c,d,e=!1;a=0;for(c=ca.length;a<c;a++)if(d=ca[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=
[];a=0;for(c=ca.length;a<c;a++)d=ca[a],d.program!==b&&e.push(d);ca=e;r.deleteProgram(b);J.info.memory.programs--}}};this.renderBufferDirect=function(a,b,c,d,e,g){if(!1!==d.visible){var k=u(a,b,c,d,g);a=k.attributes;c=e.attributes;b=!1;k=16777215*e.id+2*k.id+(d.wireframe?1:0);k!==Z&&(Z=k,b=!0);b&&h();if(g instanceof THREE.Mesh)if(g=c.index){(c=e.offsets)&&1<c.length&&(b=!0);k=0;do{var l,m,n;c?(l=c[k].index,m=c[k].start,n=c[k].count):(m=l=0,n=g.array.length);b&&(f(d,a,e,l),!g.buffer&&e.streamingDraw?
(l=qa.index,l||(l=r.createBuffer(),qa.index=l),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,l),r.bufferData(r.ELEMENT_ARRAY_BUFFER,g.array,r.DYNAMIC_DRAW)):r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,g.buffer));r.drawElements(e.isLines?r.LINES:r.TRIANGLES,n,r.UNSIGNED_SHORT,2*m)}while(c&&++k<c.length)}else b&&f(d,a,e,l),r.drawArrays(e.isLines?r.LINE_STRIP:r.TRIANGLES,0,e.attributes.position.array.length/3);else console.log("Only THREE.Mesh can be rendered by the Firefly renderer. Use THREE.Mesh to draw lines.")}};
this.renderBuffer=function(a,b,c,d,e,f){if(!1!==d.visible){var k,l;c=u(a,b,c,d,f);b=c.attributes;a=!1;c=16777215*e.id+2*c.id+(d.wireframe?1:0);c!==Z&&(Z=c,a=!0);a&&h();!d.morphTargets&&0<=b.position&&a&&(r.bindBuffer(r.ARRAY_BUFFER,e.__webglVertexBuffer),g(b.position),r.vertexAttribPointer(b.position,3,r.FLOAT,!1,0,0));if(a){if(e.__webglCustomAttributesList)for(k=0,l=e.__webglCustomAttributesList.length;k<l;k++)c=e.__webglCustomAttributesList[k],0<=b[c.buffer.belongsToAttribute]&&(r.bindBuffer(r.ARRAY_BUFFER,
c.buffer),g(b[c.buffer.belongsToAttribute]),r.vertexAttribPointer(b[c.buffer.belongsToAttribute],c.size,r.FLOAT,!1,0,0));0<=b.color&&(0<f.geometry.colors.length||0<f.geometry.faces.length?(r.bindBuffer(r.ARRAY_BUFFER,e.__webglColorBuffer),g(b.color),r.vertexAttribPointer(b.color,3,r.FLOAT,!1,0,0)):d.defaultAttributeValues&&r.vertexAttrib3fv(b.color,d.defaultAttributeValues.color));0<=b.normal&&(r.bindBuffer(r.ARRAY_BUFFER,e.__webglNormalBuffer),g(b.normal),r.vertexAttribPointer(b.normal,3,r.FLOAT,
!1,0,0));0<=b.tangent&&(r.bindBuffer(r.ARRAY_BUFFER,e.__webglTangentBuffer),g(b.tangent),r.vertexAttribPointer(b.tangent,4,r.FLOAT,!1,0,0));0<=b.uv&&(f.geometry.faceVertexUvs[0]?(r.bindBuffer(r.ARRAY_BUFFER,e.__webglUVBuffer),g(b.uv),r.vertexAttribPointer(b.uv,2,r.FLOAT,!1,0,0)):d.defaultAttributeValues&&r.vertexAttrib2fv(b.uv,d.defaultAttributeValues.uv));0<=b.uv2&&(f.geometry.faceVertexUvs[1]?(r.bindBuffer(r.ARRAY_BUFFER,e.__webglUV2Buffer),g(b.uv2),r.vertexAttribPointer(b.uv2,2,r.FLOAT,!1,0,0)):
d.defaultAttributeValues&&r.vertexAttrib2fv(b.uv2,d.defaultAttributeValues.uv2));0<=b.lineDistance&&(r.bindBuffer(r.ARRAY_BUFFER,e.__webglLineDistanceBuffer),g(b.lineDistance),r.vertexAttribPointer(b.lineDistance,1,r.FLOAT,!1,0,0))}f instanceof THREE.Mesh?d.wireframe?(d=d.wireframeLinewidth,d!==da&&(r.lineWidth(d),da=d),a&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),r.drawElements(r.LINES,e.__webglLineCount,r.UNSIGNED_SHORT,0)):(a&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),
r.drawElements(r.TRIANGLES,e.__webglFaceCount,r.UNSIGNED_SHORT,0)):f instanceof THREE.Line&&(f=f.type===THREE.LineStrip?r.LINE_STRIP:r.LINES,d=d.linewidth,d!==da&&(r.lineWidth(d),da=d),r.drawArrays(f,0,e.__webglLineCount))}};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e,f,g,h,n=a.__lights,p=a.fog;la=-1;Ha=!0;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();
b.matrixWorldInverse.getInverse(b.matrixWorld);b.worldUpTransform?$a.multiplyMatrices(b.worldUpTransform,b.matrixWorld):$a.copy(b.matrixWorld);Na.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);La.setFromMatrix(Na);this.autoUpdateObjects&&this.initWebGLObjects(a);l(this.renderPluginsPre,a,b);this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);h=a.__webglObjects;d=0;for(e=h.length;d<e;d++)if(f=h[d],g=f.object,f.id=d,f.render=
!1,g.visible&&(!(g instanceof THREE.Mesh&&g.frustumCulled)||La.intersectsObject(g))){var q=g;q._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,q.matrixWorld);q._normalMatrix.getNormalMatrix(q._modelViewMatrix);var q=f,s=q.object,t=q.buffer,u=s.geometry,s=s.material;s instanceof THREE.MeshFaceMaterial?(s=s.materials[u instanceof THREE.BufferGeometry?0:t.materialIndex],s.transparent?(q.transparent=s,q.opaque=null):(q.opaque=s,q.transparent=null)):s&&(s.transparent?(q.transparent=s,q.opaque=null):
(q.opaque=s,q.transparent=null));f.render=!0;!0===this.sortObjects&&(null!==g.renderDepth?f.z=g.renderDepth:(ka.setFromMatrixPosition(g.matrixWorld),ka.applyProjection(Na),f.z=ka.z))}this.sortObjects&&h.sort(k);a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),A(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),m(a.__webglObjects,!1,"",b,n,p,!0,d)):(d=null,this.setBlending(THREE.NoBlending),
m(a.__webglObjects,!0,"opaque",b,n,p,!1,d),m(a.__webglObjects,!1,"transparent",b,n,p,!0,d));l(this.renderPluginsPost,a,b);c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&(r.bindTexture(r.TEXTURE_2D,c.__webglTexture),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.endFrame=function(){};this.initWebGLObjects=function(a){a.__webglObjects||(a.__webglObjects=[]);for(;a.__objectsAdded.length;)n(a.__objectsAdded[0],
a),a.__objectsAdded.splice(0,1);for(;a.__objectsRemoved.length;)t(a.__objectsRemoved[0],a),a.__objectsRemoved.splice(0,1);for(var f=0,g=a.__webglObjects.length;f<g;f++){var h=a.__webglObjects[f].object;void 0===h.__webglInit&&(void 0!==h.__webglActive&&t(h,a),n(h,a));var k=h,l=k.geometry,m=void 0,p=void 0,u=void 0;if(l instanceof THREE.BufferGeometry){var A=l,v=r.DYNAMIC_DRAW,w=l.freeCPUBuffers;if(!A.streamingDraw){var C=A.attributes,z=!1,D=void 0,B=void 0;for(D in C)B=C[D],B.needsUpdate&&("index"===
D?(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,B.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,B.array,v)):B.array?(r.bindBuffer(r.ARRAY_BUFFER,B.buffer),r.bufferData(r.ARRAY_BUFFER,B.array,v)):z=!0,B.needsUpdate=!1),w&&B.freeCPUBuffers&&(B.array=null);z&&(r.bindBuffer(r.ARRAY_BUFFER,A.vbbuffer),r.bufferData(r.ARRAY_BUFFER,A.vb,v),w&&A.freeCPUBuffers&&(A.vb=null))}}else if(k instanceof THREE.Mesh){for(var G=0,P=l.geometryGroupsList.length;G<P;G++)if(m=l.geometryGroupsList[G],u=c(k,m),l.buffersNeedUpdate&&b(m,
k),p=u.attributes&&q(u),l.verticesNeedUpdate||l.morphTargetsNeedUpdate||l.elementsNeedUpdate||l.uvsNeedUpdate||l.normalsNeedUpdate||l.colorsNeedUpdate||l.tangentsNeedUpdate||p){var F=m,W=k,H=r.DYNAMIC_DRAW,M=l.freeCPUBuffers,J=u;if(F.__inittedArrays){var N=e(J),Q=J.vertexColors?J.vertexColors:!1,R=d(J),T=N===THREE.SmoothShading,E=void 0,I=void 0,V=void 0,O=void 0,Y=void 0,Z=void 0,aa=void 0,ca=void 0,ba=void 0,da=void 0,ga=void 0,X=void 0,fa=void 0,S=void 0,ea=void 0,ia=void 0,ja=void 0,ka=void 0,
la=void 0,ma=void 0,ha=void 0,ua=void 0,ra=void 0,va=void 0,wa=void 0,oa=0,pa=0,ya=0,za=0,Ba=0,qa=0,na=0,Ca=0,xa=0,U=0,sa=void 0,Ea=F.__vertexArray,La=F.__uvArray,Na=F.__uv2Array,Ja=F.__normalArray,Ga=F.__tangentArray,Ha=F.__colorArray,Pa=F.__webglCustomAttributesList,K=void 0,Oa=F.__faceArray,Ma=F.__lineArray,Ia=W.geometry,Ta=Ia.elementsNeedUpdate,Ra=Ia.uvsNeedUpdate,Za=Ia.normalsNeedUpdate,$a=Ia.tangentsNeedUpdate,ab=Ia.colorsNeedUpdate,Ua=Ia.vertices,ta=F.faces3,gb=Ia.faces,bb=Ia.faceVertexUvs[0],
eb=Ia.faceVertexUvs[1];if(Ia.verticesNeedUpdate){E=0;for(I=ta.length;E<I;E++)O=gb[ta[E]],X=Ua[O.a],fa=Ua[O.b],S=Ua[O.c],Ea[pa]=X.x,Ea[pa+1]=X.y,Ea[pa+2]=X.z,Ea[pa+3]=fa.x,Ea[pa+4]=fa.y,Ea[pa+5]=fa.z,Ea[pa+6]=S.x,Ea[pa+7]=S.y,Ea[pa+8]=S.z,pa+=9;r.bindBuffer(r.ARRAY_BUFFER,F.__webglVertexBuffer);r.bufferData(r.ARRAY_BUFFER,Ea,H)}if(ab&&Q){E=0;for(I=ta.length;E<I;E++)O=gb[ta[E]],aa=O.vertexColors,ca=O.color,3===aa.length&&Q===THREE.VertexColors?(ka=aa[0],la=aa[1],ma=aa[2]):ma=la=ka=ca,Ha[xa]=ka.r,Ha[xa+
1]=ka.g,Ha[xa+2]=ka.b,Ha[xa+3]=la.r,Ha[xa+4]=la.g,Ha[xa+5]=la.b,Ha[xa+6]=ma.r,Ha[xa+7]=ma.g,Ha[xa+8]=ma.b,xa+=9;0<xa&&(r.bindBuffer(r.ARRAY_BUFFER,F.__webglColorBuffer),r.bufferData(r.ARRAY_BUFFER,Ha,H))}if($a&&Ia.hasTangents){E=0;for(I=ta.length;E<I;E++)O=gb[ta[E]],ba=O.vertexTangents,ea=ba[0],ia=ba[1],ja=ba[2],Ga[na]=ea.x,Ga[na+1]=ea.y,Ga[na+2]=ea.z,Ga[na+3]=ea.w,Ga[na+4]=ia.x,Ga[na+5]=ia.y,Ga[na+6]=ia.z,Ga[na+7]=ia.w,Ga[na+8]=ja.x,Ga[na+9]=ja.y,Ga[na+10]=ja.z,Ga[na+11]=ja.w,na+=12;r.bindBuffer(r.ARRAY_BUFFER,
F.__webglTangentBuffer);r.bufferData(r.ARRAY_BUFFER,Ga,H)}if(Za&&N){E=0;for(I=ta.length;E<I;E++)if(O=gb[ta[E]],Y=O.vertexNormals,Z=O.normal,3===Y.length&&T)for(ha=0;3>ha;ha++)ra=Y[ha],Ja[qa]=ra.x,Ja[qa+1]=ra.y,Ja[qa+2]=ra.z,qa+=3;else for(ha=0;3>ha;ha++)Ja[qa]=Z.x,Ja[qa+1]=Z.y,Ja[qa+2]=Z.z,qa+=3;r.bindBuffer(r.ARRAY_BUFFER,F.__webglNormalBuffer);r.bufferData(r.ARRAY_BUFFER,Ja,H)}if(Ra&&bb&&R){E=0;for(I=ta.length;E<I;E++)if(V=ta[E],da=bb[V],void 0!==da)for(ha=0;3>ha;ha++)va=da[ha],La[ya]=va.x,La[ya+
1]=va.y,ya+=2;0<ya&&(r.bindBuffer(r.ARRAY_BUFFER,F.__webglUVBuffer),r.bufferData(r.ARRAY_BUFFER,La,H))}if(Ra&&eb&&R){E=0;for(I=ta.length;E<I;E++)if(V=ta[E],ga=eb[V],void 0!==ga)for(ha=0;3>ha;ha++)wa=ga[ha],Na[za]=wa.x,Na[za+1]=wa.y,za+=2;0<za&&(r.bindBuffer(r.ARRAY_BUFFER,F.__webglUV2Buffer),r.bufferData(r.ARRAY_BUFFER,Na,H))}if(Ta){E=0;for(I=ta.length;E<I;E++)Oa[Ba]=oa,Oa[Ba+1]=oa+1,Oa[Ba+2]=oa+2,Ba+=3,Ma[Ca]=oa,Ma[Ca+1]=oa+1,Ma[Ca+2]=oa,Ma[Ca+3]=oa+2,Ma[Ca+4]=oa+1,Ma[Ca+5]=oa+2,Ca+=6,oa+=3;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,
F.__webglFaceBuffer);r.bufferData(r.ELEMENT_ARRAY_BUFFER,Oa,H);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,F.__webglLineBuffer);r.bufferData(r.ELEMENT_ARRAY_BUFFER,Ma,H)}if(Pa)for(ha=0,ua=Pa.length;ha<ua;ha++)if(K=Pa[ha],K.__original.needsUpdate){U=0;if(1===K.size)if(void 0===K.boundTo||"vertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)O=gb[ta[E]],K.array[U]=K.value[O.a],K.array[U+1]=K.value[O.b],K.array[U+2]=K.value[O.c],U+=3;else{if("faces"===K.boundTo)for(E=0,I=ta.length;E<I;E++)sa=K.value[ta[E]],K.array[U]=
sa,K.array[U+1]=sa,K.array[U+2]=sa,U+=3}else if(2===K.size)if(void 0===K.boundTo||"vertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)O=gb[ta[E]],X=K.value[O.a],fa=K.value[O.b],S=K.value[O.c],K.array[U]=X.x,K.array[U+1]=X.y,K.array[U+2]=fa.x,K.array[U+3]=fa.y,K.array[U+4]=S.x,K.array[U+5]=S.y,U+=6;else{if("faces"===K.boundTo)for(E=0,I=ta.length;E<I;E++)S=fa=X=sa=K.value[ta[E]],K.array[U]=X.x,K.array[U+1]=X.y,K.array[U+2]=fa.x,K.array[U+3]=fa.y,K.array[U+4]=S.x,K.array[U+5]=S.y,U+=6}else if(3===K.size){var Fa;
Fa="c"===K.type?["r","g","b"]:["x","y","z"];if(void 0===K.boundTo||"vertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)O=gb[ta[E]],X=K.value[O.a],fa=K.value[O.b],S=K.value[O.c],K.array[U]=X[Fa[0]],K.array[U+1]=X[Fa[1]],K.array[U+2]=X[Fa[2]],K.array[U+3]=fa[Fa[0]],K.array[U+4]=fa[Fa[1]],K.array[U+5]=fa[Fa[2]],K.array[U+6]=S[Fa[0]],K.array[U+7]=S[Fa[1]],K.array[U+8]=S[Fa[2]],U+=9;else if("faces"===K.boundTo)for(E=0,I=ta.length;E<I;E++)S=fa=X=sa=K.value[ta[E]],K.array[U]=X[Fa[0]],K.array[U+1]=X[Fa[1]],
K.array[U+2]=X[Fa[2]],K.array[U+3]=fa[Fa[0]],K.array[U+4]=fa[Fa[1]],K.array[U+5]=fa[Fa[2]],K.array[U+6]=S[Fa[0]],K.array[U+7]=S[Fa[1]],K.array[U+8]=S[Fa[2]],U+=9;else if("faceVertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)sa=K.value[ta[E]],X=sa[0],fa=sa[1],S=sa[2],K.array[U]=X[Fa[0]],K.array[U+1]=X[Fa[1]],K.array[U+2]=X[Fa[2]],K.array[U+3]=fa[Fa[0]],K.array[U+4]=fa[Fa[1]],K.array[U+5]=fa[Fa[2]],K.array[U+6]=S[Fa[0]],K.array[U+7]=S[Fa[1]],K.array[U+8]=S[Fa[2]],U+=9}else if(4===K.size)if(void 0===
K.boundTo||"vertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)O=gb[ta[E]],X=K.value[O.a],fa=K.value[O.b],S=K.value[O.c],K.array[U]=X.x,K.array[U+1]=X.y,K.array[U+2]=X.z,K.array[U+3]=X.w,K.array[U+4]=fa.x,K.array[U+5]=fa.y,K.array[U+6]=fa.z,K.array[U+7]=fa.w,K.array[U+8]=S.x,K.array[U+9]=S.y,K.array[U+10]=S.z,K.array[U+11]=S.w,U+=12;else if("faces"===K.boundTo)for(E=0,I=ta.length;E<I;E++)S=fa=X=sa=K.value[ta[E]],K.array[U]=X.x,K.array[U+1]=X.y,K.array[U+2]=X.z,K.array[U+3]=X.w,K.array[U+4]=fa.x,K.array[U+
5]=fa.y,K.array[U+6]=fa.z,K.array[U+7]=fa.w,K.array[U+8]=S.x,K.array[U+9]=S.y,K.array[U+10]=S.z,K.array[U+11]=S.w,U+=12;else if("faceVertices"===K.boundTo)for(E=0,I=ta.length;E<I;E++)sa=K.value[ta[E]],X=sa[0],fa=sa[1],S=sa[2],K.array[U]=X.x,K.array[U+1]=X.y,K.array[U+2]=X.z,K.array[U+3]=X.w,K.array[U+4]=fa.x,K.array[U+5]=fa.y,K.array[U+6]=fa.z,K.array[U+7]=fa.w,K.array[U+8]=S.x,K.array[U+9]=S.y,K.array[U+10]=S.z,K.array[U+11]=S.w,U+=12;r.bindBuffer(r.ARRAY_BUFFER,K.buffer);r.bufferData(r.ARRAY_BUFFER,
K.array,H)}M&&(delete F.__inittedArrays,delete F.__colorArray,delete F.__normalArray,delete F.__tangentArray,delete F.__uvArray,delete F.__uv2Array,delete F.__faceArray,delete F.__vertexArray,delete F.__lineArray,delete F.__skinIndexArray,delete F.__skinWeightArray)}}l.verticesNeedUpdate=!1;l.morphTargetsNeedUpdate=!1;l.elementsNeedUpdate=!1;l.uvsNeedUpdate=!1;l.normalsNeedUpdate=!1;l.colorsNeedUpdate=!1;l.tangentsNeedUpdate=!1;l.buffersNeedUpdate=!1;u.attributes&&s(u)}else if(k instanceof THREE.Line){u=
c(k,l);p=u.attributes&&q(u);if(l.verticesNeedUpdate||l.colorsNeedUpdate||l.lineDistancesNeedUpdate||p){var Sa=l,Ya=r.DYNAMIC_DRAW,Va=void 0,Wa=void 0,Xa=void 0,cb=void 0,Da=void 0,db=void 0,ib=Sa.vertices,nb=Sa.colors,ob=Sa.lineDistances,rb=ib.length,sb=nb.length,tb=ob.length,jb=Sa.__vertexArray,kb=Sa.__colorArray,pb=Sa.__lineDistanceArray,ub=Sa.colorsNeedUpdate,vb=Sa.lineDistancesNeedUpdate,mb=Sa.__webglCustomAttributesList,lb=void 0,qb=void 0,Ka=void 0,hb=void 0,Qa=void 0,Aa=void 0;if(Sa.verticesNeedUpdate){for(Va=
0;Va<rb;Va++)cb=ib[Va],Da=3*Va,jb[Da]=cb.x,jb[Da+1]=cb.y,jb[Da+2]=cb.z;r.bindBuffer(r.ARRAY_BUFFER,Sa.__webglVertexBuffer);r.bufferData(r.ARRAY_BUFFER,jb,Ya)}if(ub){for(Wa=0;Wa<sb;Wa++)db=nb[Wa],Da=3*Wa,kb[Da]=db.r,kb[Da+1]=db.g,kb[Da+2]=db.b;r.bindBuffer(r.ARRAY_BUFFER,Sa.__webglColorBuffer);r.bufferData(r.ARRAY_BUFFER,kb,Ya)}if(vb){for(Xa=0;Xa<tb;Xa++)pb[Xa]=ob[Xa];r.bindBuffer(r.ARRAY_BUFFER,Sa.__webglLineDistanceBuffer);r.bufferData(r.ARRAY_BUFFER,pb,Ya)}if(mb)for(lb=0,qb=mb.length;lb<qb;lb++)if(Aa=
mb[lb],Aa.needsUpdate&&(void 0===Aa.boundTo||"vertices"===Aa.boundTo)){Da=0;hb=Aa.value.length;if(1===Aa.size)for(Ka=0;Ka<hb;Ka++)Aa.array[Ka]=Aa.value[Ka];else if(2===Aa.size)for(Ka=0;Ka<hb;Ka++)Qa=Aa.value[Ka],Aa.array[Da]=Qa.x,Aa.array[Da+1]=Qa.y,Da+=2;else if(3===Aa.size)if("c"===Aa.type)for(Ka=0;Ka<hb;Ka++)Qa=Aa.value[Ka],Aa.array[Da]=Qa.r,Aa.array[Da+1]=Qa.g,Aa.array[Da+2]=Qa.b,Da+=3;else for(Ka=0;Ka<hb;Ka++)Qa=Aa.value[Ka],Aa.array[Da]=Qa.x,Aa.array[Da+1]=Qa.y,Aa.array[Da+2]=Qa.z,Da+=3;else if(4===
Aa.size)for(Ka=0;Ka<hb;Ka++)Qa=Aa.value[Ka],Aa.array[Da]=Qa.x,Aa.array[Da+1]=Qa.y,Aa.array[Da+2]=Qa.z,Aa.array[Da+3]=Qa.w,Da+=4;r.bindBuffer(r.ARRAY_BUFFER,Aa.buffer);r.bufferData(r.ARRAY_BUFFER,Aa.array,Ya)}}l.verticesNeedUpdate=!1;l.colorsNeedUpdate=!1;l.lineDistancesNeedUpdate=!1;u.attributes&&s(u)}}};this.initMaterial=function(a,b,c,d){a.addEventListener("dispose",Ya);var e,f;a instanceof THREE.MeshDepthMaterial?f="depth":a instanceof THREE.MeshNormalMaterial?console.log("MeshNormalMaterial is turned off."):
a instanceof THREE.MeshBasicMaterial?f="basic":a instanceof THREE.MeshLambertMaterial?console.log("MeshLambertMaterial is turned off."):a instanceof THREE.MeshPhongMaterial?f="phong":a instanceof THREE.LineBasicMaterial?f="basic":a instanceof THREE.LineDashedMaterial&&(f="dashed");if(f){var g=THREE.ShaderLib[f];a.uniforms=THREE.UniformsUtils.clone(g.uniforms);a.vertexShader=g.vertexShader;a.fragmentShader=g.fragmentShader}for(var h=0,k=0,l=0,m=0,g=0,n=b.length;g<n;g++){var p=b[g];p.onlyShadow||(p instanceof
THREE.DirectionalLight&&h++,p instanceof THREE.PointLight&&k++,p instanceof THREE.SpotLight&&l++,p instanceof THREE.HemisphereLight&&m++)}for(var q=0,g=0,n=b.length;g<n;g++)p=b[g],p.castShadow&&(p instanceof THREE.SpotLight&&q++,p instanceof THREE.DirectionalLight&&!p.shadowCascade&&q++);var s;a:{n=a.fragmentShader;p=a.vertexShader;g=a.uniforms;b=a.attributes;var t=a.defines;d={map:!!a.map,envMap:!!a.envMap,irradianceMap:!!a.irradianceMap,envIsSpherical:a.envMap&&a.envMap.mapping instanceof THREE.SphericalReflectionMapping,
envLogLuv:a.envMap&&a.envMap.LogLuv,irrLogLuv:a.irradianceMap&&a.irradianceMap.LogLuv,lightMap:!!a.lightMap,bumpMap:na&&!!a.bumpMap,normalMap:na&&!!a.normalMap,specularMap:!!a.specularMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:a.sizeAttenuation,maxDirLights:h,maxPointLights:k,maxSpotLights:l,maxHemiLights:m,maxShadows:q,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,
shadowMapCascade:this.shadowMapCascade,alphaTest:a.alphaTest,metal:a.metal,clearcoat:a.clearcoat,wrapAround:a.wrapAround,doubleSided:a.side===THREE.DoubleSide,flipSided:a.side===THREE.BackSide,mrtNormals:Ja&&a.mrtNormals};c=a.index0AttributeName;var u,A,v,h=[];f?h.push(f):(h.push(n),h.push(p));for(A in t)h.push(A),h.push(t[A]);for(u in d)h.push(u),h.push(d[u]);f=h.join();u=0;for(A=ca.length;u<A;u++)if(h=ca[u],h.code===f){h.usedTimes++;s=h.program;break a}u="SHADOWMAP_TYPE_BASIC";d.shadowMapType===
THREE.PCFShadowMap?u="SHADOWMAP_TYPE_PCF":d.shadowMapType===THREE.PCFSoftShadowMap&&(u="SHADOWMAP_TYPE_PCF_SOFT");A=[];for(v in t)h=t[v],!1!==h&&(h="#define "+v+" "+h,A.push(h));t=A.join("\n");v=r.createProgram();A=["precision "+z+" float;","precision "+z+" int;",t,Wa?"#define VERTEX_TEXTURES":"",J.gammaInput?"#define GAMMA_INPUT":"",J.gammaOutput?"#define GAMMA_OUTPUT":"",d.mrtNormals?"#define MRT_NORMALS":"","#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+
d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,"#define MAX_BONES "+d.maxBones,d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.vertexColors?"#define USE_COLOR":"",d.wrapAround?"#define WRAP_AROUND":"",d.doubleSided?"#define DOUBLE_SIDED":
"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+u:"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n"].join("\n");
u=["precision "+z+" float;","precision "+z+" int;",d.bumpMap||d.normalMap?"#extension GL_OES_standard_derivatives : enable":"",t,"#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,d.alphaTest?"#define ALPHATEST "+d.alphaTest:"",d.mrtNormals?"#define MRT_NORMALS":"",J.gammaInput?"#define GAMMA_INPUT":"",J.gammaOutput?"#define GAMMA_OUTPUT":"",
d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":"",d.envLogLuv?"#define ENV_LOGLUV":"",d.irrLogLuv?"#define IRR_LOGLUV":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.vertexColors?"#define USE_COLOR":"",d.metal?"#define METAL":"",d.clearcoat?"#define CLEARCOAT":
"",d.wrapAround?"#define WRAP_AROUND":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+u:"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n#ifdef USE_ENVMAP\nuniform mat4 viewMatrixInverse;\n#endif\n"].join("\n");p=W("vertex",A+p);n=W("fragment",u+n);r.attachShader(v,p);r.attachShader(v,n);
c&&r.bindAttribLocation(v,0,c);r.linkProgram(v);r.getProgramParameter(v,r.LINK_STATUS)||(console.error("Could not initialise shader\nVALIDATE_STATUS: "+r.getProgramParameter(v,r.VALIDATE_STATUS)+", gl error ["+r.getError()+"]"),console.error("Program Info Log: "+r.getProgramInfoLog(v)));r.deleteShader(n);r.deleteShader(p);v.uniforms={};v.attributes={};var w,n="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition viewMatrixInverse".split(" ");for(w in g)n.push(w);w=n;
g=0;for(n=w.length;g<n;g++)p=w[g],v.uniforms[p]=r.getUniformLocation(v,p);n="position normal uv uv2 color lineDistance".split(" ");for(s in b)n.push(s);s=n;w=0;for(b=s.length;w<b;w++)g=s[w],v.attributes[g]=r.getAttribLocation(v,g);v.id=Y++;ca.push({program:v,code:f,usedTimes:1});J.info.memory.programs=ca.length;s=v}a.program=s;a.uniformsList=[];for(e in a.uniforms)a.uniformsList.push([a.uniforms[e],e])};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?r.disable(r.CULL_FACE):(b===THREE.FrontFaceDirectionCW?
r.frontFace(r.CW):r.frontFace(r.CCW),a===THREE.CullFaceBack?r.cullFace(r.BACK):a===THREE.CullFaceFront?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK),r.enable(r.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;ma!==b&&(b?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),ma=b);xa!==a&&(a?r.frontFace(r.CW):r.frontFace(r.CCW),xa=a)};this.setDepthTest=function(a){ba!==a&&(a?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),ba=a)};this.setDepthWrite=function(a){Ca!==
a&&(r.depthMask(a),Ca=a)};this.setBlending=function(a,b,c,d){a!==Ba&&(a===THREE.NoBlending?r.disable(r.BLEND):a===THREE.AdditiveBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE)):a===THREE.SubtractiveBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.SRC_COLOR)):a===THREE.CustomBlending?r.enable(r.BLEND):(r.enable(r.BLEND),
r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA)),Ba=a);if(a===THREE.CustomBlending){if(b!==ra&&(r.blendEquation(F(b)),ra=b),c!==pa||d!==ua)r.blendFunc(F(c),F(d)),pa=c,ua=d}else ua=pa=ra=null};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",Ra),a.__webglTexture=r.createTexture(),J.info.memory.textures++);r.activeTexture(r.TEXTURE0+b);r.bindTexture(r.TEXTURE_2D,
a.__webglTexture);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,a.flipY);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);r.pixelStorei(r.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=C(c.width)&&C(c.height),e=F(a.format),f=F(a.type);P(r.TEXTURE_2D,a,d);var g=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<g.length&&d){for(var h=0,k=g.length;h<k;h++)c=g[h],r.texImage2D(r.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data);a.generateMipmaps=!1}else r.texImage2D(r.TEXTURE_2D,0,e,c.width,c.height,
0,e,f,c.data);else if(a instanceof THREE.CompressedTexture)for(h=0,k=g.length;h<k;h++)c=g[h],a.format!==THREE.RGBAFormat?r.compressedTexImage2D(r.TEXTURE_2D,h,e,c.width,c.height,0,c.data):r.texImage2D(r.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data);else if(0<g.length&&d){h=0;for(k=g.length;h<k;h++)c=g[h],r.texImage2D(r.TEXTURE_2D,h,e,e,f,c);a.generateMipmaps=!1}else r.texImage2D(r.TEXTURE_2D,0,e,e,f,a.image);a.generateMipmaps&&d&&r.generateMipmap(r.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else r.activeTexture(r.TEXTURE0+
b),r.bindTexture(r.TEXTURE_2D,a.__webglTexture)};this.initFrameBufferMRT=function(a,b){var c=a[0],d=!1;if(c&&!c.__webglFramebuffer){void 0===c.depthBuffer&&(c.depthBuffer=!0);void 0===c.stencilBuffer&&(c.stencilBuffer=!0);c.__webglFramebuffer=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,c.__webglFramebuffer);var e;c.shareDepthFrom?e=c.__webglRenderbuffer=c.shareDepthFrom.__webglRenderbuffer:c.depthBuffer&&!c.stencilBuffer?(e=c.__webglRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,
e),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,c.width,c.height)):c.depthBuffer&&c.stencilBuffer&&(e=c.__webglRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,e),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,c.width,c.height));c.depthBuffer&&!c.stencilBuffer?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e):c.depthBuffer&&c.stencilBuffer&&r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e);d=!0}e=
R;r.bindFramebuffer(r.FRAMEBUFFER,c.__webglFramebuffer);for(var f=0;f<a.length;f++){var g=a[f];if(!g.__webglTexture){var h=C(g.width)&&C(g.height),k=F(g.format),l=F(g.type);g.addEventListener("dispose",za);g.__webglTexture=r.createTexture();J.info.memory.textures++;r.bindTexture(r.TEXTURE_2D,g.__webglTexture);P(r.TEXTURE_2D,g,h);r.texImage2D(r.TEXTURE_2D,0,k,g.width,g.height,0,k,l,null);h&&g.generateMipmaps&&r.generateMipmap(r.TEXTURE_2D)}r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+f,
r.TEXTURE_2D,g.__webglTexture,0)}Ja&&1<a.length&&Ia.drawBuffersWEBGL([Ia.COLOR_ATTACHMENT0_WEBGL,Ia.COLOR_ATTACHMENT1_WEBGL]);b&&(f=r.checkFramebufferStatus(r.FRAMEBUFFER),f!==r.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+f),delete c.__webglFramebuffer,b=!1));r.bindFramebuffer(r.FRAMEBUFFER,e);d&&(r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null));return b};this.setRenderTarget=function(a){var b;
Array.isArray(a)?(this.initFrameBufferMRT(a),b=a[0]):a&&(this.initFrameBufferMRT([a]),b=a);var c,d,e;b?(a=b.__webglFramebuffer,c=b.width,b=b.height,e=d=0):(a=null,c=Ea,b=ya,d=sa,e=va);a!==R&&(r.bindFramebuffer(r.FRAMEBUFFER,a),r.viewport(d,e,c,b),R=a);aa=c;X=b};this.readPixels=function(a,b,c,d,e,f){this.setRenderTarget(a);r.readPixels(b,c,d,e,r.RGBA,r.UNSIGNED_BYTE,f)};this.verifyMRTWorks=function(a){Ia&&(Ja=this.initFrameBufferMRT(a,!0));return Ja};this.shadowMapPlugin=new THREE.ShadowMapPlugin;
this.addPrePlugin(this.shadowMapPlugin)};AutodeskNamespace("Autodesk.Viewing.Private");void 0===ENABLE_DEBUG&&(ENABLE_DEBUG=!0);void 0===ENABLE_TRACE&&(ENABLE_TRACE=!0);var ENABLE_AUTOCAM=!0,MAX_FRAME_TIME=50,MIN_FRAME_TIME=1E3/30;
Autodesk.Viewing.Private.Viewer3DImpl=function(a,b){var c=this.BackgroundPresets={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[200,233,255,100,116,127],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],"Dark Grey":[51,51,51,51,51,51],"Infinity Pool":[164,175,179,164,175,179],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],Custom:[230,230,230,150,150,150]};this.currentLightPreset=this.DefaultLightPreset=1;this.LightPresets=
[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,0.84,0.67],ambientColor:[0.8,0.9,1],lightMultiplier:1,bgColorGradient:c["Fusion Grey"],brighterFade:!1},{name:"Sharp Highlights",path:"studio_01",tonemap:1,E_bias:-9.5,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:c["Photo Booth"],brighterFade:!0},{name:"Dark Sky",path:"DarkSky",tonemap:3,E_bias:-2,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:2.5,bgColorGradient:c["Dark Grey"],
brighterFade:!1},{name:"Grey Room",path:"GreyRoom",tonemap:3,E_bias:1,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:c["Grey Room"],brighterFade:!0},{name:"Photo Booth",path:"PhotoBooth",tonemap:3,E_bias:0,directLightColor:[1,1,1],ambientColor:[0.125,0.125,0.125],lightMultiplier:1,bgColorGradient:c["Photo Booth"],brighterFade:!0},{name:"Tranquility",path:"TranquilityBlue",tonemap:3,E_bias:-2,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:4,bgColorGradient:c.Tranquility,
brighterFade:!1},{name:"Infinity Pool",path:"InfinityPool",tonemap:3,E_bias:-1,directLightColor:[1,0.84,0.67],ambientColor:[0,0,0],lightMultiplier:2.5,bgColorGradient:c["Infinity Pool"],brighterFade:!1},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[0.9,0.9,0.9],lightMultiplier:1,bgColorGradient:c.White,saoRadius:0.06,saoIntensity:0.15,brighterFade:!0},{name:"Riverbank",path:"riverbank",tonemap:3,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],
brighterFade:!1},{name:"Contrast",path:"IDViz",tonemap:3,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,brighterFade:!1}];c=[{name:"Plaza",path:"Plaza",tonemap:3,E_bias:-12.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],brighterFade:!1},{name:"Field",path:"field",tonemap:3,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],brighterFade:!1},{name:"Crossroads",path:"crossroads",tonemap:3,E_bias:-5.5,directLightColor:[1,
1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],brighterFade:!1},{name:"Seaport",path:"seaport",tonemap:3,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],brighterFade:!1},{name:"Glacier",path:"glacier",tonemap:3,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,brighterFade:!1},{name:"Boardwalk",path:"boardwalk",tonemap:3,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],brighterFade:!1},{name:"RaaS Test Env",
path:"Reflection",tonemap:3,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Grey Room"],brighterFade:!1}];ENABLE_DEBUG&&(this.LightPresets=this.LightPresets.concat(c));this.canvas=a;this.api=b;this.svfloader=new Autodesk.Viewing.Private.SvfLoader(this);var c=a.clientWidth,e=a.clientHeight;this.postProcess=!1;this.renderer=new RenderContext;this.renderer.init(a,c,e);this.RENDER_NORMAL=0;this.RENDER_HIGHLIGHTED=1;this.RENDER_HIDDEN=2;this.RENDER_FINISHED=3;this.phase=this.RENDER_NORMAL;
this.camera=new THREE.PerspectiveCamera(45,c/e,0.1,1E4);this.cameraChangedEvent={type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:this.camera};this.scene=new THREE.Scene;this.scene.add(this.camera);this.overlayScenes={};this.projector=new THREE.Projector;this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,
opacity:0.15,transparent:!0});this.createOverlayScene("selection",this.selectionMaterialBase,this.selectionMaterialTop);this.materials={};this.texturesToUpdate=[];this.modelQueue=null;this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:0.1,reflectivity:0,transparent:!0});this.addMaterial("__fadeMaterial__",this.fadeMaterial,!0);this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.addMaterial("__highlightMaterial__",
this.highlightMaterial,!0);this.needsResize=this.needsClear=this.needsRender=!1;this.moveDelay=0;this.progressiveRender=!0;this.maxFrameTime=MAX_FRAME_TIME;this.minFrameTime=MIN_FRAME_TIME;this.targetFrameRate=2E3/(MIN_FRAME_TIME+MAX_FRAME_TIME);ENABLE_AUTOCAM?this.controls=new ViewController(this,this.api):(this.controls=new THREE.TrackballControls(this.camera,this.canvas),this.controls.rotateSpeed=1,this.controls.zoomSpeed=1,this.controls.panSpeed=0.5,this.controls.dynamicDampingFactor=0.5,this.controls.owner=
this);this.selector=new Autodesk.Viewing.Private.Selector(this);this.controls.setSelector(this.selector);this.visibilityManager=new Autodesk.Viewing.Private.VisibilityManager(this);this.useEnvMap=!1;this.worldUp=new THREE.Vector3(0,1,0);this.showOverlaysWhileMoving=this.showGhosting=!0;this.lastTickMoved=this.skipAOWhenMoving=!1;this.setClearColors(230,230,230,150,150,150);this.renderer.beginScene(this.scene,this.camera,!0);this.renderer.composeFinalFrame()};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer3DImpl;Autodesk.Viewing.Private.Viewer3DImpl.prototype.run=function(){var a=this;this.reqid=0;(function c(e){a.reqid=window.requestAnimationFrame(c);a.tick(e)})()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleProgressive=function(a){this.progressiveRender=a;this.needsClear=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleGhosting=function(a){this.showGhosting=a;this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a};Autodesk.Viewing.Private.Viewer3DImpl.prototype.togglePostProcess=function(a,b,c){this.postProcessOptions=[a,b,c];this.renderer.initPostPipeline(a,b,c);this.fireRenderOptionChanged();this.needsClear=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setOptimizeNavigation=function(a){this.skipAOWhenMoving=a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.tick=function(a){(a=this.stats)&&a.begin();this.needsResize&&(this.controls.handleResize(),this.camera.aspect=this.newWidth/this.newHeight,this.renderer.setSize(this.newWidth,this.newHeight),this.overlayDirty=this.needsClear=this.needsRender=!0,this.needsResize=!1);for(;this.texturesToUpdate.length;)for(var b=this.texturesToUpdate.pop(),c=0;c<b.mats.length;c++)b.mats[c][b.slot]=b.tex,this.needsClear=b.mats[c].needsUpdate=!0;var e=(b=this.controls.update()||
this.cameraUpdated||this.camera.dirty)||this.needsClear;this.cameraUpdated=!1;this.overlayDirty=this.overlayDirty||b;var d=this.model&&this.model.isLoadDone(),f=this.modelQueue,g=c=this.progressiveRender?0.5*(this.maxFrameTime+this.minFrameTime):1E10;if(e||this.needsRender)d&&this.model.getData().fragments.length&&this.signalProgress(0,null),this.updateCameraMatrices(),this.renderer.beginScene(this.scene,this.camera,e),b&&this.api.fireEvent(this.cameraChangedEvent),this.needGhostedPass&&f.setOverrideMaterial(null),
f&&(0<this.selector.getSelectionLength()?(this.phase=this.RENDER_HIGHLIGHTED,f.reset(this.camera),f.drawHighlightedObjectsOnly(),f.setOverrideMaterial(this.highlightMaterial)):(this.phase=this.RENDER_NORMAL,f.reset(this.camera),f.drawNormalObjectsOnly(),f.setOverrideMaterial(null)));if(f&&!f.isDone()){var h=this,e=function(a){h.renderer.renderScenePart(a,h.phase!==h.RENDER_NORMAL)},g=f.renderSome(e,g);f.isDone()&&this.phase===this.RENDER_HIGHLIGHTED&&(this.phase=this.RENDER_NORMAL,f.reset(this.camera),
f.drawNormalObjectsOnly(),f.setOverrideMaterial(null),g=f.renderSome(e,g));b||this.overlayDirty||this.renderer.composeFinalFrame();f.isDone()?(this.phase===this.RENDER_NORMAL&&!f.areAllVisible()&&this.showGhosting?(this.phase=this.RENDER_HIDDEN,f.reset(this.camera),f.drawHiddenObjectsOnly(),f.setOverrideMaterial(this.fadeMaterial)):(this.phase=this.RENDER_FINISHED,this.renderer.composeFinalFrame(b&&this.skipAOWhenMoving)),d&&this.signalProgress(100,null)):d&&this.signalProgress(100*f.getRenderProgress(),
null)}if(this.overlayDirty){if(f&&f.isDone()||this.showOverlaysWhileMoving){(d=this.lightsOn)||this.toggleLights(!0,!0);if(this.dir_light1){var k=this.dir_light1.intensity;this.dir_light1.intensity=1}this.renderer.renderOverlays(this.overlayScenes);d||this.toggleLights(!1,!0);this.dir_light1&&(this.dir_light1.intensity=k);this.overlayDirty=!1}else this.renderer.clearAllOverlays();this.renderer.composeFinalFrame(b&&this.skipAOWhenMoving)}g<c&&a&&a.end();this.lastTickMoved&&!b&&this.skipAOWhenMoving&&
this.renderer.composeFinalFrame();this.lastTickMoved=b;this.needsClear=this.needsRender=!1};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.updateCameraMatrices=function(){var a=this.camera;a.updateMatrixWorld();a.matrixWorldInverse.getInverse(a.matrixWorld);if(this.model){var b=this.getVisibleBounds(!0,!0),c=new THREE.Box3;b.getTransformedBox(a.matrixWorldInverse,c);var e=-c.max.z,c=-c.min.z,e=Math.max(e,Math.min(1,1E-4*Math.abs(c-e))),c=Math.max(c,e);a.near=e;a.far=c;a.updateProjectionMatrix();this.model.is2d()&&(b=(e=this.intersectGroundViewport(0,0))?a.position.distanceTo(e):a.position.distanceTo(b.center()),
a=this.renderer.settings.deviceHeight/(2*b*Math.tan(0.5*a.fov)),this.materials.__lineMaterial__.uniforms.unitsPerPixel.value=1/a,this.materials.__lineMaterial__.uniforms.pixelsPerUnit.value=a)}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initLights=function(a){var b=this.LightPresets[this.currentLightPreset].lightMultiplier;this.lightNode=new THREE.Object3D;this.dir_light1=new THREE.DirectionalLight((new THREE.Color).setRGB(1,1,1),b);this.dir_light1.position.set(-1,0,1);this.dir_light1.position.multiplyScalar(1E3*a);this.lightNode.add(this.dir_light1);this.amb_light=new THREE.AmbientLight((new THREE.Color).setRGB(1,1,1));this.scene.add(this.amb_light);this.toggleLights(0!=b)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleLights=function(a,b){a&&!this.lightsOn?(this.scene.add(this.amb_light),this.camera.add(this.lightNode),this.lightsOn=!0):!a&&this.lightsOn&&(this.amb_light&&this.scene.remove(this.amb_light),this.lightNode&&this.camera.remove(this.lightNode),this.lightsOn=!1);var c=this.LightPresets[this.currentLightPreset];this.lightsOn?(b&&this.amb_light?this.amb_light.color.setRGB(0.5*c.directLightColor[0],0.5*c.directLightColor[1],0.5*c.directLightColor[2]):
c.ambientColor&&this.amb_light&&this.amb_light.color.setRGB(c.ambientColor[0],c.ambientColor[1],c.ambientColor[2]),c.directLightColor&&this.dir_light1&&this.dir_light1.color.setRGB(c.directLightColor[0],c.directLightColor[1],c.directLightColor[2])):c.ambientColor&&this.amb_light&&b&&this.amb_light.color.setRGB(c.ambientColor[0],c.ambientColor[1],c.ambientColor[2])};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initCamera=function(a){var b=a.getUpVector(),b=b?(new THREE.Vector3).fromArray(b):null,c=!1,e=a.getDefaultCamera();ENABLE_AUTOCAM&&null!==e?(a=e.fov,e.isPerspective||(a=10,c=!0),this.camera.isPerspective=!0,this.camera.fov=a,this.camera.position.copy(e.position),this.camera.up.copy(e.up),this.camera.target=(new THREE.Vector3).copy(e.target),e.inst&&e.inst.transform&&(a=(new THREE.Matrix4).copy(e.inst.transform),this.camera.position.applyMatrix4(a),this.camera.target.applyMatrix4(a),
this.camera.up.transformDirection(a)),b?this.camera.up.copy(b):this.camera.up=this.getNearestAxis(this.camera.up)):(e=a.getBoundingBox(),this.camera.target=e.center(),e=e.size(),this.camera.position.copy(this.camera.target),this.camera.position.z+=Math.max(e.x,Math.max(e.y,e.z)),this.camera.isPerspective=!0,b?this.camera.up.copy(b):a.is2d()?(this.camera.up.set(0,0,1),this.camera.target.y+=1E-6*e.y):this.camera.up.set(0,1,0));this.api.navigation.setWorldUpVector(this.camera.up);this.api.navigation.setView(this.camera.position,
this.camera.target);c&&this.api.navigation.fitBounds(!0,this.model.getBoundingBox());this.syncCamera(!0);this.controls.recordHomeView()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.syncCamera=function(a){this.camera.updateProjectionMatrix();a&&this.setWorldUp(this.api.navigation.getWorldUpVector());ENABLE_AUTOCAM?this.controls.syncCamera():this.controls.resetScene(this.model.getBoundingBox());this.cameraUpdated=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.getNearestAxis=function(a){a=a.clone();0>a.x&&(a.x=-a.x);0>a.y&&(a.y=-a.y);0>a.z&&(a.z=-a.z);a.x>a.y&&a.x>a.z?a.set(0<a.x?1:-1,0,0):a.y>a.x&&a.y>a.z?a.set(0,0<a.y?1:-1,0):a.set(0,0,0<a.z?1:-1);return a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setViewFromFile=function(a){var b={},c=!0,e=a.getUpVector(),e=e?(new THREE.Vector3).fromArray(e):null,d=a.getDefaultCamera();d?(c=d.isPerspective,b.isPerspective=!0,b.fov=c?d.fov:10,b.position=(new THREE.Vector3).copy(d.position),b.target=(new THREE.Vector3).copy(d.target),b.up=(new THREE.Vector3).copy(d.up),d.inst&&d.inst.transform&&(a=(new THREE.Matrix4).copy(d.inst.transform),b.position.applyMatrix4(a),b.target.applyMatrix4(a),b.up.transformDirection(a)),
b.up=e?e:this.getNearestAxis(b.up)):(b.isPerspective=!0,b.fov=this.camera.fov,b.target=a.getBoundingBox().center(),b.up=e?e:this.camera.up.clone(),b.position=b.target.clone(),a=a.getBoundingBox().size(),b.position.z+=Math.max(a.x,a.y,a.z));this.applyCamera(b,!c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setViewFromArray=function(a){a={position:new THREE.Vector3(a[0],a[1],a[2]),target:new THREE.Vector3(a[3],a[4],a[5]),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoHeight:a[11],isPerspective:!a[12]};var b=a.isPerspective;b||(a.fov=10);var c=this.model?this.model.getUpVector():null,c=c?(new THREE.Vector3).fromArray(c):null;a.up=c?c:this.getNearestAxis(a.up);this.applyCamera(a,!b)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setWorldUp=function(a){this.worldUp.copy(a);var b=0,c=Math.abs(a.x);Math.abs(a.y)>c&&(b=1,c=Math.abs(a.y));Math.abs(a.z)>c&&(b=2);this.camera.worldUpTransform=null;2==b?(a=this.camera.worldUpTransform=new THREE.Matrix4,a=a.elements,a[0]=1,a[1]=0,a[2]=0,a[4]=0,a[5]=0,a[6]=-1,a[8]=0,a[9]=1,a[10]=0):0==b&&(a=this.camera.worldUpTransform=new THREE.Matrix4,a=a.elements,a[0]=0,a[1]=1,a[2]=0,a[4]=-1,a[5]=0,a[6]=0,a[8]=0,a[9]=0,a[10]=1)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.applyCamera=function(a,b){if(b){var c=this.controls.computeFit(a.position,a.target,a.fov);this.controls.transitionView(c.position,c.target,a.fov,a.up)}else this.controls.transitionView(a.position,a.target,a.fov,a.up);this.cameraUpdated=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setModel=function(a){a&&(this.model=a,this.selector.model=this.model,this.visibilityManager.model=this.model,this.model.setLoader(this.svfloader),this.initScene())};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initScene=function(){if(this.model){this.model.is2d()&&(this.initLayerTexture(this.model),this.enter2DMode());this.modelQueue=new RenderQueue(this.model.getData().fragments.length,this.scene,this.model.getBoundingBox());this.initCamera(this.model);var a=0.5*this.model.getBoundingBox().size().length();this.initLights(a);this.setLightPreset(this.currentLightPreset);this.needsRender=this.needsClear=!0}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initLayerTexture=function(a){var b=a.getLayersList();a=0|Math.ceil(b.length/256);for(var c=new Uint8Array(1024*a),e=0,b=b.length;e<b;e++)c[4*e]=255,c[4*e+1]=255,c[4*e+2]=255,c[4*e+3]=255;a=new THREE.DataTexture(c,256,a,THREE.RGBAFormat,THREE.UnsignedByteType,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);a.generateMipmaps=!1;a.flipY=!1;a.needsUpdate=!0;this.layerMaskTex=a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.create2DMaterial=function(a){var b="__lineMaterial__";a.image&&(b+="|image:"+a.image.name);a.clip&&(b+="|clip:"+JSON.stringify(a.clip));if(!this.materials.hasOwnProperty(b)){var c=new THREE.ShaderMaterial({fragmentShader:LineShader.fragmentShader,vertexShader:LineShader.vertexShader,uniforms:THREE.UniformsUtils.clone(LineShader.uniforms),attributes:LineShader.attributes,defines:LineShader.defines,transparent:!0});c.depthWrite=!1;c.depthTest=!1;c.blending=
THREE.NormalBlending;c.side=THREE.DoubleSide;c.uniforms.tLayerMask.value=this.layerMaskTex;if(a.image){var e;a.image.dataURI?(e=new Image,e.src=a.image.dataURI,e=new THREE.Texture(e,new THREE.UVMapping),e.name=a.image.name,a.image.isPng&&(c.transparent=!0)):a.image.bits&&(e=new THREE.DataTexture(a.image.bits,a.image.width,a.image.height,THREE.RGBAFormat));e.wrapS=THREE.ClampToEdgeWrapping;e.wrapT=THREE.ClampToEdgeWrapping;e.anisotropy=1;e.flipY=!0;e.needsUpdate=!0;c.uniforms.tRaster.value=e}this.materials[b]=
c}return b};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.addMaterial=function(a,b,c){function e(a){return 0.299*a.r+0.587*a.g+0.114*a.b}var d=this.svfloader.svf;if(!c){var f=d?d.proteinMaterials:null;b.metal?(b.reflectivity||(b.reflectivity=e(b.specular)),f&&(1===b.reflectivity&&(b.reflectivity=e(b.specular)),0===b.color.r&&0===b.color.g&&0===b.color.b?(b.color.r=0.1*b.specular.r,b.color.g=0.1*b.specular.g,b.color.b=0.1*b.specular.b):(b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1))):!f&&b.reflectivity?(b.metal=
!0,b.specular.r=b.color.r*b.reflectivity,b.specular.g=b.color.g*b.reflectivity,b.specular.b=b.color.b*b.reflectivity,b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1):1!==b.color.r||1!==b.color.g||1!==b.color.b||1!==b.specular.r||1!==b.specular.g||1!==b.specular.b||b.uri_map||b.uri_specularMap?(b.reflectivity||(b.reflectivity=0.01+0.06*e(b.specular)),b.specular.r*=b.reflectivity,b.specular.g*=b.reflectivity,b.specular.b*=b.reflectivity):(b.metal=!0,b.reflectivity=0.7,b.specular.r=b.specular.g=b.specular.b=
b.reflectivity,b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1);b.ambient.copy(b.color);b.ambient.r*=0.3;b.ambient.g*=0.3;b.ambient.b*=0.3;b.combine=THREE.MixOperation;if(b.transparent||b.uri_map&&-1!=b.uri_map.toLowerCase().indexOf(".png")||b.uri_opacityMap)b.alphaTest=0.01}if(b.uri_normalMap){c=b.bumpScale;if(void 0===c||1<=c)c=1;b.normalScale=new THREE.Vector2(c,c)}else void 0===b.bumpScale&&(b.uri_map||b.uri_bumpMap)?b.bumpScale=0.03:1<b.bumpScale&&(b.bumpScale=0.03);f&&f.materials&&(f=f.materials[a])&&
(f=f.materials[f.userassets[0]],f.categories&&-1!=f.categories.indexOf("Paint")&&(b.clearcoat=!0));this.reflectionCube&&(b.envMap=this.reflectionCube);this.irradianceMap&&(b.irradianceMap=this.irradianceMap);b.mrtNormals=this.renderer.hasMRT()&&this.renderer.settings.sao;b.side==THREE.DoubleSide&&this.renderer.toggleTwoSided(!0);this.materials[a]=b};Autodesk.Viewing.Private.Viewer3DImpl.prototype.addTexture=function(a){this.texturesToUpdate.push(a)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.addMeshInstance=function(a,b,c,e){var d=this.model.getData();if(0!==b||-1==d.basePath.indexOf("SaRang")){if(a.isLines){var f=!!a.attributes.color,d=new THREE.LineBasicMaterial({vertexColors:f,polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:1});f||(d.color=this.materials[c].color);a=new THREE.Mesh(a,d,!0);a.isLine=!0}else{d=this.materials[c];if(!d)for(f in stderr("Unknown material "+c),this.materials){d=this.materials[f];break}a.attributes.color&&
(d.vertexColors=THREE.VertexColors,d.needsUpdate=!0);a.attributes.uv&&a.attributes.uv.isPattern&&(d.map&&!d.bumpMap&&(d.bumpMap=d.map,d.needsUpdate=!0),d.uri_map&&!d.uri_bumpMap&&(d.uri_bumpMap=d.uri_map,d.needsUpdate=!0));a=new THREE.Mesh(a,d,!0)}e&&(a.matrix?a.matrix.copy(e):a.matrixWorld.copy(e));a.matrixAutoUpdate=!1;this.modelQueue.addMesh(b,a)}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.signalProgress=function(a,b){this.api.fireEvent({type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:a,message:b})};Autodesk.Viewing.Private.Viewer3DImpl.prototype.resize=function(a,b){this.needsResize=!0;this.newWidth=a;this.newHeight=b};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.enter2DMode=function(){var a=new THREE.Vector3(0,0,1);this.api.navigation.setWorldUpVector(a);this.syncCamera(!0);this.controls.set2DMode(!0);this.setLightPreset(0);this.togglePostProcess(!1,!1,!0)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.loadSvf=function(a,b,c,e,d){return this.svfloader.loadSvf(a,b,c,e,d)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.createOverlayScene=function(a,b,c,e){b&&(b.depthWrite=!1,b.depthTest=!0);c&&(c.depthWrite=!1,c.depthTest=!1);var d=new THREE.Scene(!0);d.__lights=this.scene.__lights;this.overlayScenes[a]={scene:d,camera:e,materialPre:b,materialPost:c}};Autodesk.Viewing.Private.Viewer3DImpl.prototype.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b);this.overlayDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.removeOverlay=function(a,b){this.overlayScenes[a].scene.remove(b);this.overlayDirty=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.clearOverlay=function(a){this.overlayScenes[a].scene.clear();this.overlayDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setClearColors=function(a,b,c,e,d,f){this.clearColorTop=new THREE.Vector4(a/255,b/255,c/255,1);this.clearColorBottom=new THREE.Vector4(e/255,d/255,f/255,1);this.reflectionCube&&!this.reflectionCube.isBgColor||this.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom);this.renderer.setClearColors(this.clearColorTop,this.clearColorBottom);this.needsClear=!0;this.fireRenderOptionChanged()};
THREE.Object3D.prototype.traverse=function(a){a(this);if(this.children)for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.getOverlayBounds=function(){var a=new THREE.Box3,b=this.overlayScenes,c;for(c in b)if(b.hasOwnProperty(c)){var e=new THREE.Box3;e.setFromObject(b[c].scene);a.union(e)}return a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.getVisibleBounds=function(a,b){var c=null;this.modelQueue&&(c=this.modelQueue.getVisibleBounds(a),b&&(c=this.getOverlayBounds().union(c)));return c};Autodesk.Viewing.Private.Viewer3DImpl.prototype.getRenderProxy=function(a,b){return this.modelQueue.getVizmesh(b)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setFragmentVisibility=function(a,b,c){this.modelQueue.setVisibility(b,c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setModelVisibility=function(a,b){this.modelQueue.setAllVisibility(b)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.isWholeModelVisible=function(a){return this.modelQueue.areAllVisible()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.resetIsolation=function(a){this.modelQueue.setOverrideMaterial(null);this.needGhostedPass=!1;this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightFragment=function(a,b,c){this.modelQueue.setHightlighted(b,c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.explode=function(a){var b=this,c=this.model,e=c.getData(),d=this.getVisibleBounds(!0).center(),f=e.fragments,g=f.transforms,h=a*(e.maxTreeDepth-1)+1,k=0|h,l=h-k;a*=2;if(e.instanceTree&&e.instanceBoxes&&0!=a){var m=e.instanceBoxes;(function v(d,e,f,h,n,p,q,s){var t=2*a;e==k&&(t*=l);var N=6*d.dbId,z=0.5*(m[N]+m[N+3]),M=0.5*(m[N+1]+m[N+4]),N=0.5*(m[N+2]+m[N+5]);0<e&&e<=k&&(p+=(z-f)*t,q+=(M-h)*t,s+=(N-n)*t);if(f=d.children)for(h=0,n=f.length;h<n;h++)v(f[h],
e+1,z,M,N,p,q,s);d=d.fragIds;if(void 0!==d)if(Array.isArray(d))for(e=0;e<d.length;e++)z=0|d[e],N=16*z,M=b.getRenderProxy(c,z).matrixWorld.elements,M[12]=g[N+12]+p,M[13]=g[N+13]+q,M[14]=g[N+14]+s;else z=d|0,M=b.getRenderProxy(c,z).matrixWorld.elements,N=16*z,M[12]=g[N+12]+p,M[13]=g[N+13]+q,M[14]=g[N+14]+s})(e.instanceTree,0,d.x,d.y,d.x,0,0,0)}else for(e=f.boxes,h=0,f=f.length;h<f;h++){var n=6*h,p=16*h,q=0.5*(e[n]+e[n+3]),s=0.5*(e[n+1]+e[n+4]),n=0.5*(e[n+2]+e[n+5]),q=a*(q-d.x),s=a*(s-d.y),n=a*(n-d.z),
t=b.getRenderProxy(c,h).matrixWorld.elements;t[12]=g[p+12]+q;t[13]=g[p+13]+s;t[14]=g[p+14]+n}this.overlayDirty=this.needsClear=this.modelQueue.visibleBoundsDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setCubeMapFromColors=function(a,b){for(var c=255*a.x,e=255*a.y,d=255*a.z,f=255*b.x,g=255*b.y,h=255*b.z,k=new Uint8Array(16),l=new Uint8Array(16),m=new Uint8Array(16),n=0;4>n;n++)k[4*n]=c,k[4*n+1]=e,k[4*n+2]=d,k[4*n+3]=255,l[4*n]=f,l[4*n+1]=g,l[4*n+2]=h,l[4*n+3]=255,0|n/2?(m[4*n]=c,m[4*n+1]=e,m[4*n+2]=d):(m[4*n]=f,m[4*n+1]=g,m[4*n+2]=h),m[4*n+3]=255;c=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);e=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);l=new THREE.DataTexture(l,
2,2,THREE.RGBAFormat);k=new THREE.DataTexture(k,2,2,THREE.RGBAFormat);d=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);f=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);m=new THREE.Texture(null,new THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat);m.image=[e.image,c.image,k.image,l.image,f.image,d.image];m.needsUpdate=!0;this.reflectionCube=m;this.reflectionCube.isBgColor=!0;for(var p in this.materials)k=this.materials[p],k.envMap=
m,k.needsUpdate=!0;this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setCubeMap=function(a){var b=this,c=function(a){var c=b.model?b.model.getData():null;b.reflectionCube=void 0===a&&c?c.envMap:a;if(b.reflectionCube)for(var f in b.materials)a=b.materials[f],a.envMap=b.reflectionCube,a.needsUpdate=!0;else b.setCubeMapFromColors(b.clearColorTop,b.clearColorBottom);b.needsClear=!0};Array.isArray(a)?(this.reflectionCube=THREE.ImageUtils.loadTextureCube(a,new THREE.CubeReflectionMapping,c),this.reflectionCube.format=THREE.RGBFormat):
"string"==typeof a?-1!=a.toLowerCase().indexOf(".dds")?(this.reflectionCube=THREE.ImageUtils.loadCompressedTextureCube(a,new THREE.CubeReflectionMapping,c),this.reflectionCube.LogLuv=-1!=a.indexOf("logluv")):(this.reflectionCube=THREE.ImageUtils.loadTexture(a,new THREE.SphericalReflectionMapping,c),this.reflectionCube.format=THREE.RGBFormat):a?c(a):c(null)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setIrradianceMap=function(a){var b=this,c=function(a){if(a){for(var c in b.materials){var f=b.materials[c];f.irradianceMap=a;f.needsUpdate=!0}b.irradianceMap=a}else if(b.irradianceMap){for(c in b.materials)f=b.materials[c],f.irradianceMap=null,f.needsUpdate=!0;b.irradianceMap=null}b.needsClear=!0};THREE.ImageUtils.crossOrigin="";Array.isArray(a)?(this.irradianceMap=THREE.ImageUtils.loadTextureCube(a,new THREE.CubeReflectionMapping,c),this.irradianceMap.format=
THREE.RGBFormat):"string"==typeof a?-1!=a.toLowerCase().indexOf(".dds")&&(this.irradianceMap=THREE.ImageUtils.loadCompressedTextureCube(a,new THREE.CubeReflectionMapping,c),this.irradianceMap.LogLuv=-1!=a.indexOf("logluv")):a?c(a):c(null)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setGhostingBrightness=function(a){this.fadeMaterial.color=a?new THREE.Color(1052688):new THREE.Color(16777215)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setLightPreset=function(a){this.currentLightPreset=a;var b=this.LightPresets[a];if(b&&b.path){var c=RESOURCE_ROOT+"environments/"+b.path+"_mipdrop.logluv.dds";this.setIrradianceMap(RESOURCE_ROOT+"environments/"+b.path+"_irr.logluv.dds");this.setCubeMap(c);this.renderer.setExposureBias(b.E_bias,b.lightMultiplier);this.setGhostingBrightness(b.brighterFade);this.lastLightPreset=a}else this.setIrradianceMap(null),this.setCubeMap(null),this.renderer.setExposureBias(0,
1);this.renderer.setTonemapMethod(b.tonemap);b.tonemap?this.renderer.setGamma(2):this.renderer.setGamma(1);a=SAOShader.uniforms.radius.value;c=SAOShader.uniforms.intensity.value;b.hasOwnProperty("saoRadius")&&(a=b.saoRadius);b.hasOwnProperty("saoIntensity")&&(c=b.saoIntensity);this.renderer.setAOOptions(a,c);(a=b.bgColorGradient)||(a=this.BackgroundPresets.Custom);this.setClearColors(a[0],a[1],a[2],a[3],a[4],a[5]);a=1;null!==b.lightMultiplier&&void 0!==b.lightMultiplier&&(a=b.lightMultiplier);this.dir_light1&&
(this.toggleLights(0!=a),this.dir_light1.intensity=a);this.overlayDirty=this.needsClear=!0;this.fireRenderOptionChanged()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.uninitialize=function(){window.cancelAnimationFrame(this.reqid);this.controls.uninitialize();this.controls=null};Autodesk.Viewing.Private.Viewer3DImpl.prototype.hideLines=function(a){this.modelQueue.hideLines(a);this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleLayerVisibility=function(a,b){var c=this.materials.__lineMaterial__,e=c.uniforms.tLayerMask.value,d=e.image.data,f=b?255:0;d[4*a]=f;d[4*a+1]=f;d[4*a+2]=f;d[4*a+3]=f;e.needsUpdate=!0;this.needsClear=c.needsUpdate=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.fireRenderOptionChanged=function(){var a=this.renderer.hasMRT()&&this.renderer.settings.sao,b;for(b in this.materials){var c=this.materials[b];c.mrtNormals!==a&&(c.mrtNormals=a,c.needsUpdate=!0)}this.api.fireEvent({type:Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT})};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.castRayViewport=function(a,b,c){if(this.modelQueue)return a=new THREE.Vector3(a,b,1),b=this.camera,this.projector.unprojectVector(a,b),a=this.modelQueue.rayIntersect(b.position,a.sub(b.position).normalize(),c),c=a[0],a=a[1],b=null,c&&(b=(b=this.model.getData())?b.fragments:null,c=c.fragId,b.fragToCachedNode||(b.fragToCachedNode=[]),b.fragToDbNode&&b.fragToDbNode[c]?b=b.fragToDbNode[c]:(b.fragToCachedNode[c]||(b.fragToCachedNode[c]={dbId:0,fragIds:c}),
b=b.fragToCachedNode[c])),{node:b,intersectPoint:a}};Autodesk.Viewing.Private.Viewer3DImpl.prototype.castRay=function(a,b,c){var e=this.canvas.getBoundingClientRect();return this.castRayViewport((a+0.5-e.left)/e.width*2-1,2*-((b+0.5-e.top)/e.height)+1,c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.intersectGroundViewport=function(a,b){var c=this.camera,e="z";1==c.up.x?e="x":1==c.up.y&&(e="y");var d=new THREE.Vector3(a,b,1);this.projector.unprojectVector(d,c);d.sub(c.position);d.normalize();if(1E-6>Math.abs(d[e]))return null;e=((this.model?this.model.getBoundingBox().min[e]:0)-c.position[e])/d[e];d.multiplyScalar(e);d.add(c.position);return d};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.intersectGround=function(a,b){var c=this.canvas.getBoundingClientRect();return this.intersectGroundViewport((a+0.5-c.left)/c.width*2-1,2*-((b+0.5-c.top)/c.height)+1)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightObjectViewport=function(a,b){this.renderer.highlightObjectViewport(a,b);this.overlayDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightObject=function(a,b){var c=this.canvas.getBoundingClientRect();this.highlightObjectViewport((a+0.5-c.left)/c.width*2-1,2*-((b+0.5-c.top)/c.height)+1)};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.DockingPanel=function(a,b,c,e){this.visibilityCallbacks=[];this.parentContainer=a;this.container=document.createElement("div");this.container.id=b;this.container.lastWidth="";this.container.dockRight=!1;this.container.dockBottom=!1;this.titleLabel=c;this.container.className=e&&e.shadow?"dockingPanel shadow":"dockingPanel";a.appendChild(this.container);this.initialize();this.setVisible(!1)};
Autodesk.Viewing.UI.DockingPanel.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id);this.container.appendChild(this.title);this.initializeMoveHandlers(this.title);this.closer=this.createCloseButton();this.container.appendChild(this.closer)};Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize=function(){};Autodesk.Viewing.UI.DockingPanel.prototype.addVisibilityListener=function(a){this.visibilityCallbacks.push(a)};
Autodesk.Viewing.UI.DockingPanel.prototype.isVisible=function(){return"none"!==this.container.style.display&&""!==this.container.style.display};
Autodesk.Viewing.UI.DockingPanel.prototype.setVisible=function(a){this.container.style.display=a?"block":"none";if(a){if(this.container.dockRight){var b=this.parentContainer.getBoundingClientRect().width,c=this.container.style.width?this.container.style.width:this.container.getBoundingClientRect().width;c||(c=this.container.lastWidth);c=""===c?300:parseInt(c);this.container.style.left=b-c+"px"}this.container.dockBottom&&(b=this.parentContainer.getBoundingClientRect().height,c=this.container.style.height?
this.container.style.height:this.container.getBoundingClientRect().height,c||(c=this.container.lastHeight),c=""===c?300:parseInt(c),this.container.style.top=b-c+"px")}else this.container.lastWidth=this.parentContainer.style.width,this.container.lastHeight=this.parentContainer.style.height;for(b=0;b<this.visibilityCallbacks.length;b++)this.visibilityCallbacks[b](a)};
Autodesk.Viewing.UI.DockingPanel.prototype.initializeMoveHandlers=function(a){function b(a){var b=p.parentContainer.getBoundingClientRect();n.style.maxWidth&&parseInt(n.style.width)>parseInt(n.style.maxWidth)&&(n.style.width=n.style.maxWidth);n.style.maxHeight&&parseInt(n.style.height)>parseInt(n.style.maxHeight)&&(n.style.height=n.style.maxHeight);100>parseInt(n.style.width)&&(n.style.width="100px");100>parseInt(n.style.height)&&(n.style.height="100px");l+=a.screenX-f;m+=a.screenY-g;e=h+l;d=k+m;
var c=parseInt(n.style.width),u=parseInt(n.style.height);isNaN(c)&&(c=p.container.getBoundingClientRect().width);isNaN(u)&&(u=p.container.getBoundingClientRect().height);5>e&&(e=0);5>d&&(d=0);n.dockRight=!1;n.dockBottom=!1;b.width-5<e+c&&(e=b.width-c,n.dockRight=!0);b.height-5<d+u&&(d=b.height-u,n.dockBottom=!0);n.style.left=e+"px";n.style.top=d+"px";n.style.maxWidth=b.width-e+"px";n.style.maxHeight=b.height-d+"px";f=a.screenX;g=a.screenY;p.onMove(a,e,d)}function c(a){window.removeEventListener("mousemove",
b);window.removeEventListener("mouseup",c);p.onEndMove(a,e,d)}var e,d,f,g,h,k,l,m,n=this.container,p=this;a.addEventListener("mousedown",function(a){f=a.screenX;g=a.screenY;m=l=0;h=p.container.offsetLeft;k=p.container.offsetTop;window.addEventListener("mousemove",b,!1);window.addEventListener("mouseup",c,!1);a.preventDefault();p.onStartMove(a,h,k)},!1)};
Autodesk.Viewing.UI.DockingPanel.prototype.initializeCloseHandler=function(a){var b=this;a.addEventListener("click",function(a){b.setVisible(!1)},!1)};Autodesk.Viewing.UI.DockingPanel.prototype.createScrollContainer=function(a){var b=document.createElement("div");b.className=a&&a.left?"dockingPanelScroll left":"dockingPanelScroll right";a&&a.heightAdjustment&&(b.style.height="calc(100% - "+a.heightAdjustment+"px)");return b};
Autodesk.Viewing.UI.DockingPanel.prototype.createTitleBar=function(a){var b=document.createElement("div");b.className="dockingPanelTitle";b.textContent=a;return b};Autodesk.Viewing.UI.DockingPanel.prototype.createCloseButton=function(){var a=document.createElement("div");a.className="dockingPanelClose";a.innerHTML="&times;";this.initializeCloseHandler(a);return a};Autodesk.Viewing.UI.DockingPanel.prototype.onStartMove=function(a,b,c){};
Autodesk.Viewing.UI.DockingPanel.prototype.onEndMove=function(a,b,c){};Autodesk.Viewing.UI.DockingPanel.prototype.onMove=function(a,b,c){};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.ModelStructurePanel=function(a,b,c,e){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,e);this.container.style.left="0px";this.container.style.top="0px";this.scrollContainer=this.createScrollContainer({left:!1,heightAdjustment:70});this.scrollContainer.style.marginTop="20px";this.container.appendChild(this.scrollContainer);this.scrollContainer.id=this.container.id+"-scroll-container";this.container.style.minHeight="100px";this.container.style.height="600px";this.container.style.width=
"340px";this.tree=this.modelRoot=null;this.selectedNodes=[];this.options=e;this.movedSinceLastClick=!1};Autodesk.Viewing.UI.ModelStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.ModelStructurePanel.prototype.constructor=Autodesk.Viewing.UI.ModelStructurePanel;
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setModel=function(a,b){var c=this,e=function(){var a=new Autodesk.Viewing.UI.TreeDelegate;a.getTreeNodeId=function(a){return a.dbId};a.getTreeNodeLabel=function(a){return c.getNodeLabel(a)};a.getTreeNodeClass=function(a){return c.getNodeClass(a)};a.isTreeNodeGroup=function(a){return c.isGroupNode(a)};a.shouldCreateTreeNode=function(a){return c.shouldInclude(a)};a.onTreeNodeHover=function(a,b,d){c.onHover(b,d)};a.onTreeNodeClick=function(a,b,d){c.onClick(b,
d)};a.onTreeNodeRightClick=function(a,b,d){c.onRightClick(b,d)};a.onTreeNodeDoubleClick=function(a,b,d){c.onDoubleClick(b,d)};return a};c.selectedNodes=[];var d=b;d||(c.options&&c.options.defaultTitle?d=c.options.defaultTitle:a&&(d=a.name));d||(d="Model Structure");c.setTitle(d);if(c.tree){for(;c.scrollContainer.hasChildNodes();)c.scrollContainer.removeChild(c.scrollContainer.lastChild);c.title.removeEventListener("click",c.onTitleClick);c.title.removeEventListener("dblclick",c.onTitleDoubleClick)}if(c.modelRoot=
a)e=e(),c.tree=new Autodesk.Viewing.UI.Tree(e,a,c.scrollContainer,{}),c.options&&c.options.hasOwnProperty("startCollapsed")&&!c.options.startCollapsed||(c.tree.setAllCollapsed(!0),c.tree.setCollapsed(e.getTreeNodeId(a),!1)),c.options&&c.options.hasOwnProperty("excludeRoot")&&!c.options.excludeRoot||c.tree.addClass(e.getTreeNodeId(a),"exclude"),c.onTitleClick=function(b){if(!self.movedSinceLastClick)c.onClick(a,b);self.movedSinceLastClick=!1},c.onTitleDoubleClick=function(b){c.onDoubleClick(a,b)},
c.title.addEventListener("click",c.onTitleClick,!1),c.title.addEventListener("dblclick",c.onTitleDoubleClick,!1)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.setTitle=function(a){this.title.textContent=a};Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeLabel=function(a){return a.name&&""!==a.name?a.name:"Object "+a.dbId};Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeClass=function(a){return""};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.isGroupNode=function(a){return a.children&&Array.isArray(a.children)&&0<a.children.length};Autodesk.Viewing.UI.ModelStructurePanel.prototype.shouldInclude=function(a){return!0};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onHover=function(a,b){};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onClick=function(a,b){this.setSelection([a])};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onDoubleClick=function(a,b){};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.onRightClick=function(a,b){};Autodesk.Viewing.UI.DockingPanel.prototype.onMove=function(a,b,c){self.movedSinceLastClick=!0};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setSelection=function(a){if(this.tree){for(var b=0;b<this.selectedNodes.length;++b)for(var c=this.selectedNodes[b].parent;c;)this.tree.removeClass(this.tree.delegate().getTreeNodeId(c),"ancestor-selected"),c=c.parent;for(var e=[],b=0;b<a.length;++b)for(e.push(a[b].dbId),c=a[b].parent;c;)this.tree.addClass(this.tree.delegate().getTreeNodeId(c),"ancestor-selected"),c=c.parent;this.selectedNodes=a;this.tree.setSelection(e)}};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.addClass=function(a,b){this.tree.addClass(a,b)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.removeClass=function(a,b){this.tree.removeClass(a,b)};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.Extensions");Autodesk.Viewing.Extensions.ViewerModelStructurePanel=function(a,b,c){this.viewer=a;Autodesk.Viewing.UI.ModelStructurePanel.call(this,a.container,a.container.id+"ViewerModelStructurePanel",b,c);this.clickConfig=c&&c.docStructureConfig?c.docStructureConfig:null;this.isMac=-1!==navigator.userAgent.search("Mac OS");this.visibleNodes=[];this.hiddenNodes=[]};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.ModelStructurePanel.prototype);
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerModelStructurePanel;
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize=function(){Autodesk.Viewing.UI.ModelStructurePanel.prototype.initialize.call(this);var a=this;a.viewer.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(b){a.setSelection(b.nodeArray)});a.viewer.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(b){a.setIsolation(b.nodeIdArray)});a.viewer.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(b){a.setHidden(b.nodeIdArray,!0)});a.viewer.addEventListener(Autodesk.Viewing.SHOW_EVENT,
function(b){a.setHidden(b.nodeIdArray,!1)})};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setModel=function(a,b){this.visibleNodes=[];this.hiddenNodes=[];Autodesk.Viewing.UI.ModelStructurePanel.prototype.setModel.call(this,a,b)};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.handleAction=function(a,b){for(var c in a)switch(a[c]){case "selectOnly":this.viewer.select([b.dbId]);break;case "deselectAll":this.viewer.select([]);break;case "selectToggle":this.viewer.toggleSelect(b.dbId);break;case "isolate":this.viewer.isolate(b);break;case "showAll":this.viewer.isolate(null);break;case "focus":this.viewer.fitToView();break;case "hide":this.viewer.hide(b);break;case "show":this.viewer.show(b);break;case "toggleVisibility":this.viewer.toggleVisibility(b)}};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.ctrlDown=function(a){return this.isMac&&a.metaKey||!this.isMac&&a.ctrlKey};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick=function(a,b){var c="click";this.ctrlDown(b)&&(c+="Ctrl");b.shiftKey&&(c+="Shift");b.altKey&&(c+="Alt");this.clickConfig&&this.clickConfig[c]?this.handleAction(this.clickConfig[c].onObject,a):this.viewer.select([a.dbId])};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onDoubleClick=function(a,b){this.handleAction(["focus"],a)};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onRightClick=function(a,b){var c=[a.dbId];if(b.shiftKey||this.isMac&&b.metaKey||b.ctrlKey&&(!this.isMac||2===b.button))for(var e=this.viewer.impl.selector.getSelection(),d=0;d<e.length;++d)c.push(e[d].dbId);this.viewer.isolateById(c);this.viewer.select(c);return this.viewer.objectContextMenu.show(b)};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setHidden=function(a,b){if(0<a.length)for(var c=0;c<a.length;++c){var e=a[c];b?-1===this.hiddenNodes.indexOf(e)&&(this.addClass(a[c].dbId,"dim"),this.hiddenNodes.push(a[c]),e=this.visibleNodes.indexOf(e),-1<e&&(this.removeClass(a[c].dbId,"visible"),this.visibleNodes.splice(e))):-1===this.visibleNodes.indexOf(e)&&(this.addClass(a[c].dbId,"visible"),this.visibleNodes.push(a[c]),e=this.hiddenNodes.indexOf(e),-1<e&&(this.removeClass(a[c].dbId,
"dim"),this.hiddenNodes.splice(e)))}};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setIsolation=function(a){for(var b=0;b<this.hiddenNodes.length;++b)this.removeClass(this.hiddenNodes[b].dbId,"dim");for(b=0;b<this.visibleNodes.length;++b)this.removeClass(this.visibleNodes[b].dbId,"visible");this.visibleNodes=a;if(0<this.visibleNodes.length&&(1!==this.visibleNodes.length||this.visibleNodes[0]!==this.modelRoot))for(this.addClass(this.modelRoot.dbId,"dim"),this.hiddenNodes=[this.modelRoot],b=0;b<this.visibleNodes.length;++b)this.addClass(this.visibleNodes[b].dbId,
"visible")};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.RaaSPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RaaSPanel","Cloud Rendering",{shadow:!0});this.renderButton=document.createElement("input");this.renderButton.setAttribute("type","button");this.renderButton.setAttribute("value","Render");this.renderButton.id="renderButton";this.container.appendChild(this.renderButton);this.thumbnailPanel=document.createElement("div");this.thumbnailPanel.id="thumbnailPanel";this.imagePanel=
document.createElement("div");this.imagePanel.id="imagePanel";this.container.appendChild(document.getElementById("loader"));document.getElementById("loader").style.display="none";this.imageNum=0;this.thumbList=[];this.imageList=[];this.imageIndex=0;this.container.style.width="1020px";this.container.style.top="10px";this.container.style.left="150px";this.container.style.height="750px";this.container.style.display="none";this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){b.syncUI()});
this.renderButton.addEventListener("click",function(){b.addImage();b.container.appendChild(b.thumbnailPanel);b.container.appendChild(b.imagePanel);b.imagePanel.style.display="none";document.getElementById("loader").style.display="block";b.imageIndex=b.imageNum-1;for(var c=0;c<b.thumbList.length;c++)b.thumbList[c].addEventListener("click",function(){"progress"==b.imageList[this.index].status?(b.imagePanel.style.display="none",b.imageList[b.imageIndex].style.display="none",b.imageIndex=this.index,document.getElementById("loader").style.display=
"block"):"complete"==b.imageList[this.index].status?(document.getElementById("loader").style.display="none",b.imageList[b.imageIndex].style.display="none",b.imageList[this.index].style.display="block",b.imagePanel.style.display="block",b.imageIndex=this.index):"error"==b.imageList[this.index].status&&(document.getElementById("loader").style.display="none",b.imageList[b.imageIndex].style.display="none",b.imageIndex=this.index)});a.impl.svfloader.testCloudRendering(a)})};
Autodesk.Viewing.Extensions.RaaSPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Extensions.RaaSPanel.prototype.constructor=Autodesk.Viewing.Extensions.RaaSPanel;Autodesk.Viewing.Extensions.RaaSPanel.prototype.syncUI=function(){};Autodesk.Viewing.Extensions.RaaSPanel.prototype.screenCapture=function(a){return Autodesk.Viewing.ScreenCapture(a)};
Autodesk.Viewing.Extensions.RaaSPanel.prototype.addImage=function(){var a=new Image;a.src=this.screenCapture(this.viewer);a.className="thumbnail";a.style.left=130*this.imageNum+"px";a.index=this.imageNum;this.thumbList.push(a);this.thumbnailPanel.appendChild(this.thumbList[this.imageNum]);a=new Image;a.src="";a.status="progress";this.imageList.push(a);this.imagePanel.appendChild(this.imageList[this.imageNum]);this.imageNum++};
Autodesk.Viewing.Extensions.RaaSPanel.prototype.loadThumbnail=function(a){this.thumbList[this.imageNum-1].src=a};Autodesk.Viewing.Extensions.RaaSPanel.prototype.loadImage=function(a){this.imageList[this.imageNum-1].src=a;this.imageList[this.imageNum-1].status="complete";document.getElementById("loader").style.display="none";this.imageIndex==this.imageNum-1&&(this.imagePanel.style.display="block",this.imageList[this.imageIndex].style.display="block")};
Autodesk.Viewing.Extensions.RaaSPanel.prototype.imageError=function(){this.imageList[this.imageNum-1].status="error";document.getElementById("loader").style.display="none"};Autodesk.Viewing.Extensions.RaaSPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.mainImage=this.renderButton=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.RaaSDataPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RaaSDataPanel","RaaS Data",{shadow:!0});this.table=document.createElement("table");b.addTableRow("cameraPosition");b.addTableRow("cameraIsPerspective");b.addTableRow("cameraUp");b.addTableRow("cameraTarget");b.addTableRow("cameraNear");b.addTableRow("cameraFar");b.addTableRow("cameraFov");b.addTableRow("cameraAspect");b.addTableRow("lightName");b.addTableRow("lightPath");
b.addTableRow("lightTonemap");b.addTableRow("lightE_bias");b.addTableRow("lightDirectLightColor");b.addTableRow("lightAmbientColor");b.addTableRow("lightMultiplier");b.addTableRow("lightBgColorGradientClearColorTop");b.addTableRow("lightBgColorGradientClearColorBottom");b.addTableRow("renderOptionsSaoToggle");b.addTableRow("renderOptionsSaoRadius");b.addTableRow("renderOptionsSaoIntensity");b.addTableRow("renderOptionsGamma");b.addTableRow("renderOptionsExposureBias");b.addTableRow("renderOptionsWhitePointIntensity");
b.addTableRow("renderOptionsFovAngle");this.container.appendChild(this.table);this.container.style.width="600px";this.container.style.top="100px";this.container.style.left="220px";this.container.style.height="660px";this.container.dock=!0;this.container.style.display="none";this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){b.syncUI()})};Autodesk.Viewing.Extensions.RaaSDataPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.Extensions.RaaSDataPanel.prototype.constructor=Autodesk.Viewing.Extensions.RaaSDataPanel;Autodesk.Viewing.Extensions.RaaSDataPanel.prototype.syncUI=function(){};Autodesk.Viewing.Extensions.RaaSDataPanel.prototype.addTableRow=function(a){var b=document.createElement("tr"),c=document.createElement("td");this.dataValue=document.createElement("td");this.dataValue.id=a;c.textContent=a;this.dataValue.textContent="";b.appendChild(c);b.appendChild(this.dataValue);this.table.appendChild(b)};
Autodesk.Viewing.Extensions.RaaSDataPanel.prototype.undistort=function(a){this.img.style.width=window.innerWidth/2+"px";this.img.style.height=window.innerHeight/2+"px";this.container.style.width=this.img.style.width;this.container.style.height=window.innerHeight/2+50+"px"};Autodesk.Viewing.Extensions.RaaSDataPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.img=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.addClass=function(a,b){if(a){for(var c=!1,e=a.className.split(/\s+/).filter(Boolean),d=0;d<e.length;++d)if(e[d]===b){c=!0;break}c||(e.push(b),a.className=e.join(" "))}};Autodesk.Viewing.Private.removeClass=function(a,b){if(a)for(var c=a.className.split(/\s+/).filter(Boolean),e=0;e<c.length;++e)if(c[e]===b){c.splice(e,1);a.className=c.join(" ");break}};
Autodesk.Viewing.Private.hasClass=function(a,b){if(a)for(var c=a.className.split(/\s+/).filter(Boolean),e=0;e<c.length;++e)if(c[e]===b)return!0;return!1};Autodesk.Viewing.Private.toggleClass=function(a,b){Autodesk.Viewing.Private.hasClass(a,b)?Autodesk.Viewing.Private.removeClass(a,b):Autodesk.Viewing.Private.addClass(a,b)};
Autodesk.Viewing.Private.Preferences=function(a,b,c){this.viewer=a;b||(b="Autodesk.Viewing.Preferences.");this.prefix=b;void 0===c&&(c=!0);this.useWebStorage=c;this.defaults={};this.values={}};Autodesk.Viewing.Private.Preferences.prototype.constructor=Autodesk.Viewing.Private.Preferences;Autodesk.Viewing.Private.Preferences.PREFERENCES_RESET_EVENT="PreferencesReset";
Autodesk.Viewing.Private.Preferences.prototype.load=function(a){this.defaults=a;for(var b in a)if(a.hasOwnProperty(b)){var c=this._webStorage(b);if("true"===c||"false"===c)c="true"===c;this.values[b]=null!==c?c:a[b]}};Autodesk.Viewing.Private.Preferences.prototype.reset=function(){for(var a in this.defaults)this.defaults.hasOwnProperty(a)&&this.set(a,this.defaults[a]);this.viewer.fireEvent(Autodesk.Viewing.Private.Preferences.PREFERENCES_RESET_EVENT)};
Autodesk.Viewing.Private.Preferences.prototype.addResetListener=function(a,b){var c=this;c.viewer.addEventListener(Autodesk.Viewing.Private.Preferences.PREFERENCES_RESET_EVENT,function(){b(a?c.values[a]:c.values)},!1)};Autodesk.Viewing.Private.Preferences.prototype.get=function(a){return this.values[a]};Autodesk.Viewing.Private.Preferences.prototype.set=function(a,b){this.values[a]=b;this._webStorage(a,b)};
Autodesk.Viewing.Private.Preferences.prototype._webStorage=function(a,b){return this.useWebStorage?"undefined"!==typeof localStorage&&"string"===typeof a?(a=this.prefix+a,"undefined"!==typeof b?localStorage[a]=b:b=localStorage[a]||null,b):null:null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.PropertyPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"PropertyPanel","Object Properties Loading...",{shadow:!1});this.table=document.createElement("table");this.table.id="propertygrid";this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:70});this.scrollpanel.style.marginTop="20px";this.container.appendChild(this.scrollpanel);
this.scrollpanel.appendChild(this.table);this.container.style.width="335px";this.container.style.height="200px";this.container.style.top="180px";this.container.style.left="220px";this.container.dockRight=!0;this.setOpenOnSelect=function(a){this.openOnSelect=a};this.lastSelected=[];a.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.lastSelected=a.dbIdArray;b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.dbIdArray.length)});a.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,
function(a){for(var e=[],d=0;d<a.nodeIdArray.length;d++){var f=a.nodeIdArray[d].dbId;f&&e.push(f)}b.lastSelected=e;b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.nodeIdArray.length)});a.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){b.pullCorrectProperties()});a.addEventListener(Autodesk.Viewing.SHOW_EVENT,function(a){b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.nodeIdArray.length)});this.pullCorrectProperties=function(){if(0<this.lastSelected.length)this.setNodeId(this.lastSelected[this.lastSelected.length-
1]);else{if(!a.areAllVisible())for(var b=[a.model.getRoot()];0<b.length;){var e=b.shift();if(e){if(Autodesk.Viewing.Private.VisibilityManager.isVisible(e)){this.setNodeId(e.dbId);return}if(e.children)for(var d=0;d<e.children.length;d++)b.push(e.children[d])}}b=a.model.getRoot()?a.model.getRootId():null;this.setNodeId(b)}};this.getNodeId=function(){return this.currentID};this.setDefaultProperties=function(){a.model.getRoot()?this.setNodeId(a.model.getRootId()):this.setNodeId(null)};this.setNodeId=
function(c){b.tbody.innerHTML="";c||(c=a.model&&a.model.getRoot()?a.model.getRootId():null);c?(this.currentID=c,a.getProperties(c,function(c){b.tbody.innerHTML="";if(c.properties)for(var d=0;d<c.properties.length;d++){var f=c.properties[d],g=f.displayValue,h=b.tbody.insertRow(-1),k=h.insertCell(0);k.textContent=f.displayName;k=h.insertCell(1);k.textContent=g;f=k;g=a.searchText;""!==g&&(g=new RegExp("(\\b"+g+"\\b)","gim"),h=f.innerHTML.replace(/(<highlight>|<\/highlight>)/igm,""),f.innerHTML=h,g=h.replace(g,
"<highlight>$1</highlight>"),f.innerHTML=g)}b.title.textContent=c.name?c.name:"Object Properties";b.scrollpanel.scrollTop=0;c=b.viewer.canvas.clientHeight;d=b.table.offsetHeight+b.title.offsetHeight+parseInt(b.scrollpanel.style.marginBottom);b.container.style.height=(d>c-180?c-180:d)+"px"})):(this.currentID=null,b.title.textContent="Object Properties")}};Autodesk.Viewing.Private.PropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.Private.PropertyPanel.prototype.constructor=Autodesk.Viewing.Private.PropertyPanel;Autodesk.Viewing.Private.PropertyPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.scrollpanel=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.OptionSlider=function(a,b,c,e){function d(a){a.target!=f.stepperElement&&(f.stepperElement.value=f.sliderElement.value);f.fireChangeEvent()}var f=this;this.tbody=e;this.sliderRow=this.tbody.insertRow(-1);e=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.innerHTML=a+":";this.sliderElement=document.createElement("input");this.sliderElement.type="range";this.sliderElement.id=a+"_slider";this.sliderElement.min=b;this.sliderElement.max=c;e.appendChild(this.caption);
e.appendChild(this.sliderElement);e=this.sliderRow.insertCell(1);this.stepperElement=document.createElement("input");this.stepperElement.type="number";this.stepperElement.id=a+"_stepper";this.stepperElement.min=b;this.stepperElement.max=c;this.stepperElement.step=1;this.stepperElement.style.width="64px";e.appendChild(this.stepperElement);this.blockEvent=!1;this.stepperElement.addEventListener("change",function(a){a.target!=f.sliderElement&&(f.sliderElement.value=f.stepperElement.value);f.fireChangeEvent()},
!1);this.sliderElement.addEventListener("change",d,!1);this.sliderElement.addEventListener("input",d,!1)};Autodesk.Viewing.Private.OptionSlider.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Private.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var a=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(a)}};
Autodesk.Viewing.Private.OptionSlider.prototype.setValue=function(a){this.blockEvent=!0;this.value=a;this.sliderElement.value=a;this.stepperElement.value=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionSlider.prototype.setDisabled=function(a){this.sliderElement.disabled=a;this.stepperElement.disabled=a;this.caption.disabled=a};
Autodesk.Viewing.Private.OptionCheckbox=function(a,b,c){THREE.EventDispatcher.call(this.prototype);var e=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(-1);b=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.innerHTML=a;b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.checkElement=document.createElement("input");this.checkElement.type="checkbox";this.checkElement.id=a+"_check";this.checkElement.checked=c;b.appendChild(this.checkElement);this.blockEvent=
!1;this.checked=c;this.checkElement.addEventListener("change",function(a){e.fireChangeEvent()},!1);this.checkElement.addEventListener("click",function(a){a.stopPropagation()},!1);this.sliderRow.addEventListener("click",function(a){e.checkElement.checked=!e.checkElement.checked;e.fireChangeEvent()},!1)};Autodesk.Viewing.Private.OptionCheckbox.prototype=Object.create(THREE.EventDispatcher.prototype);
Autodesk.Viewing.Private.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var a=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(a)}};Autodesk.Viewing.Private.OptionCheckbox.prototype.setValue=function(a){this.blockEvent=!0;this.checked=a;this.checkElement.checked=a;this.blockEvent=!1};
Autodesk.Viewing.Private.OptionCheckbox.prototype.setDisabled=function(a){this.checkElement.disabled=a;this.caption.disabled=a};
Autodesk.Viewing.Private.OptionDropDown=function(a,b,c,e){THREE.EventDispatcher.call(this.prototype);var d=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(-1);b=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.innerHTML=a+":";b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.dropdownElement=document.createElement("select");this.dropdownElement.id=a+"_dropdown";this.dropdownElement.className="optionDropDown";for(a=0;a<c.length;a++){var f=document.createElement("option");
f.value=a;f.text=c[a];this.dropdownElement.add(f)}this.selectedIndex=this.dropdownElement.selectedIndex=e;b.appendChild(this.dropdownElement);this.blockEvent=!1;this.dropdownElement.addEventListener("change",function(a){d.fireChangeEvent()},!1)};Autodesk.Viewing.Private.OptionDropDown.prototype=Object.create(THREE.EventDispatcher.prototype);
Autodesk.Viewing.Private.OptionDropDown.prototype.setSelectedIndex=function(a){this.blockEvent=!0;this.selectedIndex=this.dropdownElement.selectedIndex=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionDropDown.prototype.setSelectedValue=function(a){this.blockEvent=!0;this.dropdownElement.selectedValue=a;this.selectedIndex=this.dropdownElement.selectedIndex;this.blockEvent=!1};
Autodesk.Viewing.Private.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var a=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(a)}};Autodesk.Viewing.Private.OptionDropDown.prototype.setDisabled=function(a){this.dropdownElement.disabled=a;this.caption.disabled=a};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ProgressBar=function(a){this.bg=document.createElement("div");this.bg.className="progressbg";this.fg=document.createElement("div");this.fg.className="progressfg";this.bg.appendChild(this.fg);a.appendChild(this.bg);this.widthScale=this.fg.clientWidth};
Autodesk.Viewing.Private.ProgressBar.prototype.setPercent=function(a){99<=a?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*a*0.01+"px")};"undefined"!==typeof window&&function(a,b,c){function e(b){if(a.event&&a.event.contentOverflow!==c)return{x:a.event.offsetX,y:a.event.offsetY};if(b.offsetX!==c&&b.offsetY!==c)return{x:b.offsetX,y:b.offsetY};var d=b.target.parentNode.parentNode;return{x:b.layerX-d.offsetLeft,y:b.layerY-d.offsetTop}}function d(a,c,d){a=b.createElementNS(v,a);for(var e in c)a.setAttribute(e,c[e]);"[object Array]"!=Object.prototype.toString.call(d)&&(d=[d]);c=0;for(e=d[0]&&d.length||0;c<e;c++)a.appendChild(d[c]);return a}
function f(a){var b,c,d,e,f=a.h%360/60;e=a.v*a.s;d=e*(1-Math.abs(f%2-1));b=c=a=a.v-e;f=~~f;b+=[e,d,0,0,d,e][f];c+=[d,e,e,d,0,0][f];a+=[0,0,d,e,e,d][f];d=Math.floor(255*b);c=Math.floor(255*c);a=Math.floor(255*a);return{r:d,g:c,b:a,hex:"#"+(16777216|a|c<<8|d<<16).toString(16).slice(1)}}function g(a){var b=a.r,c=a.g,d=a.b;if(1<a.r||1<a.g||1<a.b)b/=255,c/=255,d/=255;var e;a=Math.max(b,c,d);e=a-Math.min(b,c,d);b=(0==e?0:a==b?(c-d)/e+(c<d?6:0):a==c?(d-b)/e+2:(b-c)/e+4)%6*60;return{h:b,s:0==e?0:e/a,v:a}}
function h(b,d,g){return function(h){h=h||a.event;h=e(h);b.h=h.y/d.offsetHeight*360+u;b.s=b.v=1;var k=f({h:b.h,s:1,v:1});g.style.backgroundColor=k.hex;b.callback&&b.callback(k.hex,{h:b.h-u,s:b.s,v:b.v},{r:k.r,g:k.g,b:k.b},c,h)}}function k(b,c){return function(d){d=d||a.event;d=e(d);var g=c.offsetHeight;b.s=d.x/c.offsetWidth;b.v=(g-d.y)/g;g=f(b);b.callback&&b.callback(g.hex,{h:b.h-u,s:b.s,v:b.v},{r:g.r,g:g.g,b:g.b},d)}}function l(a,b,c){if(!(this instanceof l))return new l(a,b,c);this.h=0;this.v=this.s=
1;if(c)this.callback=c,this.pickerElement=b,this.slideElement=a;else{a.innerHTML=w;this.slideElement=a.getElementsByClassName("slide")[0];this.pickerElement=a.getElementsByClassName("picker")[0];var d=a.getElementsByClassName("slide-indicator")[0],e=a.getElementsByClassName("picker-indicator")[0];l.fixIndicators(d,e);this.callback=function(a,c,f,g,h){l.positionIndicators(d,e,h,g);b(a,c,f)}}if("SVG"==q){a=t.cloneNode(!0);c=s.cloneNode(!0);var f=a.getElementById("gradient-hsv"),g=a.getElementsByTagName("rect")[0];
f.id="gradient-hsv-"+B;g.setAttribute("fill","url(#"+f.id+")");f=[c.getElementById("gradient-black"),c.getElementById("gradient-white")];g=c.getElementsByTagName("rect");f[0].id="gradient-black-"+B;f[1].id="gradient-white-"+B;g[0].setAttribute("fill","url(#"+f[1].id+")");g[1].setAttribute("fill","url(#"+f[0].id+")");this.slideElement.appendChild(a);this.pickerElement.appendChild(c);B++}else this.slideElement.innerHTML=t,this.pickerElement.innerHTML=s;m(this.slideElement,"click",h(this,this.slideElement,
this.pickerElement));m(this.pickerElement,"click",k(this,this.pickerElement));n(this,this.slideElement,h(this,this.slideElement,this.pickerElement));n(this,this.pickerElement,k(this,this.pickerElement))}function m(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function n(a,b,c){var d=!1;m(b,"mousedown",function(a){d=!0});m(b,"mouseup",function(a){d=!1});m(b,"mouseout",function(a){d=!1});m(b,"mousemove",function(a){d&&c(a)})}function p(a,b,c,d){a.h=b.h%
360;a.s=b.s;a.v=b.v;b=f(a);var e={y:a.h*a.slideElement.offsetHeight/360,x:0},g=a.pickerElement.offsetHeight,g={x:a.s*a.pickerElement.offsetWidth,y:g-a.v*g};a.pickerElement.style.backgroundColor=f({h:a.h,s:1,v:1}).hex;a.callback&&a.callback(d||b.hex,{h:a.h,s:a.s,v:a.v},c||{r:b.r,g:b.g,b:b.b},g,e);return a}var q=a.SVGAngle||b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",s,t,u=15,v="http://www.w3.org/2000/svg",w='<div class="picker-wrapper"><div class="picker"></div><div class="picker-indicator"></div></div><div class="slide-wrapper"><div class="slide"></div><div class="slide-indicator"></div></div>';
"SVG"==q?(t=d("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[d("defs",{},d("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[d("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),d("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),d("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),d("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),d("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),
d("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),d("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),d("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),d("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),s=d("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[d("defs",{},[d("linearGradient",{id:"gradient-black",x1:"0%",
y1:"100%",x2:"0%",y2:"0%"},[d("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),d("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[d("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),d("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),d("rect",{x:"0",y:"0",width:"100%",height:"100%",
fill:"url(#gradient-black)"})])):"VML"==q&&(t='<DIV style="position: relative; width: 100%; height: 100%"><v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill></v:rect></DIV>',s='<DIV style="position: relative; width: 100%; height: 100%"><v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill></v:rect><v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill></v:rect></DIV>',
b.namespaces.v||b.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"));var B=0;l.hsv2rgb=function(a){a=f(a);delete a.hex;return a};l.hsv2hex=function(a){return f(a).hex};l.rgb2hsv=g;l.rgb2hex=function(a){return f(g(a)).hex};l.hex2hsv=function(a){return g(l.hex2rgb(a))};l.hex2rgb=function(a){return{r:parseInt(a.substr(1,2),16),g:parseInt(a.substr(3,2),16),b:parseInt(a.substr(5,2),16)}};l.prototype.setHsv=function(a){return p(this,a)};l.prototype.setRgb=function(a){return p(this,g(a),
a)};l.prototype.setHex=function(a){return p(this,l.hex2hsv(a),c,a)};l.positionIndicators=function(a,b,c,d){c&&(b.style.left="auto",b.style.right="0px",b.style.top="0px",a.style.top=c.y-a.offsetHeight/2+"px");d&&(b.style.top=d.y-b.offsetHeight/2+"px",b.style.left=d.x-b.offsetWidth/2+"px")};l.fixIndicators=function(a,b){b.style.pointerEvents="none";a.style.pointerEvents="none"};a.ColorPicker=l}(window,window.document);AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ContextMenu=function(a){this.viewer=a;this.menus=[];this.open=!1;this.itemWidth=100;this.itemHeight=25};Autodesk.Viewing.Private.ContextMenu.prototype.constructor=Autodesk.Viewing.Private.ContextMenu;
Autodesk.Viewing.Private.ContextMenu.prototype.show=function(a,b){var c=this.viewer.api.container.getBoundingClientRect(),e=a.clientX-c.left,c=a.clientY-c.top;if(!1==this.open){var d=this;this.showMenu(b,0,e,c);this.open=!0;this.hideEventListener=function(a){"menuItem"!=a.target.className&&d.hide(a)};document.body.addEventListener("mousedown",this.hideEventListener,!0)}};
Autodesk.Viewing.Private.ContextMenu.prototype.showMenu=function(a,b,c,e){0>c&&(c=0);0>e&&(e=0);c+this.itemWidth+10>this.viewer.canvas.width&&(c=this.viewer.canvas.width-this.itemWidth-10);e+Object.keys(a).length*this.itemHeight>this.viewer.canvas.height&&(e=this.viewer.canvas.height-Object.keys(a).length*this.itemHeight);var d=document.createElement("div");d.width=this.itemWidth;d.className="menu";d.style.top=e+"px";d.style.left=c+"px";d.style.zIndex=10;this.viewer.api.container.appendChild(d);var f=
0,g;for(g in a){var h=this.createMenuItem(d,g,f),f=f+this.itemHeight;"object"==typeof a[g]?this.addSubMenuClickToMenuItem(h,b,a[g],c+this.itemWidth+10,e+f):"function"==typeof a[g]?this.addCallbackToMenuItem(h,a[g]):console.warn("Invalid option",a,g)}d.style.height=f+"px";null!=this.menus[b]&&this.menus[b].parentNode.removeChild(this.menus[b]);this.menus[b]=d};
Autodesk.Viewing.Private.ContextMenu.prototype.createMenuItem=function(a,b,c){c=document.createElement("div");c.className="menuItem";c.innerHTML=b;a.appendChild(c);return c};Autodesk.Viewing.Private.ContextMenu.prototype.addSubMenuClickToMenuItem=function(a,b,c,e,d){var f=this;a.addEventListener("click",function(){f.showMenu(c,b+1,e,d)})};
Autodesk.Viewing.Private.ContextMenu.prototype.addCallbackToMenuItem=function(a,b){var c=this;a.addEventListener("click",function(a){c.hide();b();a.preventDefault();return!1})};Autodesk.Viewing.Private.ContextMenu.prototype.hide=function(){if(this.open){for(var a=0;a<this.menus.length;++a)this.menus[a]&&this.menus[a].parentNode.removeChild(this.menus[a]);this.menus=[];this.open=!1;document.body.removeEventListener("mousedown",this.hideEventListener);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ObjectContextMenu=function(a){this.viewerImpl=a;this.contextMenu=new Autodesk.Viewing.Private.ContextMenu(a)};Autodesk.Viewing.Private.ObjectContextMenu.prototype.constructor=Autodesk.Viewing.Private.ObjectContextMenu;
Autodesk.Viewing.Private.ObjectContextMenu.prototype.show=function(a){for(var b=this,c={},e=b.viewerImpl.selector.selectedObjects.length,d=!1,f=!1,g=0;g<e&&(Autodesk.Viewing.Private.VisibilityManager.isVisible(b.viewerImpl.selector.selectedObjects[g])?d=!0:f=!0,!d||!f);g++);0<e&&(c.Isolate=function(){var a=b.viewerImpl.selector.getSelection();b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.isolateMultiple(a)},d&&(c["Hide Selected"]=function(){var a=b.viewerImpl.selector.getSelection();
b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.hideMultiple(a)}),f&&(c["Show Selected"]=function(){var a=b.viewerImpl.selector.getSelection();b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.showMultiple(a)}));c["Show All"]=function(){b.viewerImpl.visibilityManager.isolate(null)};0<e&&(c.Focus=function(){b.viewerImpl.api.fitToView()});this.contextMenu.show(a,c);return!1};Autodesk.Viewing.Private.ObjectContextMenu.prototype.hide=function(){return this.contextMenu.hide()};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.RenderOptionsPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RenderOptionsPanel","Rendering Options",{shadow:!0});this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:70});this.scrollpanel.style.marginTop="20px";this.container.appendChild(this.scrollpanel);this.scrollpanel.appendChild(this.table);
this.container.style.width="364px";this.container.style.top="260px";this.container.style.left="220px";this.container.style.height="500px";this.container.dockRight=!0;var c=[],e;for(e in a.BackgroundPresets)c.push(e);this.bgSelect=new Autodesk.Viewing.Private.OptionDropDown("Background Color",this.tbody,c,-1);this.updateBgColorIndex();this.bgSelect.addEventListener("change",function(c){c=a.BackgroundPresets[b.bgSelect.value];a.prefs.set("backgroundColorPreset",JSON.stringify(c));a.impl.setClearColors(c[0],
c[1],c[2],c[3],c[4],c[5])});this.saoToggle=new Autodesk.Viewing.Private.OptionCheckbox("AO Enabled:",this.tbody,!0);this.saoToggle.addEventListener("change",function(c){c=b.saoToggle.checked;a.prefs.set("ambientShadows",c);a.setQualityLevel(c,a.impl.renderer.settings.antialias)});this.saoRadius=new Autodesk.Viewing.Private.OptionSlider("AO Radius",0,100,this.tbody);this.saoRadius.setValue(10);this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=1;this.saoRadius.addEventListener("change",
function(c){a.impl.renderer.setAOOptions(b.saoRadius.value,b.saoIntensity.value);a.impl.renderer.composeFinalFrame(!1)});this.saoIntensity=new Autodesk.Viewing.Private.OptionSlider("AO Intensity",0,3,this.tbody);this.saoIntensity.setValue(0.75);this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=0.1;this.saoIntensity.addEventListener("change",function(c){a.impl.renderer.setAOOptions(b.saoRadius.value,b.saoIntensity.value);a.impl.renderer.composeFinalFrame(!1)});c=[];for(e=0;e<
a.impl.LightPresets.length;e++)c.push(a.impl.LightPresets[e].name);this.envSelect=new Autodesk.Viewing.Private.OptionDropDown("Environment Light",this.tbody,c,a.impl.currentLightPreset);this.envSelect.addEventListener("change",function(c){c=b.envSelect.selectedIndex;a.prefs.set("lightPreset",c);a.impl.setLightPreset(c)});c=a.impl.renderer.getToneMapMethod();this.toneMapMethod=new Autodesk.Viewing.Private.OptionDropDown("Tonemap method",this.tbody,"None Linear Reinhard Filmic Exp Canon".split(" "),
c);this.toneMapMethod.addEventListener("change",function(c){c=a.impl.renderer.getToneMapMethod();var e=b.toneMapMethod.selectedIndex;a.impl.renderer.setTonemapMethod(e);if(0==e&&0!=c||0==c&&0!=e)c=0==e?1:1.7,b.gamma.setValue(c),a.impl.renderer.setGamma(c);a.impl.fireRenderOptionChanged();a.impl.needsClear=!0});this.gamma=new Autodesk.Viewing.Private.OptionSlider("Gamma",0,5,this.tbody);this.gamma.setValue(a.impl.renderer.getGamma());this.gamma.sliderElement.step=this.gamma.stepperElement.step=0.05;
this.gamma.addEventListener("change",function(c){a.impl.renderer.setGamma(b.gamma.value);a.impl.renderer.composeFinalFrame(!1)});this.gamma.setDisabled(0==c);this.exposureBias=new Autodesk.Viewing.Private.OptionSlider("Exposure bias",-30,30,this.tbody);this.exposureBias.setValue(a.impl.renderer.getExposureBias());this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=0.1;this.exposureBias.addEventListener("change",function(c){a.impl.renderer.setExposureBias(b.exposureBias.value,
b.whiteScale.value);a.impl.needsClear=!0});this.exposureBias.setDisabled(0==c);this.whiteScale=new Autodesk.Viewing.Private.OptionSlider("White Point Intensity",-5,20,this.tbody);c=0;a.impl.dir_light1&&(c=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1E-20);this.whiteScale.setValue(c);this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=0.1;this.whiteScale.addEventListener("change",function(c){a.impl.dir_light1.intensity=Math.pow(2,b.whiteScale.value);
a.impl.renderer.setExposureBias(b.exposureBias.value,b.whiteScale.value);a.impl.needsClear=!0});this.fovAngle=new Autodesk.Viewing.Private.OptionSlider("Field of View (degrees)",6.88,100,this.tbody);this.fovAngle.setValue(a.getFOV());this.fovAngle.addEventListener("change",function(c){a.setFOV(parseFloat(b.fovAngle.value))});this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(c){c=parseFloat(b.fovAngle.value);var e=a.getFOV();c!=e&&b.fovAngle.setValue(e)});this.viewer.addEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,
function(a){b.syncUI()})};Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel;
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.updateBgColorIndex=function(){var a=this.viewer.impl,b=a.clearColorTop,c=a.clearColorBottom,b=[255*b.x|0,255*b.y|0,255*b.z|0,255*c.x|0,255*c.y|0,255*c.z|0],e,d;for(d in a.BackgroundPresets){var c=a.BackgroundPresets[d],f;for(f=0;6>f&&c[f]==b[f];f++);if(6==f){e=d;break}}if(!e)for(e="Custom",a=a.BackgroundPresets[e],d=0;6>d;d++)a[d]=b[d];this.bgSelect.setSelectedValue(e)};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var a=this.viewer.impl,b=0;a.dir_light1&&(b=0!=a.dir_light1.intensity?Math.log(a.dir_light1.intensity)/Math.log(2):-1E-20);this.whiteScale.setValue(b);this.exposureBias.setValue(a.renderer.getExposureBias());this.gamma.setValue(a.renderer.getGamma());this.updateBgColorIndex();b=a.renderer.getToneMapMethod();this.toneMapMethod.setSelectedIndex(b);this.envSelect.setSelectedIndex(a.currentLightPreset);this.gamma.setDisabled(0==b);
this.exposureBias.setDisabled(0==b);this.saoToggle.setValue(a.renderer.settings.sao);this.saoRadius.setDisabled(!a.renderer.settings.sao);this.saoIntensity.setDisabled(!a.renderer.settings.sao)};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.fovAngle=this.whiteScale=this.exposureBias=this.gamma=this.toneMapMethod=this.envSelect=this.saoIntensity=this.saoRadius=this.saoToggle=this.bgSelect=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.LayersPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"LayersPanel","Layer Manager",{shadow:!0});this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:50});this.container.appendChild(this.scrollpanel);this.scrollpanel.appendChild(this.table);this.container.style.width=
"300px";this.container.style.top="180px";this.container.style.left="220px";this.container.style.height="460px";this.container.dockRight=!0;this.container.style.display="none";this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){b.syncUI()})};Autodesk.Viewing.Private.LayersPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.LayersPanel.prototype.constructor=Autodesk.Viewing.Private.LayersPanel;
Autodesk.Viewing.Private.LayersPanel.prototype.syncUI=function(){this.tbody.innerHTML="";if(this.viewer.model&&this.viewer.model){this.layerCheckboxes=[];var a=this.viewer.model.getLayersList();if(a)for(var b=this,c=0;c<a.length;c++){var e=this.layerCheckboxes[c]=new Autodesk.Viewing.Private.OptionCheckbox(a[c].name||"Layer "+a[c].index,this.tbody,!0);e.layer=a[c].index;e.addEventListener("change",function(a){b.viewer.impl.toggleLayerVisibility(a.detail.target.layer,a.detail.target.checked)},!1)}}};
Autodesk.Viewing.Private.LayersPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.scrollpanel=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.NavigationTab=1;Autodesk.Viewing.Private.PerformanceTab=2;
Autodesk.Viewing.Private.Viewer3dSettingsPanel=function(a){this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"Viewer3dSettingsPanel","Settings",{shadow:!0});this.container.style.minWidth="425px";this.container.style.maxWidth="800px";this.container.style.height="385px";this.container.style.top="200px";this.container.style.left="220px";this.container.style.resize="none";this.container.style.position="absolute";this.container.dockRight=!0;this.main=document.createElement("div");this.main.className=
"viewer-tabs";this.container.appendChild(this.main);this.tabs=document.createElement("ul");this.tab1=document.createElement("li");this.tab1.id="navigationtab";this.tab2=document.createElement("li");this.tab2.id="performancetab";var b=document.createElement("a"),c=document.createElement("span");c.innerHTML="Navigation & selection";b.appendChild(c);var c=document.createElement("a"),e=document.createElement("span");e.innerHTML="Performance & appearance";c.appendChild(e);this.tab1.appendChild(b);this.tab2.appendChild(c);
this.tabs.appendChild(this.tab1);this.tabs.appendChild(this.tab2);this.main.appendChild(this.tabs);this.table1=document.createElement("table");this.table1.className="viewer-table tftable";this.tbody1=document.createElement("tbody");this.table1.appendChild(this.tbody1);this.table2=document.createElement("table");this.table2.className="viewer-table tftable";this.tbody2=document.createElement("tbody");this.table2.appendChild(this.tbody2);this.container.appendChild(this.table1);this.container.appendChild(this.table2);
b=document.createElement("div");b.className="viewer-restore-defaults";c=document.createElement("label");c.textContent="Restore defaults";b.appendChild(c);b.addEventListener("click",function(){a.prefs.reset()},!1);this.container.appendChild(b);this.mouseOver=!1;this.selectTab(Autodesk.Viewing.Private.NavigationTab);var d=this;this.tab1.addEventListener("click",function(a){d.selectTab(Autodesk.Viewing.Private.NavigationTab)});this.tab2.addEventListener("click",function(a){d.selectTab(Autodesk.Viewing.Private.PerformanceTab)});
this.createNavigationPanel(this.tbody1);this.createPerformancePanel(this.tbody2);this.container.addEventListener("mouseover",function(a){a=a.toElement||a.relatedTarget;if(d.mouseOver)return!0;for(;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),d.mouseOver=!0,Autodesk.Viewing.Private.removeClass(d.tab1,"selectedmouseout"),Autodesk.Viewing.Private.removeClass(d.tab2,"selectedmouseout"),!0;a=a.parentNode}});this.container.addEventListener("mouseout",
function(a){a=a.toElement||a.relatedTarget;if(d.mouseOver){for(;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),!1;a=a.parentNode}d.mouseOver=!1;a=Autodesk.Viewing.Private.hasClass(d.tab1,"tabselected")?d.tab1:d.tab2;Autodesk.Viewing.Private.addClass(a,"selectedmouseout")}})};Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.constructor=Autodesk.Viewing.Private.Viewer3dSettingsPanel;Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.container=null};Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.setVisible=function(a){a&&(this.container.style.display="block");Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a)};
Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.selectTab=function(a){a===Autodesk.Viewing.Private.NavigationTab?(this.table1.style.display="table",this.table2.style.display="none",Autodesk.Viewing.Private.addClass(this.tab1,"tabselected"),Autodesk.Viewing.Private.removeClass(this.tab2,"tabselected"),this.mouseOver||(Autodesk.Viewing.Private.addClass(this.tab1,"selectedmouseout"),Autodesk.Viewing.Private.removeClass(this.tab2,"selectedmouseout")),this.container.style.height="385px"):a===
Autodesk.Viewing.Private.PerformanceTab&&(this.table1.style.display="none",this.table2.style.display="table",Autodesk.Viewing.Private.addClass(this.tab2,"tabselected"),Autodesk.Viewing.Private.removeClass(this.tab1,"tabselected"),this.mouseOver||(Autodesk.Viewing.Private.addClass(this.tab2,"selectedmouseout"),Autodesk.Viewing.Private.removeClass(this.tab1,"selectedmouseout")),this.container.style.height="295px")};
Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.addOptionCheckbox=function(a,b,c,e,d){var f=this.viewer,g=f.prefs.values[d],h=new Autodesk.Viewing.Private.OptionCheckbox(a,b,null!==g?g:c);h.addEventListener("change",function(a){a=a.detail.target.checked;f.prefs.set(d,a);e(a)});f.prefs.addResetListener(d,function(a){h.setValue(a);e(a)});return h};
Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.createNavigationPanel=function(a){var b=this.viewer;this.viewcube=this.addOptionCheckbox("Show ViewCube",a,!0,function(a){b.displayViewCube(a)},"viewCube");this.viewcubeonpivot=this.addOptionCheckbox("ViewCube acts on pivot",a,!1,function(a){b.navigation.setUsePivotAlways(a)},"alwaysUsePivot");this.reverse=this.addOptionCheckbox("Reverse mouse zoom direction",a,!1,function(a){b.navigation.setReverseZoomDirection(a)},"reverseMouseZoomDir");this.zoom=
this.addOptionCheckbox("Zoom towards pivot",a,!1,function(a){b.navigation.setZoomTowardsPivot(a)},"zoomTowardsPivot");this.orbit=this.addOptionCheckbox("Orbit past world poles",a,!0,function(a){b.navigation.setOrbitPastWorldPoles(a)},"orbitPastWorldPoles");this.setpivot=this.addOptionCheckbox("Set pivot with left mouse button",a,!1,function(a){b.setClickToSetCOI(a)},"clickToSetCOI");this.propertiesOnSelect=this.addOptionCheckbox("Open properties on select",a,!0,function(a){b.setPropertiesOnSelect(a)},
"openPropertiesOnSelect");this.leftHanded=this.addOptionCheckbox("Left handed mouse setup",a,!1,function(a){b.navigation.setUseLeftHandedInput(a)},"leftHandedMouseSetup")};
Autodesk.Viewing.Private.Viewer3dSettingsPanel.prototype.createPerformancePanel=function(a){var b=this.viewer;this.ghosthidden=this.addOptionCheckbox("Ghost hidden objects",a,!0,function(a){b.setGhosting(a)},"ghosting");this.optimizeNavigation=this.addOptionCheckbox("Smooth navigation",a,!1,function(a){b.setOptimizeNavigation(a)},"optimizeNavigation");this.ambientshadows=this.addOptionCheckbox("Ambient shadows",a,!0,function(a){b.setQualityLevel(a,b.prefs.values.antialiasing)},"ambientShadows");this.antialiasing=
this.addOptionCheckbox("Anti-aliasing",a,!0,function(a){b.setQualityLevel(b.prefs.values.ambientShadows,a)},"antialiasing");this.progressiveRender=this.addOptionCheckbox("Progressive model display",a,!0,function(a){b.setProgressiveRendering(a)},"progressiveRendering")};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.AlertBox=function(){};Autodesk.Viewing.Private.AlertBox.instances=[];
Autodesk.Viewing.Private.AlertBox.displayError=function(a,b,c,e,d){var f=document.createElement("div");f.className="alertBox error";a.appendChild(f);e||(e=RESOURCE_ROOT+"icons/error_item_not_found.png");var g=document.createElement("img");g.className="alertBoxImage";g.src=e;f.appendChild(g);e=document.createElement("div");e.className="alertBoxMsg";f.appendChild(e);c||(c="Error Occurred");g=document.createElement("div");g.className="alertBoxTitle";g.textContent=c;e.appendChild(g);c=document.createElement("div");
c.className="alertBoxText";c.textContent=b;e.appendChild(c);d&&(b=document.createElement("div"),b.className="alertBoxContent",b.appendChild(d),e.appendChild(b));d=document.createElement("div");d.className="alertBoxOK";d.textContent="OK";var h={alertBox:f,container:a};d.addEventListener("click",function(b){f.style.visibility="hidden";a.removeChild(f);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(h),1)});f.appendChild(d);f.style.visibility="visible";
Autodesk.Viewing.Private.AlertBox.instances.push(h)};Autodesk.Viewing.Private.AlertBox.dismiss=function(){if(0<Autodesk.Viewing.Private.AlertBox.instances.length){var a=Autodesk.Viewing.Private.AlertBox.instances.pop();a.alertBox.style.visibility="hidden";a.container.removeChild(a.alertBox);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.TreeDelegate=function(){};Autodesk.Viewing.UI.TreeDelegate.prototype.constructor=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.UI.TreeDelegate.prototype.isTreeNodeGroup=function(a){throw"isTreeNodeGroup is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeId=function(a){throw"getTreeNodeId is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeLabel=function(a){return a.name};
Autodesk.Viewing.UI.TreeDelegate.prototype.shouldCreateTreeNode=function(a){return!0};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeDoubleClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeRightClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeEnter=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeLeave=function(a,b,c){};
Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeHover=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeClass=function(a){return""};
Autodesk.Viewing.UI.Tree=function(a,b,c,e){this.myDelegate=a;this.mySelectedIds=[];this.myOptions=e;"string"===typeof c?(a=c,c=document.getElementById(a)):a=c.id;this.myRootContainerId=a+"-treeview";this.myInternalIds=[];this.myInternalIdCounter=0;this.myGroupNodes=[];c=this.createHtmlElement_(c,"div",this.myRootContainerId,"treeview");this.createElement_(b,c)};Autodesk.Viewing.UI.Tree.prototype.constructor=Autodesk.Viewing.UI.Tree;
Autodesk.Viewing.UI.Tree.prototype.show=function(a){document.getElementById(this.myRootContainerId).style.display=a?"block":"none"};Autodesk.Viewing.UI.Tree.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.UI.Tree.prototype.delegate=function(){return this.myDelegate};Autodesk.Viewing.UI.Tree.prototype.isCollapsed=function(a){return this.hasClass(a,"collapsed")};
Autodesk.Viewing.UI.Tree.prototype.setCollapsed=function(a,b){var c=this.isCollapsed(a);if(b){if(!c)return this.addClass(a,"collapsed"),this.removeClass(a,"expanded"),!0}else if(c)return this.addClass(a,"expanded"),this.removeClass(a,"collapsed"),!0;return!1};
Autodesk.Viewing.UI.Tree.prototype.setAllCollapsed=function(a){var b;a?(a=function(a){return Autodesk.Viewing.Private.hasClass(a,"expanded")},b=function(a){Autodesk.Viewing.Private.addClass(a,"collapsed");Autodesk.Viewing.Private.removeClass(a,"expanded")}):(a=function(a){return Autodesk.Viewing.Private.hasClass(a,"collapsed")},b=function(a){Autodesk.Viewing.Private.addClass(a,"expanded");Autodesk.Viewing.Private.removeClass(a,"collapsed")});for(var c=0;c<this.myGroupNodes.length;++c){var e=this.myGroupNodes[c];
a(e)&&b(e)}};Autodesk.Viewing.UI.Tree.prototype.addToSelection=function(a){for(var b=a.length,c=0;c<b;++c){var e=a[c],d;d=e;-1===this.mySelectedIds.indexOf(d)?(this.mySelectedIds.push(d),d=!0):d=!1;d&&this.addClass(e,"selected")}};Autodesk.Viewing.UI.Tree.prototype.removeFromSelection=function(a){for(var b=a.length-1;0<=b;--b){var c=a[b],e;e=this.mySelectedIds.indexOf(c);-1!==e?(this.mySelectedIds.splice(e,1),e=!0):e=!1;e&&this.removeClass(c,"selected")}};
Autodesk.Viewing.UI.Tree.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};Autodesk.Viewing.UI.Tree.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.UI.Tree.prototype.isSelected=function(a){return this.hasClass(a,"selected")};
Autodesk.Viewing.UI.Tree.prototype.addClass=function(a,b){var c=this.getInternalId_(a,!1);c&&(c=document.getElementById(c),Autodesk.Viewing.Private.addClass(c,b))};Autodesk.Viewing.UI.Tree.prototype.removeClass=function(a,b){var c=this.getInternalId_(a,!1);c&&(c=document.getElementById(c),Autodesk.Viewing.Private.removeClass(c,b))};
Autodesk.Viewing.UI.Tree.prototype.hasClass=function(a,b){var c=this.getInternalId_(a,!1);return c?(c=document.getElementById(c),Autodesk.Viewing.Private.hasClass(c,b)):!1};Autodesk.Viewing.UI.Tree.prototype.getInternalId_=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};
Autodesk.Viewing.UI.Tree.prototype.createElement_=function(a,b){function c(b){d.myDelegate.onTreeNodeEnter(d,a,b);d.myDelegate.onTreeNodeHover(d,a,b);b.stopPropagation();b.preventDefault()}function e(b){d.myDelegate.onTreeNodeLeave(d,a,b);d.myDelegate.onTreeNodeHover(d,a,b);b.stopPropagation();b.preventDefault()}if(a&&this.myDelegate.shouldCreateTreeNode(a)){var d=this,f=d.myDelegate.getTreeNodeId(a),f=this.getInternalId_(f,!0),g,h;if(d.myDelegate.isTreeNodeGroup(a))for(g=d.createHtmlElement_(b,"group",
f,"expanded"),d.myGroupNodes.push(g),f=d.createHtmlElement_(g,"header","header"+f),h=d.createHtmlElement_(f,"icon"),h.addEventListener("click",function(a){Autodesk.Viewing.Private.toggleClass(g,"collapsed");Autodesk.Viewing.Private.toggleClass(g,"expanded");a.stopPropagation();a.preventDefault()},!1),f=d.createHtmlElement_(f,"label"),f.textContent=d.myDelegate.getTreeNodeLabel(a),f=a.children?a.children.length:0,h=0;h<f;++h)d.createElement_(a.children[h],g);else g=d.createHtmlElement_(b,"leaf",f),
f=d.createHtmlElement_(g,"header","header"+f),h=d.createHtmlElement_(f,"icon"),f=d.createHtmlElement_(f,"label"),f.textContent=d.myDelegate.getTreeNodeLabel(a);g.addEventListener("click",function(b){d.myDelegate.onTreeNodeClick(d,a,b);b.stopPropagation();b.preventDefault()},!1);g.addEventListener("dblclick",function(b){d.myDelegate.onTreeNodeDoubleClick(d,a,b);b.stopPropagation();b.preventDefault()},!1);g.addEventListener("contextmenu",function(b){d.myDelegate.onTreeNodeRightClick(d,a,b);b.stopPropagation();
b.preventDefault()},!1);g.addEventListener("mouseenter",function(a){c(a)},!1);g.addEventListener("mouseleave",function(a){e(a)},!1);g.addEventListener("mouseover",function(a){c(a)},!1);g.addEventListener("mouseout",function(a){e(a)},!1);Autodesk.Viewing.Private.addClass(g,d.myDelegate.getTreeNodeClass(a))}};Autodesk.Viewing.UI.Tree.prototype.createHtmlElement_=function(a,b,c,e){b=document.createElement(b);a.appendChild(b);c&&(b.id=c);e&&(b.className=e);return b};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.TreeDelegate=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.Private.TreeDelegate.prototype=Autodesk.Viewing.UI.TreeDelegate.prototype;Autodesk.Viewing.Private.Tree=Autodesk.Viewing.UI.Tree;Autodesk.Viewing.Private.Tree.prototype=Autodesk.Viewing.UI.Tree.prototype;AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.BrowserDelegate=function(){};Autodesk.Viewing.Private.BrowserDelegate.prototype.constructor=Autodesk.Viewing.Private.BrowserDelegate;Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeId=function(a){throw"getId is not implemented.";};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeLabel=function(a){return a.name};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeClass=function(a){return""};
Autodesk.Viewing.Private.BrowserDelegate.prototype.hasThumbnail=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.getThumbnail=function(a){return null};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeClick=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeHover=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasContent=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.addContent=function(a,b){};
Autodesk.Viewing.Private.Browser=function(a,b,c,e){this.myDelegate=a;this.mySelectedIds=[];this.myParentContainderId=c;this.myRootContainerId=c+"-browserview";this.myInternalIds=[];this.myInternalIdCounter=0;this.jQuery=(this.myOptions=e)&&e.jQuery?e.jQuery:$;this.jQuery('<div id="'+this.myRootContainerId+'" class="browserview"></div>').appendTo("#"+this.myParentContainderId);this.createElements(b,this.myRootContainerId)};Autodesk.Viewing.Private.Browser.prototype.constructor=Autodesk.Viewing.Private.Browser;
Autodesk.Viewing.Private.Browser.prototype.show=function(a){a?this.jQuery("#"+this.myRootContainerId).fadeIn():this.jQuery("#"+this.myRootContainerId).hide()};Autodesk.Viewing.Private.Browser.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.Private.Browser.prototype.delegate=function(){return this.myDelegate};
Autodesk.Viewing.Private.Browser.prototype.addToSelection=function(a){for(var b in a){var c=a[b],e;e=c;-1==this.mySelectedIds.indexOf(e)?(this.mySelectedIds.push(e),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).addClass("selected"))}};Autodesk.Viewing.Private.Browser.prototype.removeFromSelection=function(a){for(var b in a){var c=a[b],e;e=this.mySelectedIds.indexOf(c);-1!=e?(this.mySelectedIds.splice(e,1),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).removeClass("selected"))}};
Autodesk.Viewing.Private.Browser.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};Autodesk.Viewing.Private.Browser.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.Private.Browser.prototype.getInternalId=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};
Autodesk.Viewing.Private.Browser.prototype.createElements=function(a,b){if(a)for(var c=0;c<a.length;c++)this.createElement(a[c],b)};
Autodesk.Viewing.Private.Browser.prototype.createElement=function(a,b){var c=this,e=c.myDelegate.getNodeId(a),e=c.getInternalId(e,!0),d="#"+e;this.jQuery('<item id="'+e+'"></item>').appendTo(this.jQuery("#"+b)).hover(function(){c.myDelegate.onNodeHover(c,a)});this.jQuery("#"+e).click(function(b){c.jQuery(".flipped").removeClass("flipped");c.myDelegate.onNodeClick(c,a,b)});var f=this.jQuery('<div id="card'+e+'" class="card"></div>');f.appendTo(this.jQuery(d));var g=this.jQuery('<div class="browserElement"></div>');
g.appendTo(f);f=c.myDelegate.getNodeLabel(a);this.jQuery("<label>"+f+"</label>").appendTo(g).click(function(b){c.myDelegate.onNodeClick(c,a,b)});(f=c.myDelegate.getThumbnail(a))&&this.jQuery('<img class="thumb" src="'+f+'" ></img>').appendTo(g).click(function(b){c.myDelegate.onNodeClick(c,a,b)});c.myDelegate.hasContent(a)&&c.myDelegate.addContent(a,e);this.jQuery(d).addClass(c.myDelegate.getNodeClass(a))};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ErrorInfoData={1:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},2:{img:"icons/error_unsupported_file_type.png",header:"Oops",text:"Sorry. The item you are trying to view was not processed completely.",content:"<ul><li>Try loading the item again.</li><li>Please upload the file again to see if that fixes the issue.</li></ul>"},
3:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},4:{img:"icons/error_unlock_upload.png",header:"No access",text:"Sorry. You don\u2019t have the required privileges to access this item.",content:"<ul><li>Please contact the author.</li></ul>"},
5:{img:"icons/error_item_not_found.png",header:"Oops",text:"Sorry. We can\u2019t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.",content:'<ul><li>Try loading the item again.</li><li>Try uploading the file again to see if that fixes the issue.</li><li><a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></li></ul>'},
6:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},7:{img:"icons/error_reload_in_viewer.png",header:"Network problem",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},
8:{img:"icons/error_unsupported_file_type.png",header:"Oops",text:"Sorry. We couldn\u2019t show the item because your browser doesn\u2019t support 3D viewing.",content:'<ul><li>Please use Google Chrome, Firefox or another browser that supports WebGL 3D graphics.</li><li><a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-6BD255B4-FB67-4909-9332-3A5905076E0A" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></li></ul>'},9:{img:"icons/error_item_not_found.png",header:"No viewable content",
text:"There\u2019s nothing to display for this item. It may not have been processed or it may not have content we can display.",content:"<ul><li>Please contact the author.</li><li>Try uploading the file again to see if that fixes the issue.</li></ul>"}};Autodesk.Viewing.Private.ErrorHandler=function(){};Autodesk.Viewing.Private.ErrorHandler.prototype.constructor=Autodesk.Viewing.Private.ErrorHandler;
Autodesk.Viewing.Private.ErrorHandler.reportError=function(a,b,c){var e=Autodesk.Viewing.Private.ErrorInfoData[b];if(e){c=e.text;b=e.header;var d=RESOURCE_ROOT+e.img,e=e.content,f=null;e&&(f=document.createElement("div"),f.innerHTML=e);Autodesk.Viewing.Private.AlertBox.displayError(a,c,b,d,f)}else Autodesk.Viewing.Private.AlertBox.displayError(a,c)};
Autodesk.Viewing.Private.ErrorHandler.getErrorCode=function(a){return 403===a||401===a?Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED:404===a?Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND:500<=a?Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR:Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.ToolBar=function(a){this.parentContainer=a;this.container=document.createElement("div");this.container.className="toolbar-menuplacer";this.menu=document.createElement("ul");this.menu.className="toolbar-menu";this.container.appendChild(this.menu);this.parentContainer.appendChild(this.container);this.subToolbars={}};Autodesk.Viewing.UI.ToolBar.prototype.constructor=Autodesk.Viewing.UI.ToolBar;
Autodesk.Viewing.UI.ToolBar.createMenuButton=function(a,b,c){var e=document.createElement("li");e.className="toolbar-generic-button";e.id=a;var d=null;b&&(d=document.createElement("div"),d.className="toolbar-tooltip",d.textContent=b,d.setAttribute("tooltipText",b),e.appendChild(d));var f=document.createElement("div");f.className="toolbar-button";f.id=a+"Button";e.appendChild(f);c&&e.addEventListener("click",c);d&&(e.addEventListener("mouseover",function(a){if(a.target==e||a.target===f)d.style.visibility=
"visible"}),e.addEventListener("mouseout",function(a){if(a.target===e||a.target==f)d.style.visibility="hidden"}));return e};Autodesk.Viewing.UI.ToolBar.prototype.addSubToolbar=function(a,b){var c=new Autodesk.Viewing.UI.SubToolbar(this.menu,a,b);return this.subToolbars[a]=c};Autodesk.Viewing.UI.ToolBar.prototype.getSubToolbars=function(){return this.subToolbars};Autodesk.Viewing.UI.ToolBar.prototype.getSubToolbarById=function(a){return a in this.subToolbars?this.subToolbars[a]:null};
Autodesk.Viewing.UI.ToolBar.prototype.removeSubToolbar=function(a){if(a in this.subToolbars){var b=this.subToolbars[a];b&&(this.menu.removeChild(b.subtoolbar),delete this.subToolbars[a])}};Autodesk.Viewing.UI.ToolBar.prototype.removeAllSubToolbars=function(){for(;this.menu.firstChild;)this.menu.removeChild(this.menu.firstChild);this.subToolbars={}};Autodesk.Viewing.UI.ToolBar.prototype.addToSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].addTool(b)};
Autodesk.Viewing.UI.ToolBar.prototype.removeFromSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].removeTool(b.id)};Autodesk.Viewing.UI.ToolBar.prototype.attachSubMenu=function(a,b){a.appendChild(b)};Autodesk.Viewing.UI.ToolBar.prototype.collapse=function(a){a?Autodesk.Viewing.Private.addClass(this.container,"toolbar-menu-collapsed"):Autodesk.Viewing.Private.removeClass(this.container,"toolbar-menu-collapsed")};
Autodesk.Viewing.UI.ToolBar.prototype.isCollapsed=function(){return Autodesk.Viewing.Private.hasClass(this.container,"toolbar-menu-collapsed")};Autodesk.Viewing.UI.ToolBar.prototype.addEventListener=function(a,b){this.menu.addEventListener(a,b)};Autodesk.Viewing.UI.ToolBar.prototype.removeEventListener=function(a,b){this.menu.removeEventListener(a,b)};
Autodesk.Viewing.UI.SubToolbar=function(a,b,c){this.parentContainer=a;this.subtoolbar=document.createElement("div");this.subtoolbar.className="toolbar-subtoolbar";this.subtoolbar.id=b;this.parentContainer.appendChild(this.subtoolbar);this.buttons={};this.isRadio=c};Autodesk.Viewing.UI.SubToolbar.prototype.constructor=Autodesk.Viewing.SubToolbar;Autodesk.Viewing.UI.SubToolbar.prototype.addTool=function(a){this.buttons[a.id]=a;this.subtoolbar.appendChild(a)};
Autodesk.Viewing.UI.SubToolbar.prototype.removeTool=function(a){a in this.buttons&&(this.subtoolbar.removeChild(this.buttons[a]),delete this.buttons[a])};Autodesk.Viewing.UI.SubToolbar.prototype.getTool=function(a){return a in this.buttons?this.buttons[a]:null};Autodesk.Viewing.UI.SubToolbar.prototype.getToolCount=function(){return this.subtoolbar.children?this.subtoolbar.children.length:0};
Autodesk.Viewing.UI.SubToolbar.prototype.select=function(a){a in this.buttons&&(this.isRadio&&this.deselectAll(),a=this.buttons[a],Autodesk.Viewing.Private.removeClass(a.childNodes[a.childNodes.length-1],"disabled-button"))};Autodesk.Viewing.UI.SubToolbar.prototype.deselect=function(a){a in this.buttons&&(a=this.buttons[a],Autodesk.Viewing.Private.addClass(a.childNodes[a.childNodes.length-1],"disabled-button"))};
Autodesk.Viewing.UI.SubToolbar.prototype.deselectAll=function(){for(var a in this.buttons)this.buttons.hasOwnProperty(a)&&this.deselect(a)};Autodesk.Viewing.UI.SubToolbar.prototype.setToolVisibility=function(a,b){a in this.buttons&&(this.buttons[a].style.display=b?"list-item":"none")};Autodesk.Viewing.UI.SubToolbar.prototype.isToolVisible=function(a){return a in this.buttons?!(this.buttons[a].style.display&&"none"===this.buttons[a].style.display):!1};
Autodesk.Viewing.UI.SubToolbar.prototype.setVisibility=function(a){this.subtoolbar.style.display=a?"":"none"};Autodesk.Viewing.UI.SubToolbar.prototype.isVisible=function(){return!(this.subtoolbar.style.display&&"none"===this.subtoolbar.style.display)};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.GEOMETRY_LOADED_EVENT="geometry_loaded";Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT="frag->node array created";Autodesk.Viewing.SELECTION_CHANGED_EVENT="selection";Autodesk.Viewing.ISOLATE_EVENT="isolate";Autodesk.Viewing.HIDE_EVENT="hide";Autodesk.Viewing.SHOW_EVENT="show";Autodesk.Viewing.HIGHLIGHT_EVENT="highlight";Autodesk.Viewing.CAMERA_CHANGE_EVENT="cameraChanged";Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged";
Autodesk.Viewing.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};
Autodesk.Viewing.Viewer3D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);if("CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvas=document.createElement("canvas");this.canvas.tabIndex=0;var c=this.getDimensions();this.canvas.width=c.width;this.canvas.height=c.height;this.container.appendChild(this.canvas);this.canvas.viewer=this;this.modelstructure=null;this.running=!1};Autodesk.Viewing.Viewer3D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);
Autodesk.Viewing.Viewer3D.prototype.constructor=Autodesk.Viewing.Viewer3D;Autodesk.Viewing.Viewer3D.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"],offObject:["deselectAll"]},clickShift:{onObject:["selectToggle"],offObject:["deselectAll"]},clickCtrlShift:{onObject:["deselectAll"],offObject:["deselectAll"]}};
Autodesk.Viewing.Viewer3D.prototype.initialize=function(){var a=this.detectWebGL();if(0>=a)return Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED;Autodesk.Viewing.Viewer.prototype.initialize.call(this);this.impl=new Autodesk.Viewing.Private.Viewer3DImpl(this.canvas,this);this.model=null;this.navigation=new Autodesk.Viewing.Navigation(this.impl.camera);this.__initAutoCam();if(4096==a)return Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED;this.setCanvasClickBehavior(this.config&&this.config.canvasConfig?
this.config.canvasConfig:Autodesk.Viewing.Viewer3D.kDefaultCanvasConfig);this.loader=document.createElement("div");this.loader.id="loader";this.loader.className="spinner";this.container.appendChild(this.loader);for(a=1;3>=a;a++){var b=document.createElement("div");b.className="bounce"+a;this.loader.appendChild(b)}this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run();return 0};
Autodesk.Viewing.Viewer3D.prototype.run=function(){this.running||(this.running=!0,this.impl.run())};
Autodesk.Viewing.Viewer3D.prototype.__initAutoCam=function(){var a=this,b=a.getCamera();b.pivot||(b.pivot=new THREE.Vector3(0,0,0));b.target||(b.target=new THREE.Vector3(0,0,0));b.worldup||(b.target=b.up.clone());a.autocamCamera=b.clone();a.autocamCamera.target=b.target.clone();a.autocamCamera.pivot=b.pivot.clone();a.autocamCamera.worldup=b.worldup.clone();a.autocam=new Autocam(a.autocamCamera,a.navigation,function(c){b.position.copy(a.autocamCamera.position);b.target.copy(a.autocamCamera.target);
b.pivot.copy(a.autocamCamera.pivot);b.up.copy(a.autocamCamera.up);b.fov=a.autocamCamera.fov;a.impl.syncCamera(c);c&&b.worldup.copy(a.autocamCamera.worldup)},function(b){a.impl.controls.pivotActive(b,!1)});a.addEventListener("cameraChanged",function(b){a.autocam.sync(b.camera)});a.autocam.sync(b);a.impl.controls.setAutocam(a.autocam)};
Autodesk.Viewing.Viewer3D.prototype.load=function(a,b,c,e){var d=this;return this.loadModel(a,null,b,function(){d.modelstructure&&d.model.getObjectTree(function(a){d.modelstructure.setModel(a,d.config.defaultModelStructureTitle?d.config.defaultModelStructureTitle:"")});c&&c()},e)};
Autodesk.Viewing.Viewer3D.prototype.uninitialize=function(a){this.canvas.parentNode.removeChild(this.canvas);this.canvas=this.canvas.viewer=null;this.navigation&&this.navigation.uninitialize();this.impl&&(this.impl.uninitialize(),this.impl=null);this.model=this.loader=null;Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};
Autodesk.Viewing.Viewer3D.prototype.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,e=0;4>e;e++)try{if((c=a.getContext(b[e]))&&"function"===typeof c.getParameter)return 1}catch(d){}return 0}return-1};
Autodesk.Viewing.Viewer3D.prototype.loadModel=function(a,b,c,e,d){var f=this;this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(a){this.impl.needsRender=!0;f.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT)});return this.impl.loadSvf(a,b,c,function(a){f.model=new Autodesk.Viewing.Model(a);f.impl.setModel(f.model);f.loader.style.display="None";e&&e()},function(a,b){f.loader.style.display="None";d&&d(a,b)})};
Autodesk.Viewing.Viewer3D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);return this.impl.resize(this.container.clientWidth,this.container.clientHeight)};Autodesk.Viewing.Viewer3D.prototype.getCamera=function(){return this.impl.camera};Autodesk.Viewing.Viewer3D.prototype.setViewFromArray=function(a){this.impl.setViewFromArray(a)};Autodesk.Viewing.Viewer3D.prototype.setViewFromFile=function(){this.impl.setViewFromFile(this.model)};
Autodesk.Viewing.Viewer3D.prototype.getProperties=function(a,b,c){this.model?this.model.getProperties(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist.")};Autodesk.Viewing.Viewer3D.prototype.getObjectTree=function(a,b){this.model?this.model.getObjectTree(a,b):b&&b(Autodesk.Viewing.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist.")};Autodesk.Viewing.Viewer3D.prototype.setCanvasClickBehavior=function(a){this.impl.controls.setClickBehavior(a)};
Autodesk.Viewing.Viewer3D.prototype.search=function(a,b,c){this.searchText=a;this.model?this.model.search(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Search failed since model does not exist.")};Autodesk.Viewing.Viewer3D.prototype.isolate=function(a){Array.isArray(a)?this.impl.visibilityManager.isolateMultiple(a):this.impl.visibilityManager.isolate(a)};
Autodesk.Viewing.Viewer3D.prototype.isolateById=function(a){function b(b){(e=d.model.getNodesByIds(Array.isArray(a)?a:[a]))&&d.isolate(e)}function c(a){this.getObjectTree(b);d.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}var e=[],d=this;this.model&&this.model.isLoadDone()?this.getObjectTree(b):this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)};Autodesk.Viewing.Viewer3D.prototype.setBackgroundColor=function(a,b,c,e,d,f){this.impl.setClearColors(a,b,c,e,d,f)};
Autodesk.Viewing.Viewer3D.prototype.toggleSelect=function(a){this.impl.selector.toggleSelectionId(a)};Autodesk.Viewing.Viewer3D.prototype.select=function(a){"number"===typeof a&&(a=[a]);this.impl.selector.setSelectionIds(a)};Autodesk.Viewing.Viewer3D.prototype.deselect=function(a){throw Error("not implemented yet");};Autodesk.Viewing.Viewer3D.prototype.clearSelection=function(){this.impl.selector.clearSelection()};
Autodesk.Viewing.Viewer3D.prototype.hide=function(a){Array.isArray(a)?this.impl.visibilityManager.hideMultiple(a):this.impl.visibilityManager.hide(a)};Autodesk.Viewing.Viewer3D.prototype.show=function(a){Array.isArray(a)?this.impl.visibilityManager.showMultiple(a):this.impl.visibilityManager.show(a)};Autodesk.Viewing.Viewer3D.prototype.showAll=function(){this.impl.visibilityManager.isolateNone()};Autodesk.Viewing.Viewer3D.prototype.hideAll=function(){throw Error("not implemented yet");};
Autodesk.Viewing.Viewer3D.prototype.toggleVisibility=function(a){this.impl.visibilityManager.toggleVisibility(a)};Autodesk.Viewing.Viewer3D.prototype.areAllVisible=function(){return this.impl.visibilityManager.areAllVisible()};Autodesk.Viewing.Viewer3D.prototype.explode=function(a){this.impl.explode(a)};Autodesk.Viewing.Viewer3D.prototype.setQualityLevel=function(a,b){this.impl.togglePostProcess(a,b)};Autodesk.Viewing.Viewer3D.prototype.setEnvironmentMap=function(a){this.impl.setCubeMap(a)};
Autodesk.Viewing.Viewer3D.prototype.setGhosting=function(a){this.impl.toggleGhosting(a)};Autodesk.Viewing.Viewer3D.prototype.setProgressiveRendering=function(a){this.impl.toggleProgressive(a)};Autodesk.Viewing.Viewer3D.prototype.setOptimizeNavigation=function(a){this.impl.setOptimizeNavigation(a)};Autodesk.Viewing.Viewer3D.prototype.getNavigationMode=function(){if("getNavigationMode"in this.impl.controls)return this.impl.controls.getNavigationMode()};
Autodesk.Viewing.Viewer3D.prototype.setNavigationMode=function(a){"setNavigationMode"in this.impl.controls&&this.impl.controls.setNavigationMode(a)};Autodesk.Viewing.Viewer3D.prototype.getFOV=function(){return"getFOV"in this.impl.controls?this.impl.controls.getFOV():this.impl.camera.fov};Autodesk.Viewing.Viewer3D.prototype.setFOV=function(a){"setFOV"in this.impl.controls?this.impl.controls.setFOV(a):(this.impl.camera.fov=a,this.impl.syncCamera())};
Autodesk.Viewing.Viewer3D.prototype.getFocalLength=function(){if("getFocalLength"in this.impl.controls)return this.impl.controls.getFocalLength();var a=THREE.Math.degToRad(this.impl.camera.fov);return Math.round(12/Math.tan(0.5*a))};Autodesk.Viewing.Viewer3D.prototype.setFocalLength=function(a){"setFocalLength"in this.impl.controls?this.impl.controls.setFocalLength(a):(this.impl.camera.setLens(a),this.impl.syncCamera())};Autodesk.Viewing.Viewer3D.prototype.hideLines=function(a){this.impl.hideLines(a)};
Autodesk.Viewing.Viewer3D.prototype.applyCamera=function(a,b){this.impl.applyCamera(a,b)};
Autodesk.Viewing.Viewer3D.prototype.fitToView=function(a){var b=this,c=!0,e=function(){var f=null;if(Array.isArray(a)&&0<a.length){for(var g=new THREE.Box3,h=new THREE.Box3,k=b.impl.selector.getFragIdsFromObjectIds(a),l=0;l<k.length;l++)if(void 0!==k[l]){var m=b.impl.getRenderProxy(b.model,k[l]);m.geometry.boundingBox.getTransformedBox(m.matrixWorld,h);g.union(h)}g.empty()||(f=g)}b.impl.controls.fitToView(!1,f);b.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,d);b.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,
e);return c},d=function(){b.model&&b.model.isLoadDone()?e():(c=!1,b.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,e))};this.model&&this.model.isObjectTreeCreated()?d():(c=!1,this.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,d))};Autodesk.Viewing.Viewer3D.prototype.setClickConfig=function(a,b,c){var e=this.impl.controls.getClickBehavior();return a in e&&(a=e[a],b in a)?(a[b]=c,!0):!1};
Autodesk.Viewing.Viewer3D.prototype.getClickConfig=function(a,b){var c=this.impl.controls.getClickBehavior();return a in c&&(c=c[a],b in c)?c[b]:null};Autodesk.Viewing.Viewer3D.prototype.setClickToSetCOI=function(a){var b=this.getClickConfig("click","onObject");a?-1===b.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):0<=b.indexOf("setCOI")&&this.setClickConfig("click","onObject",["selectOnly"])};
Autodesk.Viewing.Viewer3D.prototype.setModelStructurePanel=function(a){var b=this;return a instanceof Autodesk.Viewing.UI.ModelStructurePanel?(this.modelstructure&&this.removePanel(this.modelstructure),this.modelstructure=a,this.addPanel(this.modelstructure),b.model&&b.model.getObjectTree(function(a){b.modelstructure.setModel(a)}),!0):!1};Autodesk.Viewing.BaseViewer3D=Autodesk.Viewing.Viewer3D;AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Viewer2D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);b||(b={});b.domElement=this.container;this.impl=new Autodesk.Viewing.Private.Viewer2DImpl(this,b)};Autodesk.Viewing.Viewer2D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);Autodesk.Viewing.Viewer2D.prototype.constructor=Autodesk.Viewing.Viewer2D;Autodesk.Viewing.Viewer2D.prototype.initialize=function(){Autodesk.Viewing.Viewer.prototype.initialize.call(this);return this.impl.initialize()};
Autodesk.Viewing.Viewer2D.prototype.load=function(a,b,c,e){if(this.impl.load(a))return c&&c(),!0;e&&e();return!1};Autodesk.Viewing.Viewer2D.prototype.uninitialize=function(){this.impl.uninitialize();Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};Autodesk.Viewing.Viewer2D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);this.impl.resize()};Autodesk.Viewing.Viewer2D.prototype.setViewFromFile=function(){this.impl.goHome()};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.Document=function(a,b){function c(a){if(a){var b=a.children?a.children.length:0;if("geometry"===a.type&&"3d"===a.role&&b){for(var g=0,h=0;h<b;h++){var k=a.children[h];k&&"view"===k.type&&"3d"===k.role&&(e.myViewGeometry[k.guid]=a,g++)}e.myNumViews[a.guid]=g}else if("application/autodesk-db"==a.mime)e.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<b)for(h=0;h<b;h++)c(a.children[h])}}this.myPath=b;this.myData=a;this.myViewGeometry={};this.myNumViews={};this.myPropertyDb=
null;var e=this;c(a)};Autodesk.Viewing.Document.prototype.constructor=Autodesk.Viewing.Document;
Autodesk.Viewing.Document.load=function(a,b,c,e){function d(a,b){var c=a+": "+b.status;b.statusText&&(c+=" ("+b.statusText+")");return c}"function"!==typeof b&&(console.log("Autodesk.Viewing.Document.load called with deprecated (auth) parameter"),"function"===typeof c&&(b=c),"function"===typeof e&&(c=e));var f=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8))return a;if(-1===a.indexOf("urn:"))return 0!==a.indexOf("/")&&(a="/"+a),window.location.protocol+
"//"+window.location.host+a;a=a.substr(4);return 0==Autodesk.Viewing.Private.env.indexOf("Autodesk")?VIEWING_URL+"/"+a:VIEWING_URL+"/bubbles/"+a}(a);try{var g=new XMLHttpRequest;g.open("GET",f,!0);g.withCredentials=!0;g.setRequestHeader("Access-Control-Allow-Credentials",!0);g.setRequestHeader("Access-Control-Allow-Origin","*");g.onload=function(a){if(g.status&&200===g.status)a=g.response?g.response:g.responseText,/<[^>]*script/.test(g.responseText)?c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malicious document content detected. Abort loading."):
(a="string"===typeof a?JSON.parse(a):a,a=new Autodesk.Viewing.Document(a,f),b&&b(a));else if(c){a=d("Network error",g);var e=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);c(e,a)}};g.onerror=function(a){if(c){a=d("Load error",g);var b=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);c(b,a)}};g.ontimeout=function(a){if(c){a=d("Timeout occurred",g);var b=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);c(b,a)}};g.send()}catch(h){c&&c(Autodesk.Viewing.ErrorCodes.UNKNOWN_FAILURE,
"An exception occurred while loading the document: "+h.toString())}};Autodesk.Viewing.Document.prototype.getFullPath=function(a){var b=a;0===a.indexOf("urn")?b=VIEWING_URL+"/items/"+a:0===a.indexOf("$file$")&&-1!==this.myPath.indexOf("/output/bubble.json")&&(b=this.myPath.replace("/output/bubble.json","")+a.replace("$file$",""));return b};
Autodesk.Viewing.Document.prototype.getThumbnailPath=function(a,b,c){b=b?b:200;c=c?c:200;return VIEWING_URL+"/thumbnails/"+this.myData.urn+"?guid="+encodeURIComponent(a.guid)+"&width="+b+"&height="+c};
Autodesk.Viewing.Document.prototype.getViewablePath=function(a){if("geometry"===a.type){var b=[];"3d"===a.role?b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-svf"},!1):"2d"===a.role&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"tileRoot"},!0));if(0<b.length)return this.getFullPath(b[0].urn)}else if("view"===a.type&&(a=this.getViewGeometry(a)))return this.getViewablePath(a);return""};Autodesk.Viewing.Document.prototype.getPropertyDbPath=function(){return this.myPropertyDb};
Autodesk.Viewing.Document.prototype.getRootItem=function(){return this.myData};Autodesk.Viewing.Document.prototype.getPath=function(){return this.myPath};Autodesk.Viewing.Document.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var e in c){var d=c[e];if("guid"===e&&d===a)return c;if(null!==d&&"object"===typeof d&&(d=b(d)))return d}return null}return b(this.myData)};
Autodesk.Viewing.Document.getSubItemsWithProperties=function(a,b,c){var e=[];if(!a)return[];for(var d=a.children?a.children.length:0,f=0;f<d;f++){var g=a.children[f],h;a:{h=b;var k=void 0;for(k in h)if(!(k in g)||h[k]!==g[k]){h=!1;break a}h=!0}h&&e.push(g);c&&e.push.apply(e,Autodesk.Viewing.Document.getSubItemsWithProperties(g,b,c))}return e};Autodesk.Viewing.Document.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]};
Autodesk.Viewing.Document.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ModelUnits={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"};Autodesk.Viewing.Model=function(a){this.myData=a;this.myLoader=this.propWorker=this.sharedPath=null};Autodesk.Viewing.Model.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Model.prototype.constructor=Autodesk.Viewing.Model;Autodesk.Viewing.Model.prototype.setData=function(a){this.myData=a};Autodesk.Viewing.Model.prototype.getData=function(){return this.myData};
Autodesk.Viewing.Model.prototype.setLoader=function(a){this.myLoader=a};Autodesk.Viewing.Model.prototype.getRoot=function(){return this.myData?this.myData.instanceTree:null};Autodesk.Viewing.Model.prototype.getRootId=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.dbId:null};Autodesk.Viewing.Model.prototype.getBoundingBox=function(){return this.myData?this.myData.bbox:null};
Autodesk.Viewing.Model.prototype.getUnitScale=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return 1;case "foot":case "ft":return 0.3048;case "inch":case "in":return 0.0254;case "centimeter":case "cm":return 0.01;case "millimeter":case "mm":return 0.001;default:return 1}};
Autodesk.Viewing.Model.prototype.getUnitString=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return Autodesk.Viewing.ModelUnits.METER;case "foot":case "ft":return Autodesk.Viewing.ModelUnits.FOOT;case "inch":case "in":return Autodesk.Viewing.ModelUnits.INCH;case "centimeter":case "cm":return Autodesk.Viewing.ModelUnits.CENTIMETER;case "millimeter":case "mm":return Autodesk.Viewing.ModelUnits.MILLIMETER;default:return null}};
Autodesk.Viewing.Model.prototype.getBgColor=function(){return this.myData?this.myData.bgColor:4294967295};Autodesk.Viewing.Model.prototype.getNodeById=function(a){function b(c){if(!c)return null;if(c.dbId&&c.dbId===a)return c;if(c.children&&0<c.children.length)for(var e=0;e<c.children.length;e++){var d=b(c.children[e]);if(d)return d}return null}return b(this.getRoot())};
Autodesk.Viewing.Model.prototype.getNodesByIds=function(a){function b(a,e,d){if(0===a.length)return d;var f=a.indexOf(e.dbId);-1!==f&&(d.push(e),a.splice(f,1));if(e.children)for(f=0;f<e.children.length;f++)b(a,e.children[f],d);return d}a=a.slice(0);return b(a,this.getRoot(),[])};Autodesk.Viewing.Model.prototype.getMetadata=function(a,b,c){if(this.myData){var e=this.myData.metadata;if(e&&(a=e[a],void 0!==a))if(b){if(b=a[b],void 0!==b)return b}else return a}return c};
Autodesk.Viewing.Model.prototype.getDefaultCamera=function(){var a=this.myData;if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var e=this.getMetadata("default camera","index",null);if(null!==e&&a.cameras[e])b=a.cameras[e];else{for(e=0;e<c;e++){var d=a.cameras[e];if(d.isPerspective){b=d;break}}b||(b=a.cameras[0])}}return b};Autodesk.Viewing.Model.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)};
Autodesk.Viewing.Model.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null};Autodesk.Viewing.Model.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null};Autodesk.Viewing.Model.prototype.getLayersList=function(){return this.myData?this.myData.layersList:null};Autodesk.Viewing.Model.prototype.is2d=function(){return this.myData&&this.myData.is2d};Autodesk.Viewing.Model.prototype.isLoadDone=function(){return this.myData&&this.myData.loadDone};
Autodesk.Viewing.Model.prototype.isObjectTreeCreated=function(){return this.myData&&this.myData.fragToNodeDone};Autodesk.Viewing.Model.prototype.getProperties=function(a,b,c){this.myData&&this.myLoader&&this.myLoader.getProperties(a,b,c)};Autodesk.Viewing.Model.prototype.getObjectTree=function(a,b){this.myData&&this.myLoader&&this.myLoader.getObjectTree(a,b)};
Autodesk.Viewing.Model.prototype.search=function(a,b,c){var e=this;this.isLoadDone()?this.myLoader.searchProperties(a,b,c):this.getObjectTree(function(d){e.myLoader.searchProperties(a,b,c)})};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.Navigation=function(a){this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1};this.__transitionActive=this.__homeViewRequested=this.__fitToViewRequested=this.__pivotIsSetFlag=!1;var b=this.__destinationView=null,c={left:0,top:0,width:1,height:1};this.uninitialize=function(){this.setCamera(null)};this.setCamera=function(a){a!==b&&(b=a)&&(a.hasOwnProperty("target")||(a.target=new THREE.Vector3(0,0,0)),a.hasOwnProperty("pivot")||
(a.pivot=new THREE.Vector3(0,0,0)),a.worldup=a.up.clone(),a.dirty=!0)};this.getCamera=function(){return b};this.setScreenViewport=function(a){c=a};this.getScreenViewport=function(){return c};this.__setUp=function(a){return a&&b&&0!==a.clone().normalize().sub(b.worldup).lengthSq()?(b.worldup.copy(a).normalize(),b.dirty=!0):!1};this.__getUp=function(){return b?b.worldup:null};this.setView=function(a,c){b&&a&&c&&!this.__options.lockNavigation&&(b.position.copy(a),b.target.copy(c),b.dirty=!0)};this.getPivotPoint=
function(){return b?b.pivot.clone():new THREE.Vector3(0,0,0)};this.setPivotPoint=function(a){b&&a&&(b.pivot.copy(a),b.dirty=!0)};this.getPosition=function(){return b?b.position.clone():new THREE.Vector3(0,0,1)};this.setPosition=function(a){b&&a&&!this.__options.lockNavigation&&(b.position.copy(a),b.dirty=!0)};this.setTarget=function(a){b&&a&&!this.__options.lockNavigation&&(b.target.copy(a),b.dirty=!0)};this.getTarget=function(){return b?b.target.clone():new THREE.Vector3(0,0,0)};this.getEyeVector=
function(){return b?b.target.clone().sub(b.position):new THREE.Vector3(0,0,-1)};this.getFovMin=function(){return 6.88};this.getFovMax=function(){return 100};this.setVerticalFov=function(a,c){6.88>a?a=6.88:100<a&&(a=100);if(b&&!(1E-6>=Math.abs(b.fov-a))){if(c){var f=this.getEyeVector(),g=THREE.Math.degToRad(b.fov),h=THREE.Math.degToRad(a),g=f.length()*Math.tan(0.5*g)/Math.tan(0.5*h),f=f.multiplyScalar(-1).normalize();this.setPosition(this.getTarget().add(f.multiplyScalar(g)))}b.fov=a;b.dirty=!0}};
this.computeFit=function(a,b,c,g){if(g.empty())return{position:a,target:b};var h=g.center();g=g.size();g=0.5*Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);0===g&&(g=1);var k=Math.max(1,0.9+c/100*0.5);g*=k;a=a.clone().sub(b).normalize();c=g/Math.tan(THREE.Math.degToRad(0.5*c));a.multiplyScalar(c);return{position:h.clone().add(a),target:h}};this.fitBounds=function(a,b){var c=this.getTarget(),g=this.getPosition();if(this.__options.lockNavigation||!b||b.empty())return{position:g,target:c};var h=this.getVerticalFov(),
c=this.computeFit(g,c,h,b);a?this.setView(c.position,c.target):this.setRequestTransition(!0,c.position,c.target,h);this.setPivotPoint(c.target);this.setPivotSetFlag(!0);return c};this.updateCamera=function(){b&&(b.updateProjectionMatrix(),this.orient(b,b.target,b.position,b.up),b.dirty=!1)};this.setCamera(a)};Autodesk.Viewing.Navigation.prototype.constructor=Autodesk.Viewing.Navigation;
Autodesk.Viewing.Navigation.prototype.orient=function(){var a=new THREE.Matrix4,b=new THREE.Vector3,c=new THREE.Vector3,e=new THREE.Vector3;return function(d,f,g,h){var k=a.elements;e.subVectors(g,f).normalize();0===e.lengthSq()&&(e.z=1);b.crossVectors(h,e).normalize();0===b.lengthSq()&&(h.z>h.y?e.y-=1E-4:e.z+=1E-4,b.crossVectors(h,e).normalize());c.crossVectors(e,b);k[0]=b.x;k[4]=c.x;k[8]=e.x;k[1]=b.y;k[5]=c.y;k[9]=e.y;k[2]=b.z;k[6]=c.z;k[10]=e.z;d.setRotationFromMatrix(a)}}();
Autodesk.Viewing.Navigation.prototype.fov2fl=function(a){a=THREE.Math.degToRad(a);0>=a&&(a=1E-4);return Math.round(12/Math.tan(0.5*a))};Autodesk.Viewing.Navigation.prototype.fl2fov=function(a){0>=a&&(a=1E-4);a=2*Math.atan(12/a);return THREE.Math.radToDeg(a)};Autodesk.Viewing.Navigation.prototype.getCameraUpVector=function(){var a=new THREE.Vector3;return function(){var b=this.getCameraRightVector(),c=this.getEyeVector();return a.crossVectors(c,b).normalize()}}();
Autodesk.Viewing.Navigation.prototype.getCameraRightVector=function(){var a=new THREE.Vector3;return function(){var b=this.getWorldUpVector(),c=this.getEyeVector();a.set(-c.x,-c.y,-c.z);a.cross(b);0===a.lengthSq()&&(b.z>b.y?c.y-=1E-4:c.z+=1E-4,a.cross(b));return a.normalize()}}();Autodesk.Viewing.Navigation.prototype.setWorldUpVector=function(a){this.__setUp(a)};Autodesk.Viewing.Navigation.prototype.getWorldUpVector=function(){return this.__getUp().clone()};
Autodesk.Viewing.Navigation.prototype.getWorldRightVector=function(){var a=this,b=new THREE.Vector3;return function(){b.copy(a.__getUp());Math.abs(b.z)<=Math.abs(b.y)?b.set(b.y,-b.x,0):0<=b.z?b.set(b.z,0,-b.x):b.set(-b.z,0,b.x);return b.normalize()}}();Autodesk.Viewing.Navigation.prototype.getVerticalFov=function(){return this.getCamera().fov};Autodesk.Viewing.Navigation.prototype.getHorizontalFov=function(){var a=this.getScreenViewport();return this.getCamera().fov*(a.width/a.height)};
Autodesk.Viewing.Navigation.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())};Autodesk.Viewing.Navigation.prototype.setFocalLength=function(a){this.setVerticalFov(this.fl2fov(a))};Autodesk.Viewing.Navigation.prototype.setReverseZoomDirection=function(a){this.__options.reverseDolly=!!a};Autodesk.Viewing.Navigation.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly};
Autodesk.Viewing.Navigation.prototype.setZoomTowardsPivot=function(a){this.__options.dollyToPivot=!!a};Autodesk.Viewing.Navigation.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot};Autodesk.Viewing.Navigation.prototype.setOrbitPastWorldPoles=function(a){this.__options.orbitPastPoles=!!a};Autodesk.Viewing.Navigation.prototype.getOrbitPastWorldPoles=function(){return this.__options.orbitPastPoles};
Autodesk.Viewing.Navigation.prototype.setUsePivotAlways=function(a){this.__options.usePivotAlways=!!a};Autodesk.Viewing.Navigation.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways};Autodesk.Viewing.Navigation.prototype.setUseLeftHandedInput=function(a){this.__options.useLeftHandedInput=!!a};Autodesk.Viewing.Navigation.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput};
Autodesk.Viewing.Navigation.prototype.setIsLocked=function(a){this.__options.lockNavigation=!!a};Autodesk.Viewing.Navigation.prototype.getIsLocked=function(){return this.__options.lockNavigation};Autodesk.Viewing.Navigation.prototype.setPivotSetFlag=function(a){this.__pivotIsSetFlag=!!a};Autodesk.Viewing.Navigation.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag};Autodesk.Viewing.Navigation.prototype.setRequestFitToView=function(a){this.__fitToViewRequested=!!a};
Autodesk.Viewing.Navigation.prototype.getRequestFitToView=function(){return this.__fitToViewRequested};Autodesk.Viewing.Navigation.prototype.setRequestHomeView=function(a){this.__homeViewRequested=!!a};Autodesk.Viewing.Navigation.prototype.getRequestHomeView=function(){return this.__homeViewRequested};
Autodesk.Viewing.Navigation.prototype.setRequestTransition=function(a,b,c,e){a?(a=this.getWorldUpVector(),this.getPivotPoint(),this.__destinationView={position:b.clone(),coi:c.clone(),fov:e,worldUp:a}):this.__destinationView=null};Autodesk.Viewing.Navigation.prototype.getRequestTransition=function(){return this.__destinationView};Autodesk.Viewing.Navigation.prototype.setTransitionActive=function(a){this.__transitionActive=!!a};Autodesk.Viewing.Navigation.prototype.getTransitionActive=function(){return this.__transitionActive};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ScreenCapture=function(a){this.viewer=a;return this.viewer.impl.renderer.screenCaptureRenderer.domElement.toDataURL("image/png")};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ViewingApplication=function(a,b){this.appContainerId=a;this.container=document.getElementById(a);this.options=b;this.myRegisteredViewers={};this.urn=this.myCurrentViewer=this.myDocument=null};Autodesk.Viewing.ViewingApplication.prototype.k3D="3D";Autodesk.Viewing.ViewingApplication.prototype.k2D="2D";
Autodesk.Viewing.ViewingApplication.prototype.registerViewer=function(a,b,c){this.myRegisteredViewers[a]={};this.myRegisteredViewers[a].class=b;this.myRegisteredViewers[a].config=c};Autodesk.Viewing.ViewingApplication.prototype.getViewerClass=function(a){return this.myRegisteredViewers.hasOwnProperty(a)?this.myRegisteredViewers[a].class:null};Autodesk.Viewing.ViewingApplication.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)};
Autodesk.Viewing.ViewingApplication.prototype.getViewer=function(a,b,c){if(a in this.myRegisteredViewers){this.setCurrentViewer(null);var e=this.myRegisteredViewers[a].class,d={};a=this.myRegisteredViewers[a].config;for(var f in a)a.hasOwnProperty(f)&&(d[f]=a[f]);for(f in b)b.hasOwnProperty(f)&&(d[f]=b[f]);for(b=this.getViewerContainer();b.hasChildNodes();)b.removeChild(b.lastChild);e=new e(b,d);d=e.initialize();if(0===d)return this.setCurrentViewer(e),e;c&&c(d,"Viewer failed to initialize.")}return null};
Autodesk.Viewing.ViewingApplication.prototype.setCurrentViewer=function(a){this.myCurrentViewer&&this.myCurrentViewer.uninitialize();this.myCurrentViewer=a};Autodesk.Viewing.ViewingApplication.prototype.getCurrentViewer=function(){return this.myCurrentViewer};Autodesk.Viewing.ViewingApplication.prototype.loadDocument=function(a,b,c){var e=this;Autodesk.Viewing.Document.load(a,function(a){e.myDocument=a;e.onDocumentLoaded(a);b&&b(a)},function(a,b){e.onDocumentFailedToLoad(a,b);c&&c(a,b)})};
Autodesk.Viewing.ViewingApplication.prototype.onDocumentLoaded=function(a){console.log(a)};Autodesk.Viewing.ViewingApplication.prototype.onDocumentFailedToLoad=function(a,b){console.log(a)};
Autodesk.Viewing.ViewingApplication.prototype.selectItem=function(a,b,c){var e=this.myDocument.getViewablePath(a);if(e){var d,f,g;if("geometry"===a.type&&"3d"===a.role)d=this.k3D,g=a.name;else if("view"===a.type&&"3d"===a.role){f=a;d=this.k3D;var h=this.myDocument.getViewGeometry(a);h&&(g=h.name)}else"geometry"===a.type&&"2d"===a.role&&(d=this.k2D,g=a.name);Autodesk.Viewing.Private.logger.log({viewer_current_time:Date.now(),viewer_event_type:"switch sheet",viewer_sheet_title:g});if(d){var k=this,
l=this.myCurrentViewer&&this.urn===e,h=null,h=f&&f.camera?function(){k.myCurrentViewer.setViewFromArray(f.camera);b&&b(k.myCurrentViewer,a)}:l?function(){k.myCurrentViewer.setViewFromFile();b&&b(k.myCurrentViewer,a)}:function(){b&&b(k.myCurrentViewer,a)},m=!1;l?(h&&h(),m=!0):(this.urn=null,(d=this.getViewer(d,{defaultModelStructureTitle:g},c))&&d.load(this.myDocument.getFullPath(e),this.myDocument.getPropertyDbPath(),h,c)&&(this.urn=e,m=!0));if(m)return this.onItemSelected(a),!0}}return!1};
Autodesk.Viewing.ViewingApplication.prototype.onItemSelected=function(a){console.log("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(a.guid))};Autodesk.Viewing.ViewingApplication.prototype.selectItemById=function(a,b,c){return(a=this.myDocument.getItemById(a))?this.selectItem(a,b,c):!1};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Initializer=function(a,b){Autodesk.Viewing.Private.initializeEnvironmentVariable(a);Autodesk.Viewing.Private.initializeServiceEndPoints();Autodesk.Viewing.Private.initializeAuth(b,a)};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.GuiViewer3D=function(a,b){b||(b={});b.startOnInitialize=!1;this.prefs=new Autodesk.Viewing.Private.Preferences(this,"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.");Autodesk.Viewing.Viewer3D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer3D.prototype=Object.create(Autodesk.Viewing.Viewer3D.prototype);Autodesk.Viewing.Private.GuiViewer3D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer3D;
Autodesk.Viewing.Private.GuiViewer3D.prototype.resize=function(){Autodesk.Viewing.Viewer3D.prototype.resize.call(this);600>this.container.clientWidth?this.toolBar.collapse(!0):this.toolBar.collapse(!1)};Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig={click:{onObject:["isolate"]},clickCtrl:{onObject:["toggleVisibility"]}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initialize=function(){var a=Autodesk.Viewing.Viewer3D.prototype.initialize.call(this);if(0<a)return a;var b=this,a=b.container;this.toolBar=new Autodesk.Viewing.UI.ToolBar(a);var c=document.createElement("div");c.className="toolbarcentertop";a.appendChild(c);this.toolbar=document.createElement("div");this.toolbar.className="toolbar";c.appendChild(this.toolbar);this.initFocalLengthOverlay();this.initSettings();this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,
function(a){b.resizePanels({viewer:b});b.updateScreenModeButton(a.mode)});this.propertygrid=new Autodesk.Viewing.Private.PropertyPanel(b);this.addPanel(this.propertygrid);this.propertygrid.addVisibilityListener(function(a){b.setPropertiesButtonEnabled(a)});this.propertygrid.setOpenOnSelect(this.prefs.values.openPropertiesOnSelect);this.modelstructure||this.setModelStructurePanel(new Autodesk.Viewing.Extensions.ViewerModelStructurePanel(this,"Model Structure Loading...",{docStructureConfig:this.config&&
this.config.docStructureConfig?this.config.docStructureConfig:Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig,shadow:!1}));this.initMinTools();this.initNavTools();this.initCameraTools();this.initCameraStateMachine();this.initModelTools();this.initHomeButton();this.initViewCube();ENABLE_DEBUG&&this.initDebugTools();this.initSearchBox();this.initContextMenu();this.progressbar=new Autodesk.Viewing.Private.ProgressBar(this.container);this.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,
function(a){void 0!==a.percent&&b.progressbar.setPercent(a.percent)},!1);this.selectionActive=!1;this.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.selectionActive=0<a.dbIdArray.length});this.initEscapeHandlers();this.updateScreenModeButton(this.getScreenMode());this.run();this.resize();return 0};
Autodesk.Viewing.Private.GuiViewer3D.prototype.uninitialize=function(){this.modelstructure&&(this.modelstructure.uninitialize(),this.modelstructure=null);this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null);this.propertygrid&&(this.propertygrid.uninitialize(),this.propertygrid=null);this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null);this.raaSPanel&&(this.raaSPanel.uninitialize(),this.raaSPanel=null);this.raaSDataPanel&&(this.raaSDataPanel.uninitialize(),
this.raaSPanel=null);Autodesk.Viewing.Viewer3D.prototype.uninitialize.call(this)};Autodesk.Viewing.Private.GuiViewer3D.prototype.setModelStructurePanel=function(a){var b=this;return Autodesk.Viewing.Viewer3D.prototype.setModelStructurePanel.call(b,a)?(this.modelstructure.addVisibilityListener(function(a){if(a)b.onPanelVisible(b.modelstructure,b);b.setStructureButtonEnabled(a)}),!0):!1};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initContextMenu=function(){function a(a){var e=b.navigation.getUseLeftHandedInput()?0:2;return a.button===e?!0:!1}var b=this;this.objectContextMenu=new Autodesk.Viewing.Private.ObjectContextMenu(this.impl);this.canvas.addEventListener("mousedown",function(c){a(c)&&(b.startX=c.clientX,b.startY=c.clientY)});this.canvas.addEventListener("mouseup",function(c){if(a(c)&&c.clientX===b.startX&&c.clientY===b.startY){var e=b.impl.castRay(c.clientX,c.clientY);if(e.node&&
!b.impl.selector.isSelectedOrParentIsSelected(e.node)){var d=-1!==navigator.userAgent.search("Mac OS");d&&c.metaKey||!d&&c.ctrlKey||b.impl.selector.setSelection([e.node])}return b.objectContextMenu.show(c)}return!0},!1)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addOptionToggle=function(a,b,c,e,d){var f=this,g=d?this.prefs.values[d]:null;c=null!==g?g:c;g=document.createElement("li");g.className="toolbar-submenu-listitem";var h=document.createElement("input");h.className="toolbar-submenu-checkbox";h.type="checkbox";h.id=b;g.appendChild(h);var k=document.createElement("label");k.innerHTML=b;k.setAttribute("for",b);g.appendChild(k);a.appendChild(g);h.checked=c;h.onchange=function(a){var b=a.target.checked;f.prefs.set(d,
b);e(b);a.stopPropagation()};h.addEventListener("click",function(a){var b=h.checked;d&&f.prefs.set(d,b);e(b);a.stopPropagation()});k.addEventListener("click",function(a){a.stopPropagation()});g.addEventListener("click",function(a){var b=!h.checked;h.checked=b;d&&f.prefs.set(d,b);e(b);a.stopPropagation()});d&&this.prefs.addResetListener(d,function(a){h.checked=a;e(a)});return h};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addOptionList=function(a,b,c,e,d,f){var g=this,h=this.prefs.values[f];e=null!==h?h:e;var k=document.createElement("select");k.className="optionDropDown";for(h=0;h<c.length;h++){var l=document.createElement("option");l.value=h;l.text=c[h];k.add(l)}c=document.createElement("li");c.className="toolbar-submenu-select";h=document.createElement("div");h.className="toolbar-submenu-selectlabel";h.innerHTML=b;h.setAttribute("for",b);c.appendChild(h);c.appendChild(k);
a.appendChild(c);k.selectedIndex=e;k.onchange=function(a){a=a.target.selectedIndex;g.prefs.set(f,a);d(a)};this.prefs.addResetListener(f,function(a){k.selectedIndex=a;d(a)});return k};Autodesk.Viewing.Private.GuiViewer3D.prototype.addMenuButton=function(a,b,c,e){b=Autodesk.Viewing.UI.ToolBar.createMenuButton(b,c,e);this.toolBar.addToSubToolbar(a,b);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initColorPicker=function(){function a(a,b,d,e){var p;if(7==a.length){for(b=1;b<a.length;b++)if(d=parseInt(a[b],16),0>d||16<d||d!==d)return;p=parseInt(a.slice(1),16);b=1*(p>>16&255);d=1*(p>>8&255);p=1*(p&255);e||(e=[b,d,p,0|0.6521739130434783*b,0|0.6521739130434783*d,0|0.6521739130434783*p],h.setBackgroundColor(e[0],e[1],e[2],e[3],e[4],e[5]),h.prefs.set("backgroundColorPreset",JSON.stringify(e)));c.style.background=a;g=f.value=a}}var b=document.createElement("li");
b.className="color-picker";var c=document.createElement("div");c.className="backgroundButton";var e=document.createElement("div");e.className="cp-small thecolorpicker";c.appendChild(e);b.appendChild(c);var d=this.impl.clearColorTop,d=255*d.x<<16|255*d.y<<8|255*d.z,f=document.createElement("input");f.className="backgroundColorText";f.type="text";f.value="#"+d.toString(16);b.appendChild(f);var g=f.value,h=this;f.addEventListener("change",function(){a(f.value);f.value=g});this.menuoptions.appendChild(b);
ColorPicker(e,a);c.style.background=f.value};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initFPSStats=function(){var a=this;this.addOptionToggle(this.debugMenu.subMenu,"FPS statistics",!1,function(b){if(b&&!a.impl.stats){var c=new Stats;c.setMode(1);c.domElement.style.position="absolute";c.domElement.style.bottom="0px";c.domElement.style.right="0px";c.domElement.style.visibility="hidden";c.domElement.style["z-index"]=1;a.container.appendChild(c.domElement);a.impl.stats=c}a.impl.stats.domElement.style.visibility=b?"visible":"hidden"})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelStats=function(){function a(a){var b=c.impl,f="",g=c.model;g&&(f+="Geom&nbsp;polys:&nbsp;"+g.geomPolyCount()+"<br>",f+="Instance&nbsp;polys:&nbsp;"+g.instancePolyCount()+"<br>",f+="Scenes:&nbsp;"+b.modelQueue.getSceneCount()+"<br>");c.modelStats.innerHTML=f+("# "+(a||""))}function b(){c.modelStats=document.createElement("div");c.modelStats.className="statspanel";c.container.appendChild(c.modelStats);c.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,
function(b){b.message&&a(b.message)})}var c=this;this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(e){e&&!c.modelStats&&(b(),a(""));c.modelStats.style.visibility=e?"visible":"hidden"})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initExplodeSlider=function(a){var b=this,c=this.explodeslider=document.createElement("input");c.className="slider";c.type="range";c.min="0";c.max="100";c.value="0";c.width="200";this.toolbar.appendChild(c);c.addEventListener("input",function(a){b.explode(c.value/100)});c.addEventListener("change",function(a){b.explode(c.value/100)});this.explodebutton=this.addMenuButton(a,"toolbar-explodeTool","Explode model",function(a){b.showExplodeSlider("hidden"==
c.style.visibility||""==c.style.visibility)});c.addEventListener("keyup",function(a){27===a.keyCode&&b.canvas.focus()})};Autodesk.Viewing.Private.GuiViewer3D.prototype.showExplodeSlider=function(a){a?(this.modelTools.deselect(this.explodebutton.id),this.explodeslider.style.visibility="visible"):(this.modelTools.select(this.explodebutton.id),this.explodeslider.style.visibility="hidden")};Autodesk.Viewing.Private.GuiViewer3D.prototype.showViewer3dOptions=function(a){this.vieweroptions.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.showRenderingOptions=function(a){this.renderoptions.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showLayerManager=function(a){this.layersPanel.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showRaaSPanel=function(a){this.raaSPanel.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showRaaSDataPanel=function(a){this.raaSDataPanel.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initMinTools=function(){if(this.canChangeScreenMode()){this.minTools=this.toolBar.addSubToolbar("minTools",!1);var a=this;this.minTools.minfullscreenbutton=this.addMenuButton("minTools","toolbar-minfullscreenTool","Full screen",function(b){a.nextScreenMode()})}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initNavTools=function(){var a=this;this.navigationMode=Autodesk.Viewing.NAVIGATION_MODE.ORBIT;this.navTools=this.toolBar.addSubToolbar("navTools",!0);this.navTools.orbitbutton=this.addMenuButton("navTools","toolbar-orbitTool","Orbit",function(b){a.setNavigationMode(Autodesk.Viewing.NAVIGATION_MODE.ORBIT)});this.navTools.panbutton=this.addMenuButton("navTools","toolbar-panTool","Pan",function(b){a.setNavigationMode(a.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.PAN?
Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.PAN)});this.navTools.dollybutton=this.addMenuButton("navTools","toolbar-zoomTool","Zoom",function(b){a.setNavigationMode(a.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.DOLLY?Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.DOLLY)});this.navTools.select(this.navTools.orbitbutton.id);a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/turntable_cur.cur), wait"};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initRaaSTools=function(){var a=this;this.raaSTools=this.toolBar.addSubToolbar("raaSTools",!1);var b=this.raaSPanel=new Autodesk.Viewing.Extensions.RaaSPanel(this);this.addPanel(b);var c=this.raaSDataPanel=new Autodesk.Viewing.Extensions.RaaSDataPanel(this);this.addPanel(c);this.raaSTools.raaSButton1=this.addMenuButton("raaSTools","toolbar-raaSTool","RaaS",function(c){a.showRaaSPanel(!b.isVisible())});this.raaSTools.raaSButton2=this.addMenuButton("raaSTools",
"toolbar-raaSDataTool","RaaS Data",function(b){document.getElementById("cameraPosition").innerText="x = "+a.impl.camera.position.x+" y = "+a.impl.camera.position.y+" z = "+a.impl.camera.position.z;document.getElementById("cameraIsPerspective").innerText=a.impl.camera.isPerspective;document.getElementById("cameraUp").innerText="x = "+a.impl.camera.up.x+" y = "+a.impl.camera.up.y+" z = "+a.impl.camera.up.z;document.getElementById("cameraTarget").innerText="x = "+a.impl.camera.target.x+" y = "+a.impl.camera.target.y+
" z = "+a.impl.camera.target.z;document.getElementById("cameraNear").innerText=a.impl.camera.near;document.getElementById("cameraFar").innerText=a.impl.camera.far;document.getElementById("cameraFov").innerText=a.impl.camera.fov;document.getElementById("cameraAspect").innerText=a.impl.camera.aspect;stderr("camera debug outputs start ...");stderr("eye : "+JSON.stringify([a.impl.camera.position.x,a.impl.camera.position.y,a.impl.camera.position.z]));stderr("target : "+JSON.stringify([a.impl.camera.target.x,
a.impl.camera.target.y,a.impl.camera.target.z]));stderr("up : "+JSON.stringify([a.impl.camera.up.x,a.impl.camera.up.y,a.impl.camera.up.z]));stderr("fov : "+JSON.stringify([a.impl.camera.fov]));stderr("camera debug outputs end ...");document.getElementById("lightName").innerText=a.impl.LightPresets[a.impl.currentLightPreset].name;document.getElementById("lightPath").innerText=a.impl.LightPresets[a.impl.currentLightPreset].path;document.getElementById("lightTonemap").innerText=a.impl.LightPresets[a.impl.currentLightPreset].tonemap;
document.getElementById("lightE_bias").innerText=a.impl.LightPresets[a.impl.currentLightPreset].E_bias;document.getElementById("lightDirectLightColor").innerText="r = "+a.impl.dir_light1.color.r+" g = "+a.impl.dir_light1.color.g+" b = "+a.impl.dir_light1.color.b;document.getElementById("lightAmbientColor").innerText="r = "+a.impl.amb_light.color.r+" g = "+a.impl.amb_light.color.g+" b = "+a.impl.amb_light.color.b;document.getElementById("lightMultiplier").innerText=a.impl.LightPresets[a.impl.currentLightPreset].lightMultiplier;
document.getElementById("lightBgColorGradientClearColorTop").innerText="x = "+a.impl.clearColorTop.x+" y = "+a.impl.clearColorTop.y+" z = "+a.impl.clearColorTop.z;document.getElementById("lightBgColorGradientClearColorBottom").innerText="x = "+a.impl.clearColorBottom.x+" y = "+a.impl.clearColorBottom.y+" z = "+a.impl.clearColorBottom.z;document.getElementById("renderOptionsSaoToggle").innerText=a.renderoptions.saoToggle.checked;document.getElementById("renderOptionsSaoRadius").innerText=a.renderoptions.saoRadius.value;
document.getElementById("renderOptionsSaoIntensity").innerText=a.renderoptions.saoIntensity.value;document.getElementById("renderOptionsGamma").innerText=a.renderoptions.gamma.value;document.getElementById("renderOptionsExposureBias").innerText=a.renderoptions.exposureBias.value;document.getElementById("renderOptionsWhitePointIntensity").innerText=a.renderoptions.whiteScale.value;document.getElementById("renderOptionsFovAngle").innerText=a.renderoptions.fovAngle.value;a.showRaaSDataPanel(!c.isVisible())})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createCameraSubmenu=function(){var a=document.createElement("ul"),b=this;this.cameraMenu.fittoviewbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-fitToViewTool","Fit to view (F)",function(a){b.impl.controls.fitToView()});a.appendChild(this.cameraMenu.fittoviewbutton);this.cameraMenu.fovbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-focalLengthTool","Focal length (Ctrl+Shift drag)",function(a){b.setNavigationMode(b.getNavigationMode()===
Autodesk.Viewing.NAVIGATION_MODE.FOV?Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.FOV)});Autodesk.Viewing.Private.addClass(this.cameraMenu.fovbutton.childNodes[this.cameraMenu.fovbutton.childNodes.length-1],"disabled-button");a.appendChild(this.cameraMenu.fovbutton);this.cameraMenu.rollbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-rollTool","Roll (Alt+Shift drag)",function(a){b.setNavigationMode(b.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.ROLL?
Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.ROLL)});Autodesk.Viewing.Private.addClass(this.cameraMenu.rollbutton.childNodes[this.cameraMenu.rollbutton.childNodes.length-1],"disabled-button");a.appendChild(this.cameraMenu.rollbutton);return a};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initCameraTools=function(){this.cameraMenu=this.toolBar.addSubToolbar("cameraTools",!1);var a=this.addMenuButton("cameraTools","toolbar-cameraSubmenuTool","Camera interactions",null),b=this.createCameraSubmenu();this.toolBar.attachSubMenu(a,b)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initCameraStateMachine=function(){function a(a){Autodesk.Viewing.Private.addClass(a.childNodes[a.childNodes.length-1],"disabled-button")}function b(a){Autodesk.Viewing.Private.removeClass(a.childNodes[a.childNodes.length-1],"disabled-button")}var c=this;c.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,function(e){c.navTools.deselectAll();a(this.cameraMenu.fovbutton);a(this.cameraMenu.rollbutton);switch(e.value){case Autodesk.Viewing.NAVIGATION_MODE.ORBIT:c.navTools.select(c.navTools.orbitbutton.id);
c.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/turntable_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:c.navTools.select(c.navTools.dollybutton.id);c.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/dolly_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:c.navTools.select(c.navTools.panbutton.id);c.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/pan_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:b(c.cameraMenu.fovbutton);c.canvas.style.cursor="url("+
RESOURCE_ROOT+"icons/fov_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:b(c.cameraMenu.rollbutton);c.canvas.style.cursor="auto";break;default:c.canvas.style.cursor="auto"}c.navigationMode=e.value;c.showFocalLengthOverlay(c.navigationMode===Autodesk.Viewing.NAVIGATION_MODE.FOV)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelTools=function(){var a=this;this.modelTools=this.toolBar.addSubToolbar("modelTools",!1);this.modelTools.structurebutton=this.addMenuButton("modelTools","toolbar-modelStructureTool","Model structure",function(b){a.modelstructure&&a.showModelStructurePanel(!a.modelstructure.isVisible())});this.initExplodeSlider("modelTools");this.addMenuButton("modelTools","toolbar-resetTool","Reset model",function(b){a.explode(0);a.explodeslider.value=0;a.showAll()});
this.modelTools.propertiesbutton=this.addMenuButton("modelTools","toolbar-propertiesTool","Properties",function(b){a.propertygrid.isVisible()?(a.propertygrid.setVisible(!1),a.modelTools.select(a.modelTools.propertiesbutton.id)):(a.propertygrid.getNodeId()||a.propertygrid.setDefaultProperties(),a.propertygrid.setVisible(!0),a.modelTools.deselect(a.modelTools.propertiesbutton.id))});this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!1);this.vieweroptions=new Autodesk.Viewing.Private.Viewer3dSettingsPanel(this);
this.addPanel(this.vieweroptions);var b=this.addMenuButton("modelTools","toolbar-settingsTool","",null),c=this.createOptionsMenu(b);this.toolBar.attachSubMenu(b,c);if(ENABLE_DEBUG){var e=this.renderoptions=new Autodesk.Viewing.Private.RenderOptionsPanel(this);this.addPanel(e);this.addMenuButton("modelTools","toolbar-renderOptionsTool","Rendering options",function(b){a.showRenderingOptions(!e.isVisible())})}this.canChangeScreenMode()&&(this.modelTools.fullscreenbutton=this.addMenuButton("modelTools",
"toolbar-fullscreenTool","Full screen",function(b){a.nextScreenMode()}))};Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesOnSelect=function(a){a?this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!1):this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!0);this.propertygrid.setOpenOnSelect(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addDivider=function(a){var b=document.createElement("li");b.className="toolbar-submenu-horizontal-divider";a.appendChild(b);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createOptionsMenu=function(a){var b=this;this.menuoptions=document.createElement("ul");this.menuoptions.style.width="310px";for(var c=[],e=0;e<b.impl.LightPresets.length;e++)c.push(b.impl.LightPresets[e].name);var d=this.addOptionList(this.menuoptions,"Background and lighting",c,4,function(a){b.blockEvent||b.impl.setLightPreset(a)},"lightPreset");b.addEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(a){b.blockEvent=!0;d.selectedIndex=
b.impl.currentLightPreset;b.blockEvent=!1});a.addEventListener("mouseout",function(a){a.target&&(a.target!==b.menuoptions&&"menu-option"!==a.target.className||d.blur())});d.addEventListener("mouseout",function(a){a.target&&(a.target!==b.container&&a.target!==b.menuoptions&&"menu-option"!==a.target.className||d.blur())});this.addOptionToggle(this.menuoptions,"Display lines",!0,function(a){b.hideLines(!a)},"lineRendering");this.addDivider(this.menuoptions);a=document.createElement("li");a.className=
"toolbar-submenu-listitem";c=document.createElement("label");c.innerHTML="Performance and appearance settings";a.appendChild(c);a.addEventListener("click",function(){b.showViewer3dOptions(!0);b.vieweroptions.selectTab(Autodesk.Viewing.Private.PerformanceTab)});a.style.opacity=1;this.menuoptions.appendChild(a);this.addDivider(this.menuoptions);a=document.createElement("li");a.className="toolbar-submenu-listitem";c=document.createElement("label");c.innerHTML="Navigation and selection settings";a.appendChild(c);
a.addEventListener("click",function(){b.showViewer3dOptions(!0);b.vieweroptions.selectTab(Autodesk.Viewing.Private.NavigationTab)});a.style.opacity=1;this.menuoptions.appendChild(a);return this.menuoptions};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initDebugTools=function(){this.debugMenu=this.toolBar.addSubToolbar("debugTools",!1);var a=this,b=this.layersPanel=new Autodesk.Viewing.Private.LayersPanel(this);this.addPanel(b);this.addMenuButton("debugTools","toolbar-renderOptionsToolXXX","Layer Manager",function(c){a.showLayerManager(!b.isVisible())});var c=this.addMenuButton("debugTools","toolbar-debugTool","",null);this.debugMenu.subMenu=document.createElement("ul");this.debugMenu.subMenu.style.width=
"180px";this.initFPSStats();this.addDivider(this.debugMenu.subMenu);this.initModelStats();this.addDivider(this.debugMenu.subMenu);this.addOptionToggle(this.debugMenu.subMenu,"Show search bar",!1,function(b){a.searchMenu.setVisibility(b)});this.toolBar.attachSubMenu(c,this.debugMenu.subMenu)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){if(a.renderoptions&&a.renderoptions.isVisible())a.renderoptions.setVisible(!1);else if("hidden"!==a.explodeslider.style.visibility&&""!==a.explodeslider.style.visibility)a.showExplodeSlider(!1);else if(a.navigationMode!==Autodesk.Viewing.NAVIGATION_MODE.ORBIT)a.setNavigationMode(Autodesk.Viewing.NAVIGATION_MODE.ORBIT);else if(a.selectionActive)a.clearSelection();
else if(!a.areAllVisible())a.showAll();else if(!Autodesk.Viewing.Private.AlertBox.dismiss()){for(b=0;b<a.dockingPanels.length;++b){var c=a.dockingPanels[b];if("none"!==c.container.style.display&&""!==c.container.style.display){c.container===a.modelstructure?a.showModelStructurePanel(!1):c.setVisible(!1);return}}a.escapeScreenMode()}})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initHomeButton=function(){var a=document.createElement("div");a.className="homeViewWrapper";var b=document.createElement("img");b.className="homeView";b.src=RESOURCE_ROOT+"icons/resetview_icon.png";b.style.cursor="pointer";a.appendChild(b);this.container.appendChild(a);this.homeViewContainer=a;var c=this;b.addEventListener("click",function(a){c.navigation.setRequestHomeView(!0)});b.addEventListener("contextmenu",function(a){c.navigation.setRequestHomeView(!0)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initViewCube=function(){this.viewcube=document.createElement("div");this.viewcube.className="viewcube";this.container.appendChild(this.viewcube);this.cube=new Autocam.ViewCube("cube",this.autocam,this.viewcube);this.displayViewCube(this.prefs.values.viewCube)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.displayViewCube=function(a){this.viewcube.style.display=a?"block":"none";this.homeViewContainer&&(this.homeViewContainer.style.right=a?"120px":"4px");a&&(this.impl.needsClear=!0,this.autocam.refresh())};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initSearchBox=function(){this.searchMenu=this.toolBar.addSubToolbar("searchBox",!1);this.searchMenu.setVisibility(!1);var a=document.createElement("li"),b=document.createElement("input");b.type="search";b.results=5;b.placeholder="Search";b.incremental="incremental";b.autosave=this.container.id+"search_autosave";a.appendChild(b);this.toolBar.addToSubToolbar("searchBox",a);var c=this;this.searchbox=b;b.addEventListener("change",function(a){stderr("search "+
b.value);c.search(b.value,function(a){c.isolateById(a)})});b.addEventListener("keypress",function(a){27===a.keyCode&&setTimeout(function(){""!==b.value&&(b.value="")},0)});this.toolBar.addEventListener("mouseleave",function(a){function d(){clearTimeout(f)}var f;c.toolBar.addEventListener("mouseenter",d);f=setTimeout(function(){c.toolBar.removeEventListener("mouseenter",d);document.activeElement===b&&c.canvas.focus()},2E3)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesButtonEnabled=function(a){a?this.modelTools.deselect(this.modelTools.propertiesbutton.id):this.modelTools.select(this.modelTools.propertiesbutton.id)};Autodesk.Viewing.Private.GuiViewer3D.prototype.setStructureButtonEnabled=function(a){a?this.modelTools.deselect(this.modelTools.structurebutton.id):this.modelTools.select(this.modelTools.structurebutton.id)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showModelStructurePanel=function(a){this.modelstructure.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.onPanelVisible=function(a,b){b||(b=this);b.dockingPanels.splice(b.dockingPanels.indexOf(a),1);b.dockingPanels.splice(0,0,a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initFocalLengthOverlay=function(){var a=this.focallength=document.createElement("div");a.className="focallength";var b=document.createElement("table"),c=document.createElement("tbody");b.appendChild(c);a.appendChild(b);this.container.appendChild(a);var b=c.insertRow(-1),e=b.insertCell(0);e.textContent="Focal Length:";e=b.insertCell(1);e.textContent="";e.style.width="4em";e.style.textAlign="right";var d=0,f=this;this.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
function(a){a=f.getFocalLength();d!==a&&(d=a,e.textContent=a.toString()+" mm")});a.style.visibility="hidden"};Autodesk.Viewing.Private.GuiViewer3D.prototype.showFocalLengthOverlay=function(a){this.focallength&&"hidden"!==this.focallength.style.visibility!==a&&(this.focallength.style.visibility=a?"visible":"hidden")};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initSettings=function(){var a=window.navigator;this.isAndroid=-1!=a.platform.indexOf("armv")||a.appVersion&&-1!=a.appVersion.indexOf("Android");this.prefs.load({ambientShadows:!this.isAndroid,antialiasing:!this.isAndroid,progressiveRendering:!0,environmentMap:!1,openPropertiesOnSelect:!0,ghosting:!0,viewCube:!0,lineRendering:!0,lightPreset:this.isAndroid||_isIE11?0:this.impl.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,alwaysUsePivot:!1,
zoomTowardsPivot:!1,orbitPastWorldPoles:!0,leftHandedMouseSetup:!1,clickToSetCOI:!1,optimizeNavigation:!1});this.setQualityLevel(this.prefs.values.ambientShadows,this.prefs.values.antialiasing);this.setGhosting(this.prefs.values.ghosting);this.setProgressiveRendering(this.prefs.values.progressiveRendering);this.setClickToSetCOI(this.prefs.values.clickToSetCOI);this.setOptimizeNavigation(this.prefs.values.optimizeNavigation);this.navigation.setUsePivotAlways(this.prefs.values.alwaysUsePivot);this.navigation.setReverseZoomDirection(this.prefs.values.reverseMouseZoomDir);
this.navigation.setZoomTowardsPivot(this.prefs.values.zoomTowardsPivot);this.navigation.setOrbitPastWorldPoles(this.prefs.values.orbitPastWorldPoles);this.navigation.setUseLeftHandedInput(this.prefs.values.leftHandedMouseSetup);this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){this.hideLines(!this.prefs.values.lineRendering)});if(a=this.prefs.values.backgroundColorPreset){var b;try{b=JSON.parse(a),this.impl.setClearColors(b[0],b[1],b[2],b[3],b[4],b[5])}catch(c){this.prefs.set("backgroundColorPreset",
null)}}this.impl.setLightPreset(this.prefs.values.lightPreset)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.GuiViewer2D=function(a,b){Autodesk.Viewing.Viewer2D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer2D.prototype=Object.create(Autodesk.Viewing.Viewer2D.prototype);Autodesk.Viewing.Private.GuiViewer2D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer2D;
Autodesk.Viewing.Private.GuiViewer2D.prototype.initialize=function(){var a=Autodesk.Viewing.Viewer2D.prototype.initialize.call(this);if(0<a)return a;this.toolBar=new Autodesk.Viewing.UI.ToolBar(this.container);this.initNavTools();this.initModelTools();this.initEscapeHandlers();this.initHomeButton();var b=this;this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,function(a){b.updateScreenModeButton(a.mode)});this.updateScreenModeButton(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal);
return 0};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initNavTools=function(){var a=this;this.navTools=this.toolBar.addSubToolbar("navTools",!0);this.navTools.panbutton=this.addMenuButton("navTools","toolbar-panTool","Pan",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)});this.navTools.dollybutton=this.addMenuButton("navTools","toolbar-zoomTool","Zoom",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.ZOOM)});this.navTools.select(this.navTools.panbutton.id);this.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,function(b){a.navTools.deselectAll();
switch(b.value){case VIEWER2D_NAVIGATION_MODE.PAN:a.navTools.select(a.navTools.panbutton.id);a.impl.container.style.cursor="url("+RESOURCE_ROOT+"icons/pan_cur.cur), wait";break;case VIEWER2D_NAVIGATION_MODE.ZOOM:a.navTools.select(a.navTools.dollybutton.id);a.impl.container.style.cursor="url("+RESOURCE_ROOT+"icons/dolly_cur.cur), wait";break;default:a.impl.container.style.cursor="auto"}});this.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initModelTools=function(){if(this.canChangeScreenMode()){this.modelTools=this.toolBar.addSubToolbar("modelTools",!1);var a=this;this.modelTools.fullscreenbutton=this.addMenuButton("modelTools","toolbar-fullscreenTool","Full screen",function(b){a.nextScreenMode()})}};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)||a.escapeScreenMode()},!1)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initHomeButton=function(){var a=this,b=this.homeViewContainer=document.createElement("div");b.className="homeViewWrapper";var c=document.createElement("img");c.className="homeView";c.src=RESOURCE_ROOT+"icons/resetview_icon.png";c.style.cursor="pointer";b.appendChild(c);b.style.width="auto";this.container.appendChild(b);c.addEventListener("click",function(){a.impl.goHome()})};
Autodesk.Viewing.Private.GuiViewer2D.prototype.addMenuButton=function(a,b,c,e){b=Autodesk.Viewing.UI.ToolBar.createMenuButton(b,c,e);this.toolBar.addToSubToolbar(a,b);return b};
Autodesk.Viewing.Private.GuiViewer2D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};AutodeskNamespace("Autodesk.Viewing.Private");var auth=null,VIEWING_URL,SEARCH_URL,RESOURCE_ROOT="";Autodesk.Viewing.Private.env=null;Autodesk.Viewing.Private.logger=null;Autodesk.Viewing.Private.refreshToken=null;Autodesk.Viewing.Private.lastTokenRefreshTime=null;var USE_OAUTH_NONE=!0,USE_OAUTH_ZERO=!1,USE_OAUTH_ONE=!1,USE_OAUTH_TWO=!1,SHOULD_SET_TOKEN=!0;
Autodesk.Viewing.Private.EnvironmentConfigurations={Local:{RESOURCE:"",VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},Development:{RESOURCE:"https://viewing-dev.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},Staging:{RESOURCE:"https://viewing-staging.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing-staging.api.autodesk.com/viewingservice/v1",
SEARCH:"https://search-staging.api.autodesk.com/search/v1"},Production:{RESOURCE:"https://viewing.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing.api.autodesk.com/viewingservice/v1",SEARCH:"https://search.api.autodesk.com/search/v1"},AutodeskDevelopment:{RESOURCE:"https://developer-dev.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://developer-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},AutodeskStaging:{RESOURCE:"https://developer-stg.api.autodesk.com/viewingservice/v1/viewers/",
VIEWING:"https://developer-stg.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-staging.api.autodesk.com/search/v1"},AutodeskProduction:{RESOURCE:"https://developer.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://developer.api.autodesk.com/viewingservice/v1",SEARCH:"https://search.api.autodesk.com/search/v1"}};
Autodesk.Viewing.Private.setAuthTokenInCookie=function(a,b){var c={oauth:{token:""}};c.oauth.token=a;var e=new XMLHttpRequest;e.open("POST",VIEWING_URL+"/token",!0);e.setRequestHeader("Content-Type","application/json");e.withCredentials=!0;b&&(e.onload=b);e.send(JSON.stringify(c))};
Autodesk.Viewing.Private.setApigeeTokenInCookie=function(a,b){var c=new XMLHttpRequest,e=VIEWING_URL.substring(0,VIEWING_URL.indexOf("/viewingservice"));c.open("POST",e+"/utility/v1/settoken",!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.withCredentials=!0;b&&(c.onload=b);c.send("access-token="+a)};
Autodesk.Viewing.Private.initializeEnvironmentVariable=function(a){if(a&&a.env)a=a.env;else switch(window.location.hostname){case "viewing-dev.api.autodesk.com":a="Development";break;case "viewing-staging.api.autodesk.com":a="Staging";break;case "viewing.api.autodesk.com":a="Production";break;case "developer-dev.api.autodesk.com":a="AutodeskDevelopment";break;case "developer-stg.api.autodesk.com":a="AutodeskStaging";break;case "developer.api.autodesk.com":a="AutodeskProduction";break;case "ec2-23-20-101-198.compute-1.amazonaws.com":a=
"Development";break;case "localhost.autodesk.com":a="Local";break;case "":a="Local";break;case "127.0.0.1":a="Local";break;default:a="AutodeskProduction"}console.log("Host name : "+window.location.hostname);console.log("Environment initialized as : "+a);Autodesk.Viewing.Private.env=a};Autodesk.Viewing.Private.initializeServiceEndPoints=function(){var a=Autodesk.Viewing.Private.EnvironmentConfigurations[Autodesk.Viewing.Private.env];VIEWING_URL=a.VIEWING;SEARCH_URL=a.SEARCH;RESOURCE_ROOT=a.RESOURCE};
Autodesk.Viewing.Private.initializeAuth=function(a,b){auth=!0;var c;b?(c=b.getAccessToken?b.getAccessToken():b.accessToken?b.accessToken:Autodesk.Viewing.Private.getParameterByName("accessToken"),Autodesk.Viewing.Private.refreshToken=b.refreshToken):c=Autodesk.Viewing.Private.getParameterByName("accessToken");c||(c="bebhjjAIDUpa/pz/EBC3RvTeknU=",console.log("Warning : no access token is provided. Use built in token : "+c));SHOULD_SET_TOKEN&&(0==Autodesk.Viewing.Private.env.indexOf("Autodesk")?Autodesk.Viewing.Private.setApigeeTokenInCookie(c,
a):Autodesk.Viewing.Private.setAuthTokenInCookie(c,a));Autodesk.Viewing.Private.initializeLogger(c);Autodesk.Viewing.Private.lastTokenRefreshTime=Date.now();setInterval(Autodesk.Viewing.Private.heartBeat,6E4);return auth};
Autodesk.Viewing.Private.initializeLogger=function(a){var b=Autodesk.Viewing.Private.logger=new Autodesk.Viewing.Private.Logger({console:!1,viewingservice:!0,webstorage:!1,endpoint:VIEWING_URL,flushThreshold:10});a={viewer_current_time:Date.now(),viewer_user_access_token:a,viewer_user_host_url:window.location.hostname,viewer_user_agent:navigator.userAgent};b.log(a)};
Autodesk.Viewing.Private.heartBeat=function(){6E4<Date.now()-Autodesk.Viewing.Private.logger.lastFlushTime&&Autodesk.Viewing.Private.logger.flush();if(15E5<Date.now()-Autodesk.Viewing.Private.lastTokenRefreshTime){var a=Autodesk.Viewing.Private.refreshToken;a&&(a=a(),Autodesk.Viewing.Private.lastTokenRefreshTime=Date.now(),0==Autodesk.Viewing.Private.env.indexOf("Autodesk")?Autodesk.Viewing.Private.setApigeeTokenInCookie(a):Autodesk.Viewing.Private.setAuthTokenInCookie(a))}};
Autodesk.Viewing.Private.getAuthObject=function(){return auth};Autodesk.Viewing.Private.getParameterByName=function(a){return Autodesk.Viewing.Private.getParameterByNameFromPath(a,window.location.href)};Autodesk.Viewing.Private.getParameterByNameFromPath=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(b);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))};
Autodesk.Viewing.Private.getDemoDocumentURN=function(){var a;switch(Autodesk.Viewing.Private.env){case "Development":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbmAvUkMgQ2FyLmR3Zg";break;case "Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case "Production":a="FIXME";break;default:a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbmAvUkMgQ2FyLmR3Zg"}return a};
function stderr(a){ENABLE_TRACE&&console.log(a)};
