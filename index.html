<!DOCTYPE html>
<html lang="en">
    
<!-- LmvDbg: This is a test app to help test the API and allow people to learn and copy snippets of
     source.  It will continually evolve along with the API and will always be a work in progress
     of "best parctices".  If you have any specific things you want added or have a suggestion of 
     how to do something a better way, don't hold back... this is here to support the developer community.

     Email me:  jim.awe@autodesk.com
-->
 
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>LMV Dbg App</title>
    
        <!-- bootstarp and jQuery -->
    <link href="./stylesheets/libs/bootstrap.min.css" rel="stylesheet">
    <script src="./scripts/libs/jquery/jquery-2.1.1.js"></script>
    <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>-->
    
        <!-- jscolor color picker library -->
    <script src="./scripts/libs/jscolor/jscolor.js"></script>
    
        <!-- jsTree library -->
    <link rel="stylesheet" href="./scripts/libs/jstree/dist/themes/default/style.min.css" />
    <script src="./scripts/libs/jstree/dist/jstree.min.js"></script>
    
        <!-- prism syntax higlighting library -->
    <link href="./scripts/libs/prism/prism.css" rel="stylesheet" />
    <script src="./scripts/libs/prism/prism.min.js"></script>
    
    
    <script>
            /* This section handles conditional inclusion of the Adsk viewer CSS and JS files
            ** based on whether you want them to come from the local (cached) directory, or the live
            ** online (current) version.  You can also choose to whether you want the debug version
            ** of the JS file or the minified version.
            **
            ** pass args to the URL:  https://127.0.0.1/index.html?local=1&debug=1
            ** if no args are passed, its the same as local=0, debug=0
            */
        
            // TBD: change this section when new Version control is in place so that we can have it run against different versions of the API.
        
            // get the arguments passed as part of the URL
        function getUrlVars() {
            var vars = {};
            var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {
                vars[key] = value;
            });
            return vars;
        }
        
            // see what values were specified (if none, they will be undefined and default to local=0, debug=0)
        var loadDebugViewerJs = getUrlVars()["debug"];
        var loadLocalJs = getUrlVars()["local"];

            // load the specified CSS file
        if (loadLocalJs == 1) {
            console.log("LmvDbg: loading local version of viewer css...");
            loadAdskViewingCss('./stylesheets/libs/adsk/style.css');
        }
        else {
            console.log("LmvDbg: loading online version of viewer css...");
            loadAdskViewingCss('https://viewing.api.autodesk.com/viewingservice/v1/viewers/style.css');       // PROD
            //loadAdskViewingCss('https://developer-stg.api.autodesk.com/viewingservice/v1/viewers/style.css');   // STG
        }
    
            
        function loadAdskViewingCss(path) {
            $('<link/>', {
                rel: 'stylesheet',
               type: 'text/css',
               href: path
            }).appendTo('head');
        }
        
            // load the specified JS file
        if (loadLocalJs == 1) {
            if (loadDebugViewerJs == 1) {
                console.log("LmvDbg: loading local/debug version of viewer js...");
                loadAdskViewingJs("./scripts/libs/adsk/viewer3D.js");
            }
            else {
                console.log("LmvDbg: loading local/minified version of viewer js...");
                loadAdskViewingJs("./scripts/libs/adsk/viewer3D.min.js");
            }
        }
        else {
            if (loadDebugViewerJs == 1) {
                console.log("LmvDbg: loading online/debug version of viewer js...");
                loadAdskViewingJs("https://viewing.api.autodesk.com/viewingservice/v1/viewers/viewer3D.js");      // PROD
                //loadAdskViewingJs("https://developer-stg.api.autodesk.com/viewingservice/v1/viewers/viewer3D.js");  // STG
            }
            else {
                console.log("LmvDbg: loading online/minified version of viewer js...");
                loadAdskViewingJs("https://viewing.api.autodesk.com/viewingservice/v1/viewers/viewer3D.min.js");      // PROD
                //loadAdskViewingJs("https://developer-stg.api.autodesk.com/viewingservice/v1/viewers/viewer3D.min.js");  // STG
            }
        }
        
        function loadAdskViewingJs(path) {
            $.ajaxSetup({async:false});
            $.getScript(path);
            $.ajaxSetup({async:true});
        }
    
    </script>
        
        <!-- This apps includes -->
    <link href="./stylesheets/theme.css" rel="stylesheet">
    <script src="./scripts/MyAuthToken.js"></script>
    <script src="./scripts/DebugUtils.js"></script>
 
    <script>
                
        $(document).ready(function() {
            
            $("#codeSnippetLinks").on("click", "a", function(evt) {  
                evt.preventDefault();
                
                var $link = $(evt.target);
                //var url = "http://127.0.0.1:3000/" + $link.attr("href");  // if you need a node.js server to serve data from another service
                var url = $link.attr("href");   // our code snippets are local to this client app so we just need a relative path
                console.log("LmvDbg: loading " + url);
                
                    // load the form in
                $.get(url, function(data) {
                    var formSection = $("div.lmvDbg_swap"); // replace contents at this DOM node with new HTML
                    formSection.html(data);
                    formSection.hide().fadeIn(500);
                    
                        // if its a "partials/" page, then take the code and put it into the source code panel
                    var prefixStr = url.substring(0, 8);
                    if (prefixStr === "partials") {
                        var sourceSection = $("code.language-markup");  // replace contents at this DOM node with source code
                        var htmlStr = escapeHTML(data);
                        sourceSection.html(htmlStr);
                        Prism.highlightAll();
                        sourceSection.hide().fadeIn(500);
                    }
                });
                
            });
            
        });
        
            // prism syntax highlighter needs html escaped with ampersand chars
        function escapeHTML(s) { 
            return s.replace(/&/g, '&amp;')
                    .replace(/"/g, '&quot;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;');
        }
        
       
    </script>
</head>
 
<body onload="loadInitialModel();" style="margin:0" oncontextmenu="return false;">  <!-- NOTE: setting oncontextmenu=false allows the viewer context menu to work (for things like "Hide Selected") -->
    <div class="container">
        <div class="row form-buffer">
            <img id="img_logo" src="./images/logo_header.png" alt="Autodesk, Inc.">
        </div>
        <div class="row form-buffer">
            <div class="col-md-4">
                <h1>LmvDbg</h1>
            </div>
            <div class="col-md-4">
                <label for="pu_modelToLoad">Model</label>
                <select id="pu_modelToLoad" class="form-control" name="modelToLoad">
                    <!-- Options filled in by function in LoadModel.js -->
                </select>
            </div>
            <div class="col-md-4">
                <label for="pu_viewToLoad">View</label>
                <select id="pu_viewToLoad" class="form-control" name="viewToLoad">
                    <!-- Options filled in by function in LoadModel.js -->
                </select>
            </div>
        </div>
    </div>
            
          <!-- Viewer and API function selection -->
    <div class="container">
        <div class="row">
            <div class="col-md-8" id="viewer">          <!-- Viewer goes here -->        
                <!-- Upon the viewer initalizaiton, it will append a div to the above div to insert the viewer.  It
                    will use 100% width and height so that it will fill up whatever the above div's dimensions are. 
                    NOTE: I had to set height in theme.css for this object or bootstrap would set height to 1px -->
            </div>
            <div class="col-md-3 col-md-offset-1" id="codeSnippetLinks">
                <h4>Viewer API functions</h4>
                <ul>
                    <li><a href="partials/setBackgroundColor.html">background color</a></li>
                    <li><a href="partials/setGhosting.html">ghosting</a></li>
                    <li><a href="partials/setNavMode.html">navigation tool</a></li>
                    <li><a href="partials/hideAll_showAll.html">hide/show/visibility</a></li>
                    <li><a href="partials/getCamera.html">camera</a></li>
                    <li><a href="partials/setView.html">view</a></li>
                    <li><a href="partials/setFocalLength.html">focal length</a></li>
                    <li><a href="partials/setFOV.html">FOV</a></li>
                    <li><a href="partials/explode.html">explode</a></li>
                    <li><a href="partials/getViewerState.html">viewer state</a></li>
                    <li><a href="partials/search.html">search</a></li>
                    <li><a href="partials/getObjTree.html">object tree</a></li>
                    <li><a href="partials/clickConfig.html">mouse-click config</a></li>
                    <br/>
                    <li><a href="partials/curSelectionSet.html">** Selection set **</a></li>
                    <li><a href="partials/dumpNavSettings.html">** Navigation settings **</a></li>
                    <li><a href="partials/dumpDocumentSettings.html">** Document settings **</a></li>
                    <li><a href="partials/overrideColor.html">** Override color **</a></li>
                    <br/>
                    <li><a href="https://docs.google.com/document/d/1p-rNfsNfi1-5BnCKrQr6RPtgXqGfVYLrqkOxRO0e3FE/pub">README</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <br/>

    <div class="container">
        <div class="lmvDbg_swap">
            <!-- form for a specific function will go here -->
        </div>
    </div>
    
    <br/>
    
    <div class="container">        
        <pre class="language-markup">
            <code class="language-markup">
                <!-- source code for a specific example goes here -->
            </code>  
        </pre>

    </div>
    
    <script src="./scripts/LoadModel.js"></script>

</body>
 
</html>
